INFO:     Will watch for changes in these directories: ['/home/ubuntu/OTB_TEST']
INFO:     Uvicorn running on http://0.0.0.0:5050 (Press CTRL+C to quit)
INFO:     Started reloader process [288482] using WatchFiles
INFO:     Started server process [288484]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     205.210.31.98:0 - "GET / HTTP/1.1" 200 OK
INFO:     64.225.60.253:0 - "GET / HTTP/1.1" 200 OK
INFO:     207.154.255.12:0 - "GET /solr/admin/info/system HTTP/1.1" 404 Not Found
INFO:     207.154.255.12:0 - "GET /solr/admin/cores?action=STATUS&wt=json HTTP/1.1" 404 Not Found
INFO:     167.94.138.58:0 - "GET / HTTP/1.1" 200 OK
INFO:     167.94.138.58:0 - "GET / HTTP/1.1" 200 OK
INFO:     167.94.138.58:0 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     167.94.138.39:0 - "GET / HTTP/1.1" 200 OK
INFO:     167.94.138.39:0 - "GET / HTTP/1.1" 200 OK
INFO:     167.94.138.39:0 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     198.235.24.94:0 - "GET / HTTP/1.1" 200 OK
INFO:     167.248.133.178:0 - "GET / HTTP/1.1" 200 OK
INFO:     167.248.133.178:0 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [288484]
INFO:     Stopping reloader process [288482]
INFO:     Will watch for changes in these directories: ['/home/ubuntu/OTB_API']
INFO:     Uvicorn running on http://0.0.0.0:5050 (Press CTRL+C to quit)
INFO:     Started reloader process [230420] using WatchFiles
INFO:     Started server process [230422]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection open
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection open
INFO:     connection closed
1
{'history_date_range': {'fro': '2023-01-01', 'to': '2023-12-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-12-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': True, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-01-01', to='2023-12-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-12-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
4.203973831 start_to_execute main the stored procedure
conn established
sp executed
4.280091564 end of main the stored procedure
conn established
sku wise calc executed
4.331922871 end of sku wise stored proc
we called the sku wise stored procedure_init
We are getting data from ra_and_stock
4.332027381 started to fetch data
conn established
<function getData.<locals>.<lambda> at 0x76aa723f6dd0> dfafghaf
259.512779788 end of fetch data
(535152, 168) output data shape
111111111111111111111111111111111111111111111
processing...
we are calling main groupby process
1
WebSocket connection closed unexpectedly
1
1
WebSocket connection closed unexpectedly
conn established
sku wise calc executed
263.501807955 end of sku wise stored proc
conn established
[OrderedDict([('id', 233274), ('store', None), ('region', None), ('area', None), ('Channel', 'B.TECH X'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 233275), ('store', None), ('region', None), ('area', None), ('Channel', 'MINI'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 233276), ('store', None), ('region', None), ('area', None), ('Channel', 'WAREHOUSE'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 233277), ('store', None), ('region', None), ('area', None), ('Channel', 'ARKAN'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 233278), ('store', None), ('region', None), ('area', None), ('Channel', 'Retail'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)])] 3310 getData dictsize
263.644924398 end of fetch data
shape: (3_310, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 233274 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 233275 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 233276 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 233277 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 233278 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 236579 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 236580 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 236581 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 236582 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 236583 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the filter dataframe
shape: (3_310, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 233274 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 233275 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 233276 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 233277 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 233278 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 236579 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 236580 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 236581 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 236582 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 236583 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the_fiter_data
id Int64
store String
region String
area Int32
Channel String
budget_year Int32
budget_quarter String
budget_month String
budget_weekday Int64
budget_day String
budget_dates Int32
historical_year Int64
history_Quarter String
history_month String
history_week String
history_Day String
history_datess Int32
family String
sub_Family String
Supplier String
Category String
Dom_Comm String
Sub_Category String
Extended_sub_category String
Sub_Category_supplier String
Article_Score Int32
last_v store store
last_v region region
last_v Channel Channel
last_v Quarter budget_quarter
last_v month budget_month
last_v week budget_weekday
last_v Day budget_day
last_v history_Quarter history_Quarter
last_v history_month history_month
last_v history_Day history_Day
last_v family family
last_v sub_family sub_Family
last_v supplier Supplier
last_v category Category
last_v dom_comm Dom_Comm
last_v sub_category Sub_Category
last_v extended_sub_category Extended_sub_category
last_v sub_category_supplier Sub_Category_supplier
{'store': ['Roxy Branch', 'BTECHX ASU', 'New sohag', 'Shebin El Koum Branch', 'Mall Of Arabia Branch', 'B2B Gov', 'Banha Branch', 'BTECHX Mansoura', 'Mall Of Egypt Branch', 'ElBahr ElAzam', 'Dar El Salam Branch', 'B.TECH STAFF', 'BTECHX Dokki', 'Oraby Branch', 'BTECH2Fayoum', 'Mahalla Branch', 'BTECHX Roxcy', 'BTECHX El Mosher Axis', 'October-WH', 'BTECHX Saad El Din El Shazly', 'BTECHX 2Mansoura', 'Noon Seller Store1', 'BTECH Mini Air Force House', 'Ismaila Branch-Railway station', 'Port Said', 'New Dumietta Branch', 'Alex_ Tusun', 'Malawi Branch', 'EL Matria', 'Hassan El Maamon', 'Makram Ebaid Branch', 'Mall Of October Branch', 'Mega Alex Sidi Gaber', 'Zahra El Asher Branch', 'Aswan WH', 'Shubra El Kheima Branch', 'HQ Call Center', 'BTECHX City Stars Mall', 'Sohag Branch', 'Shoubra Branch', 'Abbas El-Akkad Branch', 'BTECHX El Menia', 'BTECHX Open Air Mall', 'BTECHX Gihan3 Abasia', 'El Seyouf Branch', 'Dakernis Branch', 'Fakous Branch', 'Nagaa Hamadi Branch', 'BTECHX Safwa Zaid ', 'BTECHX ElRehab Mall1', 'BTECHX Maadi Grand Mall', 'Luxor Branch', 'BTECHX Manial', 'Asyut WH', 'B.ONLINE', 'Deel Asyut WH', 'Mansoura Branch', 'BTECHX ElRehab North', 'Mega Helwan', 'BTECHX Mahala', 'New Damanhour', 'BTECHX Assuit', '0', 'Smouha Branch', 'BTECHX Kafr ElSheikh', 'BTECHX The Yard Mall', 'El Fayoum Branch', 'Makadi Bay', 'Sale With Cost W.H', 'BTECHX El Sherouk', 'El Menia Mega Branch', 'Elagamy2', 'El Kanater Branch', 'Aswan Mega  Branch', 'Flag Mall Branch', 'El Tahrir', 'BTECHX CityCenterMaadi', '10th of Ramadan WH', 'Faisal Branch', 'BTECH mini Egyptian Shooting ', 'Tanta Branch', 'Zayton Branch', 'Desouk Branch', 'El Nozha Branch', 'Marina Kaian Branch', 'BTECH Mini MPC', 'Cairo Retail Warehouses', 'Agami Branch', 'Delta Tanta Mega Store', 'Mega Fisal', 'Corporate Sales', 'Suez Branch', 'BTECHX Obour2', '26Th July Branch', 'Uni Mall El Obour', 'Ras Ghareb Branch', 'Masara', 'GateWay Mall El Rehab', 'Salah Salim Branch', 'El Mokattam Branch', 'B.TECH X AUC', 'Qena Branch', 'BTECHX San_Stefano Mall', 'El-Elsoudan Street Branch', 'Assiut Branch - Ibn Sina Tower', 'BTECHX Truck Alex', 'QENA-Warehouse', 'Town Center El Salam', '10th Tech Club WH', 'Winget Branch', 'BTECHXMataria', 'Berket Elsabaa Branch', 'Banha warehouse', 'Dumietta Branch', 'BTECHX GardeniaTagamo', 'El Sadat Branch', 'El Zaher', 'BTECHX Moharam Bek', 'Loran Branch', 'CFC Mall', 'BTECHXCFC', 'Qalyub', 'El Galaa', 'BTECHX ElShams Club', 'Miela Arkan Mall', 'Alex WH', 'BTECHX Midor', 'El Sayeda Zainab', 'Maadi Branch-El Laselky St.', 'Miela Arkan WH', 'El Tagamou 1 Branch', 'BTECHX Hegaz', 'EL Amiria Branch', 'BTECHX Airport', 'Misr elgdida', '9025Show Room Alex', 'Amwaj ranch', '10th Show Room WH', 'Alamein Masa Mall', 'BTECHX Ramses Station', 'Haram Branch', 'BTECHX Sheraton', 'B.TECHX El Mandara', 'Hadek El Kobba Branch', 'BTECHX Shinzo Abe', 'El Helmya', 'Sky Mall El Sherouk Branch', 'BTECHX Sohag', 'BTECHX Gehan2 Dewaka', 'BTECHX Sporting Club', 'BTECHX Sidi Bishr', 'Show Room - Corp. Sale-38', 'BTECHX Kasr El Einy', 'BTECHX Triumph Tagamo', 'BTECHX 45', 'Beni Suef Branch', 'Marassi-North-Coast Branch', 'El-Gouna Branch', 'BTECHX Ismailia Square', 'BTECHX Zagazig', 'Zagazig Branch', 'Damanhour Branch', 'El Betash Branch', 'Ain Shams Branch - Mostafa Hafez St.', 'Almaza Branch', 'BTECHX CityCenter Alex', 'Tanta WH', 'Ismalia Branch-City Council Square', 'Asafra Branch', 'Gesr El Suez Branch', '3Tanta Mall', 'El Tagamou 2 Branch', 'Eldahar Mega Branch', 'Marina Branch', 'BTECHX Shebin El koum', 'New Roxy', 'Jumia Seller Store', '1Imbaba', 'Assuit Mega Branch', 'Ain Shams Branch - Ibrahim Abdel Razek St.', 'Quesna Branch'], 'region': ['HURGHADA', 'UPPER EGYPT', '0', 'CAIRO', 'ALEXANDRIA', 'DELTA'], 'season': [], 'area': [], 'Channel': ['B2B', 'MINI', 'DEEL', 'B.TECH X', 'Retail', 'NON', 'ONLINE', 'ARKAN', 'CALL CENTER', '0', 'WAREHOUSE'], 'budget_year': [0.0], 'Quarter': ['0', '4', '3'], 'month': ['July     ', '0', 'November ', 'December ', 'August   ', 'October  ', 'September'], 'week': [0, 1, 2, 3, 4, 5, 6, 7], 'date': ['20019', '19924', '19920', '20068', '19950', '19930', '19984', '19971', '19982', '20066', '19927', '20061', '20009', '19941', '20021', '19966', '20047', '19973', '20012', '20032', '20042', '19985', '20010', '19983', '20020', '20003', '19942', '19925', '20073', '20081', '20008', '19935', '20026', '19975', '19963', '19937', '20054', '19918', '19968', '19911', '19965', '20000', '19962', '19909', '19919', '20045', '19943', '19994', '19997', '20024', '19958', '20065', '19956', '19946', '19922', '20004', '20034', '19995', '19929', '20085', '19972', '20036', '20053', '19986', '19974', '20087', '19961', '19996', '20084', '20074', '20006', '19948', '19936', '19912', '19977', '19999', '19969', '19947', '20063', '19976', '20023', '19987', '19934', '20031', '20049', '19992', '19967', '19970', '19907', '20052', '20022', '19915', '19905', '19933', '20064', '19988', '19928', '20016', '19989', '19945', '20040', '20088', '20056', '20015', '20078', '20079', '20043', '20051', '19964', '19959', '20059', '20060', '19913', '19978', '20033', '19991', '20076', '20002', '20028', '19939', '20070', '20044', '20069', '20014', '20057', '19923', '19931', '19955', '20007', '20062', '20025', '20039', '19932', '20082', '20086', '20005', '19993', '19951', '20037', '19926', '20077', '20075', '19906', '20035', '19990', '19944', '20083', '20001', '19914', '19917', '20017', '19957', '19916', '20080', '19949', '0', '19954', '19960', '20046', '19910', '20058', '19980', '20072', '20038', '19940', '19938', '19981', '19921', '19953', '20029', '20030', '20050', '19998', '19979', '20055', '19952', '20071', '19908', '20041', '20011', '20067', '20013', '20018', '20048', '20027'], 'Day': ['Saturday ', 'Monday   ', 'Wednesday', 'Tuesday  ', 'Thursday ', 'Sunday   ', '0', 'Friday   '], 'historical_year': [], 'history_Quarter': ['1', '0', '4', '2', '3'], 'history_month': ['April    ', 'November ', '0', 'July     ', 'January  ', 'May      ', 'June     ', 'March    ', 'August   ', 'February ', 'December ', 'September', 'October  '], 'history_week': ['0', '1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '3', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '4', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '5', '50', '51', '52', '6', '7', '8', '9'], 'history_Day': ['Thursday ', 'Tuesday  ', 'Wednesday', 'Saturday ', '0', 'Friday   ', 'Sunday   ', 'Monday   '], 'history_dates': [0, 18997, 19003, 19005, 19010, 19011, 19015, 19016, 19017, 19022, 19023, 19038, 19040, 19044, 19049, 19050, 19052, 19053, 19057, 19059, 19066, 19068, 19072, 19073, 19074, 19078, 19079, 19080, 19085, 19086, 19087, 19088, 19089, 19095, 19101, 19102, 19103, 19106, 19108, 19109, 19110, 19120, 19121, 19122, 19123, 19124, 19127, 19128, 19129, 19130, 19131, 19134, 19135, 19136, 19137, 19138, 19141, 19143, 19145, 19148, 19150, 19152, 19155, 19156, 19158, 19159, 19162, 19163, 19164, 19165, 19166, 19170, 19171, 19172, 19176, 19178, 19179, 19180, 19186, 19187, 19190, 19192, 19193, 19198, 19200, 19201, 19204, 19206, 19208, 19211, 19212, 19213, 19214, 19215, 19218, 19220, 19221, 19222, 19226, 19227, 19228, 19229, 19232, 19233, 19235, 19236, 19239, 19240, 19241, 19242, 19243, 19245, 19246, 19247, 19248, 19249, 19250, 19252, 19253, 19254, 19255, 19256, 19257, 19259, 19260, 19261, 19262, 19263, 19264, 19266, 19267, 19268, 19269, 19270, 19271, 19273, 19274, 19275, 19276, 19277, 19278, 19279, 19280, 19281, 19282, 19283, 19284, 19285, 19286, 19287, 19288, 19289, 19290, 19291, 19292, 19293, 19294, 19295, 19296, 19297, 19298, 19299, 19300, 19301, 19302, 19303, 19304, 19305, 19306, 19307, 19308, 19309, 19310, 19311, 19312, 19313, 19314, 19315, 19316, 19317, 19318, 19319, 19320, 19321, 19322, 19323, 19324, 19325, 19326, 19327, 19328, 19329, 19330, 19331, 19332, 19333, 19334, 19335, 19336, 19337, 19338, 19339, 19340, 19341, 19342, 19343, 19344, 19345, 19346, 19347, 19348, 19349, 19350, 19351, 19352, 19353, 19354, 19355, 19356, 19357, 19358, 19359, 19360, 19361, 19362, 19363, 19364, 19365, 19366, 19367, 19368, 19369, 19370, 19371, 19372, 19373, 19374, 19375, 19376, 19377, 19378, 19379, 19380, 19381, 19382, 19383, 19384, 19385, 19386, 19387, 19388, 19389, 19390, 19391, 19392, 19393, 19394, 19395, 19396, 19397, 19398, 19399, 19400, 19401, 19402, 19403, 19404, 19405, 19406, 19407, 19408, 19409, 19410, 19411, 19412, 19413, 19414, 19415, 19416, 19417, 19418, 19419, 19420, 19421, 19422, 19423, 19424, 19425, 19426, 19427, 19428, 19429, 19430, 19431, 19432, 19433, 19434, 19435, 19436, 19437, 19438, 19439, 19440, 19441, 19442, 19443, 19444, 19445, 19446, 19447, 19448, 19449, 19450, 19451, 19452, 19453, 19454, 19455, 19456, 19457, 19458, 19459, 19460, 19461, 19462, 19463, 19464, 19465, 19466, 19467, 19468, 19469, 19470, 19471, 19472, 19473, 19474, 19475, 19476, 19477, 19478, 19479, 19480, 19481, 19482, 19483, 19484, 19485, 19486, 19487, 19488, 19489, 19490, 19491, 19492, 19493, 19494, 19495, 19496, 19497, 19498, 19499, 19500, 19501, 19502, 19503, 19504, 19505, 19506, 19507, 19508, 19509, 19510, 19511, 19512, 19513, 19514, 19515, 19516, 19517, 19518, 19519, 19520, 19521, 19522, 19523, 19524, 19525, 19526, 19527, 19528, 19529, 19530, 19531, 19532, 19533, 19534, 19535, 19536, 19537, 19538, 19539, 19540, 19541, 19542, 19543, 19544, 19545, 19546, 19547, 19548, 19549, 19550, 19551, 19552, 19553, 19554, 19555, 19556, 19557, 19558, 19559, 19560, 19561, 19562, 19563, 19564, 19565, 19566, 19567, 19568, 19569, 19570, 19571, 19572, 19573, 19574, 19575, 19576, 19577, 19578, 19579, 19580, 19581, 19582, 19583, 19584, 19585, 19586, 19587, 19588, 19589, 19590, 19591, 19592, 19593, 19594, 19595, 19596, 19597, 19598, 19599, 19600, 19601, 19602, 19603, 19604, 19605, 19606, 19607, 19608, 19609, 19610, 19611, 19612, 19613, 19614, 19615, 19616, 19617, 19618, 19619, 19620, 19621, 19622, 19623, 19624, 19625, 19626, 19627, 19628, 19629, 19630, 19631, 19632, 19633, 19634, 19635, 19636, 19637, 19638, 19639, 19640, 19641, 19642, 19643, 19644, 19645, 19646, 19647, 19648, 19649, 19650, 19651, 19652, 19653, 19654, 19655, 19656, 19657, 19658, 19659, 19660, 19661, 19662, 19663, 19664, 19665, 19666, 19667, 19668, 19669, 19670, 19671, 19672, 19673, 19674, 19675, 19676, 19677, 19678, 19679, 19680, 19681, 19682, 19683, 19684, 19685, 19686, 19687, 19688, 19689, 19690, 19691, 19692, 19693, 19694, 19695, 19696, 19697, 19698, 19699, 19700, 19701, 19702, 19703, 19704, 19705, 19706, 19707, 19708, 19709, 19710, 19711, 19712, 19713, 19714, 19715, 19716, 19717, 19718, 19719, 19720, 19721, 19722, 19723, 19724, 19725, 19726, 19727, 19728, 19729, 19730, 19731, 19732, 19733, 19734, 19735, 19736, 19737, 19738, 19739, 19740, 19741, 19742, 19743, 19744, 19745, 19746, 19747, 19748, 19749, 19750, 19751, 19752, 19753, 19754, 19755, 19756, 19757, 19758, 19759, 19760, 19761, 19762, 19763, 19764, 19765, 19766, 19767, 19768, 19769, 19770, 19771, 19772, 19773, 19774, 19775, 19776, 19777, 19778, 19779, 19780, 19781, 19782, 19783, 19784, 19785, 19786, 19787, 19788, 19789, 19790, 19791, 19792, 19793, 19794, 19795, 19796, 19797, 19798, 19799, 19800, 19801, 19802, 19803, 19804, 19805, 19806, 19807, 19808, 19809, 19810, 19811, 19812, 19813, 19814, 19815, 19816, 19817, 19818, 19819, 19820, 19821, 19822, 19823, 19824, 19825, 19826, 19827, 19828, 19829, 19830, 19831, 19832, 19833, 19834, 19835, 19836, 19837, 19838, 19839, 19840, 19841, 19842, 19843, 19844, 19845, 19846, 19847, 19848, 19849, 19850, 19851, 19852, 19853, 19854, 19855, 19856, 19857, 19858, 19859, 19860, 19861, 19862, 19863, 19864, 19865, 19866, 19867, 19868, 19869, 19870, 19871, 19872, 19873, 19874], 'article_score': ['sale', 'abc', 'ae', 'speed', 'terminal', 'margin', 'sell', 'markdown', 'core', 'quartile', 'sortimeter'], 'history_year': [0.0, 2022.0, 2023.0, 2024.0], 'family': ['0', 'LAPTOP', 'MDA', 'BMOBILE ACCESSORIES', 'TABLET', 'MOBILE', 'TV', 'SDA', 'NON', 'AC', 'COMPLEMENTARY'], 'sub_family': ['AC COM', 'MDA DOM', 'TV DOM', 'BMOBILE', 'AC DOM', '0', 'TV COM', 'MDA COM', 'SDA COM', 'SDA DOM', 'NON'], 'supplier': ['SPEED', 'SANDISK', 'EPSON', 'EZVIZ', 'SENCOR', 'GLEMGAS', 'HONOR', 'HOOVER', 'ATLANTIC', 'ETI', 'SYINIX', 'MIDEA', 'NESPRESSO', 'BMOBILE ACCESSORIES', 'ORIGINAL', 'AMERICOOL', 'CHOETECH', 'ARISTON', 'INFINIX', 'KLASS', 'CANON', 'TANK', 'MICROSOFT', 'XIAOMI', 'MUTECH', 'VIEW', 'KIRIAZI', 'DOB', 'ROVO', 'SKYWORTH ZAPPER', 'STRONG', 'BLACK AND WHITE', 'CLAGE', 'NI', 'CRAFT', 'VAIO', 'CARRIERE', 'WACACO', 'LA GERMANYA', 'CONTEX', 'CANDY', 'FLAT', 'HUAWEI', 'ASUS', 'HELLER', 'ELIOS', 'HAIER', 'TOSHIBA', 'INTEL', 'G.TEC', 'AKWRJ', 'ATA', 'ARIETE', 'IDEAL', 'FRANKE', 'TORNADO', 'OKKA', 'NARDI', 'MSI', 'NIKON', 'GENERAL ELECTRIC', 'SONY', 'OPPO', 'HAPILLINE', '0', 'KHATER', 'BIALETTI', 'TCL', 'ICONZ', 'FERROLI', 'REMINGTON', 'KARCHER', 'OZO', 'BABYLISS', 'GALAXI', 'SOLAC', 'BOMAN', 'FRESH', 'NESTLE', 'ROYAL', 'BAUMATIC', 'RUSH BRUSH', 'LONGLIFE', 'LOGITECH', 'ARION', 'GORENJE', 'UG', 'F&D', 'BISSELL', 'SHTEBEL', 'SAMSUNG', 'LENOVO', 'LG', 'BOSCH', 'ORAIMO', 'NOKIA', 'ILOOK', 'WHITE WHALE', 'FORA', 'REALME', 'VIVO', 'BENEX', 'BEKO', 'XAIOMI', 'NIKAI', 'LDNIO', 'OLYMPIC', 'TOUCH', 'PREMIUM', 'SONAI', 'SEASONS', 'APPLE', 'FLYON', 'BERGEN', 'SNDWAY', 'KENWOOD', 'PHILIPS', 'TEFAL', 'ITEL', 'KIOXIA', 'MEDIA TECH', 'NOUR TECH', 'DALY', 'SEM', 'INDESIT', 'ZANUSSI', 'MPT HT', 'AMAZONE', 'DAEWOO', 'SCHNEIDER', 'BLACK AND DECAR', 'ARZUM', 'KOLDAIR', 'DAHUA', 'ALASKA', 'S.LINK', 'ELBA', 'ULTRA', 'MUSIC HERO', 'OSN', 'GROUHY', 'LAVVENTO', 'TRUMAN', 'AVANTREE', 'ZAHRAN', 'HAVIT', 'NON', 'SARY', 'TOSHIBA Midea', 'UNIVERSAL', 'CAIXUN', 'BRAUN', 'MOULINEX', 'UNION AIRE', 'HOME TECH', 'HISENSE', 'ECOMATIC', 'LAVA', 'WHITE POINT', 'TIGER', 'FIRST', 'MODEM', 'PREMIER', 'SHARP', 'STEEL', 'MIELE', 'BENQ', 'FUTURE', 'ALEXA', 'BeKO', 'HAMA', 'PLUTO', 'DELONGHI', 'MPT PT', 'MIENTA', 'ZADA', 'FAGOR', 'DAIKIN', 'HOPE', 'MODEX', 'VEITO', 'PASSAP', 'ELECTROSTAR', 'HITACHI', 'INFINX', 'ICOOK', 'SIMFER', 'CLABER', 'HOME', 'HOUSECOM', 'SMART', 'HP', 'BRANDT', 'PANASONIC', 'DELL', 'KEENDEX', 'FALCON'], 'category': ['Headset SBS', 'Filter Tank', 'Grill Zada', 'Gift Indesit', 'Cables SBS', 'Kettle Touch', 'TV Accessory', 'TV Acc Energizer', 'Ele Heater Toshiba', 'Gift Nestle', 'F.Proc Moulinex', 'Oven Brandt', 'Comp Monitor Dell', 'E.Hot Pla Home', 'AC Acc Union Aire', 'Warmer Heller', 'Charger SBS', 'Gas Heater Tornado', 'WD speed', 'TV Tcl', 'Fun Line Media Tech', 'AC Zanussi', 'Air Styler Babyliss', 'TV Rowa', 'AC Union Aire?', 'Kitchen M Ariete', 'Mic. Zanussi', 'Air Cooler Fresh', 'Deep F Ariston', 'Speaker SBS', 'IFix', 'Fridge Kiriazi', 'Cleaning SBS', 'Power Bank SBS', 'F.Proc ULTRA', 'Blender Modex', 'Washing M Bosch', 'H.Mixer Braun', 'AC Daikin', 'Fridge Union Aire', 'Coffee M Solac', 'Mobile OPPO', 'kitchen m sary', 'Holders SBS', 'Hair Dryer Solac', 'Chopper Fresh', 'Fun Line Black&decke', 'Mic. Hoover', 'Hair Dryer Philips', 'Oven Touch', 'Cooker Premium', 'Oven Hoover', 'TV Acc HP', 'Oven Miele', 'F.Proc Black&white', 'Iron Home', 'Juicer Moulinex', 'H.Mixer Rovo', 'Gas Heater Bosch', 'Kettle SENCOR', 'Gift LG', 'TV Sharp', 'Blender Touch', 'TV Hisense', 'Warmer Media Tech', 'D Washer Indesit', 'Mincer White Whale', 'Ele Heater Ariston', 'Blender Moulinex', 'Juicer Solac', 'Thermoses Tiger', 'Kettle Housecom', 'Hood Fresh', 'AC Beko', 'AC Accessory Fresh', 'Frayer Miele', 'Laptop Microsoft', 'Lam Philips', 'Deep F Miele', 'VC Fresh', 'H.Blend G.tec', 'Hobs Nardi', 'Wall Hood Fresh', 'Blender G.tec', 'R.cooker Media Tech', 'Tripod SBS', 'Washing M Tornado', 'Complent Alexa IOT', 'mosq.kill Home', 'Oven Ultra', 'tv acc truman', 'Washing M Beko', 'Gas Heater Zanussi', 'Hood Panasonic', 'Fan Kenwood', 'Mobile APPLE', 'Fridge Ideal', 'Coffee M Modex', 'Oven Fresh', 'Deep F Sharp', 'Ele Heater White Wha', 'Oven Sharp', 'Gas Heater Olympic', 'Mincer Bosch', 'Coffee M Media Tech', 'VC Grouhy', 'Curl Irons Rush brus', 'Receiver Daly', 'Coffee M Beko', 'Kettle Black&decker', 'Fan universal', 'Blender Ultra', 'WD Ultra', 'Shaving_Tri Philips', 'TV Pluto', 'Toaster tornado', 'Chopper Ariete', 'H.Blend Black&decker', 'Masher Kenwood', 'Tablet Nokia', 'Hobs Bosch', 'Iron Black&Decker', 'Iron Mienta', 'Chopper Tornado', 'Bundle- b-in Indesit', 'Mobile HONOR', 'Deep F Indesit', 'Complem Camera CANON', 'Comp Monitor Xiaomi', 'Ele Heater Zanussi', 'D Washer Bosch', 'M.Mincer Kenwood', 'Protection SBS', 'Gas Heater White Wha', 'Grill Modex', 'Wall Hood Tornado', 'Hobs Indesit', 'Hood Elba', 'Coffee M SMART', 'Receiver ETI', 'Tablet APPLE', 'D Washer Beko', 'Juicer Bosch', 'Coffee M Tefal', 'Hood ASS Indesit', 'H.Blend Moulinex', 'Mixer Black&decker', 'F.Proc Bosch', 'Kitchen M Black&whit', 'Oven Bosch', 'Kettle Panasonic', 'AC Crafft', 'Kettle Tornado', 'Mincer Black&decker', 'Grill Home', 'Coffee M Bialetti', 'Toaster Home', 'Washing M Fresh', 'VC Ariete', 'IFixBtech', 'Air Purifier SHARP', 'Comp Monitor Lenovo', 'Grill Fresh', 'H.Blend SENCOR', 'H.Blend Bosch', 'kettle Mienta', 'Kitchen M Home', 'TV Acc Etrain', 'Kettle Braun', 'E.Hot Touch', 'Deep F Panasonic', 'Frayer Ariston', 'Mobile INFINX', 'H.Blend Home', 'Fun Line Ariete', 'Straightners Rush br', 'Thermal Mug WACACO', 'Deep F Electrostar', 'Fan Sonai', 'Air Fryer Tornado', 'Fridge LG', 'Grill Tefal', 'Frayer Modex', 'Tablet Lenovo', 'Comp Printer Epson', 'Ele Heater Union Air', 'AC Accessory Sharp', 'Oven Klass', 'Deep F White Whale', 'Fridge Haier', 'H.Blender Smart', 'Warmer veito', 'AC Midea', 'Receiver', 'Gaming ASS ASS', 'Grill Mienta', 'Air Styler Rush brus', 'AC Accessory Premium', 'Fridge Beko', 'Oven Franke', 'Fridge Samsung', 'D Washer LG', 'Kitchen M Modex', 'Comp Monitor Samsung', 'TV Acc Itel', 'Ice Tank Tank', 'Mic. Daewoo', 'Cooker Bosch', 'Coffee M Nespresso', 'Iron Ariete', 'VC Black&white', 'Mobile Hope', 'Coffee M okka', 'Blender Braun', 'Warmer Delonghi', 'Mobile LAVA', 'F.Proc Home', 'Fridge Sharp', 'Warmer Mienta', 'Kettle Zada', 'TABLET REALME', 'Juicer Home Tech', 'Toaster Ariete', 'AC Carriere', 'Mixer Touch', 'Compl Camera GoPRO', 'H.Blend Tornado', 'Gas Heater Arion', 'Hobs Fagor', 'VC Hitachi', 'Deep F PASSAP', 'Chopper Touch', 'IT ASS ASS', 'Warmer Black&decker', 'Tools Hitachi', 'Blender Media Tech', 'Kettle Zahran', 'Audio LG', 'AC Hisense', 'Deep F Tornado', 'B.ElectronicServices', 'Deep F Beko', 'Wall Hood Olympic', 'Iron Braun', 'Toaster Kenwood', 'Washing M Samsung', 'Chopper Sonai', 'Audio Samsung', 'Frayer Home', 'TV ATA', 'H.Mixer Panasonic', 'Deep F Union Aire?', 'Grill Solac', 'WARMER Ultra', 'Air Cooler Home', 'Chopper Bosch', 'D Washer White Point', 'Coffee M Tornado', 'TV Syinix', 'F.Proc SMART', 'Complem Camera Nikon', 'Ele Heater TORNADO', 'VC Tornado', 'Hobs Beko', 'Tools Claber', 'Frayer Philips I2', 'TV FRESH', 'VC Bosch', 'Iron Modex', 'TV Union Aire', 'Comp Google Mesh IOT', 'Juicer Kenwood', 'Deep F Fresh', 'Washing M Kiriazi', 'Hair Dryer Rush brus', 'Curl Irons Babyliss', 'Iron Media Tech', 'AC ULTRA', 'TV Nikai', 'Lam Black&decker', 'Hair Dryer Tornado', 'Hobs Tornado', 'Coffee M Sonai', 'VC LG', 'Straightners Solac', 'D Washer Fresh', 'H.Blend Kenwood', 'Kettle Ariete', 'Wall Hood Toshiba', 'Fridge ULTRA', 'Gas Heater Ariston', 'Ele Heater Olympic', 'Washing M Toshiba', 'Kitchen M Bosch', 'H.Mixer Modex', 'Receiver SkyWorth Za', 'Boxi', 'Gas Heater premium', 'Thermal Mug Tefal', 'F.Proc Braun', 'Tools MPT PT', 'Toaster Mienta', 'TV Acc Tiger', 'Cooker Universal', 'Mic. Ariston', 'tv acc elios', 'Kitchen M Kenwood', 'TV Acc STEEL', 'Gas Heater Universal', 'Mobile XIAOMI', 'Mic. SMART', 'Juicer Mienta', 'Audio', 'Filter ASS philips', 'Juicer Tornado', 'Receiver Galaxi', 'Cooking Appliances A', 'Mobile NOKIA', 'Mic. Kenwood', 'Cooker Zanussi', 'Shaving_TriRemington', 'Complem Gaming Sony', 'Washer Dry ASSMiele', 'Mixer Black&white', 'Washing M LG', 'Ele Heater Kiriazi', 'Selfie Stick SBS', 'Kettle Kenwood', 'Stand Indesit', 'tv acc schneider', 'H.Mixer Midea', 'Iron Tefal', 'H.Mixer Bosch', 'Blender Smart', 'TV Acc ICONZ', 'Audio Philips', 'Grill Black&decker', 'Juicer Sonai', 'Gift Bosch', 'VC Samsung', 'Masher Mienta', 'H.Mixer Black&white', 'Grill Kenwood', 'TV Acc MUTECH', 'Air Fryer Kenwood', 'Juicer Modex', 'AC Accessory Daikin', 'Laptop VAIO', 'Shaving_Tri Tornado', 'Gas Heater White Poi', 'Gift Fresh', 'Compl DESK PC Intel', 'Warmer Fresh', 'F.Proc Grouhy', 'VC AccessoriesMiele', 'Compl Printer CANON', 'Grill Tornado', 'Mobile Samsung', 'TV Acc ETI', 'Laptop ASUS', 'Fan Arion', 'Fun Line Solac', 'H.Mixer Fresh', 'AC Americool', 'Ele heater flyon', 'Hood Miele', 'Gift Universal', 'VC Solac', 'TV Acc FLAT', 'Coffee M Kenwood', 'Shaving_Tri Hapillin', 'R.cooker HOME', 'Mixer Media Tech', 'Fridge Electrostar', 'Washing M White Poin', 'Mobile REALME', 'Washing M Hoover', 'F.Proc Kenwood', 'AC Accessory Zanussi', 'Straightners Braun', 'Washing M Sharp', 'Hobs SMART', 'Washing M Ariston', 'Straightners Babylis', 'Mic. Sharp', 'Deep F White Point', 'Espresso Machine Ari', 'Hobs Hoover', 'Chopper Mienta', 'Kettle Fresh', 'Laptop APPLE', 'AC Accessory Carrier', 'D Washer Miele', 'M.Mincer Bosch', 'TV Ultra', 'M.Mincer Sonai', 'Chopper Black&decker', 'Straightners Tornado', 'Complem Printer HP', 'Cooker Royal', 'Washing M Miele', 'Cooker Fresh', 'Deep F Alaska', 'Hair Dryer Remington', 'AC Accessory LG', 'Fridge Toshiba', 'Mic. Black&decker', 'E.Hot Plate SMART', 'H.Blend Media Tech', 'Ele Heater Clage', 'Iron Tornado', 'AC Premium', 'Oven Fagor', 'VC Hoover', 'Air Cooler Tornado', 'Oven Nardi', 'H.Blend Black&white', 'F.Proc Mienta', 'Coffee M Zada', 'Fun Line Sonai', 'Mic. Fresh', 'F.Proc Benex', 'Cooker La germanya', 'Hood Sonai', 'Fan Panasonic', 'VC Rovo', 'Enquiry Fees', 'TV SARY', 'VC Smart', 'Laptop Huawei', 'TV View', 'WD PASSAP', 'Hood Indesit', 'R.cooker Black&decke', 'Hair Dryer arzum', 'Hobs Baumatic', 'VC Mienta', 'Hood Bosch', 'Audio oraimo', 'Ele Heater Shtebel', 'Blender Bosch', 'Mixer Kenwood', 'Hobs Fresh', 'Fridge PASSAP', 'Hood Hoover', 'TV UG', 'AC TORNADO', 'F.Proc G.tec', 'Mic. Home', 'TV Samsung', 'Oven Simfer', 'Kettle Arion', 'Gas Heater Panasonic', 'Kitchen M Fresh', 'Sport Machine Khater', 'Gas Heater PASSAP', 'Dryer Home', 'Ele Heater Universal', 'Tools MPT HT', 'TV Premium', 'Mixer Union Aire', 'Gas Heater Toshiba', 'Blender sary', 'H.Blend sary', 'Hobs Gorenje', 'R.cooker Modex', 'Washing M Fagor', 'Ele Heater VEITO', 'Washing M Union Aire', 'Juicer Braun', 'Kettle Modex', 'Fridge Ariston', 'Frayer Tefal', 'Coffee M Philips I2', 'Fun Line Tornado', 'Blender Ariete', 'H.Mixer Touch', 'TV Haier', 'Frayer Black&decker', 'Audio First', 'TV LG', 'WD Fresh', 'Hobs ICook', 'D Washer Zanussi', 'Blender Black&white', 'VC Modex', 'Fridge Tornado', 'Oven Tornado', 'Hood Franke', 'Iron Kenwood', 'Tablet TCL', 'WD Tornado', 'F.Proc Black&decker', 'Audio Media Tech', 'Gas Heater Atlantic', 'F.Proc Modex', 'Gas Heater Kiriazi', 'Kettle SMART', 'Oven Mienta', 'Hobs Zanussi', 'Ele Heater Atlantic', 'Coffee M Delonghi', 'Hood Zanussi', 'Hobs GLEMGAS', 'TV Acc hama', 'Kitchen M Mienta', 'Hobs Franke', 'Toaster Panasonic', 'Oven Ariston', 'Hood Gorenje', 'Juicer Home', 'Hood Ariston', 'Iron Black&white', 'kettle Black&white', 'Mincer Home', 'Comp Monitor BenQ', 'Fan Smart', 'Straightners Philips', 'Fan Black&white', 'TV Acc STRONG', 'F.Proc Tornado', 'AC Fresh', 'Fridge White Whale', 'Blender Panasonic', 'Cooker Beko', 'Sport Machine Future', 'Hood Tornado', 'Hobs Ariston', 'Air Purifier LG', 'Cliner M Karcher', 'Cooker Union Aire?', 'M.Mincer Panasonic', 'F.Proc Panasonic', 'Frayer Bergen', 'Dryer LG', 'Blender sencor', 'Oven Indesit', 'TV Tornado', 'Blender Sonai', 'Washing M Zanussi', 'Mixer Ultra', 'Cooker Kiriazi', 'Audio Toshiba', 'Fridge Bosch', 'Deep F Toshiba', 'Toaster Braun', 'Mixer Modex', 'Laptop HP', 'TV ASS ASS', 'Scale Solac', 'VC Daewoo', 'Iron Smart', 'Grill Bosch', 'tv acc keendex', 'Oven Zanussi', 'Washing M Indesit', 'Fun Line Zahran', 'Oven Elba', 'Laptop MSI', 'TV Acc ilook', 'H.Mixer Mienta', 'Tablet Huawei', 'Coffee M Home', 'Audio Avantree', 'Blender Home', 'Hobs Klass', 'Mic. Tornado', 'H.Mixer SMART', 'Warmer Shtebel', 'Laptop Lenovo', 'Hood ICook', 'WD White Whale', 'kettle Media', 'Kettle Media Tech', 'Hobs Brandt', 'AC Haier', 'Hobs Elba', 'F.Proc Sonai', 'AC Accessory Crafft', 'Kettle Sonai', 'Shaving_Tri Babyliss', 'Blender Black&decker', 'Kettle Bosch', 'Gas Heater LongLife', 'Grill Touch', 'TV Acc Fora', 'AC Sharp', 'Chopper Media Tech', 'Bottel Tank', 'Audio Dob', 'Iron Touch', 'Blender Kenwood', 'Iron Ultra', 'Grill Media Tech', 'VC Toshiba', 'Shaving_Tri Braun', 'Mic. Samsung', 'TV Sony', 'Hood Touch', 'Coffee M Bosch', 'Kitchen M SMART', 'VC Tefal', 'Hood Fagor', 'Kitchen M Moulinex', 'Thermal Mug Tiger', 'Tools sndway', 'Thermal Mug Tank', 'Chopper Ultra', 'Fridge Alaska', 'M.Mincer Moulinex', 'TV Contex', 'Warmer Akwrj', 'Hood Beko', 'TV Acc osn', 'Fridge Miele', 'M.Mincer SMART', 'VC Miele', 'Ele Heater Boman', 'M.Mincer Black&White', 'Fridge Indesit', 'Blender Fresh', 'Fan Tefal', 'VC Panasonic', 'Deep F Kiriazi', 'Hobs Miele', 'Cooker White Whale', 'H.Blender Braun', 'Kitchen M G.tec', 'VC Black&decker', 'Com Projector Merlin', 'H.Blend Touch', 'Mobile VIVO', 'Deep F LG', 'Oven Gorenje', 'Fan Tornado', 'Toaster Black&decker', 'WD White Point', 'M.Mincer Braun', 'Oven beko', 'Air Cooler Sonai', 'M Grinder Sonai', 'Tools Bosch', 'E.Hot Plate Mienta', 'Fan Touch', 'Fridge White Point', 'Hobs ECOMATIC', 'Masher Black&white', 'Kettle Home', 'H.Mixer Moulinex', 'Gas Heater Ferroli', 'Security Ass Camera ', 'Cooker White Point', 'F.Proc Ariete', 'Chopper Rovo', 'H.Mixer Sonai', 'Gift Samsung', 'Straightners Mienta', 'TV Toshiba', 'Receiver truman', 'Hood Premier', 'Washing M Haier', 'VC Kenwood', 'B.Electronic ass', 'Juicer Media Tech', 'Coffee M White Whale', 'Gas Heater Union Air', 'Fan Fresh', 'Fan Nikai', 'WD Tank', 'Fan Mienta', 'Blender Tornado', 'TV Caixun', 'H.Mixer Tornado', 'Mobile Huawei', 'Fan Union Aire?', 'Laptop DELL', 'Frayer Mienta', 'TV Acc NI', 'Airpods kit SBS', 'Filter ASS Tank', 'Frayer Delonghi', 'Iron Panasonic', 'Iron Philips I2', 'Transferfeesonline01', 'Tablet Samsung', 'Mic. LG', 'Ele Heater Fresh', 'Chopper SMART', 'VC Ultra', '0', 'H.Blend Mienta', 'M.Mincer Touch', 'Gas Heater Fresh', 'Blender Mienta', 'Audio sony', 'Fun Line Mienta', 'Washing M Premium', 'D Washer Ariston', 'Coffee M Mienta', 'AC LG', 'Kettle Solac', 'E.Hot Plate Fresh', 'Iron Solac', 'H.Blender SEM', 'Washer Dryer Ariston', 'Coffee Grinder Ariet', 'VC Bissell', 'Fun Line Home', 'AC Accessory Haier', 'Audio F&D', 'Oven Home', 'AC General Electric', 'R.cooker Tefal', 'Fridge Fresh', 'Chopper Moulinex', 'Fan black&decker', 'M.Mincer Tornado', 'TV Acc Media Tech', 'Fan Ultra', 'F.Proc Union Aire', 'Fridge Zanussi', 'Chopper Kenwood', 'Coffee M Braun', 'Security Ass Camera', 'TV Acc Toshiba', 'WD Bergen', 'Cappuccino Maker Ari', 'Washing M CANDY', 'TV Acc Falcon', 'Straightners Remingt', 'Warmer Touch', 'M.Mincer Modex', 'Ice Box Tank', 'Frayer Fresh', 'Gift Ariston', 'H.Mixer Kenwood', 'Kitchen M Touch', 'Warmer Tornado', 'Hair Dryer Babyliss', 'B2B AC', 'Coffee M Black&decke'], 'dom_comm': ['COMM', 'DOM', 'B.MOBILE', 'NON', '0'], 'sub_category': ['LAPTOP', 'STRAIGHTNERS', 'TV-40', 'THERMAL VESSEL', 'ESPRESSO MACH', 'FILTER 6 STAGES', 'WASHER DRY ASS', 'M.MINCER', 'SCALE', 'COMPLEMENTARY', 'TV-32-SMRT', 'Mobile_Acc', 'WALL HOOD', 'TV-70-SMRT', 'E.HOT PLATE', 'AC-HOT/COLD-2.25HP-INDOOR UNIT', 'AC-HOT/COLD-1.5HP', 'TV-FRAME', 'FAN', 'AC-HOT/COLD-4HP-OUTDOOR UNIT', 'D WASHER', 'GAS HEATER', 'VC', 'LAM', 'MASHER', 'COFFEE GRINDER', 'IRON', 'MOSQ.KILL', 'TOOLS', 'FILTER ASS', 'WASHING M', 'COOKER', 'AC ACCESSORY', 'BLENDER', 'HOOD ASS', 'JUICER', 'TV-50-SMRT-HI', 'KITCHEN M', 'AC-HOT/COLD-3HP-OUTDOOR UNIT', 'FILTER 7 STAGES', 'AC-HOT/COLD-3HP-INDOOR UNIT', 'ALEXA ECHO DOT', 'AC-HOT/COLD-4HP-INDOOR UNIT', 'OVEN', 'FRIDGE', 'HOOD', 'TV-ACCESSORY', 'HOBS', 'TV-32', 'TV-60-SMRT', '0', 'AC-COLD-7HP-OUTDOOR UNIT', 'DRYER', 'GIFT', 'MINCER', 'AC-HOT/COLD-5HP', 'WARMER', 'AC-COLD-1.5HP-OUTDOOR UNIT', 'MIXER', 'AC-COLD-3HP-INDOOR UNIT', 'AC-HOT/COLD-7HP-OUTDOOR UNIT', 'WD', 'F.PROC', 'TV-55-SMRT', 'It_Acc', 'TV-43', 'TV-65-SMRT-HI', 'TV-85-SMRT-HI', 'AC-HOT/COLD-5HP-INDOOR UNIT', 'FILTER 5 STAGES', 'AC-HOT/COLD-2.25HP', 'CAPPUCCINO MAKER', 'H.MIXER', 'CURL IRONS', 'MDA ASS', 'BUNDLE- B-IN', 'TABLET', 'TV-75-SMRT-HI', 'AC-COLD-2.25HP-OUTDOOR UNIT', 'AIR PURIFIER', 'AC-HOT/COLD-1.5HP-OUTDOOR UNIT', 'GRILL', 'WASHER DRYER', 'HAIR DRYER', 'CHOPPER', 'TANK', 'BMOBILE ACCESSORIES', 'Wearable_Acc', 'TV-55-SMRT-HI', 'DEEP FREEZER', 'TV-50-SMRT', 'AC-HOT/COLD-6HP-INDOOR UNIT', 'AC-COLD-7HP-INDOOR UNIT', 'TV-40-SMRT', 'AC-HOT/COLD-3HP', 'TOASTER', 'AC-HOT/COLD-4HP', 'FUN LINE', 'AC-COLD-1.5HP-INDOOR UNIT', 'H.BLENDER', 'KETTLE', 'FRAYER', 'TV-85-SMRT', 'AC-COLD-1.5HP', 'TV-50', 'AC-COLD-2.25HP', 'NON', 'SPORT MACHINE', 'AUDIO', 'AIR COOLER', 'AC-HOT/COLD-1.5HP-INDOOR UNIT', 'AC-HOT/COLD-2.25HP-OUTDOOR UNIT', 'AC-COLD-3HP-OUTDOOR UNIT', 'RECEIVER', 'ELE HEATER', 'CLINER M', 'AC-HOT/COLD-7HP-INDOOR UNIT', 'COFFEE M', 'R.COOKER', 'VC ACCESSORIES', 'AC-HOT/COLD-5HP-OUTDOOR UNIT', 'AIR STYLER', 'AC-COLD-2.25HP-INDOOR UNIT', 'SHAVING_TRI', 'FILTER 3 STAGES', 'MICROWAVE', 'TV-65-SMRT', 'MOBILE', 'TV-86-SMRT', 'COOKING APPLIANCES', 'AIR FRYER', 'TV-43-SMRT', 'TV-75-SMRT'], 'extended_sub_category': ['0', 'TV-65-SMRT-HI', 'CHOPPER', 'ESPRESSO MACH', 'SCALE', 'BMOBILE ACCESSORIES', 'AC-COLD-7HP', 'TV-50-SMRT', 'STRAIGHTNERS', 'Wearables', 'TV-40', 'MOBILE', 'COMPLEMENTARY', 'E.HOT PLATE', 'JUICER', 'MDA COMPLEMENTARY', 'TV-85-SMRT', 'TV-85-SMRT-HI', 'LAPTOP', 'Network-Switch', 'Power', 'COFFEE GRINDER', 'WD', 'TABLET', 'MOSQ.KILL', 'AC-HOT/COLD-7HP', 'AC-HOT/COLD-2.25HP', 'AC-HOT/COLD-6HP', 'TV-43-SMRT', 'Storage', 'HAIR DRYER', 'MINCER', 'FILTER 5 STAGES', 'AIR PURIFIER', 'Smart tag', 'DRYER', 'H.BLENDER', 'TV-50-SMRT-HI', 'AC-COLD-3HP', 'TV-65-SMRT', 'TV-50', 'COOKER', 'TV-55-SMRT-HI', 'COFFEE M', 'OVEN', 'AC-HOT/COLD-4HP', 'WALL HOOD', 'GRILL', 'NON', 'Smart Home', 'TOASTER', 'F.PROC', 'AC-COLD-1.5HP', 'SDA COMPLEMENTARY', 'Gift', 'AC-HOT/COLD-1.5HP', 'TV Cables', 'CLINER M', 'AC-HOT/COLD-3HP', 'SHAVING_TRI', 'KETTLE', 'MICROWAVE', 'BUNDLE- B-IN', 'TV-40-SMRT', 'Network-Adapter', 'FUN LINE', 'Mobile Cables', 'TV-60-SMRT', 'TV-55-SMRT', 'CAPPUCCINO MAKER', 'Bundle', 'Security', 'Mobile photography', 'Service', 'AIR STYLER', 'Network-Modem', 'TV-75-SMRT-HI', 'VC', 'FILTER 7 STAGES', 'Gaming', 'M.MINCER', 'FILTER 3 STAGES', 'Smart Scale', 'IOT', 'Bar Code Scanner', 'TV COMPLEMENTARY', 'TV-32-SMRT', 'Cross Bag', 'AIR FRYER', 'FAN', 'Computer peripherals', 'TV Supplies', 'TANK', 'SPORT MACHINE', 'TV-32', 'FRIDGE', 'DEEP FREEZER', 'ELE HEATER', 'Network', 'GAS HEATER', 'TV-70-SMRT', 'AC COMPLEMENTARY', 'KITCHEN M', 'WASHING M', 'Mobile Holder', 'MIXER', 'WASHER DRYER', 'CURL IRONS', 'MOBILE COMPLEMENTARY', 'AC-COLD-2.25HP', 'MASHER', 'AIR COOLER', 'Mobile Audio', 'TV-43', 'TV-75-SMRT', 'HOOD', 'HOBS', 'WL Telephone', 'BLENDER', 'D WASHER', 'FRAYER', 'ALEXA ECHO DOT', 'H.MIXER', 'AC-HOT/COLD-5HP', 'WARMER', 'THERMAL VESSEL', 'COOKING APPLIANCES', 'Protection', 'FILTER 6 STAGES', 'IRON', 'R.COOKER', 'Mobile cables'], 'sub_category_supplier': ['STRAIGHTNERS-REMINGTON', 'SHAVING_TRI-HAPILLINE', 'KETTLE-ZAHRAN', 'DEEP FREEZER-ARISTON', 'AC-HOT/COLD-3HP-CARRIERE', 'COFFEE M-NESPRESSO', 'WARMER-FRESH', 'TV-85-SMRT-SAMSUNG', 'VC-LG', 'FUN LINE-BLACK AND DECAR', 'F.PROC-KENWOOD', 'AC-COLD-2.25HP-FRESH', 'DEEP FREEZER-BEKO', 'OVEN-HOOVER', 'FUN LINE-MEDIA TECH', 'RECEIVER-DALY', 'VC-HITACHI', 'AC-HOT/COLD-3HP-ULTRA', 'TV-43-HAIER', 'KITCHEN M-MODEX', 'SHAVING_TRI-RUSH BRUSH', 'COFFEE M-BOSCH', 'H.BLENDER-BLACK AND WHITE', 'DEEP FREEZER-ELECTROSTAR', 'MOBILE-APPLE', 'KETTLE-MIENTA', 'H.BLENDER-BLACK AND DECAR', 'DEEP FREEZER-WHITE WHALE', 'WASHING M-Toshiba', 'HOOD-BEKO', 'AC-HOT/COLD-3HP-UNION AIRE', 'TOASTER-MIENTA', 'VC-BLACK AND DECAR', 'FAN-KENWOOD', 'AIR STYLER-RUSH BRUSH', 'KITCHEN M-TOUCH', 'FUN LINE-ZAHRAN', 'D WASHER-FRESH', 'SHAVING_TRI-BRAUN', 'F.PROC-MOULINEX', 'COMPLEMENTARY-HAVIT', 'ELE HEATER-SHTEBEL', 'AC-HOT/COLD-1.5HP-BEKO', 'TOOLS-CLABER', 'BMOBILE ACCESSORIES-TOSHIBA', 'MICROWAVE-SHARP', 'OVEN-FRANKE', 'COFFEE M-SONAI', 'TOOLS-HITACHI', 'AC ACCESSORY-SHARP', 'H.MIXER-SONAI', 'TV-32-SMRT-SHARP', 'TV-ACCESSORY-ETI', 'AC-COLD-3HP-ULTRA', 'IRON-TEFAL', 'KETTLE-SENCOR', 'ELE HEATER-TORNADO', 'TV-43-CONTEX', 'TV-75-SMRT-UNION AIRE', 'FAN-TEFAL', 'IRON-BLACK AND DECAR', 'ELE HEATER-TOSHIBA', 'TV-50-SMRT-PREMIUM', 'COFFEE M-ZADA', 'DEEP FREEZER-FRESH', 'JUICER-BRAUN', 'WARMER-TORNADO', 'WD-ULTRA', 'KETTLE-BLACK AND DECAR', 'HOOD ASS-INDESIT', 'FRIDGE-WHITE WHALE', 'TV-32-TCL', 'BUNDLE- B-IN-INDESIT', 'H.MIXER-MEDIA TECH', 'BMOBILE ACCESSORIES-NI', 'FRIDGE-UNION AIRE', 'TOASTER-HOME TECH', 'AUDIO-AVANTREE', 'TV-65-SMRT-SHARP', 'GAS HEATER-TORNADO', 'TV-ACCESSORY-FLAT', 'CLINER M-KARCHER', 'OVEN-MIELE', 'H.BLENDER-BOSCH', 'TV-43-SMRT-PLUTO', 'TV-75-SMRT-HI-SHARP', 'MICROWAVE-BLACK AND DECAR', 'KETTLE-BRAUN', 'COFFEE M-MIENTA', 'HOOD-PANASONIC', 'VC-DAEWOO', 'WD-FRESH', 'TV-75-SMRT-LG', 'FRIDGE-ULTRA', 'BLENDER-SMART', 'GAS HEATER-BOSCH', 'LAPTOP-ASUS', 'WASHING M-HAIER', 'FRIDGE-TORNADO', 'AC-HOT/COLD-2.25HP-UNION AIRE', 'IRON-PANASONIC', 'H.BLENDER-MOULINEX', 'TV-65-SMRT-TOSHIBA', 'FILTER 3 STAGES-SEASONS', 'HAIR DRYER-BABYLISS', 'VC-TOSHIBA', 'OVEN-TORNADO', 'AUDIO-PHILIPS', 'FRIDGE-BEKO', 'HOOD-GORENJE', 'LAPTOP-APPLE', 'TV-32-ULTRA', 'GAS HEATER-LONGLIFE', 'OVEN-SIMFER', 'D WASHER-LG', 'FRIDGE-ELECTROSTAR', 'TV-32-SMRT-CAIXUN', 'H.BLENDER-G.TEC', 'LAPTOP-HP', 'TV-ACCESSORY-HP', 'TV-32-SONY', 'E.HOT PLATE-SMART', 'AC ACCESSORY-CRAFT', 'WARMER-TOUCH', 'TV-70-SMRT-LG', 'OVEN-GORENJE', 'ELE HEATER-ATLANTIC', 'VC-BOSCH', 'BMOBILE ACCESSORIES-STEEL', 'MIXER-BLACK AND WHITE', 'MINCER-WHITE WHALE', 'AC-HOT/COLD-1.5HP-FRESH', 'KETTLE-BOSCH', 'FAN-TORNADO', 'CHOPPER-TOUCH', 'BLENDER-SARY', 'D WASHER-BeKO', 'TV-32-SMRT-SONY', 'GRILL-MEDIA TECH', 'HOBS-KLASS', 'VC-FRESH', 'TV-55-SMRT-TORNADO', 'MICROWAVE-HOOVER', 'WD-SPEED', 'AUDIO-ORAIMO', 'FAN-PANASONIC', 'HOBS-ECOMATIC', 'AIR COOLER-SONAI', 'TV-43-NIKAI', 'FAN-UNION AIRE', 'FAN-SMART', 'WD-BERGEN', 'TV-50-SMRT-ULTRA', 'TV-65-SMRT-LG', 'VC ACCESSORIES-MIELE', 'KITCHEN M-BOSCH', 'AIR FRYER-TORNADO', 'HOBS-TORNADO', 'AC-COLD-1.5HP-UNION AIRE', 'TV-50-SMRT-TCL', 'TABLET-APPLE', 'IRON-ARIETE', 'VC-PANASONIC', 'AC-HOT/COLD-3HP-SHARP', 'VC-ROVO', 'FRIDGE-INDESIT', 'KETTLE-ARION', 'H.BLENDER-HOME TECH', 'WARMER-AKWRJ', 'MDA-ZANUSSI', 'AC-COLD-3HP-UNION AIRE', 'KETTLE-SONAI', 'WASHING M-ARISTON', 'COMPLEMENTARY-SAMSUNG', 'AUDIO-TOSHIBA', 'KETTLE-KENWOOD', 'BMOBILE ACCESSORIES-HP', 'GAS HEATER-PREMIUM', 'TV-32-SMRT-TORNADO', 'TV-32-FRESH', 'WARMER-BLACK AND DECAR', 'FRIDGE-SAMSUNG', 'DEEP FREEZER-KIRIAZI', 'IRON-BLACK AND WHITE', 'FUN LINE-SONAI', 'ELE HEATER-VEITO', 'ELE HEATER-UNION AIRE', 'HOOD-TOUCH', 'MOBILE-INFINX', 'MOBILE-SAMSUNG', 'COFFEE M-HOME TECH', 'MINCER-HOME TECH', 'AC-HOT/COLD-2.25HP-TORNADO', 'WALL HOOD-OLYMPIC', 'AIR COOLER-TORNADO', 'AC ACCESSORY-CARRIERE', 'IRON-TORNADO', 'BLENDER-TORNADO', 'ELE HEATER-OLYMPIC', 'AUDIO-LG', 'AC-HOT/COLD-4HP-FRESH', 'GAS HEATER-PANASONIC', 'BLENDER-ULTRA', 'F.PROC-ULTRA', 'WASHING M-BOSCH', 'BLENDER-FRESH', 'GRILL-TEFAL', 'GIFT-SAMSUNG', 'SHAVING_TRI-PHILIPS', 'TV-32-ATA', 'TV-32-SMRT-PREMIUM', 'BLENDER-PANASONIC', 'FRAYER-MIENTA', 'KITCHEN M-ARIETE', 'TV-65-SMRT-TORNADO', 'M.MINCER-KENWOOD', 'M.MINCER-BRAUN', 'DEEP FREEZER-TOSHIBA Midea', 'ELE HEATER-FRESH', 'GIFT-UNIVERSAL', 'TV-55-SMRT-SHARP', 'GAS HEATER-WHITE WHALE', 'KETTLE-TORNADO', 'THERMAL VESSEL-WACACO', 'TV-50-SMRT-HI-LG', 'VC-SAMSUNG', 'TV-ACCESSORY-HAMA', 'WARMER-MIENTA', 'GIFT-NESTLE', 'TV-86-SMRT-UNION AIRE', 'FRIDGE-ARISTON', 'H.MIXER-TORNADO', 'TV-43-TOSHIBA', 'F.PROC-TORNADO', 'TV-43-SMRT-ULTRA', 'HOOD-MIELE', 'TOOLS-SNDWAY', 'TV-55-SMRT-TOSHIBA', 'TV-32-HAIER', 'JUICER-MEDIA TECH', 'HOBS-FRANKE', 'FAN-MIENTA', 'LAM-BLACK AND DECAR', 'COMPLEMENTARY-SONY', 'GAS HEATER-ATLANTIC', 'BMOBILE ACCESSORIES-LDNIO', 'WASHER DRY ASS-MIELE', 'TOASTER-BRAUN', 'COFFEE M-SMART', 'HOBS-BRANDT', 'D WASHER-WHITE POINT', 'MICROWAVE-HOME TECH', 'WARMER-HELLER', 'TV-40-SMRT-SAMSUNG', 'TV-32-UNION AIRE', 'TABLET-HUAWEI', 'WASHING M-FAGOR', 'TV-50-SMRT-SONY', 'RECIEVER-TIGER', 'KITCHEN M-MOULINEX', 'TABLET-TCL', 'KETTLE-SMART', 'RECEIVER-TRUMAN', 'BLENDER-MOULINEX', 'AIR FRYER-KENWOOD', 'AC-COLD-1.5HP-FRESH', 'AC-COLD-2.25HP-TORNADO', 'COMPLEMENTARY-HP', 'GIFT-LG', 'AC-HOT/COLD-7HP-CARRIERE', 'MINCER-BOSCH', 'TV-50-ULTRA', 'HOOD-BOSCH', 'AC-HOT/COLD-3HP-MIDEA', 'IRON-TOUCH', 'KETTLE-FRESH', 'TV-75-SMRT-HI-SAMSUNG', 'TV-50-SMRT-UNION AIRE', 'TV-32-TOSHIBA', 'FRIDGE-MIELE', 'WD-PASSAP', 'TV-43-SMRT-HAIER', 'CHOPPER-SONAI', 'HOBS-SMART', 'FAN-BLACK AND DECAR', 'GRILL-FRESH', 'SHAVING_TRI-BABYLISS', 'AC-HOT/COLD-6HP-CARRIERE', 'BMOBILE ACCESSORIES', 'HOBS-FRESH', 'AC-COLD-2.25HP-SHARP', 'F.PROC-UNION AIRE', 'TANK-SEASONS', 'COMPLEMENTARY-INTEL', 'COMPLEMENTARY-NIKON', 'FRIDGE-FRESH', 'MIXER-ULTRA', 'M.MINCER-MODEX', 'F.PROC-SONAI', 'TV-43-SMRT-UNION AIRE', 'TV-ACCESSORY-SYINIX', 'OVEN-SHARP', 'TV-85-SMRT-HI-SAMSUNG', 'AC-COLD-2.25HP-LG', 'LAPTOP-MSI', 'WARMER-MEDIA TECH', 'TV-43-CAIXUN', 'TV-50-SMRT-SHARP', 'TV-32-SMRT-NIKAI', 'AC-HOT/COLD-5HP-CARRIERE', 'WASHING M-HOOVER', 'FRAYER-HOME TECH', 'IRON-KENWOOD', 'AC-HOT/COLD-2.25HP-FRESH', 'BMOBILE ACCESSORIES-LAVVENTO', 'H.MIXER-KENWOOD', 'OVEN-ELBA', 'FAN-ARION', 'TABLET-LENOVO', 'COFFEE M-BLACK AND DECAR', 'AC-COLD-2.25HP-UNION AIRE', 'M.MINCER-TORNADO', 'AC-COLD-1.5HP-AMERICOOL', 'HOBS-GLEMGAS', 'CHOPPER-ULTRA', 'H.MIXER-TOUCH', 'H.BLENDER-SARY', 'F.PROC-MODEX', 'TV-32-TORNADO', 'HOOD-PREMIER', 'GRILL-KENWOOD', 'CHOPPER-KENWOOD', 'TV-86-SMRT-LG', 'WASHING M-TOSHIBA', 'FAN-SONAI', 'COOKER-WHITE WHALE', 'GRILL-MIENTA', 'STRAIGHTNERS-TORNADO', 'COFFEE M-WHITE WHALE', 'COOKER-KIRIAZI', 'HOOD-FRANKE', 'MICROWAVE-ZANUSSI', 'BLENDER-HOME TECH', 'AC-COLD-2.25HP-MIDEA', 'IRON-BRAUN', 'TOASTER-PANASONIC', 'COFFEE M-BEKO', 'AC-COLD-1.5HP-MIDEA', 'TV-32-PLUTO', 'WD-WHITE POINT', 'KITCHEN M-KENWOOD', 'H.BLENDER-MIENTA', 'BMOBILE ACCESSORIES-MUSIC HERO', 'HOBS-ICOOK', 'DEEP FREEZER-UNION AIRE', 'COOKER-UNIVERSAL', 'HAIR DRYER-REMINGTON', 'TV-43-SMRT-FRESH', 'M.MINCER-TOUCH', 'AC-HOT/COLD-5HP-LG', 'KETTLE-TOUCH', 'GRILL-BLACK AND DECAR', 'WALL HOOD-TOSHIBA', 'TV-ACCESSORY-FORA', 'WD-TORNADO', 'H.BLENDER-KENWOOD', 'WASHING M-SAMSUNG', 'SHAVING_TRI-REMINGTON', 'CHOPPER-FRESH', 'WARMER-VEITO', 'BLENDER-G.TEC', 'AIR PURIFIER-DAIKIN', 'H.MIXER-MIENTA', 'GIFT-ARISTON', 'TOASTER-TORNADO', 'HOBS-BOSCH', 'VC-KENWOOD', 'SCALE-SOLAC', 'HOBS-BAUMATIC', 'COFFEE M-OKKA', 'MICROWAVE-TORNADO', 'AC-HOT/COLD-5HP-SHARP', 'MIXER-TOUCH', 'TV-40-CONTEX', 'FILTER 7 STAGES-SEASONS', 'COMPLEMENTARY-XIAOMI', 'GIFT-INFINX', 'COOKER-BOSCH', 'COOKER-UNION AIRE', 'FRIDGE-PASSAP', 'FRAYER-TEFAL', 'BMOBILE ACCESSORIES-DAHUA', 'GRILL-TOUCH', 'IRON-MIENTA', 'TV-75-SMRT-SAMSUNG', 'AC-HOT/COLD-1.5HP-CARRIERE', 'VC-SMART', 'OVEN-KLASS', 'AC ACCESSORY-HAIER', 'STRAIGHTNERS-RUSH BRUSH', 'AC-COLD-1.5HP-CARRIERE', 'WALL HOOD-TORNADO', 'HOBS-NARDI', 'AC-COLD-2.25HP-GENERAL ELECTRIC', 'FUN LINE-MIENTA', 'COMPLEMENTARY-EPSON', 'HOBS-GORENJE', 'WASHING M-WHITE POINT', 'H.BLENDER-MEDIA TECH', 'TV-75-SMRT-HI-LG', 'AC-HOT/COLD-1.5HP-HAIER', 'M.MINCER-MOULINEX', 'BMOBILE ACCESSORIES-SONY', 'CHOPPER-ARIETE', 'MICROWAVE-KENWOOD', 'AUDIO-MEDIA TECH', 'TV-ACCESSORY-HISENSE', 'COFFEE M-TEFAL', 'R.COOKER-MEDIA TECH', 'AC ACCESSORY-ZANUSSI', 'SPORT MACHINE-KHATER', 'FILTER ASS-PHILIPS', 'WASHING M-PREMIUM', 'CHOPPER-MIENTA', 'AC-COLD-1.5HP-SHARP', 'CHOPPER-SMART', 'TV-40-SMRT-VIEW', 'R.COOKER-TEFAL', 'TV-ACCESSORY-ORIGINAL', 'JUICER-SOLAC', 'AC-COLD-1.5HP-LG', 'F.PROC-ARIETE', 'MIXER-MODEX', 'TV-65-SMRT-SAMSUNG', 'THERMAL VESSEL-TEFAL', 'TV-32-SMRT-SAMSUNG', 'KITCHEN M-MIENTA', 'TV-43-SMRT-PREMIUM', 'JUICER-HOME TECH', 'AC-COLD-2.25HP-CRAFT', 'VC-ARIETE', 'LAPTOP-VAIO', 'HOBS-BEKO', 'TV-32-SMRT-HAIER', 'DEEP FREEZER-LG', 'LAM-PHILIPS', 'FRAYER-MIELE', 'COFFEE M-BRAUN', 'OVEN-INDESIT', 'BMOBILE ACCESSORIES-LOGITECH', 'MOBILE-VIVO', 'AC-HOT/COLD-1.5HP-LG', 'OVEN-ULTRA', 'BMOBILE ACCESSORIES-EZVIZ', 'KETTLE-MODEX', 'COFFEE M-MEDIA TECH', 'M.MINCER-BLACK AND WHITE', 'JUICER-MODEX', 'HOOD-ICOOK', 'GAS HEATER-KIRIAZI', 'FRIDGE-HAIER', 'F.PROC-HOME TECH', 'D WASHER-INDESIT', 'MOBILE-HUAWEI', 'TV-ACCESSORY-SCHNEIDER', 'DEEP FREEZER-TORNADO', 'TV-55-SMRT-HI-SAMSUNG', 'H.BLENDER-SMART', 'AC-COLD-2.25HP-ULTRA', 'MOBILE-LAVA', 'AC-COLD-3HP-CRAFT', 'COFFEE M-SOLAC', 'H.MIXER-ROVO', 'TV-60-SMRT-TORNADO', 'MICROWAVE-ARISTON', 'VC-GROUHY', 'WD-WHITE WHALE', 'FILTER ASS-SEASONS', 'MOSQ.KILL-HOME TECH', 'AC-HOT/COLD-2.25HP-ULTRA', 'TV-32-SMRT-LG', 'WASHING M-LG', 'TV-32-SAMSUNG', 'STRAIGHTNERS-BABYLISS', 'COFFEE GRINDER-ARIETE', 'AC-COLD-3HP-CARRIERE', 'ELE HEATER-UNIVERSAL', 'R.COOKER-HOME TECH', 'JUICER-KENWOOD', 'HOOD-FAGOR', 'OVEN-BEKO', 'AC-HOT/COLD-3HP-GENERAL ELECTRIC', 'WASHING M-UNION AIRE', 'AC-HOT/COLD-2.25HP-HISENSE', 'GAS HEATER-FRESH', 'COMPLEMENTARY-DELL', 'AIR PURIFIER-SHARP', 'DRYER-HOME TECH', 'AC-HOT/COLD-2.25HP-LG', 'H.MIXER-BRAUN', 'AUDIO-SAMSUNG', 'TV-43-SMRT-TOSHIBA', 'COOKER-BEKO', 'CHOPPER-MEDIA TECH', 'THERMAL VESSEL-TANK', 'DEEP FREEZER-INDESIT', 'TV-32-SMRT-FRESH', 'WD-KOLDAIR', 'ALEXA ECHO DOT-ALEXA', 'AC-HOT/COLD-2.25HP-SHARP', 'TV-43-SMRT-TORNADO', 'WASHING M-INDESIT', 'BLENDER-ARIETE', 'AC-COLD-1.5HP-TORNADO', 'NON', 'IRON-SOLAC', 'STRAIGHTNERS-MIENTA', 'AC-HOT/COLD-1.5HP-SHARP', 'IRON-PHILIPS', 'M.MINCER-SMART', 'FRAYER-BLACK AND DECAR', 'HAIR DRYER-RUSH BRUSH', 'MOBILE-HOPE', 'GIFT-BOSCH', 'TV-50-SMRT-SAMSUNG', 'WASHER DRYER-LG', 'KITCHEN M-BLACK AND WHITE', 'SPORT MACHINE-FUTURE', 'R.COOKER-MODEX', 'FAN-TOUCH', 'COOKER-LA GERMANYA', 'GAS HEATER-UNIVERSAL', 'H.BLENDER-TOUCH', 'CHOPPER-TORNADO', 'HOOD-INDESIT', 'MOBILE-OPPO', 'TV-75-SMRT-TOSHIBA', 'JUICER-TORNADO', 'TV-50-SMRT-LG', 'AUDIO-F&D', 'OVEN-ARISTON', 'KETTLE-ARIETE', 'AIR COOLER-FRESH', 'F.PROC-PANASONIC', 'MIXER-MEDIA TECH', 'MOBILE-HONOR', 'HAIR DRYER-SOLAC', 'HOOD-HOOVER', 'GIFT-INDESIT', 'CHOPPER-BLACK AND DECAR', 'TV-43-SMRT-SHARP', 'MICROWAVE-SAMSUNG', 'TV-ACCESSORY-NOUR TECH', 'TV-85-SMRT-HI-LG', 'RECEIVER-ETI', 'AC-HOT/COLD-2.25HP-GENERAL ELECTRIC', 'KETTLE-HOUSECOM', 'WALL HOOD-FRESH', 'GAS HEATER-ARION', 'GRILL-HOME TECH', 'JUICER-SONAI', 'AC-COLD-2.25HP-CARRIERE', 'WASHING M-SHARP', 'AC ACCESSORY-PREMIUM', 'TV-55-SMRT-ULTRA', 'H.BLENDER-SEM', 'TV-FRAME-SAMSUNG', 'COOKER-FRESH', 'GRILL-MODEX', 'TABLET-REALME', 'WASHING M-KIRIAZI', 'F.PROC-BLACK AND WHITE', 'BLENDER-MEDIA TECH', 'MASHER-BLACK AND WHITE', 'COOKER-PREMIUM', 'F.PROC-BOSCH', 'COFFEE M-PHILIPS', 'GAS HEATER-WHITE POINT', 'STRAIGHTNERS-PHILIPS', 'MICROWAVE-DAEWOO', 'AUDIO-FIRST', 'VC-TORNADO', 'AC-HOT/COLD-1.5HP-PREMIUM', 'COFFEE M-TORNADO', 'COMPLEMENTARY-LENOVO', 'E.HOT PLATE-HOME TECH', 'KITCHEN M-FRESH', 'COFFEE M-KENWOOD', 'MICROWAVE-LG', 'TV-ACCESSORY-FALCON', 'STRAIGHTNERS-BRAUN', 'FRAYER-PHILIPS', 'MOBILE-NOKIA', 'TV-43-UNION AIRE', 'GAS HEATER-UNION AIRE', 'KITCHEN M-HOME TECH', 'H.MIXER-MODEX', 'FRIDGE-SHARP', 'TOOLS-MPT HT', 'COMPLEMENTARY-BENQ', 'RECEIVER-GALAXI', 'COFFEE M-BIALETTI', 'RECEIVER-SKYWORTH ZAPPER', 'DEEP FREEZER-WHITE POINT', 'AC-HOT/COLD-1.5HP-TORNADO', 'VC-TEFAL', 'MDA ASS-INDESIT', 'KETTLE-MEDIA TECH', 'HOBS-FAGOR', 'AC-HOT/COLD-1.5HP-AMERICOOL', 'GAS HEATER-OLYMPIC', 'GRILL-TORNADO', 'WASHING M-ZANUSSI', 'AUDIO-SONY', 'WASHING M-FRESH', 'KITCHEN M-SARY', 'ELE HEATER-CLAGE', 'TV-50-SMRT-TORNADO', 'BLENDER-MIENTA', 'FAN-BLACK AND WHITE', 'TV-65-SMRT-TCL', 'MOBILE-REALME', 'IRON-SMART', 'HOOD-FRESH', 'HAIR DRYER-ARZUM', 'KETTLE-SOLAC', 'TV-55-SMRT-PREMIUM', 'D WASHER-ZANUSSI', 'M.MINCER-PANASONIC', 'FRIDGE-ZANUSSI', 'FRIDGE-TOSHIBA', 'CHOPPER-BOSCH', 'AUDIO-DOB', 'AC ACCESSORY-LG', 'TV-43-SMRT-SAMSUNG', 'F.PROC-GROUHY', 'BMOBILE ACCESSORIES-OSN', 'AC-HOT/COLD-2.25HP-BEKO', 'TV-32-SMRT-TOSHIBA', 'FRIDGE-WHITE POINT', 'FRAYER-BERGEN', 'BLENDER-BOSCH', 'H.BLENDER-BRAUN', 'F.PROC-SMART', 'D WASHER-BOSCH', 'AC-COLD-3HP-LG', 'ELE HEATER-WHITE WHALE', 'WASHING M-TORNADO', 'VC-MIENTA', 'DEEP FREEZER-ALASKA', 'WARMER-DELONGHI', 'DEEP FREEZER-TOSHIBA', 'VC-MODEX', 'CURL IRONS-RUSH BRUSH', 'TV-50-SMRT-PLUTO', 'ELE HEATER-BOMAN', 'FRAYER-DELONGHI', 'FRIDGE-LG', 'FAN-UNIVERSAL', 'TV-32-UG', 'RECEIVER-MUTECH', 'MASHER-MIENTA', 'BMOBILE ACCESSORIES-STRONG', 'WARMER-SHTEBEL', 'E.HOT PLATE-FRESH', 'OVEN-BRANDT', 'AC-COLD-7HP-CARRIERE', 'ELE HEATER-ARISTON', 'TV-50-SMRT-TOSHIBA', 'GAS HEATER-FERROLI', 'F.PROC-G.TEC', 'HAIR DRYER-TORNADO', 'AC-HOT/COLD-4HP-CARRIERE', 'FAN-FRESH', 'COOKER-ZANUSSI', 'F.PROC-MIENTA', 'COOKER-WHITE POINT', 'TABLET-SAMSUNG', 'M.MINCER-BOSCH', 'BMOBILE ACCESSORIES-ORIGINAL', 'H.MIXER-BOSCH', 'HOBS-INDESIT', 'AIR FRYER-SOLAC', 'OVEN-FAGOR', 'MINCER-BLACK AND DECAR', 'MOBILE-XIAOMI', 'CHOPPER-MOULINEX', 'HOOD-ZANUSSI', 'VC-MIELE', 'F.PROC-BLACK AND DECAR', 'DEEP FREEZER-PANASONIC', 'DRYER-ARISTON', 'BLENDER-SONAI', 'FAN-NIKAI', 'AC-COLD-1.5HP-HAIER', 'FAN-ULTRA', 'AC-HOT/COLD-1.5HP-HISENSE', 'AC-HOT/COLD-4HP-LG', 'KITCHEN M-SMART', 'LAPTOP-DELL', 'F.PROC-BENEX', 'TOASTER-KENWOOD', 'D WASHER-BEKO', 'MIXER-UNION AIRE', 'TV-43-SMRT-LG', 'AC-HOT/COLD-2.25HP-PREMIUM', 'COFFEE M-MODEX', 'R.COOKER-BLACK AND DECAR', 'H.MIXER-MOULINEX', 'TOOLS-MPT PT', 'AC ACCESSORY-UNION AIRE', 'LAPTOP-LENOVO', 'TV-43-TORNADO', 'TV-55-SMRT-SAMSUNG', 'HOBS-MIELE', 'JUICER-BOSCH', 'AC-COLD-3HP-FRESH', 'AC-COLD-1.5HP-ULTRA', 'IRON-ULTRA', 'GRILL-SOLAC', 'WASHING M-CANDY', 'FUN LINE-HOME TECH', 'TV-43-LG', 'ELE HEATER-ZANUSSI', 'HOOD-TORNADO', 'AC-HOT/COLD-3HP-TORNADO', 'COOKER-ROYAL', 'AC ACCESSORY-DAIKIN', 'TV-ACCESSORY-ICONZ', 'TOOLS-BOSCH', 'VC-BLACK AND WHITE', 'GAS HEATER-ZANUSSI', 'OVEN-NARDI', 'TV-ACCESSORY-MEDIA TECH', 'TV-65-SMRT-UNION AIRE', 'BLENDER-KENWOOD', 'CURL IRONS-BABYLISS', 'AC-HOT/COLD-1.5HP-UNION AIRE', 'TOASTER-BLACK AND DECAR', 'TV-43-ULTRA', 'WASHING M-BEKO', 'F.PROC-BRAUN', 'H.MIXER-BLACK AND WHITE', 'AIR COOLER-HOME TECH', 'GRILL-BOSCH', '0', 'WARMER-ULTRA', 'GAS HEATER-PASSAP', 'HOBS-HOOVER', 'THERMAL VESSEL-TIGER', 'THERMAL VESSEL-SEASONS', 'MICROWAVE-SMART', 'AC-HOT/COLD-2.25HP-CARRIERE', 'HOOD-BeKO', 'D WASHER-ARISTON', 'CHOPPER-ROVO', 'FILTER 6 STAGES-SEASONS', 'FILTER 5 STAGES-SEASONS', 'FRIDGE-BOSCH', 'GAS HEATER-ARISTON', 'TV-65-SMRT-HI-LG', 'AC-COLD-3HP-MIDEA', 'TV-55-SMRT-SONY', 'TV-55-SMRT-HI-LG', 'TV-ACCESSORY-TRUMAN', 'FRIDGE-IDEAL', 'D WASHER-MIELE', 'AC-COLD-1.5HP-PREMIUM', 'ESPRESSO MACH-ARIETE', 'H.BLENDER-TORNADO', 'FRIDGE-KIRIAZI', 'AC-HOT/COLD-3HP-LG', 'BLENDER-BRAUN', 'H.MIXER-PANASONIC', 'GIFT-FRESH', 'MASHER-KENWOOD', 'HOBS-ZANUSSI', 'OVEN-TOUCH', 'TOASTER-ARIETE', 'AIR STYLER-BABYLISS', 'FUN LINE-SOLAC', 'LAPTOP-MICROSOFT', 'IRON-HOME TECH', 'TV-50-SMRT-HAIER', 'TV-32-SARY', 'TV-55-SMRT-TCL', 'AC-HOT/COLD-3HP-PREMIUM', 'AC-HOT/COLD-1.5HP-ZANUSSI', 'ELE HEATER-KIRIAZI', 'FRAYER-MODEX', 'TV-40-SMRT-UNION AIRE', 'TV-32-PREMIUM', 'TV-ACCESSORY-KEENDEX', 'COMPLEMENTARY-CANON', 'OVEN-HOME TECH', 'IRON-MEDIA TECH', 'AC ACCESSORY-FRESH', 'IRON-MODEX', 'FRAYER-FRESH', 'AC-HOT/COLD-1.5HP-MIDEA', 'JUICER-MOULINEX', 'KETTLE-ZADA', 'DEEP FREEZER-SHARP', 'OVEN-FRESH', 'VC-SOLAC', 'AC-HOT/COLD-3HP-FRESH', 'TV-ACCESSORY-ELIOS', 'TV-55-SMRT-LG', 'LAPTOP-HUAWEI', 'H.BLENDER-SENCOR', 'VC-HOOVER', 'FUN LINE-TORNADO', 'AC-COLD-2.25HP-PREMIUM', 'HOOD-ELBA', 'BLENDER-MODEX', 'TV-ACCESSORY-ILOOK', 'AC-COLD-3HP-PREMIUM', 'AC-HOT/COLD-1.5HP-ULTRA', 'E.HOT PLATE-MIENTA', 'BLENDER-BLACK AND WHITE', 'TV-32-LG', 'HOOD-ARISTON', 'FUN LINE-ARIETE', 'WASHING M-MIELE', 'AC-COLD-3HP-TORNADO', 'DEEP FREEZER-PASSAP', 'CAPPUCCINO MAKER-ARIETE', 'OVEN-ZANUSSI', 'VC-BISSELL', 'BLENDER-TOUCH', 'BLENDER-SENCOR', 'TV-ACCESSORY-LG', 'TV-43-SMRT-SONY', 'ELE HEATER-FLYON', 'AC-HOT/COLD-4HP-SHARP', 'COFFEE M-DELONGHI', 'TV-55-SMRT-PLUTO', 'MIXER-BLACK AND DECAR', 'AC-COLD-1.5HP-CRAFT', 'HOOD-SONAI', 'TV-ACCESSORY-FRESH', 'MICROWAVE-FRESH', 'JUICER-MIENTA', 'HAIR DRYER-PHILIPS', 'TV-70-SMRT-SAMSUNG', 'AIR PURIFIER-LG', 'OVEN-MIENTA', 'KETTLE-BLACK AND WHITE', 'SHAVING_TRI-TORNADO', 'E.HOT PLATE-TOUCH', 'FRAYER-ARISTON', 'TV-ACCESSORY-ITEL', 'COOKING APPLIANCES-ARIETE', 'KITCHEN M-G.TEC', 'AC-HOT/COLD-3HP-BEKO', 'TV-65-SMRT-HI-SAMSUNG', 'BLENDER-BLACK AND DECAR', 'H.MIXER-SMART', 'GRILL-ZADA', 'OVEN-BOSCH', 'M.MINCER-SONAI', 'HOBS-ELBA', 'KETTLE-PANASONIC', 'HOBS-ARISTON', 'H.MIXER-FRESH', 'VC-ULTRA', 'KETTLE-HOME TECH', 'AC-HOT/COLD-5HP-FRESH', 'DEEP FREEZER-MIELE', 'AC-HOT/COLD-2.25HP-MIDEA']} the_received_subfilter
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
263.781916139 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('5199.0323314761039854')), ('initial_average_retail_price', Decimal('13347.107178136645')), ('proposed_sellthru_percent', Decimal('48.1362304541513439')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('32.3688615570903220')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.36886155709032), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 12635823095.75676), ('budget_cost', 5556158737.007249), ('deficit', Decimal('12635823096.1753')), ('Original_BudgetAmount', Decimal('12635823096.1753')), ('budget_percent', Decimal('96.5753')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 2254753.0), ('ACT_FCT', Decimal('1593455453.3700')), ('Original_BudgetCostofGoods', Decimal('5556158737.0060')), ('PO', Decimal('40344038580.0137')), ('COSTPRICE', 4741863379.231934), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('1593455453.3700')), ('stock_on_hand_qty', Decimal('3222526')), ('net_sales_ly', Decimal('8198878717.2100')), ('net_sales_lly', Decimal('991385109.1300')), ('gross_sales_ly', Decimal('8505674881.6810')), ('total_sku_count', Decimal('516857')), ('ly_customer_disc', Decimal('306796164.4710')), ('SupplyCost', Decimal('5278350800.1573')), ('SALESQTY', 2109040.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('87.3465')), ('budget_qty_act_fct_percent', Decimal('203125003.1727')), ('budget_vs_py_qty_percent', Decimal('131199885.8079')), ('budget_vs_ppy_qty_percent', Decimal('213884556.2962')), ('QTY_Buy_By_SKU', Decimal('2254753.0000')), ('total_sku_count_ty', Decimal('117023406565')), ('total_sku_count_lly', Decimal('38021')), ('total_sku_count_ly', Decimal('256308')), ('quantity_mix_percent', Decimal('101.0189')), ('quantity_act_forecast', Decimal('2515012.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('1493363.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('134745400.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.1062')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('5556158737.0060')), ('budget_vs_py_cost_percent', Decimal('315266041822.7000')), ('budget_vs_ppy_cost_percent', Decimal('36232403869.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('1034118331.6800')), ('cost_of_goods_ly', Decimal('3404918491.7120')), ('cost_act_forecast', Decimal('6590277068.6860')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('721257095577.9461')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('565025546.5300')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('1.7690')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('24447.2482')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('24447.2482')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
263.985574078 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 5199.0323 ┆ 13347.107 ┆ … ┆ 0.0       ┆ 24447.248 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆ 31        ┆ 178       ┆   ┆           ┆ 2         ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 58.470925         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 3.0680e8   ┆ 8.1989e9   ┆ 1.2636e10  ┆ 58.227092 ┆ 1.3109e10 ┆ 48.13623  ┆ 2.7232e10 ┆ 3.606959  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x769BEB197B50>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x769BEB197C70>, <Expr ['col("SalesActualsByForecast").…'] at 0x769BEB197E80>, <Expr ['col("initial_average_retail_pr…'] at 0x769BEB1943D0>, <Expr ['col("proposed_sellthru_percent…'] at 0x769BEB197F10>, <Expr ['col("retail_value_including_ma…'] at 0x769BEB197760>, <Expr ['col("budget_gross_margin_perce…'] at 0x769BEB197A90>, <Expr ['col("Logistic%").mean()'] at 0x769BEB197850>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x769BEB194400>, <Expr ['col("MarkdownValue").mean()'] at 0x769BEB197A30>, <Expr ['col("markdown_percent").mean()'] at 0x769BEB195030>, <Expr ['col("DisplayItemValue").mean()'] at 0x769BEB1976A0>, <Expr ['col("budget_amount").sum()'] at 0x769BEB194310>, <Expr ['col("budget_cost").sum()'] at 0x769BEB194340>, <Expr ['col("deficit").sum()'] at 0x769BEB197FD0>, <Expr ['col("Original_BudgetAmount").s…'] at 0x769BEB194430>, <Expr ['col("budget_percent").sum()'] at 0x769BEB194100>, <Expr ['col("relative_budget_percent")…'] at 0x769BEB1977F0>, <Expr ['col("History_Net_Sales").sum()'] at 0x769BEB194040>, <Expr ['col("budget_qty").sum()'] at 0x769BEB1940A0>, <Expr ['col("ACT_FCT").sum()'] at 0x769BEB194130>, <Expr ['col("Original_BudgetCostofGood…'] at 0x769BEB1976D0>, <Expr ['col("PO").sum()'] at 0x769BEB1969E0>, <Expr ['col("COSTPRICE").sum()'] at 0x769BEB196830>, <Expr ['col("Historical_Gross_Margin")…'] at 0x769BEB1940D0>, <Expr ['col("sales_actual").sum()'] at 0x769BEB196A70>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x769BEB197700>, <Expr ['col("net_sales_ly").sum()'] at 0x769BEB196BC0>, <Expr ['col("net_sales_lly").sum()'] at 0x769BEB196AA0>, <Expr ['col("gross_sales_ly").sum()'] at 0x769BEB196C20>, <Expr ['col("total_sku_count").sum()'] at 0x769BEB194160>, <Expr ['col("ly_customer_disc").sum()'] at 0x769BEB196BF0>, <Expr ['col("SupplyCost").sum()'] at 0x769BEB196CB0>, <Expr ['col("SALESQTY").sum()'] at 0x769BEB197F70>, <Expr ['col("DisplayItemQty").sum()'] at 0x769BEB196CE0>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x769BEB196D40>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x769BEB1942B0>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x769BEB1968C0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x769BEB196F80>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x769BEB196A40>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x769BEB196FE0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x769BEB197640>, <Expr ['col("total_sku_count_lly").sum…'] at 0x769BEB197130>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x769BEB197010>, <Expr ['col("quantity_mix_percent").su…'] at 0x769BEB196FB0>, <Expr ['col("quantity_act_forecast").s…'] at 0x769BEB197040>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x769BEB197220>, <Expr ['col("sold_qty_ly").sum()'] at 0x769BEB197070>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x769BEB196DA0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x769BEB1971C0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x769BEB1973A0>, <Expr ['col("budget_cost_percent").sum…'] at 0x769BEB197340>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x769BEB196E60>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x769BEB1967D0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x769BEB197EE0>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x769BEB1974C0>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x769BEB1973D0>, <Expr ['col("cost_mix_percent").sum()'] at 0x769BEB197400>, <Expr ['col("cost_actuals").sum()'] at 0x769BEB197DF0>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x769BEB197490>, <Expr ['col("cost_act_forecast").sum()'] at 0x769BEB196C80>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x769BEB1944F0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x769BEB197580>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x769BEB197F40>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x769BEB197280>, <Expr ['col("budget_margin_percent").s…'] at 0x769BEB1946A0>, <Expr ['col("budget_margin_mix_percent…'] at 0x769BEB1944C0>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x769BEB194760>, <Expr ['col("margin_actuals").sum()'] at 0x769BEB197430>, <Expr ['col("margin_act_forecast").sum…'] at 0x769BEB194640>, <Expr ['col("units_per_sku_total").sum…'] at 0x769BEB194850>, <Expr ['col("units_per_sku_lly").sum()'] at 0x769BEB197100>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x769BEB1945B0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x769BEB194820>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x769BEB194610>, <Expr ['col("initial_average_retail_pr…'] at 0x769BEB196EC0>, <Expr ['col("initial_average_retail_pr…'] at 0x769BEB194A90>, <Expr ['col("budget_per_sku").sum()'] at 0x769BEB194670>, <Expr ['col("budget_qty_ty").sum()'] at 0x769BEB1975E0>, <Expr ['col("Check_box").max()'] at 0x769BEB194BB0>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,5199.0323314761,13347.1071781366,48.1362304542,13108646538.3788547516,56.0285175338,5.0,56.0285175338,30679616447.1000022888,3.6069585158,0.0,12635823095.7567596436,5556158737.0072488785,12635823096.1753005981,12635823096.1753005981,100.0,100.0,0.0,2254753.0,1593455453.3699998856,5556158737.0059995651,40344038580.0137023926,4741863379.2319335938,0.0,1593455453.3699998856,3222526.0,8198878717.2100000381,991385109.1299999952,8505674881.6809997559,516857.0,306796164.4710000157,5278350800.1572999954,2109040.0,0.0,0.0,87.3465,203125003.1726999879,131199885.8078999966,213884556.2962000072,2254753.0,117023406565.0,38021.0,256308.0,101.0189,2515012.0,0.0,1493363.0,134745400.0,0.0,0.0,0.1062,0.0,0.0,5556158737.0059995651,315266041822.700012207,36232403869.0,0.0,1034118331.6799999475,3404918491.7119998932,6590277068.6859998703,0.0,0.0,0.0,0.0,721257095577.9460449219,0.0,0.0,565025546.5299999714,0.0,1.769,0.0,24447.2482,0.0,0.0,0.0,0.0,24447.2482,0.0,0.0,154.1164777719,1274.5625266498,19.4350411603,6216.9555900323,100.0,4190987.7524788929,58.2270916571,43011399906.3319702148,58.470924999,4793960225.498000145,0.0,0.0,7079664358.7495107651,121080081.4057896435,43011399906.3319702148,17862236526.0850143433,43011399906.3319702148,13108646538.3788547516,12635823095.7567596436,27232391100.6378898621,11375761774.040555954,4616414.7212826116]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":5199.0323314761,"initial_average_retail_price":13347.1071781366,"proposed_sellthru_percent":48.1362304542,"retail_value_including_markdown":13108646538.3788547516,"budget_gross_margin_percent":56.0285175338,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":56.0285175338,"MarkdownValue":30679616447.1000022888,"markdown_percent":3.6069585158,"DisplayItemValue":0.0,"budget_amount":12635823095.7567596436,"budget_cost":5556158737.0072488785,"deficit":12635823096.1753005981,"Original_BudgetAmount":12635823096.1753005981,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":2254753.0,"ACT_FCT":1593455453.3699998856,"Original_BudgetCostofGoods":5556158737.0059995651,"PO":40344038580.0137023926,"COSTPRICE":4741863379.2319335938,"Historical_Gross_Margin":0.0,"sales_actual":1593455453.0,"stock_on_hand_qty":3222526.0,"net_sales_ly":8198878717.2100000381,"net_sales_lly":991385109.1299999952,"gross_sales_ly":8505674881.6809997559,"total_sku_count":516857.0,"ly_customer_disc":306796164.4710000157,"SupplyCost":5278350800.1572999954,"SALESQTY":2109040.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":87.3465,"budget_qty_act_fct_percent":203125003.1726999879,"budget_vs_py_qty_percent":131199885.8078999966,"budget_vs_ppy_qty_percent":213884556.2962000072,"QTY_Buy_By_SKU":2254753.0,"total_sku_count_ty":117023406565.0,"total_sku_count_lly":38021.0,"total_sku_count_ly":256308.0,"quantity_mix_percent":101.0189,"quantity_act_forecast":2515012.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":1493363.0,"quantity_act_forecast_vs_ly_percent":134745400.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.1062,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":5556158737.0059995651,"budget_vs_py_cost_percent":315266041822.700012207,"budget_vs_ppy_cost_percent":36232403869.0,"cost_mix_percent":0.0,"cost_actuals":1034118331.6799999475,"cost_of_goods_ly":3404918491.7119998932,"cost_act_forecast":6590277068.6859998703,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":721257095577.9460449219,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":565025546.5299999714,"margin_act_forecast":0.0,"units_per_sku_total":1.769,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":24447.2482,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":24447.2482,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":58.470924999,"FirstMargin_percent":58.2270916571,"budget_vpy":154.1164777719,"budget_vppy":1274.5625266498,"StockatRetailPrice":43011399906.3319702148,"TYForecast":43011399906.3319702148,"LYvsACT_FCT_percent":100.0,"supply_retail_value":12635823095.7567596436} }INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection open
 data_json
WebSocket connection closed unexpectedly
{'history_date_range': {'fro': '2023-01-01', 'to': '2023-12-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-12-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': True, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-01-01', to='2023-12-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-12-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
265.006256809 start_to_execute main the stored procedure
conn established
sp executed
265.079916487 end of main the stored procedure
conn established
sku wise calc executed
265.126389486 end of sku wise stored proc
we called the sku wise stored procedure_init
We are getting data from ra_and_stock
265.126501216 started to fetch data
conn established
<function getData.<locals>.<lambda> at 0x76aa7237af80> dfafghaf
443.485772473 end of fetch data
(535152, 168) output data shape
111111111111111111111111111111111111111111111
processing...
we are calling main groupby process
1
WebSocket connection closed unexpectedly
1
conn established
sku wise calc executed
447.574949504 end of sku wise stored proc
conn established
[OrderedDict([('id', 236584), ('store', None), ('region', None), ('area', None), ('Channel', 'B.TECH X'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 236585), ('store', None), ('region', None), ('area', None), ('Channel', 'MINI'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 236586), ('store', None), ('region', None), ('area', None), ('Channel', 'WAREHOUSE'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 236587), ('store', None), ('region', None), ('area', None), ('Channel', 'ARKAN'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 236588), ('store', None), ('region', None), ('area', None), ('Channel', 'Retail'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)])] 3306 getData dictsize
447.707904837 end of fetch data
shape: (3_306, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 236584 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 236585 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 236586 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 236587 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 236588 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 239885 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 239886 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 239887 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 239888 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 239889 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the filter dataframe
shape: (3_306, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 236584 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 236585 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 236586 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 236587 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 236588 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 239885 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 239886 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 239887 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 239888 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 239889 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the_fiter_data
id Int64
store String
region String
area Int32
Channel String
budget_year Int32
budget_quarter String
budget_month String
budget_weekday Int64
budget_day String
budget_dates Int32
historical_year Int64
history_Quarter String
history_month String
history_week String
history_Day String
history_datess Int32
family String
sub_Family String
Supplier String
Category String
Dom_Comm String
Sub_Category String
Extended_sub_category String
Sub_Category_supplier String
Article_Score Int32
last_v store store
last_v region region
last_v Channel Channel
last_v Quarter budget_quarter
last_v month budget_month
last_v week budget_weekday
last_v Day budget_day
last_v history_Quarter history_Quarter
last_v history_month history_month
last_v history_Day history_Day
last_v family family
last_v sub_family sub_Family
last_v supplier Supplier
last_v category Category
last_v dom_comm Dom_Comm
last_v sub_category Sub_Category
last_v extended_sub_category Extended_sub_category
last_v sub_category_supplier Sub_Category_supplier
{'store': ['Ain Shams Branch - Mostafa Hafez St.', 'October-WH', 'Asyut WH', 'Tanta Branch', 'BTECHX Zagazig', 'Suez Branch', 'El Betash Branch', 'New Dumietta Branch', 'BTECHX Saad El Din El Shazly', 'B.ONLINE', 'Malawi Branch', 'B.TECHX El Mandara', 'Fakous Branch', 'Banha Branch', 'Beni Suef Branch', 'Uni Mall El Obour', 'Show Room - Corp. Sale-38', 'Shebin El Koum Branch', '1Imbaba', 'Sale With Cost W.H', 'Smouha Branch', 'Haram Branch', 'BTECHX Sheraton', 'El Tagamou 2 Branch', 'Desouk Branch', 'El Sayeda Zainab', 'Tanta WH', 'El Mokattam Branch', 'BTECHX Open Air Mall', '10th of Ramadan WH', 'El-Gouna Branch', 'Masara', 'BTECHX Hegaz', 'Zahra El Asher Branch', 'Dar El Salam Branch', 'Miela Arkan Mall', 'BTECHX CityCenterMaadi', 'Agami Branch', 'Aswan Mega  Branch', 'Cairo Retail Warehouses', 'BTECHX Airport', 'Ain Shams Branch - Ibrahim Abdel Razek St.', 'Ismaila Branch-Railway station', 'Mega Helwan', 'Corporate Sales', 'BTECHX Mansoura', 'Shoubra Branch', 'Ras Ghareb Branch', 'Town Center El Salam', 'BTECHX Ramses Station', 'BTECHX GardeniaTagamo', 'Nagaa Hamadi Branch', 'Roxy Branch', 'BTECHX Mahala', 'Faisal Branch', 'BTECHX Kafr ElSheikh', 'El-Elsoudan Street Branch', 'El Kanater Branch', 'BTECH mini Egyptian Shooting ', 'Alamein Masa Mall', 'CFC Mall', 'El Nozha Branch', 'BTECHX 45', 'New Damanhour', '10th Tech Club WH', 'EL Amiria Branch', 'Miela Arkan WH', 'Banha warehouse', 'BTECHX Truck Alex', 'BTECHX Roxcy', 'Hassan El Maamon', 'Sohag Branch', 'EL Matria', 'BTECHXMataria', 'B.TECH X AUC', '0', 'Mega Alex Sidi Gaber', 'Misr elgdida', 'BTECHX Manial', 'Eldahar Mega Branch', 'El Helmya', 'Sky Mall El Sherouk Branch', 'Damanhour Branch', 'Ismalia Branch-City Council Square', 'El Menia Mega Branch', 'BTECHX Sporting Club', 'BTECHX Sohag', 'Berket Elsabaa Branch', 'BTECHX Shebin El koum', 'BTECHX 2Mansoura', 'BTECHX Obour2', 'B2B Gov', 'Aswan WH', '26Th July Branch', 'BTECHXCFC', '10th Show Room WH', 'BTECHX City Stars Mall', 'BTECHX San_Stefano Mall', 'Qena Branch', 'BTECHX Dokki', 'El Tahrir', 'Marina Kaian Branch', 'BTECH Mini Air Force House', 'BTECHX Assuit', 'BTECHX CityCenter Alex', 'BTECHX Midor', 'BTECHX Shinzo Abe', 'Makram Ebaid Branch', 'Dumietta Branch', 'BTECHX ElRehab North', 'Elagamy2', 'BTECHX El Sherouk', 'BTECHX ElShams Club', 'Maadi Branch-El Laselky St.', 'BTECHX El Menia', 'Quesna Branch', 'BTECHX Maadi Grand Mall', '9025Show Room Alex', 'Delta Tanta Mega Store', 'El Fayoum Branch', 'QENA-Warehouse', 'Mega Fisal', 'BTECHX Gehan2 Dewaka', 'Flag Mall Branch', 'BTECHX El Mosher Axis', 'BTECHX Kasr El Einy', 'New sohag', 'Winget Branch', 'Marina Branch', 'Port Said', 'Hadek El Kobba Branch', 'Marassi-North-Coast Branch', 'Dakernis Branch', 'Mansoura Branch', 'BTECHX Moharam Bek', 'HQ Call Center', 'BTECHX Ismailia Square', 'ElBahr ElAzam', 'Makadi Bay', 'GateWay Mall El Rehab', 'Assiut Branch - Ibn Sina Tower', 'BTECHX ElRehab Mall1', 'BTECHX Sidi Bishr', 'New Roxy', 'Jumia Seller Store', 'Oraby Branch', 'Deel Asyut WH', 'BTECHX ASU', 'Amwaj ranch', 'B.TECH STAFF', 'Mall Of October Branch', 'Alex_ Tusun', 'El Galaa', 'BTECHX Triumph Tagamo', 'Salah Salim Branch', 'Gesr El Suez Branch', 'BTECHX Gihan3 Abasia', 'Qalyub', 'Zayton Branch', 'El Seyouf Branch', 'BTECHX The Yard Mall', 'Asafra Branch', 'Luxor Branch', '3Tanta Mall', 'Zagazig Branch', 'Noon Seller Store1', 'Assuit Mega Branch', 'Loran Branch', 'BTECHX Safwa Zaid ', 'El Sadat Branch', 'BTECH Mini MPC', 'Mall Of Egypt Branch', 'El Zaher', 'Mahalla Branch', 'Almaza Branch', 'Abbas El-Akkad Branch', 'Shubra El Kheima Branch', 'El Tagamou 1 Branch', 'BTECH2Fayoum', 'Mall Of Arabia Branch', 'Alex WH'], 'region': ['DELTA', 'UPPER EGYPT', 'ALEXANDRIA', 'CAIRO', '0', 'HURGHADA'], 'season': [], 'area': [], 'Channel': ['B2B', 'ONLINE', 'CALL CENTER', 'WAREHOUSE', 'Retail', '0', 'MINI', 'ARKAN', 'B.TECH X', 'DEEL', 'NON'], 'budget_year': [0.0], 'Quarter': ['4', '0', '3'], 'month': ['December ', 'July     ', 'September', 'October  ', 'August   ', '0', 'November '], 'week': [0, 1, 2, 3, 4, 5, 6, 7], 'date': ['19944', '19983', '19992', '19906', '20074', '19989', '19968', '19954', '19965', '20052', '19961', '20005', '20066', '20084', '19912', '19930', '19915', '20032', '19935', '19940', '20042', '19980', '20028', '19911', '20029', '20087', '19999', '20017', '19921', '20036', '19936', '20011', '20044', '20004', '19937', '19958', '20000', '19974', '19986', '19966', '19953', '20076', '19919', '20085', '19924', '20035', '19910', '19955', '20054', '20086', '20055', '20039', '20009', '19929', '19952', '20051', '20058', '19963', '19991', '20065', '19977', '19978', '19947', '20050', '19971', '19981', '20075', '20070', '20062', '20020', '19946', '20069', '19987', '19996', '19916', '20046', '20024', '19923', '19950', '20033', '20012', '19922', '19927', '20003', '20057', '20027', '20025', '20023', '20038', '20064', '20013', '20007', '19969', '20060', '20079', '20078', '20059', '19988', '20026', '19917', '19994', '19998', '20015', '19956', '19973', '20056', '20071', '19976', '19941', '19934', '19918', '20008', '20083', '20080', '20077', '19959', '20053', '19920', '19985', '19908', '19960', '19984', '19926', '20047', '20049', '19905', '20040', '19957', '19975', '19993', '20068', '20081', '19907', '19995', '20010', '19938', '20088', '20073', '19970', '19928', '20048', '20030', '20002', '19931', '19942', '20006', '19990', '19982', '19949', '20019', '19932', '20041', '19939', '20034', '19972', '19948', '19943', '19951', '0', '19914', '19967', '19913', '20072', '20082', '20037', '19997', '20045', '19964', '20021', '20018', '19962', '19979', '20031', '19909', '20001', '20022', '19945', '19925', '19933', '20067', '20063', '20061', '20014', '20016', '20043'], 'Day': ['Wednesday', '0', 'Tuesday  ', 'Sunday   ', 'Monday   ', 'Thursday ', 'Friday   ', 'Saturday '], 'historical_year': [], 'history_Quarter': ['2', '0', '3', '4', '1'], 'history_month': ['December ', 'April    ', 'June     ', '0', 'September', 'March    ', 'October  ', 'July     ', 'August   ', 'May      ', 'January  ', 'February ', 'November '], 'history_week': ['0', '1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '3', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '4', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '5', '50', '51', '52', '6', '7', '8', '9'], 'history_Day': ['Sunday   ', 'Thursday ', 'Monday   ', 'Wednesday', 'Tuesday  ', 'Friday   ', '0', 'Saturday '], 'history_dates': [0, 18997, 19003, 19010, 19011, 19015, 19016, 19017, 19022, 19023, 19038, 19040, 19044, 19049, 19050, 19052, 19053, 19057, 19059, 19066, 19068, 19072, 19073, 19074, 19078, 19079, 19080, 19085, 19086, 19087, 19088, 19089, 19095, 19101, 19102, 19103, 19106, 19108, 19109, 19110, 19120, 19121, 19122, 19124, 19127, 19128, 19129, 19130, 19131, 19134, 19135, 19136, 19137, 19138, 19141, 19143, 19145, 19148, 19150, 19152, 19155, 19156, 19158, 19159, 19162, 19163, 19164, 19165, 19166, 19170, 19171, 19172, 19176, 19178, 19179, 19180, 19186, 19187, 19190, 19192, 19193, 19198, 19200, 19201, 19204, 19206, 19211, 19212, 19213, 19214, 19215, 19218, 19220, 19221, 19222, 19226, 19227, 19228, 19229, 19232, 19233, 19235, 19236, 19239, 19240, 19241, 19243, 19245, 19246, 19247, 19248, 19249, 19250, 19252, 19253, 19254, 19255, 19256, 19257, 19259, 19260, 19261, 19262, 19263, 19264, 19266, 19267, 19268, 19269, 19270, 19271, 19273, 19274, 19275, 19276, 19277, 19278, 19279, 19280, 19281, 19282, 19283, 19284, 19285, 19286, 19287, 19288, 19289, 19290, 19291, 19292, 19293, 19294, 19295, 19296, 19297, 19298, 19299, 19300, 19301, 19302, 19303, 19304, 19305, 19306, 19307, 19308, 19309, 19310, 19311, 19312, 19313, 19314, 19315, 19316, 19317, 19318, 19319, 19320, 19321, 19322, 19323, 19324, 19325, 19326, 19327, 19328, 19329, 19330, 19331, 19332, 19333, 19334, 19335, 19336, 19337, 19338, 19339, 19340, 19341, 19342, 19343, 19344, 19345, 19346, 19347, 19348, 19349, 19350, 19351, 19352, 19353, 19354, 19355, 19356, 19357, 19358, 19359, 19360, 19361, 19362, 19363, 19364, 19365, 19366, 19367, 19368, 19369, 19370, 19371, 19372, 19373, 19374, 19375, 19376, 19377, 19378, 19379, 19380, 19381, 19382, 19383, 19384, 19385, 19386, 19387, 19388, 19389, 19390, 19391, 19392, 19393, 19394, 19395, 19396, 19397, 19398, 19399, 19400, 19401, 19402, 19403, 19404, 19405, 19406, 19407, 19408, 19409, 19410, 19411, 19412, 19413, 19414, 19415, 19416, 19417, 19418, 19419, 19420, 19421, 19422, 19423, 19424, 19425, 19426, 19427, 19428, 19429, 19430, 19431, 19432, 19433, 19434, 19435, 19436, 19437, 19438, 19439, 19440, 19441, 19442, 19443, 19444, 19445, 19446, 19447, 19448, 19449, 19450, 19451, 19452, 19453, 19454, 19455, 19456, 19457, 19458, 19459, 19460, 19461, 19462, 19463, 19464, 19465, 19466, 19467, 19468, 19469, 19470, 19471, 19472, 19473, 19474, 19475, 19476, 19477, 19478, 19479, 19480, 19481, 19482, 19483, 19484, 19485, 19486, 19487, 19488, 19489, 19490, 19491, 19492, 19493, 19494, 19495, 19496, 19497, 19498, 19499, 19500, 19501, 19502, 19503, 19504, 19505, 19506, 19507, 19508, 19509, 19510, 19511, 19512, 19513, 19514, 19515, 19516, 19517, 19518, 19519, 19520, 19521, 19522, 19523, 19524, 19525, 19526, 19527, 19528, 19529, 19530, 19531, 19532, 19533, 19534, 19535, 19536, 19537, 19538, 19539, 19540, 19541, 19542, 19543, 19544, 19545, 19546, 19547, 19548, 19549, 19550, 19551, 19552, 19553, 19554, 19555, 19556, 19557, 19558, 19559, 19560, 19561, 19562, 19563, 19564, 19565, 19566, 19567, 19568, 19569, 19570, 19571, 19572, 19573, 19574, 19575, 19576, 19577, 19578, 19579, 19580, 19581, 19582, 19583, 19584, 19585, 19586, 19587, 19588, 19589, 19590, 19591, 19592, 19593, 19594, 19595, 19596, 19597, 19598, 19599, 19600, 19601, 19602, 19603, 19604, 19605, 19606, 19607, 19608, 19609, 19610, 19611, 19612, 19613, 19614, 19615, 19616, 19617, 19618, 19619, 19620, 19621, 19622, 19623, 19624, 19625, 19626, 19627, 19628, 19629, 19630, 19631, 19632, 19633, 19634, 19635, 19636, 19637, 19638, 19639, 19640, 19641, 19642, 19643, 19644, 19645, 19646, 19647, 19648, 19649, 19650, 19651, 19652, 19653, 19654, 19655, 19656, 19657, 19658, 19659, 19660, 19661, 19662, 19663, 19664, 19665, 19666, 19667, 19668, 19669, 19670, 19671, 19672, 19673, 19674, 19675, 19676, 19677, 19678, 19679, 19680, 19681, 19682, 19683, 19684, 19685, 19686, 19687, 19688, 19689, 19690, 19691, 19692, 19693, 19694, 19695, 19696, 19697, 19698, 19699, 19700, 19701, 19702, 19703, 19704, 19705, 19706, 19707, 19708, 19709, 19710, 19711, 19712, 19713, 19714, 19715, 19716, 19717, 19718, 19719, 19720, 19721, 19722, 19723, 19724, 19725, 19726, 19727, 19728, 19729, 19730, 19731, 19732, 19733, 19734, 19735, 19736, 19737, 19738, 19739, 19740, 19741, 19742, 19743, 19744, 19745, 19746, 19747, 19748, 19749, 19750, 19751, 19752, 19753, 19754, 19755, 19756, 19757, 19758, 19759, 19760, 19761, 19762, 19763, 19764, 19765, 19766, 19767, 19768, 19769, 19770, 19771, 19772, 19773, 19774, 19775, 19776, 19777, 19778, 19779, 19780, 19781, 19782, 19783, 19784, 19785, 19786, 19787, 19788, 19789, 19790, 19791, 19792, 19793, 19794, 19795, 19796, 19797, 19798, 19799, 19800, 19801, 19802, 19803, 19804, 19805, 19806, 19807, 19808, 19809, 19810, 19811, 19812, 19813, 19814, 19815, 19816, 19817, 19818, 19819, 19820, 19821, 19822, 19823, 19824, 19825, 19826, 19827, 19828, 19829, 19830, 19831, 19832, 19833, 19834, 19835, 19836, 19837, 19838, 19839, 19840, 19841, 19842, 19843, 19844, 19845, 19846, 19847, 19848, 19849, 19850, 19851, 19852, 19853, 19854, 19855, 19856, 19857, 19858, 19859, 19860, 19861, 19862, 19863, 19864, 19865, 19866, 19867, 19868, 19869, 19870, 19871, 19872, 19873, 19874], 'article_score': ['sale', 'abc', 'ae', 'speed', 'terminal', 'margin', 'sell', 'markdown', 'core', 'quartile', 'sortimeter'], 'history_year': [0.0, 2022.0, 2023.0, 2024.0], 'family': ['LAPTOP', 'MOBILE', 'MDA', 'AC', 'TV', 'NON', 'TABLET', '0', 'SDA', 'COMPLEMENTARY', 'BMOBILE ACCESSORIES'], 'sub_family': ['MDA DOM', 'SDA COM', 'NON', 'AC DOM', 'TV COM', 'BMOBILE', 'SDA DOM', 'TV DOM', '0', 'MDA COM', 'AC COM'], 'supplier': ['TOSHIBA Midea', 'INDESIT', 'GENERAL ELECTRIC', 'WHITE WHALE', 'LA GERMANYA', 'BEKO', 'KIRIAZI', 'AVANTREE', 'ELIOS', 'KHATER', 'MPT PT', 'VAIO', 'ARION', 'FIRST', 'ROYAL', 'UG', 'BIALETTI', 'FORA', 'BENQ', 'XIAOMI', 'BeKO', 'S.LINK', 'CLABER', 'BAUMATIC', 'CRAFT', 'KEENDEX', 'SPEED', 'BABYLISS', 'TEFAL', 'SONAI', 'TORNADO', 'HUAWEI', 'TANK', 'ARZUM', 'SEASONS', 'UNION AIRE', 'TOUCH', 'DAHUA', 'OZO', 'LG', 'NOKIA', 'ZAHRAN', 'BOSCH', 'KENWOOD', 'DOB', 'WHITE POINT', 'ECOMATIC', 'NOUR TECH', 'EPSON', 'REMINGTON', 'FLAT', 'UNIVERSAL', 'NESTLE', 'GALAXI', 'SKYWORTH ZAPPER', 'ORAIMO', 'ARISTON', 'MIELE', 'BRAUN', 'HOME TECH', 'HAPILLINE', 'G.TEC', 'BMOBILE ACCESSORIES', 'NIKON', 'GROUHY', 'NON', 'HOOVER', 'FALCON', 'INFINIX', 'ETI', 'MUTECH', 'OPPO', 'MEDIA TECH', 'HITACHI', 'SCHNEIDER', 'AKWRJ', 'DAIKIN', 'HONOR', 'BOMAN', 'HOME', 'MUSIC HERO', 'GORENJE', 'LAVA', 'REALME', 'NIKAI', 'NESPRESSO', 'INFINX', 'ATA', 'LOGITECH', 'MSI', 'WACACO', 'LENOVO', 'VEITO', 'CARRIERE', 'CAIXUN', 'SIMFER', 'VIVO', 'SYINIX', 'KOLDAIR', 'ZANUSSI', 'SHTEBEL', 'DELL', 'ILOOK', 'HOPE', 'SENCOR', 'NI', 'MODEM', 'ELECTROSTAR', 'BENEX', 'MOULINEX', 'CANON', 'GLEMGAS', 'ITEL', 'OSN', 'FUTURE', 'ASUS', 'PREMIUM', 'ULTRA', 'PANASONIC', 'STEEL', 'ROVO', 'RUSH BRUSH', 'ORIGINAL', 'EZVIZ', 'HELLER', 'MPT HT', 'KARCHER', 'BERGEN', 'BISSELL', 'F&D', 'FAGOR', 'DELONGHI', 'KIOXIA', 'OKKA', 'CANDY', 'ALASKA', 'ZADA', 'CHOETECH', 'PASSAP', 'INTEL', 'LAVVENTO', 'LONGLIFE', 'ELBA', 'FRESH', 'SMART', 'ALEXA', 'SARY', 'FERROLI', 'MIDEA', 'MIENTA', 'PHILIPS', 'AMERICOOL', 'BLACK AND DECAR', 'PLUTO', 'TOSHIBA', 'VIEW', 'SNDWAY', 'PREMIER', 'ICOOK', 'FRANKE', 'HAIER', '0', 'TCL', 'AMAZONE', 'SEM', 'BLACK AND WHITE', 'HISENSE', 'DAEWOO', 'ARIETE', 'SONY', 'ICONZ', 'BRANDT', 'FLYON', 'APPLE', 'HP', 'OLYMPIC', 'CLAGE', 'SOLAC', 'HAMA', 'MODEX', 'NARDI', 'MICROSOFT', 'TRUMAN', 'SHARP', 'SANDISK', 'STRONG', 'CONTEX', 'XAIOMI', 'LDNIO', 'ATLANTIC', 'IDEAL', 'TIGER', 'DALY', 'SAMSUNG', 'KLASS', 'HOUSECOM', 'HAVIT'], 'category': ['Hobs Fagor', 'Grill Touch', 'Audio Samsung', 'Ele heater flyon', 'IFixBtech', 'TV Acc STRONG', 'Gas Heater Kiriazi', 'Dryer LG', 'H.Blend Touch', 'E.Hot Plate Mienta', 'Fridge Sharp', 'TV Acc ICONZ', 'Audio sony', 'H.Mixer Sonai', 'AC Fresh', 'M.Mincer Black&White', 'Gift Bosch', 'Hair Dryer Babyliss', 'Cooker Zanussi', 'Tablet APPLE', 'Coffee M Zada', 'Mic. Home', 'Oven Nardi', 'AC Premium', 'TV SARY', 'Cooker White Point', 'Grill Modex', 'Air Purifier LG', 'Fun Line Media Tech', 'Filter Tank', 'Chopper Bosch', 'TV Premium', 'Hood Ariston', 'Holders SBS', 'AC LG', 'Toaster Panasonic', 'H.Blender Smart', 'Cooker Royal', 'Espresso Machine Ari', 'Washing M Zanussi', 'M.Mincer Braun', 'Fridge Miele', 'Hood Tornado', 'Washing M Haier', 'Fan Nikai', 'Gas Heater Atlantic', 'Receiver ETI', 'Gas Heater White Poi', 'Coffee M Modex', 'VC Hoover', 'TV Acc Fora', 'Iron Kenwood', 'VC Miele', 'Fun Line Black&decke', 'Air Fryer Tornado', 'Hobs Tornado', 'Bottel Tank', 'Hood Bosch', 'Mic. Ariston', 'Thermal Mug Tiger', 'VC LG', 'Chopper Fresh', 'Mobile REALME', 'Fan Touch', 'Kettle Bosch', 'Cooker Bosch', 'Fridge Samsung', 'AC Sharp', 'Tablet Nokia', 'H.Blend sary', 'Cables SBS', 'Deep F Alaska', 'Blender Ariete', 'Iron Tefal', 'H.Blend Mienta', 'WD Tank', 'AC TORNADO', 'Gift Samsung', 'Toaster Kenwood', 'VC Ultra', 'WD Tornado', 'Mixer Black&decker', 'Comp Monitor BenQ', 'Hobs Beko', 'Tablet Samsung', 'VC Bissell', 'Security Ass Camera ', 'IFix', 'Coffee M Braun', 'TV Acc Energizer', 'Cooker Beko', 'Fridge Indesit', 'Warmer Tornado', 'Chopper Black&decker', 'Frayer Mienta', 'H.Blend Moulinex', 'TV UG', 'Fan black&decker', 'H.Mixer SMART', 'Warmer Mienta', 'Complem Camera Nikon', 'Laptop APPLE', 'Iron Solac', 'E.Hot Plate SMART', 'VC Fresh', 'Deep F Fresh', 'WD Fresh', 'Washing M Premium', 'Fridge Alaska', 'Laptop MSI', 'mosq.kill Home', 'Deep F Toshiba', 'Comp Monitor Xiaomi', 'WD Bergen', 'Mic. Sharp', 'Hobs Miele', 'VC Kenwood', 'Laptop VAIO', 'Mixer Black&white', 'Iron Tornado', 'Tools Claber', 'VC Bosch', 'Coffee M Media Tech', 'Lam Black&decker', 'Hood Sonai', 'Coffee M Black&decke', 'AC General Electric', 'Hobs Indesit', 'Blender Black&decker', 'Toaster Mienta', 'Fan Tefal', 'Cleaning SBS', 'Fan Smart', 'Airpods kit SBS', 'Washing M Fagor', 'VC Grouhy', 'Iron Smart', 'Washing M Indesit', 'Oven beko', 'Gas Heater Zanussi', 'H.Mixer Fresh', 'Air Purifier SHARP', 'Thermoses Tiger', 'M.Mincer Touch', 'Hobs Elba', 'Grill Home', 'Laptop Huawei', 'Kitchen M Black&whit', 'TV Acc ilook', 'Juicer Mienta', 'kettle Black&white', 'Grill Kenwood', 'Ice Box Tank', 'H.Mixer Bosch', 'F.Proc Grouhy', 'F.Proc SMART', 'Air Cooler Sonai', 'H.Blend Tornado', 'Fun Line Tornado', 'Air Cooler Home', 'Hobs Zanussi', 'Curl Irons Rush brus', 'H.Mixer Mienta', 'Air Styler Babyliss', 'F.Proc Ariete', 'Fun Line Ariete', 'Chopper Moulinex', 'Hood Hoover', 'Fun Line Zahran', 'Hair Dryer Remington', 'M.Mincer Sonai', 'Kitchen M Modex', 'TV View', 'TV Acc FLAT', 'TV Acc Toshiba', 'Oven Sharp', 'WD Ultra', 'Scale Solac', 'Ele Heater Olympic', 'tv acc keendex', 'Kitchen M Ariete', 'Fan Fresh', 'Chopper Kenwood', 'AC Accessory Carrier', 'H.Mixer Moulinex', 'Gas Heater PASSAP', 'Wall Hood Olympic', 'AC ULTRA', 'AC Crafft', 'Cooker Premium', 'Coffee M Bialetti', 'Hair Dryer Rush brus', 'Deep F Beko', 'Wall Hood Toshiba', 'Cooker Fresh', 'Ele Heater Zanussi', 'TV Accessory', 'Thermal Mug Tank', 'Deep F Miele', 'Gas Heater Fresh', 'WARMER Ultra', 'TV Acc Itel', 'Gas Heater Union Air', 'Blender Kenwood', 'Mobile INFINX', 'Cooker Union Aire?', 'Washing M Miele', 'F.Proc Benex', 'Iron Panasonic', 'AC Carriere', 'Washing M Hoover', 'H.Mixer Midea', 'Hair Dryer Philips', 'Fridge LG', 'Warmer Delonghi', 'Blender Ultra', 'Grill Tefal', 'Straightners Mienta', 'F.Proc Home', 'Cooker White Whale', 'Gift Indesit', 'VC Ariete', 'H.Mixer Rovo', 'Laptop Microsoft', 'Fan universal', 'Comp Google Mesh IOT', 'TV Sony', 'VC Mienta', 'Oven Touch', 'Oven Mienta', 'Toaster Ariete', 'Mobile OPPO', 'Kitchen M G.tec', 'Fridge White Whale', 'Fun Line Sonai', 'Washing M Samsung', 'Washing M Ariston', 'Warmer Fresh', 'Hood Gorenje', 'Iron Home', 'Receiver Galaxi', 'H.Mixer Touch', 'VC AccessoriesMiele', 'Tools Bosch', 'Hood ICook', 'H.Blend SENCOR', 'Receiver truman', 'Straightners Remingt', 'Grill Zada', 'Coffee M Mienta', 'H.Mixer Tornado', 'Mixer Media Tech', 'Fridge Union Aire', 'Coffee M Tornado', 'Gift Universal', 'Warmer Touch', 'Juicer Media Tech', 'Gas Heater premium', 'Frayer Ariston', 'Coffee M Home', 'AC Accessory Crafft', 'Fridge Tornado', 'Hood Fagor', 'M Grinder Sonai', 'Ele Heater Shtebel', 'Grill Fresh', 'Kitchen M Bosch', 'Fan Tornado', 'F.Proc G.tec', 'VC Samsung', 'F.Proc Modex', 'R.cooker Black&decke', 'Coffee M Solac', 'H.Mixer Kenwood', 'Gas Heater Universal', 'IT ASS ASS', 'Iron Ultra', 'Filter ASS Tank', 'Deep F Tornado', 'Blender Mienta', 'Mic. Kenwood', 'AC Zanussi', 'Fridge Ariston', 'R.cooker Media Tech', 'Grill Black&decker', 'TV Acc ETI', 'Thermal Mug Tefal', 'tv acc truman', 'Air Cooler Fresh', 'Headset SBS', 'Kettle Zada', 'Hobs Klass', 'Iron Black&Decker', 'Oven Franke', 'Fan Sonai', 'Deep F Ariston', 'Gas Heater Arion', 'Oven Klass', 'Mobile VIVO', 'F.Proc Union Aire', 'TV Nikai', 'AC Accessory Daikin', 'Straightners Tornado', 'TV Acc Falcon', 'Gas Heater Tornado', 'Hobs Fresh', 'R.cooker Tefal', 'Grill Bosch', 'Washer Dry ASSMiele', 'Shaving_Tri Braun', 'Sport Machine Future', 'Compl DESK PC Intel', 'Mic. Hoover', 'Mic. SMART', 'Blender Sonai', 'TV Sharp', 'Iron Braun', 'Juicer Sonai', 'Fridge Bosch', 'WD PASSAP', 'Shaving_Tri Tornado', 'E.Hot Plate Fresh', 'WD White Point', 'Audio F&D', 'VC Modex', 'Kitchen M SMART', 'TV Acc Tiger', 'H.Mixer Braun', 'Gift Fresh', 'Mixer Touch', 'Toaster tornado', 'AC Haier', 'Audio First', 'F.Proc Braun', 'Deep F Panasonic', 'Oven Ariston', 'Iron Modex', 'Warmer Media Tech', 'Coffee M White Whale', 'Fun Line Mienta', 'TV Acc STEEL', 'M.Mincer Panasonic', 'Gas Heater Toshiba', 'Kettle Zahran', 'Kettle Ariete', 'Hobs ECOMATIC', 'Hobs Bosch', 'Tablet TCL', 'Mincer Black&decker', 'Gift LG', 'Tablet Huawei', 'F.Proc Sonai', 'Blender sary', 'Hair Dryer arzum', 'Coffee M Kenwood', 'Deep F White Whale', 'Fan Union Aire?', 'Audio oraimo', 'Oven Brandt', 'Kettle SENCOR', 'Hood ASS Indesit', 'Deep F Sharp', 'Chopper SMART', 'Hobs Brandt', 'Gas Heater White Wha', 'Tripod SBS', 'TV Contex', 'Gas Heater LongLife', 'Audio Toshiba', 'Wall Hood Fresh', '0', 'Cappuccino Maker Ari', 'H.Blend Bosch', 'Fan Arion', 'Juicer Solac', 'Ele Heater White Wha', 'Hood Beko', 'Fridge Ideal', 'TV ASS ASS', 'AC Americool', 'Kettle Kenwood', 'Wall Hood Tornado', 'Blender Black&white', 'Hobs SMART', 'Kettle Touch', 'D Washer Miele', 'H.Blend Black&white', 'E.Hot Touch', 'Blender Media Tech', 'Hood Premier', 'Coffee Grinder Ariet', 'Iron Black&white', 'Fan Black&white', 'Mobile Huawei', 'TV Acc HP', 'Blender Panasonic', 'VC Toshiba', 'Chopper Media Tech', 'Chopper Ultra', 'Washing M Toshiba', 'H.Blend G.tec', 'Ele Heater Ariston', 'Coffee M Tefal', 'Mobile XIAOMI', 'Hood Panasonic', 'Hood Fresh', 'Kettle Arion', 'F.Proc Tornado', 'Toaster Black&decker', 'Mincer Bosch', 'Blender Modex', 'M.Mincer Tornado', 'Laptop HP', 'VC Black&white', 'Mobile APPLE', 'Straightners Babylis', 'Mixer Kenwood', 'Frayer Miele', 'Receiver', 'AC Accessory Premium', 'Washing M LG', 'D Washer Bosch', 'TV Acc hama', 'Coffee M okka', 'TV Hisense', 'Protection SBS', 'Mic. LG', 'Iron Touch', 'M.Mincer Modex', 'Hobs GLEMGAS', 'TV FRESH', 'Hobs Ariston', 'Gaming ASS ASS', 'Kitchen M Mienta', 'Deep F White Point', 'Oven Hoover', 'AC Accessory Fresh', 'Deep F Kiriazi', 'Fridge ULTRA', 'Complem Printer HP', 'Washing M CANDY', 'Oven Simfer', 'Iron Philips I2', 'H.Mixer Panasonic', 'Audio LG', 'Toaster Braun', 'Kettle Tornado', 'Laptop Lenovo', 'D Washer LG', 'Kitchen M Kenwood', 'Oven Zanussi', 'Curl Irons Babyliss', 'Juicer Bosch', 'Shaving_Tri Hapillin', 'Audio Dob', 'Thermal Mug WACACO', 'Selfie Stick SBS', 'Washing M Beko', 'Fridge Haier', 'Receiver SkyWorth Za', 'Blender Touch', 'Ele Heater Union Air', 'Frayer Modex', 'Oven Bosch', 'Masher Black&white', 'Shaving_TriRemington', 'Fan Mienta', 'F.Proc Black&decker', 'Laptop ASUS', 'Enquiry Fees', 'Mic. Zanussi', 'Washing M Sharp', 'Hobs Nardi', 'Hair Dryer Solac', 'Grill Mienta', 'Gift Nestle', 'M.Mincer Bosch', 'AC Beko', 'Hood Indesit', 'Blender Home', 'Cliner M Karcher', 'Mic. Daewoo', 'Chopper Tornado', 'Dryer Home', 'D Washer White Point', 'Kettle Black&decker', 'H.Mixer Black&white', 'B.ElectronicServices', 'AC Accessory LG', 'Kitchen M Home', 'M.Mincer SMART', 'Fridge Fresh', 'Warmer Heller', 'Deep F Electrostar', 'F.Proc ULTRA', 'kitchen m sary', 'F.Proc Bosch', 'Fridge White Point', 'Oven Fagor', 'Hood Elba', 'Washing M Bosch', 'Juicer Tornado', 'H.Blender SEM', 'Gas Heater Ariston', 'Ele Heater Fresh', 'F.Proc Kenwood', 'Straightners Braun', 'Com Projector Merlin', 'Fridge PASSAP', 'AC Hisense', 'Coffee M Sonai', 'Warmer Shtebel', 'Hobs Gorenje', 'Complem Gaming Sony', 'Gift Ariston', 'VC Daewoo', 'Comp Monitor Lenovo', 'Oven Gorenje', 'Ele Heater Atlantic', 'Mic. Black&decker', 'Gas Heater Olympic', 'Cooker La germanya', 'Blender G.tec', 'Oven Elba', 'Hobs ICook', 'Kettle Media Tech', 'Tools Hitachi', 'tv acc elios', 'Stand Indesit', 'Shaving_Tri Philips', 'kettle Media', 'Transferfeesonline01', 'Mobile Hope', 'Masher Mienta', 'VC Panasonic', 'AC Daikin', 'Coffee M Bosch', 'AC Acc Union Aire', 'Fun Line Home', 'Mic. Samsung', 'Kettle Solac', 'Blender Tornado', 'H.Blend Black&decker', 'Audio Philips', 'Hood Zanussi', 'Fridge Kiriazi', 'Oven Miele', 'Comp Monitor Samsung', 'Frayer Black&decker', 'Washing M Fresh', 'Kettle Modex', 'TV Toshiba', 'Mobile Samsung', 'Cooker Kiriazi', 'Mobile LAVA', 'Ele Heater VEITO', 'Audio Avantree', 'TV Rowa', 'Compl Camera GoPRO', 'Mic. Tornado', 'Tools MPT PT', 'Hobs Hoover', 'Juicer Braun', 'F.Proc Mienta', 'TV Syinix', 'Oven Ultra', 'Washing M Tornado', 'Mobile NOKIA', 'Coffee M Beko', 'Gas Heater Bosch', 'Comp Monitor Dell', 'Charger SBS', 'TV Caixun', 'Kitchen M Fresh', 'Receiver Daly', 'Filter ASS philips', 'Ele Heater Clage', 'Kettle Fresh', 'Washing M Union Aire', 'VC Tornado', 'Shaving_Tri Babyliss', 'Kettle Home', 'H.Blender Braun', 'AC Union Aire?', 'Coffee M Philips I2', 'Gas Heater Panasonic', 'Kitchen M Moulinex', 'Tools sndway', 'Comp Printer Epson', 'Fridge Electrostar', 'Kettle Housecom', 'D Washer Indesit', 'Ele Heater Kiriazi', 'Chopper Sonai', 'kettle Mienta', 'Frayer Philips I2', 'Chopper Ariete', 'Straightners Rush br', 'H.Blend Media Tech', 'Fan Kenwood', 'TV Acc Media Tech', 'Kettle SMART', 'Power Bank SBS', 'Fan Ultra', 'R.cooker Modex', 'Juicer Home Tech', 'Coffee M SMART', 'Hood Miele', 'VC Smart', 'Hood Touch', 'Blender Bosch', 'F.Proc Panasonic', 'Blender sencor', 'Hobs Baumatic', 'Gas Heater Ferroli', 'Boxi', 'E.Hot Pla Home', 'Mic. Fresh', 'F.Proc Moulinex', 'Masher Kenwood', 'M.Mincer Kenwood', 'AC Midea', 'Hair Dryer Tornado', 'Fun Line Solac', 'Hood Franke', 'Hobs Franke', 'TV Tcl', 'Blender Fresh', 'Blender Braun', 'Oven Indesit', 'Fan Panasonic', 'Audio', 'Ele Heater TORNADO', 'Deep F Union Aire?', 'Kettle Braun', 'Toaster Home', 'Ele Heater Universal', 'Air Styler Rush brus', 'TV Acc NI', 'Complent Alexa IOT', 'B2B AC', 'Air Cooler Tornado', 'AC Accessory Zanussi', 'Ice Tank Tank', 'WD speed', 'F.Proc Black&white', 'Juicer Home', 'Speaker SBS', 'Deep F Indesit', 'D Washer Beko', 'TV Pluto', 'Frayer Tefal', 'Frayer Bergen', 'Audio Media Tech', 'Frayer Home', 'TV Samsung', 'TV LG', 'Mincer Home', 'Washing M White Poin', 'Kitchen M Touch', 'Mixer Modex', 'Coffee M Delonghi', 'Mobile HONOR', 'Fridge Beko', 'Deep F PASSAP', 'Kettle Panasonic', 'H.Blend Home', 'Ele Heater Boman', 'VC Hitachi', 'Ele Heater Toshiba', 'TV Acc Etrain', 'Mixer Ultra', 'Chopper Touch', 'Cooker Universal', 'Tools MPT HT', 'Iron Mienta', 'Security Ass Camera', 'Chopper Rovo', 'H.Mixer Modex', 'Cooking Appliances A', 'AC Accessory Haier', 'Washing M Kiriazi', 'Blender Moulinex', 'Frayer Delonghi', 'WD White Whale', 'Laptop DELL', 'Blender Smart', 'Tablet Lenovo', 'TV Haier', 'TV Union Aire', 'Compl Printer CANON', 'H.Blend Kenwood', 'AC Accessory Sharp', 'tv acc schneider', 'TABLET REALME', 'TV ATA', 'Warmer Black&decker', 'Mincer White Whale', 'Juicer Kenwood', 'TV Ultra', 'D Washer Zanussi', 'B.Electronic ass', 'Deep F LG', 'Sport Machine Khater', 'Iron Ariete', 'D Washer Fresh', 'Oven Tornado', 'Fridge Zanussi', 'Complem Camera CANON', 'Washer Dryer Ariston', 'Fridge Toshiba', 'Air Fryer Kenwood', 'VC Solac', 'Iron Media Tech', 'Warmer veito', 'Oven Home', 'VC Black&decker', 'VC Tefal', 'Coffee M Nespresso', 'Chopper Mienta', 'VC Rovo', 'TV Acc MUTECH', 'Lam Philips', 'Frayer Fresh', 'Bundle- b-in Indesit', 'D Washer Ariston', 'Juicer Modex', 'Warmer Akwrj', 'TV Acc osn', 'Straightners Solac', 'Grill Solac', 'Straightners Philips', 'Kettle Sonai', 'Grill Tornado', 'TV Tornado', 'Juicer Moulinex', 'Oven Fresh', 'Grill Media Tech', 'Mixer Union Aire', 'R.cooker HOME', 'M.Mincer Moulinex'], 'dom_comm': ['0', 'COMM', 'B.MOBILE', 'DOM', 'NON'], 'sub_category': ['COFFEE GRINDER', 'AC-HOT/COLD-5HP', 'H.MIXER', 'TV-65-SMRT-HI', 'TOASTER', 'WASHING M', 'SHAVING_TRI', 'FILTER 3 STAGES', 'TV-50-SMRT', 'BLENDER', 'SPORT MACHINE', 'TV-50', 'TV-55-SMRT', 'TANK', 'LAPTOP', 'AC-HOT/COLD-1.5HP-OUTDOOR UNIT', 'FILTER 7 STAGES', 'AC-HOT/COLD-5HP-OUTDOOR UNIT', 'FAN', 'VC', 'AC-COLD-1.5HP-INDOOR UNIT', 'AC-HOT/COLD-3HP', 'FILTER 5 STAGES', 'TV-75-SMRT-HI', 'COOKER', 'AC-COLD-1.5HP-OUTDOOR UNIT', 'IRON', 'RECEIVER', 'AC-HOT/COLD-4HP', 'WASHER DRY ASS', 'AC-COLD-2.25HP-OUTDOOR UNIT', '0', 'AC-HOT/COLD-3HP-OUTDOOR UNIT', 'ELE HEATER', 'AIR COOLER', 'AC-COLD-3HP-OUTDOOR UNIT', 'AIR PURIFIER', 'F.PROC', 'AIR FRYER', 'ESPRESSO MACH', 'MASHER', 'TV-43-SMRT', 'HOOD', 'AC-HOT/COLD-7HP-OUTDOOR UNIT', 'AC-HOT/COLD-3HP-INDOOR UNIT', 'CURL IRONS', 'LAM', 'It_Acc', 'TV-32-SMRT', 'GRILL', 'TV-40', 'BUNDLE- B-IN', 'R.COOKER', 'AC-HOT/COLD-4HP-INDOOR UNIT', 'COOKING APPLIANCES', 'TV-55-SMRT-HI', 'FUN LINE', 'THERMAL VESSEL', 'TV-75-SMRT', 'AC-HOT/COLD-4HP-OUTDOOR UNIT', 'CLINER M', 'Wearable_Acc', 'FILTER 6 STAGES', 'TV-ACCESSORY', 'H.BLENDER', 'TV-86-SMRT', 'WALL HOOD', 'AC-HOT/COLD-2.25HP-INDOOR UNIT', 'AC-COLD-1.5HP', 'SCALE', 'TOOLS', 'AC-COLD-7HP-INDOOR UNIT', 'FRIDGE', 'DRYER', 'VC ACCESSORIES', 'HOOD ASS', 'CHOPPER', 'TV-43', 'AC-COLD-7HP-OUTDOOR UNIT', 'E.HOT PLATE', 'AC-COLD-2.25HP', 'HAIR DRYER', 'D WASHER', 'TV-70-SMRT', 'AC-HOT/COLD-1.5HP', 'HOBS', 'TV-85-SMRT-HI', 'NON', 'MOBILE', 'TV-FRAME', 'WASHER DRYER', 'TABLET', 'DEEP FREEZER', 'TV-50-SMRT-HI', 'STRAIGHTNERS', 'MINCER', 'AC-COLD-2.25HP-INDOOR UNIT', 'AIR STYLER', 'Mobile_Acc', 'FRAYER', 'TV-85-SMRT', 'OVEN', 'GAS HEATER', 'MOSQ.KILL', 'M.MINCER', 'COFFEE M', 'JUICER', 'TV-60-SMRT', 'MDA ASS', 'MICROWAVE', 'AC-HOT/COLD-5HP-INDOOR UNIT', 'TV-40-SMRT', 'AC-HOT/COLD-6HP-INDOOR UNIT', 'MIXER', 'WD', 'AC ACCESSORY', 'FILTER ASS', 'TV-32', 'AC-HOT/COLD-1.5HP-INDOOR UNIT', 'BMOBILE ACCESSORIES', 'CAPPUCCINO MAKER', 'AC-HOT/COLD-2.25HP', 'KETTLE', 'AUDIO', 'AC-HOT/COLD-2.25HP-OUTDOOR UNIT', 'AC-COLD-3HP-INDOOR UNIT', 'GIFT', 'AC-HOT/COLD-7HP-INDOOR UNIT', 'KITCHEN M', 'ALEXA ECHO DOT', 'WARMER', 'TV-65-SMRT', 'COMPLEMENTARY'], 'extended_sub_category': ['TV-50', 'Mobile Cables', 'SHAVING_TRI', 'KETTLE', 'Wearables', 'COMPLEMENTARY', 'AC COMPLEMENTARY', 'WALL HOOD', 'AIR COOLER', 'Network-Modem', 'AIR FRYER', 'WD', 'FRAYER', 'AC-COLD-2.25HP', 'Storage', 'TV-43-SMRT', 'E.HOT PLATE', 'AC-HOT/COLD-5HP', 'Mobile photography', 'AC-COLD-7HP', 'AC-COLD-1.5HP', 'HAIR DRYER', 'DEEP FREEZER', 'HOOD', 'TABLET', 'CAPPUCCINO MAKER', 'FUN LINE', 'AC-HOT/COLD-3HP', 'BMOBILE ACCESSORIES', 'TV-55-SMRT', 'GRILL', 'MIXER', 'TANK', 'Mobile Holder', 'DRYER', 'COFFEE M', 'IRON', 'Power', 'Security', 'MASHER', 'TV-70-SMRT', 'WASHER DRYER', 'MOSQ.KILL', 'TV-50-SMRT-HI', 'Smart Scale', 'SPORT MACHINE', 'JUICER', 'Bar Code Scanner', 'TV-40', 'CURL IRONS', 'WARMER', 'TV Cables', 'M.MINCER', 'COOKER', 'COFFEE GRINDER', 'FAN', 'Smart tag', 'Smart Home', 'FILTER 7 STAGES', 'TV-65-SMRT-HI', 'TV-32-SMRT', 'Bundle', 'TV-43', 'Mobile cables', 'F.PROC', 'Mobile Audio', 'OVEN', 'AIR STYLER', 'HOBS', 'H.BLENDER', 'ESPRESSO MACH', 'MINCER', 'TV-40-SMRT', 'Gaming', 'TV-75-SMRT', 'CLINER M', 'TV-60-SMRT', 'STRAIGHTNERS', 'IOT', 'CHOPPER', 'BUNDLE- B-IN', 'Network-Switch', 'KITCHEN M', 'FILTER 3 STAGES', '0', 'MICROWAVE', 'FRIDGE', 'TV-65-SMRT', 'AC-HOT/COLD-1.5HP', 'AC-HOT/COLD-6HP', 'TV-75-SMRT-HI', 'WL Telephone', 'SCALE', 'FILTER 5 STAGES', 'R.COOKER', 'ELE HEATER', 'FILTER 6 STAGES', 'MDA COMPLEMENTARY', 'Computer peripherals', 'Service', 'TV COMPLEMENTARY', 'ALEXA ECHO DOT', 'Gift', 'LAPTOP', 'Network-Adapter', 'VC', 'H.MIXER', 'COOKING APPLIANCES', 'MOBILE', 'THERMAL VESSEL', 'MOBILE COMPLEMENTARY', 'AC-COLD-3HP', 'D WASHER', 'TV-32', 'TV-85-SMRT', 'TV-55-SMRT-HI', 'NON', 'AC-HOT/COLD-4HP', 'TV Supplies', 'TOASTER', 'GAS HEATER', 'TV-50-SMRT', 'BLENDER', 'SDA COMPLEMENTARY', 'Protection', 'AIR PURIFIER', 'TV-85-SMRT-HI', 'AC-HOT/COLD-7HP', 'Network', 'AC-HOT/COLD-2.25HP', 'WASHING M', 'Cross Bag'], 'sub_category_supplier': ['MOBILE-SAMSUNG', 'AC-HOT/COLD-1.5HP-AMERICOOL', 'MIXER-MEDIA TECH', 'ELE HEATER-ZANUSSI', 'TV-50-SMRT-TORNADO', 'H.BLENDER-MEDIA TECH', 'FAN-SONAI', 'MICROWAVE-ZANUSSI', 'COFFEE GRINDER-ARIETE', 'WARMER-TORNADO', 'CHOPPER-MIENTA', 'DEEP FREEZER-ELECTROSTAR', 'AC-HOT/COLD-3HP-MIDEA', 'TV-32-SMRT-TORNADO', 'M.MINCER-SMART', 'GIFT-BOSCH', 'H.MIXER-MEDIA TECH', 'H.MIXER-TORNADO', 'OVEN-ARISTON', 'FAN-PANASONIC', 'WARMER-SHTEBEL', 'AUDIO-MEDIA TECH', 'TV-50-SMRT-PLUTO', 'AC-COLD-1.5HP-AMERICOOL', 'TV-ACCESSORY-ETI', 'TABLET-TCL', 'AUDIO-ORAIMO', 'AC-HOT/COLD-2.25HP-PREMIUM', 'TV-50-SMRT-SHARP', 'TV-50-SMRT-UNION AIRE', 'TV-ACCESSORY-ICONZ', 'VC-ULTRA', 'LAM-BLACK AND DECAR', 'VC-TOSHIBA', 'HAIR DRYER-BABYLISS', 'STRAIGHTNERS-BRAUN', 'COMPLEMENTARY-HP', 'BLENDER-MOULINEX', 'HOOD-ARISTON', 'AC-COLD-2.25HP-MIDEA', 'H.BLENDER-G.TEC', 'COMPLEMENTARY-DELL', 'COMPLEMENTARY-SONY', 'AUDIO-LG', 'H.MIXER-BOSCH', 'AC-HOT/COLD-4HP-CARRIERE', 'BMOBILE ACCESSORIES-HP', 'VC-FRESH', 'KETTLE-SMART', 'WASHING M-BEKO', 'FILTER ASS-SEASONS', 'HOOD-SONAI', 'CAPPUCCINO MAKER-ARIETE', 'TV-65-SMRT-SAMSUNG', 'COMPLEMENTARY-HAVIT', 'DEEP FREEZER-WHITE WHALE', 'TV-32-SMRT-CAIXUN', 'MASHER-KENWOOD', 'ELE HEATER-KIRIAZI', 'TV-75-SMRT-SAMSUNG', 'WASHING M-WHITE POINT', 'F.PROC-KENWOOD', 'TV-43-ULTRA', 'FUN LINE-ARIETE', 'GRILL-FRESH', 'H.BLENDER-TORNADO', 'VC-LG', 'AIR PURIFIER-SHARP', 'VC-PANASONIC', 'AC-HOT/COLD-1.5HP-HISENSE', 'MICROWAVE-LG', 'TV-65-SMRT-HI-SAMSUNG', 'COMPLEMENTARY-XIAOMI', 'F.PROC-SONAI', 'ELE HEATER-OLYMPIC', 'RECEIVER-SKYWORTH ZAPPER', 'FRAYER-DELONGHI', 'DEEP FREEZER-KIRIAZI', 'AIR COOLER-HOME TECH', 'TV-86-SMRT-LG', 'GIFT-INDESIT', 'AC ACCESSORY-PREMIUM', 'TV-50-SMRT-SAMSUNG', 'HOBS-GLEMGAS', 'FRAYER-TEFAL', 'H.MIXER-ROVO', 'HOBS-FRESH', 'MICROWAVE-FRESH', 'HOOD-ELBA', 'BMOBILE ACCESSORIES', 'D WASHER-INDESIT', 'AUDIO-SAMSUNG', 'WASHING M-LG', 'HOOD-FRANKE', 'LAPTOP-MSI', 'TV-50-SMRT-ULTRA', 'GRILL-MEDIA TECH', 'ELE HEATER-ARISTON', 'WD-WHITE POINT', 'F.PROC-ARIETE', 'TV-ACCESSORY-NOUR TECH', 'TV-43-SMRT-LG', 'AC-COLD-1.5HP-MIDEA', 'ELE HEATER-WHITE WHALE', 'COMPLEMENTARY-BENQ', 'TV-55-SMRT-SAMSUNG', 'AUDIO-F&D', 'ELE HEATER-UNION AIRE', 'FRAYER-HOME TECH', 'MIXER-UNION AIRE', 'CHOPPER-BLACK AND DECAR', 'AC-COLD-3HP-CARRIERE', 'E.HOT PLATE-FRESH', 'TV-43-SMRT-TORNADO', 'VC-TORNADO', 'AC-HOT/COLD-6HP-CARRIERE', 'MICROWAVE-ARISTON', 'MICROWAVE-BLACK AND DECAR', 'KETTLE-MEDIA TECH', 'TV-ACCESSORY-TRUMAN', 'HOBS-ARISTON', 'HOBS-ELBA', 'MOBILE-XIAOMI', 'F.PROC-MOULINEX', 'FRIDGE-WHITE WHALE', 'COFFEE M-MODEX', 'AIR COOLER-FRESH', 'FUN LINE-SOLAC', 'CHOPPER-MEDIA TECH', 'AC-HOT/COLD-2.25HP-HISENSE', 'COFFEE M-TORNADO', 'DEEP FREEZER-ARISTON', 'E.HOT PLATE-SMART', 'GAS HEATER-PANASONIC', 'TV-75-SMRT-HI-LG', 'BLENDER-FRESH', 'HOOD-BOSCH', 'SHAVING_TRI-REMINGTON', 'IRON-MEDIA TECH', 'AC-HOT/COLD-2.25HP-CARRIERE', 'AC-HOT/COLD-4HP-SHARP', 'AC-COLD-3HP-CRAFT', 'DEEP FREEZER-SHARP', 'WASHING M-HAIER', 'COFFEE M-BOSCH', 'WD-SPEED', 'TV-43-TORNADO', 'MINCER-BOSCH', 'VC-MODEX', 'AC-HOT/COLD-5HP-CARRIERE', 'BMOBILE ACCESSORIES-STRONG', 'GAS HEATER-PREMIUM', 'TV-55-SMRT-SHARP', 'COMPLEMENTARY-CANON', 'FRIDGE-ZANUSSI', 'F.PROC-G.TEC', 'CHOPPER-MOULINEX', 'FRAYER-MODEX', 'TV-ACCESSORY-SYINIX', 'MICROWAVE-SMART', 'WASHING M-FRESH', 'WASHING M-SAMSUNG', 'E.HOT PLATE-MIENTA', 'KETTLE-BLACK AND WHITE', 'CHOPPER-KENWOOD', 'H.BLENDER-BOSCH', 'WARMER-AKWRJ', 'FUN LINE-HOME TECH', 'VC-SMART', 'AC ACCESSORY-ZANUSSI', 'AC-HOT/COLD-2.25HP-ULTRA', 'WARMER-ULTRA', 'RECIEVER-TIGER', 'GAS HEATER-ATLANTIC', 'KETTLE-ARION', 'TV-50-SMRT-HI-LG', 'AUDIO-SONY', 'WASHING M-TOSHIBA', 'FRAYER-MIELE', 'TV-55-SMRT-ULTRA', 'AIR COOLER-SONAI', 'AC-HOT/COLD-2.25HP-UNION AIRE', 'HOBS-FRANKE', 'THERMAL VESSEL-WACACO', 'M.MINCER-MODEX', 'TV-ACCESSORY-FALCON', 'FAN-ARION', 'BLENDER-KENWOOD', 'MOBILE-NOKIA', 'ELE HEATER-CLAGE', 'D WASHER-ZANUSSI', 'HOOD-GORENJE', 'GRILL-SOLAC', 'BLENDER-BLACK AND DECAR', 'FAN-FRESH', 'COOKER-BEKO', 'SCALE-SOLAC', 'TV-43-LG', 'GRILL-TOUCH', 'GAS HEATER-ARION', 'OVEN-NARDI', 'D WASHER-FRESH', 'VC-BLACK AND DECAR', 'TV-43-SMRT-PREMIUM', 'WASHER DRY ASS-MIELE', 'AC-COLD-3HP-MIDEA', 'FILTER 7 STAGES-SEASONS', 'BMOBILE ACCESSORIES-DAHUA', 'GRILL-TORNADO', 'AC ACCESSORY-SHARP', 'WALL HOOD-OLYMPIC', 'FRIDGE-HAIER', 'KETTLE-ZAHRAN', 'MINCER-WHITE WHALE', 'F.PROC-ULTRA', 'AIR FRYER-TORNADO', 'FAN-NIKAI', 'JUICER-BRAUN', 'WD-WHITE WHALE', 'GIFT-ARISTON', 'HOBS-BOSCH', 'MDA ASS-INDESIT', 'AC ACCESSORY-DAIKIN', 'KITCHEN M-MIENTA', 'COOKING APPLIANCES-ARIETE', 'CLINER M-KARCHER', 'GRILL-HOME TECH', 'FUN LINE-MEDIA TECH', 'HAIR DRYER-REMINGTON', 'COMPLEMENTARY-LENOVO', 'VC-SAMSUNG', 'TV-55-SMRT-HI-LG', 'H.BLENDER-SMART', 'HOBS-BRANDT', 'VC-ROVO', 'OVEN-BOSCH', 'BLENDER-SENCOR', 'COMPLEMENTARY-EPSON', 'TV-60-SMRT-TORNADO', 'WD-BERGEN', 'AC-HOT/COLD-2.25HP-LG', 'GAS HEATER-LONGLIFE', 'COFFEE M-BRAUN', 'JUICER-MEDIA TECH', 'DEEP FREEZER-TORNADO', 'TV-43-SMRT-SHARP', '0', 'WASHING M-ZANUSSI', 'THERMAL VESSEL-TIGER', 'BLENDER-MODEX', 'DRYER-ARISTON', 'TV-43-NIKAI', 'MOBILE-OPPO', 'TV-70-SMRT-LG', 'HOBS-NARDI', 'AC-HOT/COLD-3HP-UNION AIRE', 'IRON-HOME TECH', 'KETTLE-PANASONIC', 'F.PROC-BLACK AND DECAR', 'AC-HOT/COLD-3HP-BEKO', 'FRAYER-FRESH', 'TV-55-SMRT-PLUTO', 'COFFEE M-SOLAC', 'AC-COLD-2.25HP-PREMIUM', 'VC-KENWOOD', 'DRYER-HOME TECH', 'HOBS-SMART', 'H.MIXER-SONAI', 'DEEP FREEZER-TOSHIBA Midea', 'H.BLENDER-TOUCH', 'HOOD-FRESH', 'KETTLE-SOLAC', 'BUNDLE- B-IN-INDESIT', 'AC-COLD-3HP-UNION AIRE', 'H.BLENDER-SENCOR', 'FILTER ASS-PHILIPS', 'H.MIXER-MIENTA', 'TOASTER-TORNADO', 'AC-HOT/COLD-2.25HP-TORNADO', 'KETTLE-HOUSECOM', 'HOBS-KLASS', 'KITCHEN M-FRESH', 'WASHING M-BOSCH', 'FRIDGE-SAMSUNG', 'COFFEE M-BIALETTI', 'TV-32-LG', 'F.PROC-BRAUN', 'TV-ACCESSORY-MEDIA TECH', 'AC-HOT/COLD-1.5HP-TORNADO', 'VC-MIELE', 'TV-43-HAIER', 'BMOBILE ACCESSORIES-LAVVENTO', 'SPORT MACHINE-KHATER', 'AC-COLD-2.25HP-ULTRA', 'TV-ACCESSORY-KEENDEX', 'M.MINCER-MOULINEX', 'COFFEE M-BEKO', 'HOBS-ICOOK', 'OVEN-GORENJE', 'FILTER 5 STAGES-SEASONS', 'GAS HEATER-BOSCH', 'WASHING M-UNION AIRE', 'IRON-SOLAC', 'ELE HEATER-UNIVERSAL', 'AUDIO-DOB', 'IRON-KENWOOD', 'TV-65-SMRT-TCL', 'IRON-BRAUN', 'VC-HOOVER', 'MOBILE-VIVO', 'VC ACCESSORIES-MIELE', 'BLENDER-ARIETE', 'TV-55-SMRT-TOSHIBA', 'TV-40-SMRT-UNION AIRE', 'WASHING M-PREMIUM', 'H.BLENDER-MIENTA', 'KITCHEN M-BOSCH', 'VC-MIENTA', 'AC-HOT/COLD-1.5HP-HAIER', 'OVEN-ELBA', 'KITCHEN M-SARY', 'AC-COLD-2.25HP-GENERAL ELECTRIC', 'STRAIGHTNERS-MIENTA', 'FRIDGE-TOSHIBA', 'SHAVING_TRI-BABYLISS', 'TV-70-SMRT-SAMSUNG', 'AC-HOT/COLD-2.25HP-SHARP', 'AC-COLD-1.5HP-LG', 'KITCHEN M-G.TEC', 'KETTLE-MODEX', 'IRON-BLACK AND WHITE', 'GIFT-INFINX', 'WALL HOOD-TORNADO', 'OVEN-FRANKE', 'JUICER-SONAI', 'HOBS-ECOMATIC', 'IRON-PANASONIC', 'TV-55-SMRT-SONY', 'TOOLS-MPT PT', 'TV-32-PLUTO', 'F.PROC-BENEX', 'FRIDGE-LG', 'WASHING M-Toshiba', 'STRAIGHTNERS-RUSH BRUSH', 'MINCER-BLACK AND DECAR', 'STRAIGHTNERS-TORNADO', 'BMOBILE ACCESSORIES-OSN', 'VC-HITACHI', 'SHAVING_TRI-PHILIPS', 'TV-FRAME-SAMSUNG', 'AC-HOT/COLD-3HP-TORNADO', 'TV-43-SMRT-PLUTO', 'COFFEE M-HOME TECH', 'VC-TEFAL', 'COMPLEMENTARY-INTEL', 'FRIDGE-BEKO', 'GRILL-ZADA', 'BLENDER-TORNADO', 'DEEP FREEZER-BEKO', 'AC-COLD-1.5HP-TORNADO', 'TV-32-SMRT-TOSHIBA', 'WD-ULTRA', 'AC-COLD-3HP-ULTRA', 'AC-COLD-1.5HP-PREMIUM', 'AC-HOT/COLD-1.5HP-UNION AIRE', 'FILTER 6 STAGES-SEASONS', 'RECEIVER-TRUMAN', 'TV-32-ATA', 'LAM-PHILIPS', 'RECEIVER-MUTECH', 'COFFEE M-ZADA', 'STRAIGHTNERS-PHILIPS', 'AC-HOT/COLD-3HP-SHARP', 'TV-75-SMRT-HI-SHARP', 'JUICER-MODEX', 'WASHING M-KIRIAZI', 'AIR FRYER-KENWOOD', 'FRIDGE-KIRIAZI', 'FRAYER-PHILIPS', 'GIFT-LG', 'CHOPPER-ULTRA', 'HAIR DRYER-PHILIPS', 'FRIDGE-ARISTON', 'OVEN-HOME TECH', 'ELE HEATER-TORNADO', 'F.PROC-HOME TECH', 'VC-BISSELL', 'FAN-MIENTA', 'BLENDER-BOSCH', 'AC-HOT/COLD-5HP-SHARP', 'GIFT-SAMSUNG', 'VC-BLACK AND WHITE', 'DEEP FREEZER-FRESH', 'GIFT-FRESH', 'TV-32-SMRT-PREMIUM', 'WARMER-BLACK AND DECAR', 'BLENDER-ULTRA', 'AC-HOT/COLD-1.5HP-SHARP', 'BMOBILE ACCESSORIES-LOGITECH', 'KETTLE-ARIETE', 'FRIDGE-ULTRA', 'WASHING M-ARISTON', 'HOOD-PREMIER', 'COFFEE M-OKKA', 'HOOD-INDESIT', 'IRON-SMART', 'AIR FRYER-SOLAC', 'HAIR DRYER-SOLAC', 'AC-COLD-2.25HP-FRESH', 'KETTLE-SONAI', 'AC-COLD-2.25HP-TORNADO', 'TV-50-SMRT-LG', 'MICROWAVE-HOME TECH', 'DEEP FREEZER-PANASONIC', 'DEEP FREEZER-INDESIT', 'TV-ACCESSORY-SCHNEIDER', 'TV-85-SMRT-HI-LG', 'MIXER-BLACK AND WHITE', 'MICROWAVE-SHARP', 'TV-86-SMRT-UNION AIRE', 'FAN-ULTRA', 'F.PROC-MODEX', 'GRILL-KENWOOD', 'OVEN-ZANUSSI', 'H.BLENDER-SARY', 'COFFEE M-NESPRESSO', 'BLENDER-MEDIA TECH', 'FUN LINE-MIENTA', 'TABLET-APPLE', 'F.PROC-PANASONIC', 'ESPRESSO MACH-ARIETE', 'JUICER-KENWOOD', 'COFFEE M-KENWOOD', 'TABLET-SAMSUNG', 'WASHING M-MIELE', 'WARMER-TOUCH', 'IRON-TORNADO', 'TOOLS-SNDWAY', 'BLENDER-SMART', 'TOASTER-BLACK AND DECAR', 'COOKER-LA GERMANYA', 'MOSQ.KILL-HOME TECH', 'R.COOKER-BLACK AND DECAR', 'FRIDGE-ELECTROSTAR', 'HOBS-MIELE', 'COMPLEMENTARY-SAMSUNG', 'MICROWAVE-TORNADO', 'LAPTOP-HUAWEI', 'TOASTER-MIENTA', 'TV-32-SMRT-LG', 'D WASHER-BEKO', 'TV-ACCESSORY-HISENSE', 'HOOD-BEKO', 'TV-65-SMRT-TOSHIBA', 'WASHING M-SHARP', 'WASHING M-INDESIT', 'WD-KOLDAIR', 'TV-43-SMRT-HAIER', 'OVEN-MIELE', 'MICROWAVE-SAMSUNG', 'TV-ACCESSORY-ORIGINAL', 'HOBS-TORNADO', 'WARMER-FRESH', 'BLENDER-BLACK AND WHITE', 'LAPTOP-LENOVO', 'AC-COLD-1.5HP-HAIER', 'WALL HOOD-TOSHIBA', 'FUN LINE-TORNADO', 'BMOBILE ACCESSORIES-NI', 'AUDIO-FIRST', 'TANK-SEASONS', 'HOOD-PANASONIC', 'KETTLE-ZADA', 'FRIDGE-WHITE POINT', 'MICROWAVE-DAEWOO', 'TV-55-SMRT-TORNADO', 'HOOD-MIELE', 'GAS HEATER-ARISTON', 'MOBILE-HUAWEI', 'TV-32-TOSHIBA', 'HOOD-HOOVER', 'F.PROC-BLACK AND WHITE', 'JUICER-BOSCH', 'AC ACCESSORY-UNION AIRE', 'CHOPPER-ARIETE', 'JUICER-TORNADO', 'TV-43-CONTEX', 'E.HOT PLATE-HOME TECH', 'FAN-TOUCH', 'FILTER 3 STAGES-SEASONS', 'H.MIXER-PANASONIC', 'TV-65-SMRT-SHARP', 'WASHING M-FAGOR', 'AC-COLD-3HP-PREMIUM', 'KITCHEN M-ARIETE', 'FAN-KENWOOD', 'TV-75-SMRT-HI-SAMSUNG', 'MASHER-MIENTA', 'TV-32-TCL', 'KETTLE-BRAUN', 'AC ACCESSORY-HAIER', 'OVEN-FAGOR', 'AIR COOLER-TORNADO', 'FAN-BLACK AND WHITE', 'FRIDGE-MIELE', 'TV-32-PREMIUM', 'OVEN-TORNADO', 'TV-40-CONTEX', 'LAPTOP-HP', 'AC ACCESSORY-LG', 'H.MIXER-BRAUN', 'TOOLS-HITACHI', 'WARMER-DELONGHI', 'M.MINCER-TORNADO', 'AIR STYLER-RUSH BRUSH', 'AC-HOT/COLD-2.25HP-BEKO', 'BLENDER-HOME TECH', 'TV-85-SMRT-SAMSUNG', 'TV-55-SMRT-HI-SAMSUNG', 'AC-HOT/COLD-4HP-LG', 'KITCHEN M-MOULINEX', 'TABLET-REALME', 'M.MINCER-BOSCH', 'VC-SOLAC', 'AC-HOT/COLD-1.5HP-MIDEA', 'R.COOKER-HOME TECH', 'NON', 'FUN LINE-BLACK AND DECAR', 'COFFEE M-DELONGHI', 'IRON-MODEX', 'TV-50-SMRT-PREMIUM', 'SHAVING_TRI-TORNADO', 'TV-55-SMRT-PREMIUM', 'COFFEE M-MEDIA TECH', 'F.PROC-MIENTA', 'TV-43-UNION AIRE', 'COOKER-UNION AIRE', 'TV-43-SMRT-UNION AIRE', 'TV-50-SMRT-SONY', 'TV-85-SMRT-HI-SAMSUNG', 'COFFEE M-BLACK AND DECAR', 'F.PROC-SMART', 'LAPTOP-VAIO', 'TV-43-SMRT-SONY', 'KETTLE-BOSCH', 'KETTLE-HOME TECH', 'TV-32-SMRT-SONY', 'KETTLE-FRESH', 'TV-43-SMRT-SAMSUNG', 'KETTLE-KENWOOD', 'FAN-SMART', 'JUICER-SOLAC', 'BLENDER-TOUCH', 'GIFT-NESTLE', 'AC-HOT/COLD-1.5HP-BEKO', 'TV-50-SMRT-TOSHIBA', 'TV-32-TORNADO', 'TV-ACCESSORY-FLAT', 'VC-ARIETE', 'HOBS-ZANUSSI', 'BLENDER-PANASONIC', 'COOKER-BOSCH', 'OVEN-TOUCH', 'MOBILE-HONOR', 'H.MIXER-TOUCH', 'HOBS-HOOVER', 'WARMER-MEDIA TECH', 'DEEP FREEZER-UNION AIRE', 'DEEP FREEZER-MIELE', 'ELE HEATER-TOSHIBA', 'AIR PURIFIER-LG', 'OVEN-INDESIT', 'GRILL-BOSCH', 'KETTLE-TORNADO', 'MASHER-BLACK AND WHITE', 'TOASTER-BRAUN', 'TOASTER-PANASONIC', 'BMOBILE ACCESSORIES-EZVIZ', 'HOBS-GORENJE', 'DEEP FREEZER-PASSAP', 'AC-HOT/COLD-3HP-LG', 'LAPTOP-MICROSOFT', 'H.MIXER-FRESH', 'H.BLENDER-BRAUN', 'KETTLE-SENCOR', 'KITCHEN M-HOME TECH', 'FAN-UNION AIRE', 'HOBS-BAUMATIC', 'STRAIGHTNERS-REMINGTON', 'H.BLENDER-SEM', 'COOKER-KIRIAZI', 'SHAVING_TRI-HAPILLINE', 'JUICER-MIENTA', 'GRILL-BLACK AND DECAR', 'AC-COLD-2.25HP-SHARP', 'AC-COLD-1.5HP-CRAFT', 'M.MINCER-BLACK AND WHITE', 'KITCHEN M-SMART', 'AC-COLD-2.25HP-UNION AIRE', 'WARMER-VEITO', 'SHAVING_TRI-RUSH BRUSH', 'CHOPPER-FRESH', 'LAPTOP-APPLE', 'CHOPPER-TOUCH', 'H.BLENDER-MOULINEX', 'IRON-PHILIPS', 'HOOD-TORNADO', 'FUN LINE-SONAI', 'TV-43-SMRT-FRESH', 'M.MINCER-BRAUN', 'AUDIO-PHILIPS', 'TOASTER-HOME TECH', 'COOKER-UNIVERSAL', 'BMOBILE ACCESSORIES-STEEL', 'GRILL-TEFAL', 'THERMAL VESSEL-SEASONS', 'H.BLENDER-BLACK AND DECAR', 'ELE HEATER-ATLANTIC', 'IRON-BLACK AND DECAR', 'TV-ACCESSORY-ILOOK', 'GAS HEATER-ZANUSSI', 'GAS HEATER-WHITE WHALE', 'AC-HOT/COLD-7HP-CARRIERE', 'GRILL-MODEX', 'TV-32-SAMSUNG', 'GAS HEATER-FRESH', 'BMOBILE ACCESSORIES-SONY', 'AC-COLD-2.25HP-LG', 'CHOPPER-BOSCH', 'TV-50-ULTRA', 'IRON-TOUCH', 'KITCHEN M-TOUCH', 'AC-COLD-2.25HP-CRAFT', 'KITCHEN M-KENWOOD', 'OVEN-SIMFER', 'ELE HEATER-SHTEBEL', 'AC-HOT/COLD-1.5HP-LG', 'TV-32-SMRT-FRESH', 'AIR PURIFIER-DAIKIN', 'AC-COLD-1.5HP-CARRIERE', 'R.COOKER-MEDIA TECH', 'WD-PASSAP', 'COOKER-PREMIUM', 'M.MINCER-PANASONIC', 'AC-HOT/COLD-1.5HP-PREMIUM', 'TV-50-SMRT-TCL', 'AC-HOT/COLD-2.25HP-MIDEA', 'TV-55-SMRT-TCL', 'OVEN-HOOVER', 'D WASHER-BeKO', 'TV-32-SMRT-SAMSUNG', 'VC-BOSCH', 'TV-ACCESSORY-FORA', 'TOOLS-CLABER', 'COOKER-ZANUSSI', 'F.PROC-UNION AIRE', 'COOKER-WHITE WHALE', 'OVEN-SHARP', 'AC-COLD-1.5HP-SHARP', 'CURL IRONS-BABYLISS', 'BLENDER-SARY', 'AC-HOT/COLD-1.5HP-CARRIERE', 'GAS HEATER-UNIVERSAL', 'CHOPPER-SONAI', 'HAIR DRYER-RUSH BRUSH', 'GAS HEATER-UNION AIRE', 'F.PROC-BOSCH', 'FUN LINE-ZAHRAN', 'STRAIGHTNERS-BABYLISS', 'AC-COLD-1.5HP-ULTRA', 'BLENDER-BRAUN', 'ALEXA ECHO DOT-ALEXA', 'TV-ACCESSORY-FRESH', 'AC-HOT/COLD-3HP-ULTRA', 'GAS HEATER-OLYMPIC', 'COFFEE M-SMART', 'TV-75-SMRT-UNION AIRE', 'TV-65-SMRT-LG', 'TV-43-TOSHIBA', 'MIXER-MODEX', 'WASHING M-HOOVER', 'MOBILE-APPLE', 'R.COOKER-MODEX', 'AUDIO-AVANTREE', 'LAPTOP-ASUS', 'AC-HOT/COLD-3HP-PREMIUM', 'AC-COLD-3HP-FRESH', 'FRIDGE-SHARP', 'FRIDGE-BOSCH', 'FAN-TORNADO', 'IRON-MIENTA', 'AC-HOT/COLD-1.5HP-FRESH', 'GRILL-MIENTA', 'CURL IRONS-RUSH BRUSH', 'TV-32-SONY', 'TV-ACCESSORY-ITEL', 'CHOPPER-TORNADO', 'WARMER-MIENTA', 'TV-75-SMRT-TOSHIBA', 'HOOD-ICOOK', 'AC-COLD-3HP-TORNADO', 'IRON-ARIETE', 'BLENDER-SONAI', 'KITCHEN M-BLACK AND WHITE', 'DEEP FREEZER-ALASKA', 'MOBILE-REALME', 'AC-HOT/COLD-1.5HP-ULTRA', 'TV-50-SMRT-HAIER', 'COOKER-WHITE POINT', 'TV-75-SMRT-LG', 'TV-ACCESSORY-ELIOS', 'H.BLENDER-BLACK AND WHITE', 'E.HOT PLATE-TOUCH', 'D WASHER-BOSCH', 'AC ACCESSORY-CRAFT', 'TV-55-SMRT-LG', 'OVEN-ULTRA', 'TOOLS-BOSCH', 'AC-COLD-7HP-CARRIERE', 'AC-HOT/COLD-2.25HP-GENERAL ELECTRIC', 'KETTLE-TOUCH', 'FRAYER-MIENTA', 'MIXER-ULTRA', 'FRIDGE-IDEAL', 'M.MINCER-KENWOOD', 'TV-43-SMRT-ULTRA', 'ELE HEATER-VEITO', 'F.PROC-TORNADO', 'WALL HOOD-FRESH', 'M.MINCER-SONAI', 'COOKER-ROYAL', 'TABLET-LENOVO', 'COFFEE M-TEFAL', 'FRIDGE-TORNADO', 'AC-HOT/COLD-2.25HP-FRESH', 'WARMER-HELLER', 'COFFEE M-PHILIPS', 'BLENDER-G.TEC', 'FAN-BLACK AND DECAR', 'SPORT MACHINE-FUTURE', 'MIXER-TOUCH', 'HOBS-BEKO', 'OVEN-BRANDT', 'MICROWAVE-HOOVER', 'TV-32-UNION AIRE', 'VC-GROUHY', 'FRAYER-ARISTON', 'HOOD ASS-INDESIT', 'AC-COLD-2.25HP-CARRIERE', 'H.BLENDER-HOME TECH', 'AC-HOT/COLD-3HP-GENERAL ELECTRIC', 'AC-HOT/COLD-3HP-FRESH', 'TV-43-SMRT-TOSHIBA', 'H.BLENDER-KENWOOD', 'H.MIXER-SMART', 'AC-HOT/COLD-3HP-CARRIERE', 'GAS HEATER-KIRIAZI', 'D WASHER-MIELE', 'TV-43-CAIXUN', 'ELE HEATER-BOMAN', 'THERMAL VESSEL-TANK', 'WD-FRESH', 'FRAYER-BERGEN', 'R.COOKER-TEFAL', 'WD-TORNADO', 'RECEIVER-ETI', 'TV-40-SMRT-VIEW', 'TOOLS-MPT HT', 'AC-HOT/COLD-5HP-FRESH', 'FRAYER-BLACK AND DECAR', 'TV-32-HAIER', 'BLENDER-MIENTA', 'TV-32-UG', 'BMOBILE ACCESSORIES-ORIGINAL', 'FRIDGE-UNION AIRE', 'H.MIXER-BLACK AND WHITE', 'AC-COLD-1.5HP-FRESH', 'JUICER-MOULINEX', 'TV-65-SMRT-UNION AIRE', 'COFFEE M-MIENTA', 'RECEIVER-GALAXI', 'HOOD-BeKO', 'FRIDGE-FRESH', 'FRIDGE-PASSAP', 'MOBILE-HOPE', 'MICROWAVE-KENWOOD', 'JUICER-HOME TECH', 'AIR STYLER-BABYLISS', 'TV-32-SARY', 'GAS HEATER-FERROLI', 'HOOD-ZANUSSI', 'AC-COLD-3HP-LG', 'AC-HOT/COLD-5HP-LG', 'HOBS-FAGOR', 'SHAVING_TRI-BRAUN', 'TABLET-HUAWEI', 'RECEIVER-DALY', 'IRON-ULTRA', 'MOBILE-INFINX', 'HOOD-TOUCH', 'TV-ACCESSORY-HAMA', 'D WASHER-LG', 'VC-DAEWOO', 'TV-32-FRESH', 'KITCHEN M-MODEX', 'IRON-TEFAL', 'LAPTOP-DELL', 'DEEP FREEZER-LG', 'D WASHER-WHITE POINT', 'TV-32-ULTRA', 'H.MIXER-KENWOOD', 'WASHING M-CANDY', 'HOBS-INDESIT', 'GAS HEATER-TORNADO', 'WASHER DRYER-LG', 'TV-32-SMRT-SHARP', 'MDA-ZANUSSI', 'BMOBILE ACCESSORIES-LDNIO', 'HAIR DRYER-ARZUM', 'HOOD-FAGOR', 'TOASTER-KENWOOD', 'MIXER-BLACK AND DECAR', 'WASHING M-TORNADO', 'TV-32-SMRT-NIKAI', 'AUDIO-TOSHIBA', 'H.MIXER-MOULINEX', 'COMPLEMENTARY-NIKON', 'AC-COLD-1.5HP-UNION AIRE', 'THERMAL VESSEL-TEFAL', 'ELE HEATER-FLYON', 'MINCER-HOME TECH', 'AC-HOT/COLD-4HP-FRESH', 'OVEN-KLASS', 'H.MIXER-MODEX', 'HAIR DRYER-TORNADO', 'TV-ACCESSORY-LG', 'TV-65-SMRT-TORNADO', 'TV-40-SMRT-SAMSUNG', 'CHOPPER-SMART', 'AC ACCESSORY-CARRIERE', 'BMOBILE ACCESSORIES-TOSHIBA', 'TV-32-SMRT-HAIER', 'OVEN-FRESH', 'F.PROC-GROUHY', 'GAS HEATER-WHITE POINT', 'DEEP FREEZER-TOSHIBA', 'TOASTER-ARIETE', 'GIFT-UNIVERSAL', 'KETTLE-BLACK AND DECAR', 'AC ACCESSORY-FRESH', 'CHOPPER-ROVO', 'FAN-TEFAL', 'M.MINCER-TOUCH', 'MOBILE-LAVA', 'GAS HEATER-PASSAP', 'COFFEE M-WHITE WHALE', 'FRIDGE-INDESIT', 'ELE HEATER-FRESH', 'DEEP FREEZER-WHITE POINT', 'COOKER-FRESH', 'TV-ACCESSORY-HP', 'OVEN-BEKO', 'AC-HOT/COLD-1.5HP-ZANUSSI', 'COFFEE M-SONAI', 'OVEN-MIENTA', 'BMOBILE ACCESSORIES-MUSIC HERO', 'FAN-UNIVERSAL', 'KETTLE-MIENTA', 'D WASHER-ARISTON', 'TV-65-SMRT-HI-LG']} the_received_subfilter
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
447.892156513 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('3806.0721494184829731')), ('initial_average_retail_price', Decimal('13595.673961982527')), ('proposed_sellthru_percent', Decimal('48.4578213292671989')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('32.5429634944838102')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.54296349448381), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 12823170355.339882), ('budget_cost', 5632039943.457241), ('deficit', Decimal('12823170355.8012')), ('Original_BudgetAmount', Decimal('12823170355.8012')), ('budget_percent', Decimal('96.8342')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 2269478.0), ('ACT_FCT', Decimal('1548844022.7300')), ('Original_BudgetCostofGoods', Decimal('5632039943.4560')), ('PO', Decimal('41168484782.9567')), ('COSTPRICE', 4844632262.491926), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('1548844022.7300')), ('stock_on_hand_qty', Decimal('3260464')), ('net_sales_ly', Decimal('8385795835.5800')), ('net_sales_lly', Decimal('1006191575.1300')), ('gross_sales_ly', Decimal('8709818176.7930')), ('total_sku_count', Decimal('517043')), ('ly_customer_disc', Decimal('324022341.2130')), ('SupplyCost', Decimal('5350437946.2848')), ('SALESQTY', 2143970.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('87.6221')), ('budget_qty_act_fct_percent', Decimal('204606554.3763')), ('budget_vs_py_qty_percent', Decimal('130981174.2119')), ('budget_vs_ppy_qty_percent', Decimal('215837740.0216')), ('QTY_Buy_By_SKU', Decimal('2269478.0000')), ('total_sku_count_ty', Decimal('117075431064')), ('total_sku_count_lly', Decimal('36403')), ('total_sku_count_ly', Decimal('258058')), ('quantity_mix_percent', Decimal('101.6067')), ('quantity_act_forecast', Decimal('2527452.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('1506474.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('136827300.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.1049')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('5632039943.4560')), ('budget_vs_py_cost_percent', Decimal('324268755712.7000')), ('budget_vs_ppy_cost_percent', Decimal('34949252865.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('1027613330.2800')), ('cost_of_goods_ly', Decimal('3521042791.3620')), ('cost_act_forecast', Decimal('6659653273.7360')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('732010389368.2682')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('526920020.1100')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('1.7850')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('24801.2361')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('24801.2361')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
448.089789402 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 3806.0721 ┆ 13595.673 ┆ … ┆ 0.0       ┆ 24801.236 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆ 49        ┆ 962       ┆   ┆           ┆ 1         ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 58.011823         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 3.2402e8   ┆ 8.3858e9   ┆ 1.2823e10  ┆ 58.275233 ┆ 1.3319e10 ┆ 48.457821 ┆ 2.7485e10 ┆ 3.720196  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76978774FC70>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76978774FBB0>, <Expr ['col("SalesActualsByForecast").…'] at 0x76978774FE50>, <Expr ['col("initial_average_retail_pr…'] at 0x76978774E440>, <Expr ['col("proposed_sellthru_percent…'] at 0x76978774FFD0>, <Expr ['col("retail_value_including_ma…'] at 0x76978774F790>, <Expr ['col("budget_gross_margin_perce…'] at 0x76978774FA90>, <Expr ['col("Logistic%").mean()'] at 0x76978774F880>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76978774E410>, <Expr ['col("MarkdownValue").mean()'] at 0x76978774FA60>, <Expr ['col("markdown_percent").mean()'] at 0x76978774D7E0>, <Expr ['col("DisplayItemValue").mean()'] at 0x76978774F6D0>, <Expr ['col("budget_amount").sum()'] at 0x76978774E500>, <Expr ['col("budget_cost").sum()'] at 0x76978774E4D0>, <Expr ['col("deficit").sum()'] at 0x76978774FE80>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76978774E3E0>, <Expr ['col("budget_percent").sum()'] at 0x76978774E710>, <Expr ['col("relative_budget_percent")…'] at 0x76978774F820>, <Expr ['col("History_Net_Sales").sum()'] at 0x76978774E7D0>, <Expr ['col("budget_qty").sum()'] at 0x76978774E770>, <Expr ['col("ACT_FCT").sum()'] at 0x76978774E6E0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76978774F700>, <Expr ['col("PO").sum()'] at 0x76978774EA10>, <Expr ['col("COSTPRICE").sum()'] at 0x76978774E860>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76978774E740>, <Expr ['col("sales_actual").sum()'] at 0x76978774EAA0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76978774F730>, <Expr ['col("net_sales_ly").sum()'] at 0x76978774EBF0>, <Expr ['col("net_sales_lly").sum()'] at 0x76978774EAD0>, <Expr ['col("gross_sales_ly").sum()'] at 0x76978774EC50>, <Expr ['col("total_sku_count").sum()'] at 0x76978774E6B0>, <Expr ['col("ly_customer_disc").sum()'] at 0x76978774EC20>, <Expr ['col("SupplyCost").sum()'] at 0x76978774ECE0>, <Expr ['col("SALESQTY").sum()'] at 0x76978774FF70>, <Expr ['col("DisplayItemQty").sum()'] at 0x76978774ED10>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76978774ED70>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76978774E560>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76978774E8F0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76978774EFB0>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76978774EA70>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76978774F010>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76978774F670>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76978774F160>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76978774F040>, <Expr ['col("quantity_mix_percent").su…'] at 0x76978774EFE0>, <Expr ['col("quantity_act_forecast").s…'] at 0x76978774F070>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76978774F250>, <Expr ['col("sold_qty_ly").sum()'] at 0x76978774F0A0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76978774EDD0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76978774F1F0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76978774F3D0>, <Expr ['col("budget_cost_percent").sum…'] at 0x76978774F370>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76978774EE90>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76978774E800>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76978774F550>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76978774F520>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76978774F400>, <Expr ['col("cost_mix_percent").sum()'] at 0x76978774F430>, <Expr ['col("cost_actuals").sum()'] at 0x76978774FA30>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76978774F4C0>, <Expr ['col("cost_act_forecast").sum()'] at 0x76978774ECB0>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76978774E320>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76978774F5B0>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76978774FF40>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76978774F2B0>, <Expr ['col("budget_margin_percent").s…'] at 0x76978774E1A0>, <Expr ['col("budget_margin_mix_percent…'] at 0x76978774E350>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76978774E0E0>, <Expr ['col("margin_actuals").sum()'] at 0x76978774F460>, <Expr ['col("margin_act_forecast").sum…'] at 0x76978774E200>, <Expr ['col("units_per_sku_total").sum…'] at 0x76978774DFC0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76978774F130>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76978774E290>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76978774DFF0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76978774E230>, <Expr ['col("initial_average_retail_pr…'] at 0x76978774EEF0>, <Expr ['col("initial_average_retail_pr…'] at 0x76978774DD80>, <Expr ['col("budget_per_sku").sum()'] at 0x76978774E1D0>, <Expr ['col("budget_qty_ty").sum()'] at 0x76978774F610>, <Expr ['col("Check_box").max()'] at 0x76978774DC60>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,3806.0721494185,13595.6739619825,48.4578213293,13318650302.8340950012,56.0791926849,5.0,56.0791926849,32402234121.3000030518,3.720196388,0.0,12823170355.339881897,5632039943.4572410583,12823170355.8012008667,12823170355.8012008667,100.0,100.0,0.0,2269478.0,1548844022.7300000191,5632039943.4560003281,41168484782.956703186,4844632262.4919261932,0.0,1548844022.7300000191,3260464.0,8385795835.5799999237,1006191575.1299999952,8709818176.7929992676,517043.0,324022341.2129999995,5350437946.2847995758,2143970.0,0.0,0.0,87.6221,204606554.3763000071,130981174.2118999958,215837740.021600008,2269478.0,117075431064.0,36403.0,258058.0,101.6067,2527452.0,0.0,1506474.0,136827300.0,0.0,0.0,0.1049,0.0,0.0,5632039943.4560003281,324268755712.700012207,34949252865.0,0.0,1027613330.2799999714,3521042791.3619999886,6659653273.736000061,0.0,0.0,0.0,0.0,732010389368.2681884766,0.0,0.0,526920020.1100000143,0.0,1.785,0.0,24801.2361,0.0,0.0,0.0,0.0,24801.2361,0.0,0.0,152.9153655391,1274.4263291693,18.4698513188,6001.9221366127,100.0,4254715.3331593554,58.2752330506,44328205508.7814025879,58.0118230828,4864753044.218000412,0.0,0.0,7191130411.8826408386,123959738.3730540276,44328205508.7814025879,18612605353.2655258179,44328205508.7814025879,13318650302.8340950012,12823170355.339881897,27485037373.7087402344,11468067790.1240730286,4621154.6461829171]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":3806.0721494185,"initial_average_retail_price":13595.6739619825,"proposed_sellthru_percent":48.4578213293,"retail_value_including_markdown":13318650302.8340950012,"budget_gross_margin_percent":56.0791926849,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":56.0791926849,"MarkdownValue":32402234121.3000030518,"markdown_percent":3.720196388,"DisplayItemValue":0.0,"budget_amount":12823170355.339881897,"budget_cost":5632039943.4572410583,"deficit":12823170355.8012008667,"Original_BudgetAmount":12823170355.8012008667,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":2269478.0,"ACT_FCT":1548844022.7300000191,"Original_BudgetCostofGoods":5632039943.4560003281,"PO":41168484782.956703186,"COSTPRICE":4844632262.4919261932,"Historical_Gross_Margin":0.0,"sales_actual":1548844022.0,"stock_on_hand_qty":3260464.0,"net_sales_ly":8385795835.5799999237,"net_sales_lly":1006191575.1299999952,"gross_sales_ly":8709818176.7929992676,"total_sku_count":517043.0,"ly_customer_disc":324022341.2129999995,"SupplyCost":5350437946.2847995758,"SALESQTY":2143970.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":87.6221,"budget_qty_act_fct_percent":204606554.3763000071,"budget_vs_py_qty_percent":130981174.2118999958,"budget_vs_ppy_qty_percent":215837740.021600008,"QTY_Buy_By_SKU":2269478.0,"total_sku_count_ty":117075431064.0,"total_sku_count_lly":36403.0,"total_sku_count_ly":258058.0,"quantity_mix_percent":101.6067,"quantity_act_forecast":2527452.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":1506474.0,"quantity_act_forecast_vs_ly_percent":136827300.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.1049,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":5632039943.4560003281,"budget_vs_py_cost_percent":324268755712.700012207,"budget_vs_ppy_cost_percent":34949252865.0,"cost_mix_percent":0.0,"cost_actuals":1027613330.2799999714,"cost_of_goods_ly":3521042791.3619999886,"cost_act_forecast":6659653273.736000061,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":732010389368.2681884766,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":526920020.1100000143,"margin_act_forecast":0.0,"units_per_sku_total":1.785,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":24801.2361,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":24801.2361,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":58.0118230828,"FirstMargin_percent":58.2752330506,"budget_vpy":152.9153655391,"budget_vppy":1274.4263291693,"StockatRetailPrice":44328205508.7814025879,"TYForecast":44328205508.7814025879,"LYvsACT_FCT_percent":100.0,"supply_retail_value":12823170355.339881897} } data_json
WebSocket connection closed unexpectedly
{'history_date_range': {'fro': '2023-01-01', 'to': '2023-01-05'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-05'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': True, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-01-01', to='2023-01-05') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-05') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
449.093487357 start_to_execute main the stored procedure
conn established
sp executed
449.128077037 end of main the stored procedure
conn established
sku wise calc executed
449.150861406 end of sku wise stored proc
we called the sku wise stored procedure_init
We are getting data from ra_and_stock
449.150981357 started to fetch data
conn established
<function getData.<locals>.<lambda> at 0x76aa723f7a30> dfafghaf
453.750880373 end of fetch data
(18941, 168) output data shape
111111111111111111111111111111111111111111111
processing...
we are calling main groupby process
conn established
sku wise calc executed
453.848102109 end of sku wise stored proc
conn established
[OrderedDict([('id', 239890), ('store', None), ('region', None), ('area', None), ('Channel', 'B.TECH X'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 239891), ('store', None), ('region', None), ('area', None), ('Channel', 'CALL CENTER'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 239892), ('store', None), ('region', None), ('area', None), ('Channel', 'MINI'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 239893), ('store', None), ('region', None), ('area', None), ('Channel', 'WAREHOUSE'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 239894), ('store', None), ('region', None), ('area', None), ('Channel', 'DEEL'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)])] 1687 getData dictsize
453.941639612 end of fetch data
shape: (1_687, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 239890 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 239891 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 239892 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 239893 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 239894 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 241572 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ TV-65-SMRT-TO ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ SHIBA         ┆              │
│ 241573 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ BLENDER-SMART ┆ 0            │
│ 241574 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ TV-43-SMRT-UN ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ION AIRE      ┆              │
│ 241575 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ KETTLE-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND WHITE     ┆              │
│ 241576 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ MOSQ.KILL-HOM ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ E TECH        ┆              │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the filter dataframe
shape: (1_687, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 239890 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 239891 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 239892 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 239893 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 239894 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 241572 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ TV-65-SMRT-TO ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ SHIBA         ┆              │
│ 241573 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ BLENDER-SMART ┆ 0            │
│ 241574 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ TV-43-SMRT-UN ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ION AIRE      ┆              │
│ 241575 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ KETTLE-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND WHITE     ┆              │
│ 241576 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ MOSQ.KILL-HOM ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ E TECH        ┆              │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the_fiter_data
id Int64
store String
region String
area Int32
Channel String
budget_year Int32
budget_quarter String
budget_month String
budget_weekday Int64
budget_day String
budget_dates Int32
historical_year Int64
history_Quarter String
history_month String
history_week String
history_Day String
history_datess Int32
family String
sub_Family String
Supplier String
Category String
Dom_Comm String
Sub_Category String
Extended_sub_category String
Sub_Category_supplier String
Article_Score Int32
last_v store store
last_v region region
last_v Channel Channel
last_v Quarter budget_quarter
last_v month budget_month
last_v week budget_weekday
last_v Day budget_day
last_v history_Quarter history_Quarter
last_v history_month history_month
last_v history_Day history_Day
last_v family family
last_v sub_family sub_Family
last_v supplier Supplier
last_v category Category
last_v dom_comm Dom_Comm
last_v sub_category Sub_Category
last_v extended_sub_category Extended_sub_category
last_v sub_category_supplier Sub_Category_supplier
{'store': ['GateWay Mall El Rehab', 'Qalyub', 'BTECHX Saad El Din El Shazly', 'El Tagamou 2 Branch', 'HQ Call Center', 'BTECHX Roxcy', 'El-Gouna Branch', 'Aswan WH', 'BTECH Mini MPC', 'Ras Ghareb Branch', 'El Menia Mega Branch', '26Th July Branch', 'Uni Mall El Obour', 'New Roxy', 'El Seyouf Branch', 'BTECHX ASU', 'BTECHX Maadi Grand Mall', 'BTECHX City Stars Mall', 'Masara', 'ElBahr ElAzam', 'B.TECHX El Mandara', 'Malawi Branch', 'BTECHX CityCenter Alex', 'Miela Arkan Mall', 'Assuit Mega Branch', 'BTECHX The Yard Mall', 'BTECH2Fayoum', 'New sohag', 'BTECHX Mansoura', 'Roxy Branch', 'BTECHX Kafr ElSheikh', 'Mall Of October Branch', 'Winget Branch', 'New Damanhour', '10th Show Room WH', 'Eldahar Mega Branch', 'El Nozha Branch', 'BTECHX Sporting Club', 'BTECHX CityCenterMaadi', 'BTECHX Manial', 'Shebin El Koum Branch', 'BTECHX Safwa Zaid ', 'BTECHX Shinzo Abe', 'El-Elsoudan Street Branch', 'Mega Fisal', 'Ismalia Branch-City Council Square', 'Mega Alex Sidi Gaber', 'BTECHX Obour2', 'Alex WH', 'Nagaa Hamadi Branch', 'Ain Shams Branch - Ibrahim Abdel Razek St.', 'El Helmya', 'Tanta WH', 'BTECHX Truck Alex', 'BTECH mini Egyptian Shooting ', 'Desouk Branch', 'Mall Of Arabia Branch', 'Tanta Branch', 'Cairo Retail Warehouses', 'Aswan Mega  Branch', 'Ismaila Branch-Railway station', 'EL Amiria Branch', 'BTECHX Gehan2 Dewaka', 'BTECHX Airport', 'Jumia Seller Store', 'Corporate Sales', 'Almaza Branch', 'Berket Elsabaa Branch', 'Hassan El Maamon', 'Mall Of Egypt Branch', 'Loran Branch', 'BTECHX El Mosher Axis', 'Port Said', 'Alex_ Tusun', 'BTECHXCFC', 'BTECHX El Menia', 'Town Center El Salam', 'Sale With Cost W.H', 'Show Room - Corp. Sale-38', 'Amwaj ranch', 'BTECHX Sidi Bishr', 'Beni Suef Branch', 'Dumietta Branch', 'El Betash Branch', 'BTECHX Moharam Bek', 'EL Matria', 'BTECHX Hegaz', 'Quesna Branch', 'Sohag Branch', 'Salah Salim Branch', 'Zagazig Branch', 'Dakernis Branch', 'Agami Branch', 'Mansoura Branch', 'Smouha Branch', 'Delta Tanta Mega Store', 'BTECHX San_Stefano Mall', '0', 'Abbas El-Akkad Branch', 'Dar El Salam Branch', 'Asyut WH', 'Qena Branch', '9025Show Room Alex', 'El Galaa', 'Asafra Branch', 'BTECHXMataria', 'BTECHX Gihan3 Abasia', 'BTECHX Open Air Mall', 'Flag Mall Branch', '3Tanta Mall', 'El Fayoum Branch', 'BTECHX Midor', 'Sky Mall El Sherouk Branch', 'BTECHX Sohag', 'BTECHX Mahala', 'Zahra El Asher Branch', 'BTECHX Dokki', 'Gesr El Suez Branch', 'Misr elgdida', 'El Sayeda Zainab', 'BTECHX Shebin El koum', 'Elagamy2', 'Marina Kaian Branch', 'Mega Helwan', 'Suez Branch', 'Marina Branch', 'Alamein Masa Mall', 'B.TECH X AUC', 'New Dumietta Branch', 'El Zaher', 'QENA-Warehouse', 'El Tagamou 1 Branch', 'Makadi Bay', 'Shubra El Kheima Branch', 'Noon Seller Store1', 'Ain Shams Branch - Mostafa Hafez St.', 'El Sadat Branch', 'Banha Branch', 'Hadek El Kobba Branch', 'Fakous Branch', 'Assiut Branch - Ibn Sina Tower', 'Makram Ebaid Branch', 'CFC Mall', 'El Mokattam Branch', 'Faisal Branch', 'El Tahrir', 'BTECHX GardeniaTagamo', 'BTECH Mini Air Force House', 'BTECHX 2Mansoura', 'Maadi Branch-El Laselky St.', 'BTECHX ElRehab Mall1', '10th of Ramadan WH', 'BTECHX ElShams Club', 'BTECHX Kasr El Einy', 'B.TECH STAFF', 'Damanhour Branch', 'Zayton Branch', '1Imbaba', 'October-WH', 'BTECHX ElRehab North', 'BTECHX Triumph Tagamo', 'El Kanater Branch', 'BTECHX Sheraton', 'Banha warehouse', 'Marassi-North-Coast Branch', 'Oraby Branch', 'BTECHX Assuit', 'Haram Branch', 'Luxor Branch', 'BTECHX El Sherouk', '10th Tech Club WH', 'BTECHX Ismailia Square', 'BTECHX Ramses Station', 'Mahalla Branch', 'Shoubra Branch', 'Miela Arkan WH'], 'region': ['UPPER EGYPT', 'CAIRO', '0', 'HURGHADA', 'ALEXANDRIA', 'DELTA'], 'season': [], 'area': [], 'Channel': ['ONLINE', 'NON', 'Retail', 'DEEL', 'B.TECH X', 'WAREHOUSE', 'B2B', 'MINI', 'ARKAN', 'CALL CENTER', '0'], 'budget_year': [0.0], 'Quarter': ['3', '0'], 'month': ['0', 'July     '], 'week': [0, 2, 3, 4, 5, 6], 'date': ['19908', '19909', '19906', '19905', '0', '19907'], 'Day': ['0', 'Monday   ', 'Wednesday', 'Tuesday  ', 'Friday   ', 'Thursday '], 'historical_year': [], 'history_Quarter': ['1', '0'], 'history_month': ['0', 'January  '], 'history_week': ['0', '1', '52'], 'history_Day': ['0', 'Tuesday  ', 'Thursday ', 'Wednesday', 'Sunday   ', 'Friday   ', 'Monday   '], 'history_dates': [0, 19358, 19359, 19360, 19361, 19362, 19723, 19724, 19725, 19726, 19727], 'article_score': ['sale', 'abc', 'ae', 'speed', 'terminal', 'margin', 'sell', 'markdown', 'core', 'quartile', 'sortimeter'], 'history_year': [0.0, 2023.0, 2024.0], 'family': ['LAPTOP', 'BMOBILE ACCESSORIES', '0', 'AC', 'NON', 'SDA', 'TV', 'TABLET', 'COMPLEMENTARY', 'MDA', 'MOBILE'], 'sub_family': ['TV COM', 'NON', 'MDA DOM', 'BMOBILE', 'SDA COM', 'SDA DOM', 'AC COM', 'AC DOM', '0', 'TV DOM', 'MDA COM'], 'supplier': ['OZO', 'F&D', 'LA GERMANYA', 'KEENDEX', 'DAIKIN', 'ROVO', 'ATLANTIC', 'ZAHRAN', 'HAPILLINE', 'BABYLISS', 'AMAZONE', 'SKYWORTH ZAPPER', 'MOULINEX', 'PREMIER', 'VIVO', 'SHARP', 'HOME TECH', 'XIAOMI', 'BOSCH', 'KENWOOD', 'INDESIT', 'ARIETE', 'BLACK AND DECAR', 'DALY', 'ORAIMO', 'RUSH BRUSH', 'ORIGINAL', 'WHITE POINT', 'SONY', 'HOME', 'REMINGTON', 'FLAT', '0', 'NIKON', 'NOUR TECH', 'MODEM', 'ZANUSSI', 'PASSAP', 'HAVIT', 'BeKO', 'HUAWEI', 'TRUMAN', 'OLYMPIC', 'LOGITECH', 'CANON', 'UNION AIRE', 'KOLDAIR', 'MIELE', 'PHILIPS', 'SOLAC', 'ARISTON', 'MUSIC HERO', 'ETI', 'BRAUN', 'CRAFT', 'ICOOK', 'ELIOS', 'ALEXA', 'FRESH', 'CARRIERE', 'XAIOMI', 'SMART', 'LAVVENTO', 'CANDY', 'NARDI', 'DELL', 'BERGEN', 'VEITO', 'NON', 'DAHUA', 'DELONGHI', 'GORENJE', 'MEDIA TECH', 'BENQ', 'INFINIX', 'MIENTA', 'HONOR', 'NIKAI', 'PREMIUM', 'FIRST', 'MICROSOFT', 'TOSHIBA', 'MUTECH', 'ULTRA', 'BMOBILE ACCESSORIES', 'SENCOR', 'SARY', 'BIALETTI', 'INFINX', 'DOB', 'BISSELL', 'HOUSECOM', 'LDNIO', 'NOKIA', 'FALCON', 'APPLE', 'ROYAL', 'BRANDT', 'HAIER', 'GENERAL ELECTRIC', 'HOOVER', 'EPSON', 'KIRIAZI', 'ELBA', 'REALME', 'ALASKA', 'UNIVERSAL', 'TORNADO', 'SAMSUNG', 'HP', 'PANASONIC', 'NESPRESSO', 'WHITE WHALE', 'MIDEA', 'LG', 'SPEED', 'BLACK AND WHITE', 'STEEL', 'ASUS', 'TOUCH', 'ICONZ', 'TCL', 'TANK', 'MODEX', 'ELECTROSTAR', 'AMERICOOL', 'TEFAL', 'ITEL', 'SEASONS', 'TOSHIBA Midea', 'HAMA', 'NI', 'OKKA', 'SONAI', 'LENOVO', 'MSI', 'FRANKE', 'FLYON', 'TIGER', 'OPPO', 'ILOOK', 'BEKO'], 'category': ['Blender Tornado', 'Complent Alexa IOT', 'Hood Indesit', 'TV Sony', 'Hood ASS Indesit', 'TV Acc Itel', 'Washing M Haier', 'TV Acc MUTECH', 'Frayer Modex', 'Tablet TCL', 'VC Bissell', 'Iron Kenwood', 'R.cooker Tefal', 'M.Mincer SMART', 'D Washer White Point', 'Hobs Hoover', 'Blender Touch', 'Wall Hood Tornado', 'AC Sharp', 'VC AccessoriesMiele', 'Kitchen M Mienta', 'TV Acc STEEL', 'Kettle Housecom', 'Chopper Rovo', 'AC Accessory LG', 'Gas Heater Panasonic', 'Straightners Braun', 'H.Blend Touch', 'Frayer Black&decker', 'Deep F Miele', 'Fridge Ariston', 'Hobs Miele', 'Deep F Toshiba', 'Fun Line Zahran', 'TV Acc ETI', 'E.Hot Pla Home', 'Ele Heater Ariston', 'Kettle Black&decker', 'Comp Monitor Xiaomi', 'Shaving_Tri Babyliss', 'Fan Tornado', 'Fun Line Mienta', 'TV FRESH', 'TV Haier', 'TV Acc Toshiba', 'Mobile VIVO', 'Kitchen M Bosch', 'Mixer Ultra', 'Hobs Elba', 'Cooker Zanussi', 'Mobile REALME', 'Mobile OPPO', 'WD Ultra', 'Grill Kenwood', 'Kettle SENCOR', 'WD Bergen', 'Grill Home', 'F.Proc Black&decker', 'Chopper Tornado', 'AC Beko', 'Air Styler Rush brus', 'Hair Dryer Remington', 'Iron Panasonic', 'Coffee M Beko', 'Mic. Kenwood', 'Hobs ICook', 'Hobs Beko', 'Dryer LG', 'Kettle Ariete', 'Audio Media Tech', 'Masher Mienta', 'Juicer Mienta', 'Fridge LG', 'Toaster Black&decker', 'Kitchen ware Modex', 'Oven Mienta', 'Gas Heater Atlantic', 'Coffee M Tornado', 'AC Accessory Haier', 'TV Acc FLAT', 'TV Acc ICONZ', 'Washing M CANDY', 'AC Union Aire?', 'Complem Printer HP', 'AC Accessory Sharp', 'Oven Ariston', 'Washing M Kiriazi', 'Thermal Mug Tefal', 'Frayer Fresh', 'Oven Tornado', 'Mic. Home', 'Toaster Home', 'mosq.kill Home', 'Chopper SMART', 'E.Hot Touch', 'Masher Black&white', 'Deep F PASSAP', 'Cooker Premium', 'TV Acc HP', 'Iron Media Tech', 'Deep F Beko', 'Juicer Moulinex', 'H.Mixer Braun', 'TV Acc Falcon', 'TV Acc hama', 'Deep F White Whale', 'Oven Franke', 'Tablet Nokia', 'kettle Mienta', 'Hobs Nardi', 'H.Blend Black&white', 'Headset SBS', 'Gas Heater Nikai', 'Blender Kenwood', 'Mic. Fresh', 'Kettle Braun', 'AC Daikin', 'Hobs SMART', 'Mobile INFINX', 'F.Proc Home', 'H.Blend Media Tech', 'Blender Braun', 'Air Purifier SHARP', 'Fun Line Sonai', 'IFix', 'Coffee M Modex', 'Coffee M Bialetti', 'Washing M Indesit', 'E.Hot Plate Fresh', 'F.Proc Mienta', 'AC Midea', 'Tablet APPLE', 'F.Proc Moulinex', 'Kettle SMART', 'Kitchen M Kenwood', 'Blender Sonai', 'Cooker Royal', 'Fridge PASSAP', 'Security Ass Camera', 'Deep F White Point', 'Fan universal', 'Mixer Black&decker', 'TV Ultra', 'Washing M Union Aire', 'Hobs Fresh', 'M.Mincer Kenwood', 'Washing M Hoover', 'Chopper Bosch', 'Juicer Kenwood', 'Chopper Mienta', 'Audio First', 'Audio', 'Comp Monitor Samsung', 'Boxi', 'AC Accessory Daikin', 'Cooker Fresh', 'TV LG', 'Air Cooler Sonai', 'H.Blend sary', 'Washing M Toshiba', 'Shaving_Tri Philips', 'VC Mienta', 'Mixer Black&white', 'Fan Sonai', 'Ele Heater Fresh', 'WD White Whale', 'Kitchen M Home', 'Mic. Sharp', 'Kettle Zahran', 'Hobs Ariston', 'Ele Heater Toshiba', 'H.Mixer Touch', 'Receiver Daly', 'TV Tornado', 'Grill Touch', 'AC Acc Union Aire', 'Coffee M Braun', 'AC TORNADO', 'Coffee M Black&decke', 'Mobile APPLE', 'Airpods kit SBS', 'Kitchen M Fresh', 'F.Proc Sonai', 'tv acc elios', 'Gas Heater White Poi', 'Warmer Fresh', 'Comp Monitor BenQ', 'Cooking Appliances A', 'Washing M Fresh', 'Fan Kenwood', 'Grill Black&decker', 'WD Tank', 'Blender Moulinex', 'F.Proc SMART', 'TV Sharp', 'Washing M White Poin', 'D Washer Fresh', 'Washing M Ariston', 'M.Mincer Modex', 'Washing M Sharp', 'Juicer Home', 'Ele Heater Union Air', 'Washing M Samsung', 'Audio sony', 'Hair Dryer Babyliss', 'TV Union Aire', 'Complem Gaming Sony', 'Fan Smart', 'Deep F Union Aire?', 'Compl Printer CANON', 'Oven Touch', 'Air Fryer Kenwood', 'Kettle Fresh', 'Tablet Samsung', 'Fridge Zanussi', 'VC LG', 'WD Tornado', 'Frayer Mienta', 'Washing M Premium', 'R.cooker Black&decke', 'Filter ASS Tank', 'Hood Premier', 'Hood Sonai', 'Iron Touch', 'TV Toshiba', 'Mic. Hoover', 'TV Acc ilook', 'AC ULTRA', 'Kettle Panasonic', 'Wall Hood Toshiba', 'Fan Touch', 'Audio Samsung', 'Fridge Bosch', 'Cooker La germanya', 'AC Americool', 'Kettle Home', 'AC LG', 'Oven Home', 'Air Cooler Tornado', 'Mobile HONOR', 'Blender Black&decker', 'Warmer Tornado', 'H.Mixer Kenwood', 'Mic. Black&decker', 'Chopper Sonai', 'AC Premium', 'H.Blend Kenwood', 'AC Haier', 'Espresso Machine Ari', 'Laptop Lenovo', 'Fun Line Media Tech', 'Coffee M Nespresso', 'Chopper Fresh', 'Ele Heater Universal', 'Cooker White Point', 'Charger SBS', 'Blender Ariete', 'Blender Ultra', 'Gaming ASS ASS', 'VC Smart', 'Gas Heater Tornado', 'Iron Home', 'Fridge Electrostar', 'Iron Tornado', 'Cables SBS', 'Gas Heater Ariston', 'TV Samsung', 'Curl Irons Babyliss', 'Coffee M Bosch', 'H.Mixer Bosch', 'Blender sary', 'Oven Bosch', 'Blender Mienta', 'Hood Franke', 'VC Miele', 'Blender Media Tech', 'Washing M Beko', 'Hood Beko', 'Receiver SkyWorth Za', 'IT ASS ASS', 'Deep F Fresh', 'Laptop Microsoft', 'VC Black&decker', 'H.Mixer Mienta', 'AC Accessory Premium', 'Mobile NOKIA', 'Frayer Tefal', 'Mincer Home', 'Washing M Tornado', 'Ele Heater Olympic', 'Speaker SBS', 'Mic. Tornado', 'Fridge Union Aire', 'Fridge Alaska', 'IFixBtech', 'Frayer Delonghi', 'H.Blend Moulinex', 'Hobs Franke', 'Tripod SBS', 'Wall Hood Fresh', 'Coffee M SMART', 'Shaving_Tri Tornado', 'TV Acc Etrain', 'Mobile Huawei', 'Hair Dryer Philips', 'Deep F Ariston', 'Gift Fresh', 'Blender Fresh', 'Coffee M Kenwood', '0', 'TV Acc NI', 'Iron Smart', 'Deep F LG', 'Grill Modex', 'Air Cooler Fresh', 'Coffee M Tefal', 'Mic. LG', 'Mobile Samsung', 'Kettle Modex', 'WD Fresh', 'H.Mixer Modex', 'Audio oraimo', 'H.Blend Mienta', 'Hobs Zanussi', 'Washing M LG', 'H.Mixer Tornado', 'kettle Black&white', 'VC Kenwood', 'Fan Black&white', 'Shaving_Tri Braun', 'VC Black&white', 'H.Mixer Black&white', 'Fridge White Point', 'Coffee M Home', 'Hood Bosch', 'Laptop ASUS', 'Deep F Alaska', 'AC Zanussi', 'Tablet Huawei', 'Receiver truman', 'Fridge Miele', 'Complem Camera CANON', 'Audio Toshiba', 'Frayer Philips I2', 'Straightners Babylis', 'Iron Black&Decker', 'Ele Heater Kiriazi', 'Coffee M Mienta', 'WD White Point', 'M.Mincer Panasonic', 'Laptop HP', 'Filter Tank', 'WD speed', 'Tools Bosch', 'Gas Heater Universal', 'H.Blend Tornado', 'Cooker Beko', 'Fridge Sharp', 'Power Bank SBS', 'Straightners Mienta', 'Mobile XIAOMI', 'Kettle Touch', 'Fan Fresh', 'Curl Irons Rush brus', 'Enquiry Fees', 'Ele Heater VEITO', 'AC Accessory Carrier', 'Hobs Bosch', 'Fun Line Home', 'Shaving_Tri Hapillin', 'Frayer Home', 'Gas Heater Fresh', 'VC Bosch', 'D Washer Bosch', 'Grill Fresh', 'Mic. SMART', 'F.Proc Ariete', 'Toaster tornado', 'Laptop DELL', 'Complem Camera Nikon', 'Iron Modex', 'Oven Indesit', 'Cooker Union Aire?', 'Fridge Kiriazi', 'M.Mincer Touch', 'Kettle Kenwood', 'H.Blend Black&decker', 'Juicer Tornado', 'Mixer Kenwood', 'Hobs Brandt', 'M.Mincer Tornado', 'Mixer Touch', 'TV Acc Tiger', 'Hood Gorenje', 'Deep F Sharp', 'Mic. Zanussi', 'Coffee M okka', 'Gas Heater Kiriazi', 'Thermoses Tiger', 'Juicer Bosch', 'AC Carriere', 'Mincer Black&decker', 'Blender Home', 'Straightners Remingt', 'Coffee M Media Tech', 'M.Mincer Bosch', 'Blender Panasonic', 'Fan Union Aire?', 'VC Hoover', 'Deep F Kiriazi', 'Straightners Philips', 'Chopper Moulinex', 'AC Fresh', 'Hood Ariston', 'AC Crafft', 'AC Accessory Crafft', 'B.ElectronicServices', 'Fan black&decker', 'Audio F&D', 'Warmer Black&decker', 'Ele Heater TORNADO', 'Kitchen M Moulinex', 'Coffee M Sonai', 'Fridge Beko', 'E.Hot Plate SMART', 'Filter ASS philips', 'Juicer Media Tech', 'M.Mincer Moulinex', 'Audio Philips', 'Fridge White Whale', 'Transferfeesonline01', 'Iron Mienta', 'M.Mincer Black&White', 'Blender Smart', 'Gas Heater Zanussi', 'Comp Printer Epson', 'D Washer LG', 'F.Proc Modex', 'Iron Black&white', 'Iron Solac', 'Fridge Fresh', 'Fridge Tornado', 'Fan Panasonic', 'Air Cooler Home', 'Holders SBS', 'Com Projector Merlin', 'Fridge Haier', 'Thermal Mug Tank', 'Gas Heater Olympic', 'Iron Tefal', 'Washing M Zanussi', 'Kitchen M SMART', 'Laptop MSI', 'Kettle Tornado', 'Mixer Media Tech', 'Kettle Media Tech', 'Deep F Tornado', 'Straightners Rush br', 'Oven Ultra', 'AC General Electric', 'TV Premium', 'Washing M Bosch', 'Iron Braun', 'AC Accessory Fresh', 'Toaster Kenwood', 'Hood ICook', 'Kitchen M Ariete', 'B.Electronic ass', 'Hair Dryer Tornado', 'VC Fresh', 'Receiver', 'M.Mincer Sonai', 'Fridge Toshiba', 'F.Proc Braun', 'Tablet Lenovo', 'AC Accessory Zanussi', 'Oven Fresh', 'Ele Heater Atlantic', 'Coffee M Delonghi', 'Hair Dryer Rush brus', 'Cooker Kiriazi', 'F.Proc Kenwood', 'Ele heater flyon', 'Blender Bosch', 'tv acc truman', 'F.Proc Bosch', 'Straightners Tornado', 'VC Panasonic', 'Kettle Sonai', 'Chopper Media Tech', 'Kitchen M Touch', 'Blender Black&white', 'TV Accessory', 'H.Mixer Fresh', 'Hood Touch', 'Kitchen M Black&whit', 'H.Mixer SMART', 'Fan Tefal', 'Chopper Touch', 'H.Blend Bosch', 'tv acc keendex', 'Fan Nikai', 'D Washer Beko', 'Audio LG', 'Warmer Media Tech'], 'dom_comm': ['NON', 'COMM', 'B.MOBILE', '0', 'DOM'], 'sub_category': ['CHOPPER', 'AC-HOT/COLD-3HP-INDOOR UNIT', 'AC-HOT/COLD-1.5HP-OUTDOOR UNIT', 'HOOD', 'Wearable_Acc', 'ELE HEATER', 'TV-55-SMRT-HI', 'GRILL', 'TV-75-SMRT-HI', 'ESPRESSO MACH', 'AC-HOT/COLD-4HP-OUTDOOR UNIT', 'GAS HEATER', 'MICROWAVE', 'COOKER', 'D WASHER', 'STRAIGHTNERS', 'WD', 'AC-COLD-3HP-INDOOR UNIT', 'AC-HOT/COLD-2.25HP-OUTDOOR UNIT', 'TV-32', 'TABLET', 'TV-43', 'WARMER', 'AC-HOT/COLD-5HP-OUTDOOR UNIT', 'HOOD ASS', 'AC-COLD-3HP-OUTDOOR UNIT', 'AIR FRYER', 'TOASTER', 'FILTER 3 STAGES', 'TV-65-SMRT', 'FILTER 6 STAGES', 'TV-75-SMRT', 'KETTLE', 'TV-85-SMRT-HI', 'TV-65-SMRT-HI', 'LAPTOP', 'IRON', '0', 'TV-43-SMRT', 'TV-55-SMRT', 'RECEIVER', 'AIR PURIFIER', 'MIXER', 'F.PROC', 'Mobile_Acc', 'AC-HOT/COLD-5HP-INDOOR UNIT', 'CURL IRONS', 'AC-HOT/COLD-1.5HP-INDOOR UNIT', 'It_Acc', 'FRIDGE', 'OVEN', 'VC', 'MOSQ.KILL', 'HAIR DRYER', 'AC ACCESSORY', 'MASHER', 'FILTER ASS', 'TV-70-SMRT', 'GIFT', 'MINCER', 'FILTER 7 STAGES', 'AC-HOT/COLD-3HP-OUTDOOR UNIT', 'H.BLENDER', 'M.MINCER', 'KITCHEN M', 'WASHING M', 'AIR STYLER', 'FILTER 5 STAGES', 'FUN LINE', 'MOBILE', 'AC-COLD-1.5HP-INDOOR UNIT', 'TOOLS', 'AC-COLD-2.25HP-INDOOR UNIT', 'THERMAL VESSEL', 'FRAYER', 'ALEXA ECHO DOT', 'TV-ACCESSORY', 'E.HOT PLATE', 'TV-FRAME', 'TV-86-SMRT', 'SHAVING_TRI', 'AC-COLD-2.25HP-OUTDOOR UNIT', 'AC-HOT/COLD-2.25HP', 'TV-32-SMRT', 'BLENDER', 'AC-COLD-2.25HP', 'BMOBILE ACCESSORIES', 'DEEP FREEZER', 'WALL HOOD', 'AUDIO', 'COMPLEMENTARY', 'AC-HOT/COLD-2.25HP-INDOOR UNIT', 'COOKING APPLIANCES', 'TV-50-SMRT', 'HOBS', 'FAN', 'NON', 'COFFEE M', 'AIR COOLER', 'WASHER DRYER', 'AC-COLD-1.5HP-OUTDOOR UNIT', 'H.MIXER', 'TV-60-SMRT', 'R.COOKER', 'VC ACCESSORIES', 'AC-HOT/COLD-4HP-INDOOR UNIT', 'JUICER'], 'extended_sub_category': ['AC-HOT/COLD-2.25HP', 'ALEXA ECHO DOT', 'M.MINCER', 'ESPRESSO MACH', 'WASHING M', 'HAIR DRYER', 'AC-COLD-2.25HP', 'AC-COLD-1.5HP', 'HOBS', 'TV-43-SMRT', 'Gift', 'COOKING APPLIANCES', 'ELE HEATER', 'CURL IRONS', 'MOBILE COMPLEMENTARY', 'AIR COOLER', 'H.BLENDER', 'Wearables', 'TV-32-SMRT', 'WASHER DRYER', 'NON', 'FILTER 3 STAGES', 'TV-65-SMRT-HI', 'TV-85-SMRT', 'Mobile Holder', 'TV-70-SMRT', 'TV-60-SMRT', 'TV COMPLEMENTARY', 'Mobile photography', 'JUICER', 'MASHER', 'TOASTER', 'TV-32', 'AC COMPLEMENTARY', 'Security', 'R.COOKER', 'MOSQ.KILL', 'CHOPPER', 'TV-75-SMRT-HI', 'Service', 'AIR PURIFIER', 'FRIDGE', 'WALL HOOD', 'Network-Adapter', 'AC-HOT/COLD-5HP', 'Mobile Case', 'Mobile Cables', 'AIR FRYER', 'SHAVING_TRI', 'FILTER 7 STAGES', 'AC-HOT/COLD-3HP', 'AC-HOT/COLD-1.5HP', 'FUN LINE', 'Mobile Audio', '0', 'AIR STYLER', 'IRON', 'Cross Bag', 'TV-85-SMRT-HI', 'FRAYER', 'TV-43', 'Protection', 'OVEN', 'MIXER', 'AC-COLD-3HP', 'Computer peripherals', 'KITCHEN M', 'BLENDER', 'GAS HEATER', 'COMPLEMENTARY', 'MOBILE', 'AC-HOT/COLD-4HP', 'BMOBILE ACCESSORIES', 'FILTER 6 STAGES', 'MINCER', 'E.HOT PLATE', 'TV-55-SMRT', 'VC', 'WD', 'GRILL', 'THERMAL VESSEL', 'TV-55-SMRT-HI', 'F.PROC', 'WARMER', 'TABLET', 'FILTER 5 STAGES', 'LAPTOP', 'TV-65-SMRT', 'H.MIXER', 'Network', 'Storage', 'Smart Scale', 'COOKER', 'KETTLE', 'MICROWAVE', 'STRAIGHTNERS', 'Gaming', 'SDA COMPLEMENTARY', 'D WASHER', 'Mobile cables', 'FAN', 'COFFEE M', 'Power', 'DEEP FREEZER', 'Smart tag', 'TV-75-SMRT', 'Network-Switch', 'TV-50-SMRT', 'HOOD'], 'sub_category_supplier': ['TV-43-SMRT-SAMSUNG', 'WASHING M-WHITE POINT', 'HOBS-SMART', 'E.HOT PLATE-FRESH', 'WASHING M-LG', 'DEEP FREEZER-BEKO', 'JUICER-BOSCH', 'FRAYER-MODEX', 'FRAYER-TEFAL', 'R.COOKER-TEFAL', 'HOBS-BOSCH', 'WARMER-TORNADO', 'STRAIGHTNERS-MIENTA', 'DEEP FREEZER-ARISTON', 'HOBS-HOOVER', 'WASHING M-SAMSUNG', 'MICROWAVE-ZANUSSI', 'WALL HOOD-TOSHIBA', 'AC ACCESSORY-ZANUSSI', 'AC-COLD-3HP-CARRIERE', 'H.BLENDER-KENWOOD', 'COMPLEMENTARY-HP', 'FILTER 7 STAGES-SEASONS', 'TABLET-HUAWEI', 'COOKER-UNION AIRE', 'HOOD-SONAI', 'MIXER-BLACK AND WHITE', 'FRIDGE-WHITE WHALE', 'VC-MIENTA', 'GAS HEATER-ZANUSSI', 'BLENDER-SMART', 'WASHING M-BOSCH', 'KETTLE-BRAUN', 'HOOD-INDESIT', 'TOASTER-TORNADO', 'M.MINCER-SONAI', 'TV-50-SMRT-SHARP', 'TABLET-TCL', 'TV-43-SMRT-SONY', 'COOKER-PREMIUM', 'AUDIO-TOSHIBA', 'ELE HEATER-TOSHIBA', 'SHAVING_TRI-BABYLISS', 'AC-HOT/COLD-2.25HP-UNION AIRE', 'TV-43-HAIER', 'TV-55-SMRT-SAMSUNG', 'TV-32-SMRT-SAMSUNG', 'COFFEE M-TORNADO', 'KETTLE-MODEX', 'DEEP FREEZER-WHITE POINT', 'HOBS-NARDI', 'TABLET-APPLE', 'WD-TORNADO', 'FAN-SONAI', 'AC-COLD-1.5HP-LG', 'KITCHEN M-BLACK AND WHITE', 'AC ACCESSORY-LG', 'FILTER ASS-PHILIPS', 'AC-COLD-1.5HP-HAIER', 'KITCHEN M-MOULINEX', 'WASHING M-TORNADO', 'TV-65-SMRT-HI-LG', 'BMOBILE ACCESSORIES', 'TV-32-UNION AIRE', 'TV-65-SMRT-SAMSUNG', 'GAS HEATER-PANASONIC', 'ALEXA ECHO DOT-ALEXA', '0', 'KETTLE-SENCOR', 'HOBS-ICOOK', 'AC-HOT/COLD-3HP-SHARP', 'TV-ACCESSORY-ILOOK', 'H.BLENDER-TORNADO', 'LAPTOP-ASUS', 'FUN LINE-HOME TECH', 'VC-FRESH', 'IRON-MEDIA TECH', 'KITCHEN M-KENWOOD', 'STRAIGHTNERS-TORNADO', 'TV-32-PREMIUM', 'FILTER 3 STAGES-SEASONS', 'ELE HEATER-OLYMPIC', 'KITCHEN M-MIENTA', 'FRIDGE-LG', 'IRON-KENWOOD', 'AC-COLD-3HP-LG', 'MICROWAVE-HOOVER', 'IRON-MIENTA', 'F.PROC-HOME TECH', 'AUDIO-PHILIPS', 'DEEP FREEZER-MIELE', 'FILTER 5 STAGES-SEASONS', 'JUICER-TORNADO', 'AC-COLD-1.5HP-FRESH', 'F.PROC-MIENTA', 'MICROWAVE-LG', 'TV-65-SMRT-LG', 'TV-ACCESSORY-FLAT', 'M.MINCER-BOSCH', 'MOBILE-REALME', 'FAN-BLACK AND WHITE', 'GRILL-HOME TECH', 'TOASTER-KENWOOD', 'H.BLENDER-MOULINEX', 'MICROWAVE-BLACK AND DECAR', 'WARMER-FRESH', 'AC-COLD-2.25HP-TORNADO', 'FRIDGE-TOSHIBA', 'TV-32-TOSHIBA', 'AC-HOT/COLD-2.25HP-GENERAL ELECTRIC', 'IRON-HOME TECH', 'GAS HEATER-NIKAI', 'MINCER-HOME TECH', 'KITCHEN M-TOUCH', 'WD-KOLDAIR', 'H.BLENDER-BOSCH', 'VC ACCESSORIES-MIELE', 'MOSQ.KILL-HOME TECH', 'MASHER-BLACK AND WHITE', 'GAS HEATER-ATLANTIC', 'AC ACCESSORY-SHARP', 'WASHING M-FRESH', 'AC-HOT/COLD-2.25HP-BEKO', 'MICROWAVE-KENWOOD', 'WALL HOOD-TORNADO', 'M.MINCER-MODEX', 'FAN-TEFAL', 'FAN-SMART', 'IRON-PANASONIC', 'AC-HOT/COLD-3HP-GENERAL ELECTRIC', 'SHAVING_TRI-RUSH BRUSH', 'R.COOKER-BLACK AND DECAR', 'HAIR DRYER-REMINGTON', 'CHOPPER-TOUCH', 'TV-ACCESSORY-NOUR TECH', 'BLENDER-ARIETE', 'AC ACCESSORY-PREMIUM', 'TV-55-SMRT-TOSHIBA', 'VC-HOOVER', 'AC-HOT/COLD-1.5HP-SHARP', 'H.BLENDER-BLACK AND WHITE', 'AC-COLD-3HP-TORNADO', 'BMOBILE ACCESSORIES-LDNIO', 'COMPLEMENTARY-HAVIT', 'BLENDER-MOULINEX', 'FAN-PANASONIC', 'MOBILE-HUAWEI', 'STRAIGHTNERS-BABYLISS', 'AIR COOLER-TORNADO', 'H.BLENDER-MIENTA', 'KETTLE-BLACK AND DECAR', 'ELE HEATER-UNION AIRE', 'MOBILE-XIAOMI', 'HOBS-FRANKE', 'TV-ACCESSORY-HP', 'AUDIO-SAMSUNG', 'H.MIXER-FRESH', 'COOKER-BEKO', 'DEEP FREEZER-PASSAP', 'GRILL-TOUCH', 'BLENDER-ULTRA', 'FRIDGE-ARISTON', 'COOKER-ROYAL', 'MICROWAVE-FRESH', 'KITCHEN M-ARIETE', 'MOBILE-OPPO', 'VC-BOSCH', 'FRIDGE-TORNADO', 'AC-COLD-3HP-FRESH', 'TV-32-TORNADO', 'WASHING M-PREMIUM', 'BMOBILE ACCESSORIES-TOSHIBA', 'HOBS-ZANUSSI', 'GIFT-FRESH', 'COMPLEMENTARY-EPSON', 'ELE HEATER-VEITO', 'BLENDER-KENWOOD', 'FILTER ASS-SEASONS', 'AC-COLD-2.25HP-UNION AIRE', 'COFFEE M-BEKO', 'FAN-KENWOOD', 'COMPLEMENTARY-SONY', 'IRON-MODEX', 'AC-HOT/COLD-3HP-LG', 'LAPTOP-DELL', 'ELE HEATER-KIRIAZI', 'BMOBILE ACCESSORIES-SONY', 'JUICER-MEDIA TECH', 'TV-75-SMRT-HI-LG', 'DEEP FREEZER-TOSHIBA Midea', 'AC-HOT/COLD-3HP-BEKO', 'JUICER-KENWOOD', 'MINCER-BLACK AND DECAR', 'DEEP FREEZER-TOSHIBA', 'AC-HOT/COLD-1.5HP-BEKO', 'OVEN-MIENTA', 'AC-HOT/COLD-5HP-CARRIERE', 'HAIR DRYER-PHILIPS', 'BMOBILE ACCESSORIES-STEEL', 'MICROWAVE-HOME TECH', 'AC-HOT/COLD-2.25HP-ULTRA', 'FAN-UNIVERSAL', 'VC-LG', 'FUN LINE-MEDIA TECH', 'AC-HOT/COLD-2.25HP-CARRIERE', 'COFFEE M-NESPRESSO', 'FAN-TOUCH', 'AC-HOT/COLD-2.25HP-SHARP', 'TV-50-SMRT-LG', 'OVEN-FRESH', 'DEEP FREEZER-TORNADO', 'COOKER-KIRIAZI', 'FAN-TORNADO', 'F.PROC-KENWOOD', 'H.MIXER-MIENTA', 'TV-32-SMRT-LG', 'AC-HOT/COLD-1.5HP-UNION AIRE', 'AC ACCESSORY-CARRIERE', 'H.MIXER-BLACK AND WHITE', 'KITCHEN M-SMART', 'GAS HEATER-WHITE POINT', 'VC-BLACK AND WHITE', 'WASHING M-KIRIAZI', 'CHOPPER-BOSCH', 'WD-WHITE POINT', 'TV-75-SMRT-SAMSUNG', 'THERMAL VESSEL-TEFAL', 'AC ACCESSORY-CRAFT', 'AC-COLD-2.25HP-CARRIERE', 'BMOBILE ACCESSORIES-MUSIC HERO', 'CHOPPER-SMART', 'FUN LINE-ZAHRAN', 'COOKER-WHITE POINT', 'FUN LINE-SONAI', 'COFFEE M-HOME TECH', 'AUDIO-ORAIMO', 'KETTLE-ARIETE', 'AC-HOT/COLD-1.5HP-FRESH', 'WASHING M-CANDY', 'TV-ACCESSORY-ETI', 'AUDIO-LG', 'TV-43-SMRT-UNION AIRE', 'BLENDER-TORNADO', 'DEEP FREEZER-LG', 'MIXER-ULTRA', 'KITCHEN M-HOME TECH', 'AC-HOT/COLD-3HP-MIDEA', 'JUICER-HOME TECH', 'HOBS-ELBA', 'COMPLEMENTARY-CANON', 'TV-43-TORNADO', 'F.PROC-BOSCH', 'COFFEE M-MIENTA', 'OVEN-FRANKE', 'FRIDGE-BOSCH', 'BLENDER-SONAI', 'DEEP FREEZER-KIRIAZI', 'WASHING M-ZANUSSI', 'GIFT-INFINX', 'TV-ACCESSORY-ORIGINAL', 'HOOD-TOUCH', 'AUDIO-F&D', 'KETTLE-TORNADO', 'KETTLE-MEDIA TECH', 'E.HOT PLATE-SMART', 'TV-55-SMRT-LG', 'KETTLE-ZAHRAN', 'KETTLE-MIENTA', 'WASHING M-ARISTON', 'IRON-TORNADO', 'CURL IRONS-BABYLISS', 'H.BLENDER-SARY', 'AIR FRYER-KENWOOD', 'ESPRESSO MACH-ARIETE', 'FRIDGE-ELECTROSTAR', 'AC-HOT/COLD-1.5HP-MIDEA', 'LAPTOP-LENOVO', 'COMPLEMENTARY-BENQ', 'BMOBILE ACCESSORIES-NI', 'ELE HEATER-TORNADO', 'COOKER-ZANUSSI', 'AC-HOT/COLD-1.5HP-CARRIERE', 'ELE HEATER-FLYON', 'COMPLEMENTARY-SAMSUNG', 'FRAYER-MIENTA', 'LAPTOP-MSI', 'VC-SMART', 'DEEP FREEZER-ALASKA', 'MOBILE-APPLE', 'IRON-BRAUN', 'MICROWAVE-SHARP', 'AC-COLD-1.5HP-MIDEA', 'ELE HEATER-ATLANTIC', 'MICROWAVE-SMART', 'BLENDER-BLACK AND DECAR', 'AC ACCESSORY-HAIER', 'LAPTOP-MICROSOFT', 'D WASHER-BEKO', 'OVEN-ULTRA', 'STRAIGHTNERS-RUSH BRUSH', 'COFFEE M-OKKA', 'AIR COOLER-SONAI', 'TV-43-SMRT-LG', 'WD-BERGEN', 'HOOD-GORENJE', 'IRON-SOLAC', 'OVEN-HOME TECH', 'FRIDGE-WHITE POINT', 'GAS HEATER-ARISTON', 'F.PROC-SONAI', 'COOKER-LA GERMANYA', 'BMOBILE ACCESSORIES-LOGITECH', 'TV-ACCESSORY-ELIOS', 'BLENDER-HOME TECH', 'MOBILE-NOKIA', 'TV-ACCESSORY-LG', 'H.MIXER-SMART', 'AC-HOT/COLD-1.5HP-HAIER', 'FRIDGE-ZANUSSI', 'GAS HEATER-OLYMPIC', 'FRIDGE-BEKO', 'DEEP FREEZER-FRESH', 'DEEP FREEZER-UNION AIRE', 'GRILL-KENWOOD', 'M.MINCER-BLACK AND WHITE', 'COFFEE M-KENWOOD', 'VC-BLACK AND DECAR', 'TV-55-SMRT-HI-SAMSUNG', 'AUDIO-FIRST', 'WD-WHITE WHALE', 'TV-43-SMRT-PREMIUM', 'AC-HOT/COLD-2.25HP-TORNADO', 'KETTLE-BLACK AND WHITE', 'FRAYER-FRESH', 'GAS HEATER-KIRIAZI', 'TV-32-FRESH', 'TOASTER-HOME TECH', 'MOBILE-SAMSUNG', 'RECEIVER-TRUMAN', 'TABLET-LENOVO', 'GRILL-FRESH', 'M.MINCER-TOUCH', 'M.MINCER-SMART', 'TV-ACCESSORY-TRUMAN', 'COFFEE M-SONAI', 'COOKER-FRESH', 'HAIR DRYER-BABYLISS', 'AC ACCESSORY-DAIKIN', 'WASHING M-Toshiba', 'TV-FRAME-SAMSUNG', 'COFFEE M-SMART', 'STRAIGHTNERS-PHILIPS', 'JUICER-MIENTA', 'COFFEE M-BIALETTI', 'FRIDGE-SHARP', 'MIXER-MEDIA TECH', 'IRON-SMART', 'KETTLE-SMART', 'FRIDGE-MIELE', 'AC-HOT/COLD-4HP-SHARP', 'TV-55-SMRT-HI-LG', 'AC-HOT/COLD-1.5HP-ULTRA', 'KETTLE-HOUSECOM', 'VC-KENWOOD', 'FRAYER-HOME TECH', 'KETTLE-KENWOOD', 'TV-50-SMRT-UNION AIRE', 'FAN-NIKAI', 'F.PROC-ARIETE', 'F.PROC-BLACK AND DECAR', 'TV-32-SMRT-SHARP', 'CHOPPER-TORNADO', 'TV-ACCESSORY-ITEL', 'KETTLE-SONAI', 'BLENDER-MIENTA', 'AC-HOT/COLD-1.5HP-LG', 'AC-COLD-2.25HP-LG', 'FAN-UNION AIRE', 'COFFEE M-BRAUN', 'WD-ULTRA', 'H.BLENDER-BLACK AND DECAR', 'D WASHER-BOSCH', 'TV-70-SMRT-LG', 'CHOPPER-MEDIA TECH', 'HOBS-BRANDT', 'FRAYER-BLACK AND DECAR', 'TV-43-ULTRA', 'D WASHER-FRESH', 'SHAVING_TRI-BRAUN', 'AC-HOT/COLD-4HP-CARRIERE', 'HOOD-TORNADO', 'TOASTER-BLACK AND DECAR', 'IRON-TEFAL', 'GRILL-MODEX', 'H.MIXER-MODEX', 'HOOD-FRANKE', 'COFFEE M-BLACK AND DECAR', 'TV-32-LG', 'H.MIXER-BOSCH', 'FRAYER-PHILIPS', 'TV-65-SMRT-HI-SAMSUNG', 'AC-HOT/COLD-1.5HP-ZANUSSI', 'BMOBILE ACCESSORIES-DAHUA', 'TV-86-SMRT-LG', 'OVEN-ARISTON', 'MICROWAVE-TORNADO', 'TV-43-SMRT-TORNADO', 'WD-SPEED', 'F.PROC-SMART', 'NON', 'TV-32-SMRT-SONY', 'OVEN-INDESIT', 'KETTLE-HOME TECH', 'OVEN-TOUCH', 'AC-HOT/COLD-3HP-CARRIERE', 'AC ACCESSORY-FRESH', 'TV-ACCESSORY-ICONZ', 'IRON-BLACK AND DECAR', 'COFFEE M-BOSCH', 'F.PROC-MOULINEX', 'HOOD-FRESH', 'COFFEE M-MEDIA TECH', 'FRIDGE-HAIER', 'GRILL-BLACK AND DECAR', 'AC ACCESSORY-UNION AIRE', 'WASHING M-BEKO', 'CHOPPER-MIENTA', 'BLENDER-FRESH', 'IRON-TOUCH', 'KETTLE-PANASONIC', 'WASHING M-INDESIT', 'MASHER-MIENTA', 'KITCHEN M-BOSCH', 'D WASHER-BeKO', 'HOOD-BOSCH', 'ELE HEATER-FRESH', 'HOBS-ARISTON', 'TV-32-ULTRA', 'ELE HEATER-ARISTON', 'AC-COLD-2.25HP-CRAFT', 'FAN-FRESH', 'RECEIVER-DALY', 'SHAVING_TRI-TORNADO', 'M.MINCER-MOULINEX', 'MOBILE-INFINX', 'TV-ACCESSORY-HAMA', 'BLENDER-BLACK AND WHITE', 'AUDIO-MEDIA TECH', 'GAS HEATER-UNIVERSAL', 'FRIDGE-UNION AIRE', 'HOOD-ARISTON', 'BMOBILE ACCESSORIES-MUTECH', 'M.MINCER-PANASONIC', 'RECEIVER-SKYWORTH ZAPPER', 'WASHING M-SHARP', 'TV-43-LG', 'HOBS-FRESH', 'AC-HOT/COLD-1.5HP-AMERICOOL', 'HAIR DRYER-RUSH BRUSH', 'SHAVING_TRI-PHILIPS', 'HOOD ASS-INDESIT', 'TV-70-SMRT-SAMSUNG', 'WASHING M-TOSHIBA', 'TV-65-SMRT-TOSHIBA', 'STRAIGHTNERS-REMINGTON', 'WARMER-BLACK AND DECAR', 'H.MIXER-TORNADO', 'H.BLENDER-TOUCH', 'D WASHER-LG', 'BLENDER-TOUCH', 'FRAYER-DELONGHI', 'AC-HOT/COLD-2.25HP-LG', 'BMOBILE ACCESSORIES-LAVVENTO', 'DEEP FREEZER-WHITE WHALE', 'COFFEE M-MODEX', 'JUICER-MOULINEX', 'AC-COLD-2.25HP-ULTRA', 'TV-ACCESSORY-KEENDEX', 'FRIDGE-PASSAP', 'COFFEE M-TEFAL', 'AC-COLD-2.25HP-FRESH', 'TV-32-SMRT-TOSHIBA', 'AIR PURIFIER-SHARP', 'H.BLENDER-MEDIA TECH', 'HOOD-PREMIER', 'TV-65-SMRT-TORNADO', 'FRIDGE-FRESH', 'CURL IRONS-RUSH BRUSH', 'VC-PANASONIC', 'WASHING M-HOOVER', 'MIXER-TOUCH', 'AUDIO-SONY', 'IRON-BLACK AND WHITE', 'M.MINCER-TORNADO', 'AC-HOT/COLD-3HP-TORNADO', 'ELE HEATER-UNIVERSAL', 'TV-50-SMRT-TOSHIBA', 'COOKING APPLIANCES-ARIETE', 'THERMAL VESSEL-TANK', 'KETTLE-FRESH', 'BLENDER-BRAUN', 'AIR COOLER-HOME TECH', 'OVEN-BOSCH', 'AC-HOT/COLD-3HP-PREMIUM', 'WD-FRESH', 'WARMER-MEDIA TECH', 'FRIDGE-KIRIAZI', 'THERMAL VESSEL-TIGER', 'HOBS-BEKO', 'H.MIXER-BRAUN', 'TV-32-SMRT-TORNADO', 'D WASHER-WHITE POINT', 'MIXER-BLACK AND DECAR', 'OVEN-TORNADO', 'WASHING M-HAIER', 'AC-COLD-3HP-MIDEA', 'TV-85-SMRT-HI-SAMSUNG', 'CHOPPER-SONAI', 'COFFEE M-DELONGHI', 'DEEP FREEZER-SHARP', 'BLENDER-BOSCH', 'RECEIVER-MUTECH', 'CHOPPER-MOULINEX', 'CHOPPER-FRESH', 'FILTER 6 STAGES-SEASONS', 'WALL HOOD-FRESH', 'AC-HOT/COLD-1.5HP-PREMIUM', 'M.MINCER-KENWOOD', 'H.MIXER-TOUCH', 'MOBILE-VIVO', 'WASHER DRYER-LG', 'F.PROC-MODEX', 'TABLET-SAMSUNG', 'HOOD-ICOOK', 'E.HOT PLATE-TOUCH', 'BLENDER-SARY', 'MOBILE-HONOR', 'GAS HEATER-TORNADO', 'TV-32-SONY', 'HOOD-BeKO', 'LAPTOP-HP', 'GAS HEATER-FRESH', 'FAN-BLACK AND DECAR', 'KITCHEN M-FRESH', 'VC-MIELE', 'TV-32-SMRT-PREMIUM', 'AC-COLD-1.5HP-UNION AIRE', 'VC-BISSELL', 'FUN LINE-MIENTA', 'WASHING M-UNION AIRE', 'BLENDER-MEDIA TECH', 'CHOPPER-ROVO', 'AC-COLD-1.5HP-CARRIERE', 'TV-ACCESSORY-FALCON', 'TV-60-SMRT-TORNADO', 'F.PROC-BRAUN', 'TV-50-SMRT-SAMSUNG', 'HOOD-BEKO', 'TOOLS-BOSCH', 'AIR STYLER-RUSH BRUSH', 'AC-COLD-2.25HP-SHARP', 'E.HOT PLATE-HOME TECH', 'TV-85-SMRT-HI-LG', 'RECIEVER-TIGER', 'STRAIGHTNERS-BRAUN', 'SHAVING_TRI-HAPILLINE', 'COMPLEMENTARY-NIKON', 'HOBS-MIELE', 'TV-75-SMRT-LG', 'BLENDER-PANASONIC', 'TV-43-SMRT-TOSHIBA', 'AIR COOLER-FRESH', 'HAIR DRYER-TORNADO', 'KETTLE-TOUCH']} the_received_subfilter
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
454.151284962 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('353.5911896256797424')), ('initial_average_retail_price', Decimal('28188.302491282051')), ('proposed_sellthru_percent', Decimal('0.63354627527585660736')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('25.3879942980835225')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 25.387994298083523), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 150239063.96797785), ('budget_cost', 115267370.42000023), ('deficit', Decimal('150239063.9603')), ('Original_BudgetAmount', Decimal('150239063.9603')), ('budget_percent', Decimal('100.0095')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 192005.0), ('ACT_FCT', Decimal('1258280.0000')), ('Original_BudgetCostofGoods', Decimal('115267370.4200')), ('PO', Decimal('24788606.6125')), ('COSTPRICE', 3901646.88), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('1258280.0000')), ('stock_on_hand_qty', Decimal('53732')), ('net_sales_ly', Decimal('10434110.1300')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('10494153.3400')), ('total_sku_count', Decimal('17678')), ('ly_customer_disc', Decimal('60043.2100')), ('SupplyCost', Decimal('109504001.8990')), ('SALESQTY', 1837.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('99.6365')), ('budget_qty_act_fct_percent', Decimal('19193211.8610')), ('budget_vs_py_qty_percent', Decimal('19150502.3458')), ('budget_vs_ppy_qty_percent', Decimal('19200500.0000')), ('QTY_Buy_By_SKU', Decimal('192005.0000')), ('total_sku_count_ty', Decimal('178010385')), ('total_sku_count_lly', Decimal('1')), ('total_sku_count_ly', Decimal('123')), ('quantity_mix_percent', Decimal('100.0017')), ('quantity_act_forecast', Decimal('192202.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('1640.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('65000.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.8798')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('115267370.4200')), ('budget_vs_py_cost_percent', Decimal('236654748.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('2104431.3600')), ('cost_of_goods_ly', Decimal('1797215.5200')), ('cost_act_forecast', Decimal('117371801.7800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('4445104381.8106')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('-846151.3600')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('11.4814')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('8498.6499')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('8498.6499')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
454.354431804 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 353.59119 ┆ 28188.302 ┆ … ┆ 0.0       ┆ 8498.6499 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆           ┆ 491       ┆   ┆           ┆           ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 82.775575         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 60043.21   ┆ 1.0434e7   ┆ 1.5024e8   ┆ 27.113496 ┆ 1.5110e8  ┆ 0.633546  ┆ 2.3850e10 ┆ 0.572159  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A998133BE0>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A998132410>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A998133E80>, <Expr ['col("initial_average_retail_pr…'] at 0x76A998130640>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A998133C70>, <Expr ['col("retail_value_including_ma…'] at 0x76A998133760>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A998133C10>, <Expr ['col("Logistic%").mean()'] at 0x76A998133850>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A9981323E0>, <Expr ['col("MarkdownValue").mean()'] at 0x76A998133C40>, <Expr ['col("markdown_percent").mean()'] at 0x76A9981305E0>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A9981336A0>, <Expr ['col("budget_amount").sum()'] at 0x76A9981324D0>, <Expr ['col("budget_cost").sum()'] at 0x76A9981324A0>, <Expr ['col("deficit").sum()'] at 0x76A998133E20>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A9981323B0>, <Expr ['col("budget_percent").sum()'] at 0x76A9981326E0>, <Expr ['col("relative_budget_percent")…'] at 0x76A9981337F0>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A9981327A0>, <Expr ['col("budget_qty").sum()'] at 0x76A998132740>, <Expr ['col("ACT_FCT").sum()'] at 0x76A9981326B0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A9981336D0>, <Expr ['col("PO").sum()'] at 0x76A9981329E0>, <Expr ['col("COSTPRICE").sum()'] at 0x76A998132830>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A998132710>, <Expr ['col("sales_actual").sum()'] at 0x76A998132A70>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A998133700>, <Expr ['col("net_sales_ly").sum()'] at 0x76A998132BC0>, <Expr ['col("net_sales_lly").sum()'] at 0x76A998132AA0>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A998132C20>, <Expr ['col("total_sku_count").sum()'] at 0x76A998132680>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A998132BF0>, <Expr ['col("SupplyCost").sum()'] at 0x76A998132CB0>, <Expr ['col("SALESQTY").sum()'] at 0x76A998133B20>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A998132CE0>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A998132D40>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A998132530>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A9981328C0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A998132EF0>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A998132A40>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A998132FE0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A998133640>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A998133130>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A998133010>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A998132FB0>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A998133040>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A998133220>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A998133070>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A998132DA0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A9981331C0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A9981333A0>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A998133340>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A998132E60>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A9981327D0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A998133EE0>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A9981334C0>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A9981333D0>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A998133400>, <Expr ['col("cost_actuals").sum()'] at 0x76A998133A60>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A998133490>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A998132C80>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A9981322F0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A998133580>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A998133A90>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A998133280>, <Expr ['col("budget_margin_percent").s…'] at 0x76A998132170>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A998132320>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A9981320B0>, <Expr ['col("margin_actuals").sum()'] at 0x76A998133430>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A9981321D0>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A998131F90>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A998133100>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A998132260>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A998131FC0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A998132200>, <Expr ['col("initial_average_retail_pr…'] at 0x76A998132EC0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A9981300A0>, <Expr ['col("budget_per_sku").sum()'] at 0x76A9981321A0>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A9981335E0>, <Expr ['col("Check_box").max()'] at 0x76A9981301C0>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,353.5911896257,28188.3024912821,0.6335462753,151103616.4363379478,23.2773638389,5.0,23.2773638389,6004320.9999999991,0.5721586874,0.0,150239063.9679778516,115267370.4200002253,150239063.9602999985,150239063.9602999985,100.0,100.0,0.0,192005.0,1258280.0,115267370.4200000018,24788606.6125000007,3901646.8799999999,0.0,1258280.0,53732.0,10434110.1300000008,0.0,10494153.3399999999,17678.0,60043.21,109504001.8990000039,1837.0,0.0,0.0,99.6365,19193211.8610000014,19150502.3458000012,19200500.0,192005.0,178010385.0,1.0,123.0,100.0017,192202.0,0.0,1640.0,65000.0,0.0,0.0,0.8798,0.0,0.0,115267370.4200000018,236654748.0,0.0,0.0,2104431.3599999999,1797215.52,117371801.7800000012,0.0,0.0,0.0,0.0,4445104381.8106002808,0.0,0.0,-846151.36,0.0,11.4814,0.0,8498.6499,0.0,0.0,0.0,0.0,8498.6499,0.0,0.0,1439.8838242661,0.0,12.0592938384,10229.918699187,0.0,125828000.0,27.113495647,1514613869.4615671635,82.7755745568,8636894.6100000013,0.0,0.0,34971693.5479776263,422488.0797893735,1514613869.4615671635,260883536.6973055303,1514613869.4615671635,151103616.4363379478,150239063.9679778516,23850446657.6723060608,17383756841.3659172058,28956748.2988865152]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":353.5911896257,"initial_average_retail_price":28188.3024912821,"proposed_sellthru_percent":0.6335462753,"retail_value_including_markdown":151103616.4363379478,"budget_gross_margin_percent":23.2773638389,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":23.2773638389,"MarkdownValue":6004320.9999999991,"markdown_percent":0.5721586874,"DisplayItemValue":0.0,"budget_amount":150239063.9679778516,"budget_cost":115267370.4200002253,"deficit":150239063.9602999985,"Original_BudgetAmount":150239063.9602999985,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":192005.0,"ACT_FCT":1258280.0,"Original_BudgetCostofGoods":115267370.4200000018,"PO":24788606.6125000007,"COSTPRICE":3901646.8799999999,"Historical_Gross_Margin":0.0,"sales_actual":1258280.0,"stock_on_hand_qty":53732.0,"net_sales_ly":10434110.1300000008,"net_sales_lly":0.0,"gross_sales_ly":10494153.3399999999,"total_sku_count":17678.0,"ly_customer_disc":60043.21,"SupplyCost":109504001.8990000039,"SALESQTY":1837.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":99.6365,"budget_qty_act_fct_percent":19193211.8610000014,"budget_vs_py_qty_percent":19150502.3458000012,"budget_vs_ppy_qty_percent":19200500.0,"QTY_Buy_By_SKU":192005.0,"total_sku_count_ty":178010385.0,"total_sku_count_lly":1.0,"total_sku_count_ly":123.0,"quantity_mix_percent":100.0017,"quantity_act_forecast":192202.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":1640.0,"quantity_act_forecast_vs_ly_percent":65000.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.8798,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":115267370.4200000018,"budget_vs_py_cost_percent":236654748.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":2104431.3599999999,"cost_of_goods_ly":1797215.52,"cost_act_forecast":117371801.7800000012,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":4445104381.8106002808,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":-846151.36,"margin_act_forecast":0.0,"units_per_sku_total":11.4814,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":8498.6499,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":8498.6499,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":82.7755745568,"FirstMargin_percent":27.113495647,"budget_vpy":1439.8838242661,"budget_vppy":0.0,"StockatRetailPrice":1514613869.4615671635,"TYForecast":1514613869.4615671635,"LYvsACT_FCT_percent":0.0,"supply_retail_value":150239063.9679778516} } data_json
INFO:     106.51.119.229:0 - "OPTIONS /otb/export/to_excel HTTP/1.1" 200 OK
INFO:     106.51.119.229:0 - "POST /otb/export/to_excel HTTP/1.1" 200 OK
{'history_date_range': {'fro': '2023-01-01', 'to': '2023-01-05'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-05'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 353.5911896257, 'initial_average_retail_price': 28188.3024912821, 'proposed_sellthru_percent': 0.6335462753, 'retail_value_including_markdown': 151103616.43633795, 'budget_gross_margin_percent': 23.2773638389, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 23.2773638389, 'MarkdownValue': 6004320.999999999, 'markdown_percent': 0.5721586874, 'DisplayItemValue': 0, 'budget_amount': 150239063.96797785, 'budget_cost': 115267370.42000023, 'deficit': 150239063.9603, 'Original_BudgetAmount': 150239063.9603, 'budget_percent': 100, 'relative_budget_percent': 100, 'History_Net_Sales': 0, 'budget_qty': 192005, 'ACT_FCT': 1258280, 'Original_BudgetCostofGoods': 115267370.42, 'PO': 24788606.6125, 'COSTPRICE': 3901646.88, 'Historical_Gross_Margin': 0, 'sales_actual': 1258280, 'stock_on_hand_qty': 53732, 'net_sales_ly': 10434110.13, 'net_sales_lly': 0, 'gross_sales_ly': 10494153.34, 'total_sku_count': 17678, 'ly_customer_disc': 60043.21, 'SupplyCost': 109504001.899, 'SALESQTY': 1837, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 99.6365, 'budget_qty_act_fct_percent': 19193211.861, 'budget_vs_py_qty_percent': 19150502.3458, 'budget_vs_ppy_qty_percent': 19200500, 'QTY_Buy_By_SKU': 192005, 'total_sku_count_ty': 178010385, 'total_sku_count_lly': 1, 'total_sku_count_ly': 123, 'quantity_mix_percent': 100.0017, 'quantity_act_forecast': 192202, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 1640, 'quantity_act_forecast_vs_ly_percent': 65000, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.8798, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 115267370.42, 'budget_vs_py_cost_percent': 236654748, 'budget_vs_ppy_cost_percent': 0, 'cost_mix_percent': 0, 'cost_actuals': 2104431.36, 'cost_of_goods_ly': 1797215.52, 'cost_act_forecast': 117371801.78, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 4445104381.8106, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': -846151.36, 'margin_act_forecast': 0, 'units_per_sku_total': 11.4814, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 8498.6499, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 8498.6499, 'budget_qty_ty': 0, 'Check_box': 0, 'budget_vpy': 1439.8838242661, 'budget_vppy': 0, 'LYvsACT_FCT_percent': 12.0592938384, 'SALES_ACT_FCT_per_sku_ly': 10229.918699187, 'LLYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_lly': 125828000, 'FirstMargin_percent': 27.113495647, 'PurchasedRetailValueGrossSale': 1514613869.4615672, 'ly_margin_percent': 82.7755745568, 'ly_margin': 8636894.610000001, 'margin_act_forecast_vs_ly_margin_percent': 0, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 34971693.54797763, 'budget_vs_py_margin_percent': 422488.0797893735, 'StockatRetailPrice': 1514613869.4615672, 'StockatCostPrice': 260883536.69730553, 'TYForecast': 1514613869.4615672, 'GrossSales': 151103616.43633795, 'supply_retail_value': 150239063.96797785, 'PurchaseRetailValueatGrossSale': 23850446657.672306, 'OTBorPurchaseCost': 17383756841.365917, 'OTBquantity': 28956748.298886515}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-01-01', to='2023-01-05') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-05') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
[] [] the expand heirarchy
sku wise calc executed
455.513585654 end of sku wise stored proc
we are finding corr ex2
['Channel'] FILTERDATA5
drilldown procedure start
conn established
['Channel'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] []   get_sp_otb_expand_heirarchy
sku wise calc executed
455.535354833 end of sku wise stored proc
conn established
[OrderedDict([('Channel', None), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('44.0510204081632653')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 44.05102040816327), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 1288477.4663408813), ('budget_cost', 675154.3900000006), ('deficit', Decimal('1288477.4666')), ('Original_BudgetAmount', Decimal('1288477.4666')), ('budget_percent', Decimal('0.8582')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 203.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('675154.3900')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', None), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('93')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('641396.6705')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.1042')), ('budget_qty_act_fct_percent', Decimal('20300.0000')), ('budget_vs_py_qty_percent', Decimal('20300.0000')), ('budget_vs_ppy_qty_percent', Decimal('20300.0000')), ('QTY_Buy_By_SKU', Decimal('203.0000')), ('total_sku_count_ty', Decimal('889328')), ('total_sku_count_lly', Decimal('1')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('203.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0053')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('675154.3900')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('675154.3900')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('68912899.6342')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0145')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('72.8863')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('72.8863')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'B.TECH X'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('24.2931696085955487')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 24.293169608595548), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 4945255.931871956), ('budget_cost', 4322093.119999993), ('deficit', Decimal('4945255.9300')), ('Original_BudgetAmount', Decimal('4945255.9300')), ('budget_percent', Decimal('3.2911')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 4151.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('4322093.1200')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('688')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('1237')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('4105988.4640')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('2.1354')), ('budget_qty_act_fct_percent', Decimal('415100.0000')), ('budget_vs_py_qty_percent', Decimal('415100.0000')), ('budget_vs_ppy_qty_percent', Decimal('415100.0000')), ('QTY_Buy_By_SKU', Decimal('4151.0000')), ('total_sku_count_ty', Decimal('11206979')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('4151.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0307')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('4322093.1200')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('4322093.1200')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('114196374.1891')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.2843')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('279.7416')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('279.7416')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'CALL CENTER'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('25.2000000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 25.2), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 95996.485350943), ('budget_cost', 68977.08), ('deficit', Decimal('95996.4853')), ('Original_BudgetAmount', Decimal('95996.4853')), ('budget_percent', Decimal('0.0639')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 17.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('68977.0800')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('2')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('14')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('65528.2260')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0086')), ('budget_qty_act_fct_percent', Decimal('1700.0000')), ('budget_vs_py_qty_percent', Decimal('1700.0000')), ('budget_vs_ppy_qty_percent', Decimal('1700.0000')), ('QTY_Buy_By_SKU', Decimal('17.0000')), ('total_sku_count_ty', Decimal('170950')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('17.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0005')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('68977.0800')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('68977.0800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('2732640.5350')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0016')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('5.4302')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('5.4302')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'MINI'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0.11829176470588235294')), ('initial_average_retail_price', Decimal('4749.0700000000000000')), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('28.6235294117647059')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 28.623529411764707), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 226709.1686105523), ('budget_cost', 176745.60000000003), ('deficit', Decimal('226709.1687')), ('Original_BudgetAmount', Decimal('226709.1687')), ('budget_percent', Decimal('0.1516')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 97.0), ('ACT_FCT', Decimal('8393.0000')), ('Original_BudgetCostofGoods', Decimal('176745.6000')), ('PO', Decimal('18508.7400')), ('COSTPRICE', 8287.779999999999), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('8393.0000')), ('stock_on_hand_qty', Decimal('52')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('83')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('167908.3200')), ('SALESQTY', 0.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0487')), ('budget_qty_act_fct_percent', Decimal('9500.0000')), ('budget_vs_py_qty_percent', Decimal('9700.0000')), ('budget_vs_ppy_qty_percent', Decimal('9700.0000')), ('QTY_Buy_By_SKU', Decimal('97.0000')), ('total_sku_count_ty', Decimal('844315')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('97.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0011')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('176745.6000')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('8287.7800')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('185033.3800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('5140946.8612')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('105.2200')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0086')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('12.8248')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('12.8248')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'WAREHOUSE'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('26.4899702823179792')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 26.48997028231798), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 80345177.20993643), ('budget_cost', 59527051.87000043), ('deficit', Decimal('80345177.2078')), ('Original_BudgetAmount', Decimal('80345177.2078')), ('budget_percent', Decimal('53.4827')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 24409.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('59527051.8700')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('40948')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('5136')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('56550699.2765')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('12.6162')), ('budget_qty_act_fct_percent', Decimal('2440900.0000')), ('budget_vs_py_qty_percent', Decimal('2440900.0000')), ('budget_vs_ppy_qty_percent', Decimal('2440900.0000')), ('QTY_Buy_By_SKU', Decimal('24409.0000')), ('total_sku_count_ty', Decimal('50251204')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('1')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('24409.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.4870')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('59527051.8700')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('59527051.8700')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('2392836823.9956')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('1.5340')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('4544.9244')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('4544.9244')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))])] 11 getData dictsize
455.761676267 end of fetch data
shape: (11, 81)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ Channel   ┆ final_pri ┆ act_forec ┆ SalesActu ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ---       ┆ ce        ┆ ast_vs_bu ┆ alsByFore ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ str       ┆ ---       ┆ dget_perc ┆ cast      ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│           ┆ f64       ┆ ent       ┆ ---       ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆           ┆ ---       ┆ f64       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆           ┆ f64       ┆           ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0         ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 72.8863   ┆ 0.0       ┆ 0.0      │
│ B.TECH X  ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 279.7416  ┆ 0.0       ┆ 0.0      │
│ CALL      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 5.4302    ┆ 0.0       ┆ 0.0      │
│ CENTER    ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆          │
│ MINI      ┆ 0.0       ┆ 0.0       ┆ 0.118292  ┆ … ┆ 0.0       ┆ 12.8248   ┆ 0.0       ┆ 0.0      │
│ WAREHOUSE ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 4544.9244 ┆ 0.0       ┆ 0.0      │
│ DEEL      ┆ 0.0       ┆ 0.0       ┆ 3.662721  ┆ … ┆ 0.0       ┆ 357.6871  ┆ 0.0       ┆ 0.0      │
│ ARKAN     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 8.0669    ┆ 0.0       ┆ 0.0      │
│ NON       ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 3.3955    ┆ 0.0       ┆ 0.0      │
│ B2B       ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 8.707     ┆ 0.0       ┆ 0.0      │
│ Retail    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 2985.2254 ┆ 0.0       ┆ 0.0      │
│ ONLINE    ┆ 0.0       ┆ 0.0       ┆ 18198.274 ┆ … ┆ 0.0       ┆ 219.7607  ┆ 0.0       ┆ 0.0      │
│           ┆           ┆           ┆ 712       ┆   ┆           ┆           ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 172.691474        │
└───────────────────┘ ly_mgn
shape: (11, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 1.2885e6   ┆ 50.220575 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 4.9453e6   ┆ 16.971163 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 95996.4853 ┆ 31.738932 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 51         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 226709.168 ┆ 25.936688 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 611        ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 8.0345e7   ┆ 29.615316 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 53177.21   ┆ 3.9962e6   ┆ 6.3232e6   ┆ 77.406769 ┆ 6.4073e6  ┆ 44.444444 ┆ 1.4417e7  ┆ 1.313231  │
│ 0.0        ┆ 0.0        ┆ 142607.577 ┆ 60.288713 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 997        ┆           ┆           ┆           ┆           ┆           │
│ 34.0       ┆ 415.0      ┆ 60023.4919 ┆ 11.188841 ┆ 64941.079 ┆ 11.111111 ┆ 584469.71 ┆ 7.572383  │
│            ┆            ┆ 68         ┆           ┆ 262       ┆           ┆ 3359      ┆           │
│ 0.0        ┆ 0.0        ┆ 153922.557 ┆ -26.18110 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 282        ┆ 4         ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 5.2773e7   ┆ 18.183849 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 6832.0     ┆ 6.43753e6  ┆ 3.8849e6   ┆ 21.155395 ┆ 3.8891e6  ┆ 19.293478 ┆ 2.0157e7  ┆ 0.106015  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['Channel', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A59BF27D30>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A59BF27F10>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A59BF27AF0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A59BF27BB0>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A59BF27A00>, <Expr ['col("retail_value_including_ma…'] at 0x76A59BF27730>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A59BF27940>, <Expr ['col("Logistic%").mean()'] at 0x76A59BF27C70>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A59BF274F0>, <Expr ['col("MarkdownValue").mean()'] at 0x76A59BF27550>, <Expr ['col("markdown_percent").mean()'] at 0x76A59BF275E0>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A59BF27F70>, <Expr ['col("budget_amount").sum()'] at 0x76A59BF27790>, <Expr ['col("budget_cost").sum()'] at 0x76A59BF24C40>, <Expr ['col("deficit").sum()'] at 0x76A59BF27490>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A59BF27640>, <Expr ['col("budget_percent").sum()'] at 0x76A59BF27BE0>, <Expr ['col("relative_budget_percent")…'] at 0x76A59BF27130>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A59BF271C0>, <Expr ['col("budget_qty").sum()'] at 0x76A59BF26F80>, <Expr ['col("ACT_FCT").sum()'] at 0x76A59BF279A0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A59BF27220>, <Expr ['col("PO").sum()'] at 0x76A59BF27160>, <Expr ['col("COSTPRICE").sum()'] at 0x76A59BF27190>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A59BF27430>, <Expr ['col("sales_actual").sum()'] at 0x76A59BF26FB0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A59BF26C20>, <Expr ['col("net_sales_ly").sum()'] at 0x76A59BF26E60>, <Expr ['col("net_sales_lly").sum()'] at 0x76A59BF26CB0>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A59BF26E00>, <Expr ['col("total_sku_count").sum()'] at 0x76A59BF26D70>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A59BF26680>, <Expr ['col("SupplyCost").sum()'] at 0x76A59BF267A0>, <Expr ['col("SALESQTY").sum()'] at 0x76A59BF26DA0>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A59BF26AA0>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A59BF26380>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A59BF265F0>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A59BF27370>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A59BF26920>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A59BF273D0>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A59BF26140>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A59BF26050>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A59BF26590>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A59BF268C0>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A59BF261D0>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A59BF262C0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A59BF25D80>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A59BF26410>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A59BF25D50>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A59BF26A40>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A59BF25E40>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A59BF25A50>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A59BF25B40>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A59BF259C0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A59BF25CC0>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A59BF25BD0>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A59BF25FC0>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A59BF25990>, <Expr ['col("cost_actuals").sum()'] at 0x76A59BF256F0>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A59BF25BA0>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A59BF25F00>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A59BF25540>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A59BF25660>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A59BF25480>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A59BF25C00>, <Expr ['col("budget_margin_percent").s…'] at 0x76A59BF25840>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A59BF255A0>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A59BF251B0>, <Expr ['col("margin_actuals").sum()'] at 0x76A59BF25600>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A59BF24FD0>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A59BF253C0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A59BF25750>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A59BF26980>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A59BF25000>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A59BF253F0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A59BF24F70>, <Expr ['col("initial_average_retail_pr…'] at 0x76A59BF24EB0>, <Expr ['col("budget_per_sku").sum()'] at 0x76A59BF25630>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A59BF24AF0>, <Expr ['col("Check_box").max()'] at 0x76A59BF24F10>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Channel","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9],"data":[["0",0.0,0.0,0.0,0.0,0.0,null,47.600605549,5.0,47.600605549,null,null,0.0,1288477.4663408813,675154.3900000006,1288477.4665999999,1288477.4665999999,0.8576181403,0.8576181403,0.0,203.0,0.0,675154.39,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,93.0,0.0,641396.6705,0.0,0.0,0.0,0.1042,20300.0,20300.0,20300.0,203.0,889328.0,1.0,0.0,0.0,203.0,0.0,0.0,0.0,0.0,0.0,0.0053,0.0,0.0,675154.39,0.0,0.0,0.0,0.0,0.0,675154.39,0.0,0.0,0.0,0.0,68912899.6342000067,0.0,0.0,0.0,0.0,0.0145,0.0,72.8863,0.0,0.0,0.0,0.0,72.8863,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,50.2205752716,0.0,0.0,0.0,null,0.0,613323.0763408807,0.0,0.0,0.0,0.0,0.0,1288477.4663408811,null,null,null],["B.TECH X",0.0,0.0,0.0,0.0,0.0,null,12.6012246981,5.0,12.6012246981,null,null,0.0,4945255.9318719562,4322093.1199999927,4945255.9299999997,4945255.9299999997,3.2915912821,3.2915912821,0.0,4151.0,0.0,4322093.1200000001,0.0,0.0,0.0,0.0,688.0,0.0,0.0,0.0,1237.0,0.0,4105988.4640000002,0.0,0.0,0.0,2.1354,415100.0,415100.0,415100.0,4151.0,11206979.0,0.0,0.0,0.0,4151.0,0.0,0.0,0.0,0.0,0.0,0.0307,0.0,0.0,4322093.1200000001,0.0,0.0,0.0,0.0,0.0,4322093.1200000001,0.0,0.0,0.0,0.0,114196374.1890999973,0.0,0.0,0.0,0.0,0.2843,0.0,279.7416,0.0,0.0,0.0,0.0,279.7416,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,16.9711634632,0.0,0.0,0.0,null,0.0,623162.8118719636,0.0,0.0,0.0,0.0,0.0,4945255.9318719562,null,null,null],["CALL CENTER",0.0,0.0,0.0,0.0,0.0,null,28.1462443673,5.0,28.1462443673,null,null,0.0,95996.485350943,68977.08,95996.4853,95996.4853,0.0638958223,0.0638958223,0.0,17.0,0.0,68977.08,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,14.0,0.0,65528.226,0.0,0.0,0.0,0.0086,1700.0,1700.0,1700.0,17.0,170950.0,0.0,0.0,0.0,17.0,0.0,0.0,0.0,0.0,0.0,0.0005,0.0,0.0,68977.08,0.0,0.0,0.0,0.0,0.0,68977.08,0.0,0.0,0.0,0.0,2732640.5350000001,0.0,0.0,0.0,0.0,0.0016,0.0,5.4302,0.0,0.0,0.0,0.0,5.4302,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,31.738932149,0.0,0.0,0.0,null,0.0,27019.405350943,0.0,0.0,0.0,0.0,0.0,95996.485350943,null,null,null],["MINI",0.0,0.0,0.1182917647,4749.07,0.0,null,22.0386184276,5.0,22.0386184276,null,null,0.0,226709.1686105523,176745.6,226709.1687,226709.1687,0.1508989491,0.1508989491,0.0,97.0,8393.0,176745.6,18508.74,8287.78,0.0,8393.0,52.0,0.0,0.0,0.0,83.0,0.0,167908.32,0.0,0.0,0.0,0.0487,9500.0,9700.0,9700.0,97.0,844315.0,0.0,0.0,0.0,97.0,0.0,0.0,0.0,0.0,0.0,0.0011,0.0,0.0,176745.6,0.0,0.0,0.0,8287.78,0.0,185033.38,0.0,0.0,0.0,0.0,5140946.8612000002,0.0,0.0,105.22,0.0,0.0086,0.0,12.8248,0.0,0.0,0.0,0.0,12.8248,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.9366875063,246951.64,0.0,0.0,null,0.0,49963.5686105523,0.0,246951.64,246951.64,246951.64,0.0,226709.1686105523,null,null,null],["WAREHOUSE",0.0,0.0,0.0,0.0,0.0,null,25.910858701,5.0,25.910858701,null,null,0.0,80345177.2099364251,59527051.8700004295,80345177.2078000009,80345177.2078000009,53.4782200367,53.4782200367,0.0,24409.0,0.0,59527051.8699999973,0.0,0.0,0.0,0.0,40948.0,0.0,0.0,0.0,5136.0,0.0,56550699.2765000015,0.0,0.0,0.0,12.6162,2440900.0,2440900.0,2440900.0,24409.0,50251204.0,0.0,1.0,0.0,24409.0,0.0,0.0,0.0,0.0,0.0,0.487,0.0,0.0,59527051.8699999973,0.0,0.0,0.0,0.0,0.0,59527051.8699999973,0.0,0.0,0.0,0.0,2392836823.9956002235,0.0,0.0,0.0,0.0,1.534,0.0,4544.9244,0.0,0.0,0.0,0.0,4544.9244,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,29.615315766,0.0,0.0,0.0,null,0.0,20818125.3399359956,0.0,0.0,0.0,0.0,0.0,80345177.2099364251,null,null,null],["DEEL",0.0,0.0,3.6627212963,36935.6971872727,44.4444444444,6407336.2218467835,76.2176510547,5.0,76.2176510547,5317721.0,1.3132307801,0.0,6323193.1103977878,1503803.8500000001,6323193.1106000002,6323193.1106000002,4.2087543302,4.2087543302,0.0,833.0,54115.0,1503803.8500000001,754103.752,1236770.6299999997,0.0,54115.0,132.0,3996165.1299999999,0.0,4049342.3399999999,106.0,53177.21,1428613.6575,653.0,0.0,0.0,0.4327,81993.3333,49670.4889,83300.0,833.0,1208267.0,0.0,50.0,38.7808,850.0,0.0,636.0,39300.0,0.0,0.0,0.0126,0.0,0.0,1503803.8500000001,96865522.0,0.0,0.0,22183.72,1214586.9099999999,1525987.5700000001,0.0,0.0,0.0,0.0,481938926.0399000049,0.0,0.0,31931.28,0.0,0.0482,0.0,357.6871,0.0,0.0,0.0,0.0,357.6871,0.0,0.0,158.231527094,0.0,1.3541732696,1082.3,0.0,0.0,77.406768502,4875512.0287200008,69.6061881707,2781578.2199999997,0.0,0.0,4819389.2603977881,69237.9425889312,4875512.0287200008,1481853.9517236757,4875512.0287200008,6407336.2218467826,6323193.1103977887,14416506.4991552643,3257154.6872834731,1804.2312197213],["ARKAN",0.0,0.0,0.0,0.0,0.0,null,58.1986449546,5.0,58.1986449546,null,null,0.0,142607.5779967159,59611.9,142607.578,142607.578,0.0949204383,0.0949204383,0.0,5.0,0.0,59611.9,0.0,0.0,0.0,0.0,111.0,0.0,0.0,0.0,4.0,0.0,56631.305,0.0,0.0,0.0,0.0025,500.0,500.0,500.0,5.0,35517.0,0.0,0.0,0.0,5.0,0.0,0.0,0.0,0.0,0.0,0.0006,0.0,0.0,59611.9,0.0,0.0,0.0,0.0,0.0,59611.9,0.0,0.0,0.0,0.0,8299567.7997000003,0.0,0.0,0.0,0.0,0.0004,0.0,8.0669,0.0,0.0,0.0,0.0,8.0669,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,60.2887127069,0.0,0.0,0.0,null,0.0,82995.6779967159,0.0,0.0,0.0,0.0,0.0,142607.5779967159,null,null,null],["NON",0.0,0.0,0.0,449.0,11.1111111111,64941.0792621383,6.5145692797,5.0,6.5145692797,3400.0,7.5723830735,0.0,60023.4919683461,56113.22,60023.4919,60023.4919,0.0399519874,0.0399519874,0.0,9.0,0.0,56113.22,0.0,364.66,0.0,0.0,1.0,415.0,0.0,449.0,9.0,34.0,53307.559,1.0,0.0,0.0,0.0045,900.0,900.0,900.0,9.0,60414.0,0.0,1.0,0.061,9.0,0.0,1.0,100.0,0.0,0.0,0.0005,0.0,0.0,56113.22,36757.0,0.0,0.0,0.0,364.66,56113.22,0.0,0.0,0.0,0.0,391027.1968,0.0,0.0,0.0,0.0,0.0009,0.0,3.3955,0.0,0.0,0.0,0.0,3.3955,0.0,0.0,14463.4920405653,0.0,0.0,0.0,0.0,0.0,11.1888408157,449.0,12.1301204819,50.34,0.0,0.0,3910.2719683461,322.3605218243,449.0,394.5357590361,449.0,64941.0792621383,60023.4919683461,584469.7133592447,519074.3275156626,83.2543373494],["B2B",0.0,0.0,0.0,0.0,0.0,null,-32.8222150215,5.0,-32.8222150215,null,null,0.0,153922.5572821971,204443.35,153922.5573,153922.5573,0.1024517547,0.1024517547,0.0,22.0,0.0,204443.35,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,13.0,0.0,194221.1825,0.0,0.0,0.0,0.0112,2200.0,2200.0,2200.0,22.0,107921.0,0.0,0.0,0.0,22.0,0.0,0.0,0.0,0.0,0.0,0.0016,0.0,0.0,204443.35,0.0,0.0,0.0,0.0,0.0,204443.35,0.0,0.0,0.0,0.0,7361114.7281999998,0.0,0.0,0.0,0.0,0.0015,0.0,8.707,0.0,0.0,0.0,0.0,8.707,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-26.1811042705,0.0,0.0,0.0,null,0.0,-50520.7927178029,0.0,0.0,0.0,0.0,0.0,153922.5572821971,null,null,null],["Retail",0.0,0.0,0.0,0.0,0.0,null,13.8777361444,5.0,13.8777361444,null,null,0.0,52772761.5082185641,45449096.9100005478,52772761.5053000003,52772761.5053000003,35.1258588242,35.1258588242,0.0,161492.0,0.0,45449096.9099999964,0.0,0.0,0.0,0.0,11130.0,0.0,0.0,0.0,10622.0,0.0,43176642.0644999966,0.0,0.0,0.0,83.8796,16149200.0,16149200.0,16149200.0,161492.0,110130820.0,0.0,0.0,0.0,161492.0,0.0,0.0,0.0,0.0,0.0,0.314,0.0,0.0,45449096.9099999964,0.0,0.0,0.0,0.0,0.0,45449096.9099999964,0.0,0.0,0.0,0.0,1293022217.8313000202,0.0,0.0,0.0,0.0,9.5337,0.0,2985.2254,0.0,0.0,0.0,0.0,2985.2254,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,18.1838493372,0.0,0.0,0.0,null,0.0,7323664.5982180163,0.0,0.0,0.0,0.0,0.0,52772761.5082185641,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":11,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":1654.732338638,"initial_average_retail_price":6123.1815561754,"proposed_sellthru_percent":6.8044576197,"retail_value_including_markdown":151103616.4363379776,"budget_gross_margin_percent":25.0263288231,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":25.0263288231,"MarkdownValue":6004321.0,"markdown_percent":0.5721586874,"DisplayItemValue":0.0,"budget_amount":150239063.9679778814,"budget_cost":115267370.4200009704,"deficit":150239063.9602999687,"Original_BudgetAmount":150239063.9602999687,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":192005.0,"ACT_FCT":1258280.0,"Original_BudgetCostofGoods":115267370.4199999869,"PO":24788606.612499997,"COSTPRICE":3901646.879999998,"Historical_Gross_Margin":0.0,"sales_actual":1258280.0,"stock_on_hand_qty":53732.0,"net_sales_ly":10434110.129999999,"net_sales_lly":0.0,"gross_sales_ly":10494153.3399999999,"total_sku_count":17678.0,"ly_customer_disc":60043.21,"SupplyCost":109504001.898999989,"SALESQTY":1837.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":99.6365,"budget_qty_act_fct_percent":19193211.8610000014,"budget_vs_py_qty_percent":19150502.3457999974,"budget_vs_ppy_qty_percent":19200500.0,"QTY_Buy_By_SKU":192005.0,"total_sku_count_ty":178010385.0,"total_sku_count_lly":1.0,"total_sku_count_ly":123.0,"quantity_mix_percent":100.0017,"quantity_act_forecast":192202.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":1640.0,"quantity_act_forecast_vs_ly_percent":65000.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.8798,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":115267370.4199999869,"budget_vs_py_cost_percent":236654748.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":2104431.3600000003,"cost_of_goods_ly":1797215.5199999998,"cost_act_forecast":117371801.7799999863,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":4445104381.8106002808,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":-846151.36,"margin_act_forecast":0.0,"units_per_sku_total":11.4814,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":8498.6499,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":8498.6499,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":82.7755745568,"FirstMargin_percent":27.113495647,"budget_vpy":1439.8838242661,"budget_vppy":0.0,"StockatRetailPrice":329010791.3764178157,"TYForecast":329010791.3764178157,"LYvsACT_FCT_percent":0.0,"supply_retail_value":150239063.9679778814} } data_json
INFO:     106.51.119.229:0 - "POST /otb/export/to_excel HTTP/1.1" 200 OK
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     connection open
{'history_date_range': {'fro': '2023-01-01', 'to': '2023-12-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-12-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': True, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-01-01', to='2023-12-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-12-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
456.829021983 start_to_execute main the stored procedure
conn established
sp executed
456.905335966 end of main the stored procedure
conn established
sku wise calc executed
456.962107536 end of sku wise stored proc
we called the sku wise stored procedure_init
We are getting data from ra_and_stock
456.962239796 started to fetch data
conn established
<function getData.<locals>.<lambda> at 0x769c781fb370> dfafghaf
699.353433272 end of fetch data
(535152, 168) output data shape
111111111111111111111111111111111111111111111
processing...
we are calling main groupby process
1
WebSocket connection closed unexpectedly
1
WebSocket connection closed unexpectedly
1
WebSocket connection closed unexpectedly
1
WebSocket connection closed unexpectedly
1
WebSocket connection closed unexpectedly
1
WebSocket connection closed unexpectedly
1
conn established
sku wise calc executed
703.395492626 end of sku wise stored proc
conn established
[OrderedDict([('id', 241577), ('store', None), ('region', None), ('area', None), ('Channel', 'B.TECH X'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 241578), ('store', None), ('region', None), ('area', None), ('Channel', 'MINI'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 241579), ('store', None), ('region', None), ('area', None), ('Channel', 'WAREHOUSE'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 241580), ('store', None), ('region', None), ('area', None), ('Channel', 'ARKAN'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 241581), ('store', None), ('region', None), ('area', None), ('Channel', 'Retail'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)])] 3303 getData dictsize
703.508920082 end of fetch data
shape: (3_303, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 241577 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 241578 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 241579 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 241580 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 241581 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 244875 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 244876 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 244877 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 244878 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 244879 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the filter dataframe
shape: (3_303, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 241577 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 241578 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 241579 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 241580 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 241581 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 244875 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 244876 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 244877 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 244878 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 244879 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the_fiter_data
id Int64
store String
region String
area Int32
Channel String
budget_year Int32
budget_quarter String
budget_month String
budget_weekday Int64
budget_day String
budget_dates Int32
historical_year Int64
history_Quarter String
history_month String
history_week String
history_Day String
history_datess Int32
family String
sub_Family String
Supplier String
Category String
Dom_Comm String
Sub_Category String
Extended_sub_category String
Sub_Category_supplier String
Article_Score Int32
last_v store store
last_v region region
last_v Channel Channel
last_v Quarter budget_quarter
last_v month budget_month
last_v week budget_weekday
last_v Day budget_day
last_v history_Quarter history_Quarter
last_v history_month history_month
last_v history_Day history_Day
last_v family family
last_v sub_family sub_Family
last_v supplier Supplier
last_v category Category
last_v dom_comm Dom_Comm
last_v sub_category Sub_Category
last_v extended_sub_category Extended_sub_category
last_v sub_category_supplier Sub_Category_supplier
{'store': ['Agami Branch', 'Alamein Masa Mall', 'Dakernis Branch', '0', 'Mega Helwan', 'BTECHX Sheraton', 'BTECHX Moharam Bek', 'BTECHX Sporting Club', 'BTECHX The Yard Mall', 'Alex_ Tusun', 'BTECHX ElShams Club', 'BTECHX Ramses Station', 'Smouha Branch', 'Ismalia Branch-City Council Square', 'Tanta Branch', 'QENA-Warehouse', 'El-Elsoudan Street Branch', 'Winget Branch', 'Flag Mall Branch', 'Suez Branch', 'BTECHX Mansoura', 'BTECHX GardeniaTagamo', 'Town Center El Salam', 'El Mokattam Branch', 'Ain Shams Branch - Ibrahim Abdel Razek St.', 'BTECHX Sidi Bishr', 'GateWay Mall El Rehab', 'Banha Branch', 'BTECHXCFC', 'BTECHX ElRehab Mall1', 'Makadi Bay', 'Zayton Branch', '9025Show Room Alex', '10th Show Room WH', 'CFC Mall', 'BTECHXMataria', 'B.TECH X AUC', 'Salah Salim Branch', 'Damanhour Branch', 'Berket Elsabaa Branch', 'BTECHX CityCenterMaadi', 'BTECHX Ismailia Square', 'BTECHX Triumph Tagamo', 'El Sayeda Zainab', 'El-Gouna Branch', 'Aswan WH', 'Delta Tanta Mega Store', 'October-WH', 'Makram Ebaid Branch', 'Marina Branch', '10th of Ramadan WH', 'Miela Arkan Mall', 'Roxy Branch', 'Elagamy2', 'BTECHX Roxcy', 'BTECHX Gehan2 Dewaka', 'BTECHX Zagazig', 'EL Matria', 'BTECHX Obour2', '10th Tech Club WH', 'El Menia Mega Branch', 'BTECHX 45', 'El Zaher', 'BTECHX Saad El Din El Shazly', 'BTECHX Assuit', 'Nagaa Hamadi Branch', 'Miela Arkan WH', 'Haram Branch', 'Almaza Branch', 'Malawi Branch', 'BTECH Mini Air Force House', 'BTECHX CityCenter Alex', 'BTECHX El Sherouk', 'El Sadat Branch', 'BTECH Mini MPC', 'Shoubra Branch', 'Beni Suef Branch', 'Desouk Branch', 'Amwaj ranch', 'Port Said', 'Masara', 'Abbas El-Akkad Branch', 'Cairo Retail Warehouses', 'BTECHX San_Stefano Mall', 'Sohag Branch', 'Alex WH', 'Deel Asyut WH', 'BTECHX Shebin El koum', 'Asafra Branch', 'El Helmya', 'Mall Of October Branch', '3Tanta Mall', 'Faisal Branch', 'Sale With Cost W.H', 'Uni Mall El Obour', 'Show Room - Corp. Sale-38', 'El Kanater Branch', 'Marassi-North-Coast Branch', 'Assiut Branch - Ibn Sina Tower', 'New Roxy', 'Noon Seller Store1', 'Oraby Branch', 'Marina Kaian Branch', 'Mansoura Branch', 'Luxor Branch', 'Jumia Seller Store', 'BTECHX Mahala', '1Imbaba', 'BTECH mini Egyptian Shooting ', 'BTECHX Hegaz', 'Asyut WH', 'Misr elgdida', 'El Tagamou 1 Branch', 'Shubra El Kheima Branch', 'El Fayoum Branch', 'Fakous Branch', 'BTECHX Safwa Zaid ', 'BTECHX Midor', 'BTECHX Truck Alex', 'Mega Fisal', 'Quesna Branch', 'Eldahar Mega Branch', 'Shebin El Koum Branch', 'Ras Ghareb Branch', 'Qalyub', 'Mall Of Egypt Branch', 'New Dumietta Branch', 'Assuit Mega Branch', 'B.ONLINE', 'Zahra El Asher Branch', 'El Nozha Branch', 'BTECHX El Mosher Axis', 'New Damanhour', 'ElBahr ElAzam', 'BTECHX 2Mansoura', 'BTECHX Kasr El Einy', 'BTECHX Maadi Grand Mall', 'BTECHX Gihan3 Abasia', 'Loran Branch', 'EL Amiria Branch', 'Hadek El Kobba Branch', 'Ismaila Branch-Railway station', 'New sohag', 'Mall Of Arabia Branch', 'BTECHX Dokki', 'Dumietta Branch', 'Aswan Mega  Branch', 'Mahalla Branch', 'BTECHX Airport', 'Zagazig Branch', 'HQ Call Center', 'El Galaa', 'Corporate Sales', 'BTECHX ASU', 'BTECHX Manial', 'El Betash Branch', 'B.TECH STAFF', '26Th July Branch', 'Qena Branch', 'BTECHX Sohag', 'El Tagamou 2 Branch', 'BTECHX El Menia', 'B.TECHX El Mandara', 'B2B Gov', 'BTECHX ElRehab North', 'Hassan El Maamon', 'Tanta WH', 'Gesr El Suez Branch', 'Mega Alex Sidi Gaber', 'BTECHX Kafr ElSheikh', 'BTECHX Open Air Mall', 'Dar El Salam Branch', 'BTECHX Shinzo Abe', 'BTECH2Fayoum', 'BTECHX City Stars Mall', 'El Tahrir', 'Maadi Branch-El Laselky St.', 'Banha warehouse', 'Ain Shams Branch - Mostafa Hafez St.', 'Sky Mall El Sherouk Branch', 'El Seyouf Branch'], 'region': ['DELTA', 'ALEXANDRIA', 'HURGHADA', 'UPPER EGYPT', '0', 'CAIRO'], 'season': [], 'area': [], 'Channel': ['NON', 'CALL CENTER', 'Retail', 'ARKAN', 'WAREHOUSE', 'B2B', '0', 'MINI', 'ONLINE', 'DEEL', 'B.TECH X'], 'budget_year': [0.0], 'Quarter': ['0', '4', '3'], 'month': ['July     ', 'December ', 'November ', '0', 'October  ', 'September', 'August   '], 'week': [0, 1, 2, 3, 4, 5, 6, 7], 'date': ['19935', '19923', '19909', '20087', '19936', '19974', '20080', '20010', '19925', '19942', '19981', '20063', '19998', '19949', '20084', '19989', '20078', '19973', '19914', '19971', '19972', '19912', '20025', '20043', '19970', '19945', '19938', '20086', '19948', '20004', '20019', '19955', '20062', '20029', '19976', '19995', '20061', '20028', '20050', '20041', '20044', '20011', '19913', '19919', '19966', '20075', '20073', '20013', '20066', '20079', '20088', '20020', '19997', '19983', '19926', '19941', '20026', '20016', '20076', '19985', '20033', '20064', '19964', '20053', '20036', '20054', '19994', '19988', '19969', '20037', '20007', '19956', '19905', '20000', '20065', '20068', '19996', '19953', '19957', '20057', '19908', '19977', '20082', '19932', '19963', '19907', '20006', '20042', '20023', '19968', '19929', '19924', '19978', '20021', '20015', '20039', '20005', '20008', '20035', '19961', '20074', '19944', '20045', '19979', '20003', '20071', '20024', '19965', '19980', '19946', '19915', '20059', '19916', '19931', '19986', '20034', '19933', '19927', '20085', '19958', '19943', '19975', '20067', '19922', '19910', '19939', '20077', '19999', '19993', '20031', '20069', '19950', '19992', '19918', '20060', '19962', '20055', '20051', '19952', '19967', '19940', '20049', '19934', '19917', '19982', '19937', '19959', '20038', '20018', '20040', '20046', '20056', '19990', '20072', '19928', '20017', '20027', '19987', '20070', '19911', '20047', '20002', '19954', '19991', '20009', '19920', '19921', '20012', '0', '20022', '20081', '20048', '20083', '19960', '20001', '20030', '20052', '20058', '19906', '19984', '19930', '19951', '19947', '20032', '20014'], 'Day': ['Friday   ', '0', 'Tuesday  ', 'Saturday ', 'Sunday   ', 'Monday   ', 'Thursday ', 'Wednesday'], 'historical_year': [], 'history_Quarter': ['1', '0', '4', '3', '2'], 'history_month': ['January  ', 'May      ', 'November ', 'June     ', 'September', 'April    ', 'February ', 'December ', 'March    ', 'July     ', 'August   ', 'October  ', '0'], 'history_week': ['0', '1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '3', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '4', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '5', '50', '51', '52', '6', '7', '8', '9'], 'history_Day': ['0', 'Friday   ', 'Thursday ', 'Monday   ', 'Wednesday', 'Sunday   ', 'Saturday ', 'Tuesday  '], 'history_dates': [0, 18997, 19003, 19005, 19010, 19011, 19015, 19016, 19017, 19022, 19023, 19038, 19040, 19044, 19050, 19052, 19053, 19057, 19059, 19066, 19068, 19072, 19073, 19074, 19078, 19079, 19080, 19085, 19086, 19087, 19088, 19089, 19095, 19101, 19102, 19106, 19108, 19109, 19110, 19120, 19121, 19122, 19123, 19124, 19127, 19128, 19129, 19130, 19131, 19134, 19135, 19136, 19137, 19138, 19141, 19143, 19145, 19148, 19152, 19155, 19156, 19158, 19159, 19162, 19163, 19164, 19165, 19166, 19170, 19171, 19172, 19176, 19178, 19179, 19180, 19186, 19190, 19192, 19193, 19200, 19201, 19204, 19206, 19208, 19211, 19212, 19213, 19214, 19215, 19218, 19220, 19221, 19222, 19226, 19227, 19228, 19229, 19232, 19233, 19235, 19236, 19239, 19240, 19241, 19243, 19245, 19246, 19247, 19248, 19249, 19250, 19252, 19253, 19254, 19255, 19256, 19257, 19259, 19260, 19261, 19262, 19263, 19264, 19266, 19267, 19268, 19269, 19270, 19271, 19273, 19274, 19275, 19276, 19277, 19278, 19279, 19280, 19281, 19282, 19283, 19284, 19285, 19286, 19287, 19288, 19289, 19290, 19291, 19292, 19293, 19294, 19295, 19296, 19297, 19298, 19299, 19300, 19301, 19302, 19303, 19304, 19305, 19306, 19307, 19308, 19309, 19310, 19311, 19312, 19313, 19314, 19315, 19316, 19317, 19318, 19319, 19320, 19321, 19322, 19323, 19324, 19325, 19326, 19327, 19328, 19329, 19330, 19331, 19332, 19333, 19334, 19335, 19336, 19337, 19338, 19339, 19340, 19341, 19342, 19343, 19344, 19345, 19346, 19347, 19348, 19349, 19350, 19351, 19352, 19353, 19354, 19355, 19356, 19357, 19358, 19359, 19360, 19361, 19362, 19363, 19364, 19365, 19366, 19367, 19368, 19369, 19370, 19371, 19372, 19373, 19374, 19375, 19376, 19377, 19378, 19379, 19380, 19381, 19382, 19383, 19384, 19385, 19386, 19387, 19388, 19389, 19390, 19391, 19392, 19393, 19394, 19395, 19396, 19397, 19398, 19399, 19400, 19401, 19402, 19403, 19404, 19405, 19406, 19407, 19408, 19409, 19410, 19411, 19412, 19413, 19414, 19415, 19416, 19417, 19418, 19419, 19420, 19421, 19422, 19423, 19424, 19425, 19426, 19427, 19428, 19429, 19430, 19431, 19432, 19433, 19434, 19435, 19436, 19437, 19438, 19439, 19440, 19441, 19442, 19443, 19444, 19445, 19446, 19447, 19448, 19449, 19450, 19451, 19452, 19453, 19454, 19455, 19456, 19457, 19458, 19459, 19460, 19461, 19462, 19463, 19464, 19465, 19466, 19467, 19468, 19469, 19470, 19471, 19472, 19473, 19474, 19475, 19476, 19477, 19478, 19479, 19480, 19481, 19482, 19483, 19484, 19485, 19486, 19487, 19488, 19489, 19490, 19491, 19492, 19493, 19494, 19495, 19496, 19497, 19498, 19499, 19500, 19501, 19502, 19503, 19504, 19505, 19506, 19507, 19508, 19509, 19510, 19511, 19512, 19513, 19514, 19515, 19516, 19517, 19518, 19519, 19520, 19521, 19522, 19523, 19524, 19525, 19526, 19527, 19528, 19529, 19530, 19531, 19532, 19533, 19534, 19535, 19536, 19537, 19538, 19539, 19540, 19541, 19542, 19543, 19544, 19545, 19546, 19547, 19548, 19549, 19550, 19551, 19552, 19553, 19554, 19555, 19556, 19557, 19558, 19559, 19560, 19561, 19562, 19563, 19564, 19565, 19566, 19567, 19568, 19569, 19570, 19571, 19572, 19573, 19574, 19575, 19576, 19577, 19578, 19579, 19580, 19581, 19582, 19583, 19584, 19585, 19586, 19587, 19588, 19589, 19590, 19591, 19592, 19593, 19594, 19595, 19596, 19597, 19598, 19599, 19600, 19601, 19602, 19603, 19604, 19605, 19606, 19607, 19608, 19609, 19610, 19611, 19612, 19613, 19614, 19615, 19616, 19617, 19618, 19619, 19620, 19621, 19622, 19623, 19624, 19625, 19626, 19627, 19628, 19629, 19630, 19631, 19632, 19633, 19634, 19635, 19636, 19637, 19638, 19639, 19640, 19641, 19642, 19643, 19644, 19645, 19646, 19647, 19648, 19649, 19650, 19651, 19652, 19653, 19654, 19655, 19656, 19657, 19658, 19659, 19660, 19661, 19662, 19663, 19664, 19665, 19666, 19667, 19668, 19669, 19670, 19671, 19672, 19673, 19674, 19675, 19676, 19677, 19678, 19679, 19680, 19681, 19682, 19683, 19684, 19685, 19686, 19687, 19688, 19689, 19690, 19691, 19692, 19693, 19694, 19695, 19696, 19697, 19698, 19699, 19700, 19701, 19702, 19703, 19704, 19705, 19706, 19707, 19708, 19709, 19710, 19711, 19712, 19713, 19714, 19715, 19716, 19717, 19718, 19719, 19720, 19721, 19722, 19723, 19724, 19725, 19726, 19727, 19728, 19729, 19730, 19731, 19732, 19733, 19734, 19735, 19736, 19737, 19738, 19739, 19740, 19741, 19742, 19743, 19744, 19745, 19746, 19747, 19748, 19749, 19750, 19751, 19752, 19753, 19754, 19755, 19756, 19757, 19758, 19759, 19760, 19761, 19762, 19763, 19764, 19765, 19766, 19767, 19768, 19769, 19770, 19771, 19772, 19773, 19774, 19775, 19776, 19777, 19778, 19779, 19780, 19781, 19782, 19783, 19784, 19785, 19786, 19787, 19788, 19789, 19790, 19791, 19792, 19793, 19794, 19795, 19796, 19797, 19798, 19799, 19800, 19801, 19802, 19803, 19804, 19805, 19806, 19807, 19808, 19809, 19810, 19811, 19812, 19813, 19814, 19815, 19816, 19817, 19818, 19819, 19820, 19821, 19822, 19823, 19824, 19825, 19826, 19827, 19828, 19829, 19830, 19831, 19832, 19833, 19834, 19835, 19836, 19837, 19838, 19839, 19840, 19841, 19842, 19843, 19844, 19845, 19846, 19847, 19848, 19849, 19850, 19851, 19852, 19853, 19854, 19855, 19856, 19857, 19858, 19859, 19860, 19861, 19862, 19863, 19864, 19865, 19866, 19867, 19868, 19869, 19870, 19871, 19872, 19873, 19874], 'article_score': ['sale', 'abc', 'ae', 'speed', 'terminal', 'margin', 'sell', 'markdown', 'core', 'quartile', 'sortimeter'], 'history_year': [0.0, 2022.0, 2023.0, 2024.0], 'family': ['TV', 'TABLET', 'MOBILE', 'AC', 'MDA', 'NON', 'BMOBILE ACCESSORIES', '0', 'COMPLEMENTARY', 'LAPTOP', 'SDA'], 'sub_family': ['0', 'TV COM', 'AC COM', 'BMOBILE', 'SDA COM', 'TV DOM', 'NON', 'MDA COM', 'SDA DOM', 'MDA DOM', 'AC DOM'], 'supplier': ['DAEWOO', 'OPPO', 'CARRIERE', 'SARY', 'F&D', 'LAVVENTO', 'OKKA', 'SKYWORTH ZAPPER', 'BLACK AND DECAR', 'REMINGTON', 'BRANDT', 'LENOVO', 'INDESIT', 'OSN', 'ELBA', 'MOULINEX', 'ITEL', 'ATLANTIC', 'OZO', 'S.LINK', 'GALAXI', 'BOSCH', 'HITACHI', 'ARISTON', 'TRUMAN', 'MSI', 'DALY', 'VAIO', 'EPSON', 'PLUTO', 'CHOETECH', 'FLAT', 'IDEAL', 'BISSELL', 'HOUSECOM', 'MODEX', 'WHITE POINT', 'UNION AIRE', 'ELIOS', 'HOPE', 'BENEX', 'MIELE', 'HISENSE', 'SHTEBEL', 'ARION', 'APPLE', 'UNIVERSAL', 'HOOVER', 'ILOOK', 'XAIOMI', 'ECOMATIC', 'ZANUSSI', 'MPT HT', 'WHITE WHALE', 'KEENDEX', 'TORNADO', 'AKWRJ', 'MODEM', 'SYINIX', 'BEKO', 'G.TEC', 'UG', 'ETI', 'SENCOR', 'LG', 'FAGOR', 'HAVIT', 'HAIER', 'FLYON', 'DELL', 'NARDI', 'TOSHIBA Midea', 'CAIXUN', 'ATA', 'ARIETE', 'FRANKE', 'TCL', 'BABYLISS', 'SOLAC', 'ALASKA', 'TOUCH', 'GLEMGAS', 'ZAHRAN', 'KIRIAZI', 'WACACO', 'PHILIPS', 'ARZUM', 'DOB', 'BOMAN', 'ALEXA', 'INTEL', 'ROYAL', 'LAVA', 'KENWOOD', 'AVANTREE', 'STEEL', 'EZVIZ', 'KARCHER', 'SONAI', 'NESTLE', 'PREMIUM', 'MEDIA TECH', 'NOKIA', 'CONTEX', 'MICROSOFT', 'KLASS', 'HAPILLINE', 'CANON', 'HOME TECH', 'NESPRESSO', 'GROUHY', 'FUTURE', 'SEM', 'HELLER', 'TIGER', 'FALCON', 'SMART', 'ZADA', 'NOUR TECH', '0', 'BERGEN', 'HUAWEI', 'ORIGINAL', 'KOLDAIR', 'OLYMPIC', 'TOSHIBA', 'SEASONS', 'MIDEA', 'ICONZ', 'MPT PT', 'BLACK AND WHITE', 'KHATER', 'GENERAL ELECTRIC', 'VIEW', 'BAUMATIC', 'FRESH', 'PREMIER', 'ROVO', 'TEFAL', 'CANDY', 'CLABER', 'NI', 'DAHUA', 'FORA', 'KIOXIA', 'SANDISK', 'ULTRA', 'SPEED', 'ELECTROSTAR', 'SAMSUNG', 'INFINIX', 'SONY', 'MIENTA', 'DELONGHI', 'BMOBILE ACCESSORIES', 'REALME', 'CLAGE', 'HONOR', 'CRAFT', 'ORAIMO', 'MUTECH', 'RUSH BRUSH', 'SHARP', 'HAMA', 'FERROLI', 'TANK', 'BIALETTI', 'NIKAI', 'LDNIO', 'HOME', 'BRAUN', 'AMAZONE', 'SCHNEIDER', 'SNDWAY', 'MUSIC HERO', 'INFINX', 'VIVO', 'VEITO', 'HP', 'ASUS', 'LA GERMANYA', 'DAIKIN', 'AMERICOOL', 'LONGLIFE', 'PASSAP', 'BENQ', 'PANASONIC', 'LOGITECH', 'NON', 'ICOOK', 'GORENJE', 'STRONG', 'SIMFER', 'FIRST', 'BeKO', 'NIKON', 'XIAOMI'], 'category': ['Audio Samsung', 'AC ULTRA', 'Warmer Shtebel', 'TV ATA', 'Washing M Bosch', 'Kettle SMART', 'WD Fresh', 'Hobs Bosch', 'Comp Monitor Samsung', 'Tablet Samsung', 'Cooker Zanussi', 'Gas Heater Tornado', 'M.Mincer Tornado', 'Oven Elba', 'TV Acc Media Tech', 'M.Mincer Kenwood', 'AC Accessory Sharp', 'Air Cooler Sonai', 'Mixer Kenwood', 'VC Hoover', 'Tablet APPLE', 'Oven Hoover', 'TV Toshiba', 'H.Blend Media Tech', 'Iron Philips I2', 'Dryer LG', 'Ice Tank Tank', 'Audio LG', 'Receiver', 'F.Proc Mienta', 'TV Acc STRONG', 'TV Rowa', 'Kitchen M Mienta', 'TV Contex', 'Fridge Indesit', 'F.Proc Tornado', 'Kettle Modex', 'Ele Heater TORNADO', 'H.Blender Smart', 'Fridge Haier', 'Chopper Ultra', 'Kettle Arion', 'Deep F PASSAP', 'Deep F Miele', 'AC Daikin', 'Tablet Huawei', 'Gift LG', 'Thermal Mug WACACO', 'Kettle Zada', 'Fan Arion', 'H.Blend Touch', 'Hood Panasonic', 'Hood Touch', 'Fan Tefal', 'Chopper Kenwood', 'Deep F LG', 'Cooker Kiriazi', 'Cooking Appliances A', 'Gas Heater LongLife', 'Coffee M Bosch', 'Fun Line Tornado', 'Kitchen M Home', 'B.ElectronicServices', 'TV Haier', 'TV Acc HP', 'Deep F Kiriazi', 'VC Smart', 'Juicer Sonai', 'Sport Machine Khater', 'Mobile VIVO', 'Tablet TCL', 'TV Nikai', 'Washing M Kiriazi', 'Washing M LG', 'Kettle Sonai', 'Coffee M Media Tech', 'TV Acc Itel', 'Washing M Fagor', 'Enquiry Fees', 'Coffee M Black&decke', 'Coffee M okka', 'Grill Kenwood', 'H.Blend Moulinex', 'VC Panasonic', 'Air Cooler Tornado', 'Hobs ICook', 'Iron Mienta', 'Toaster Home', 'Kitchen M Ariete', 'Bundle- b-in Indesit', 'H.Blend G.tec', 'Cooker Premium', 'Kettle SENCOR', 'Comp Printer Epson', 'tv acc truman', 'AC Crafft', 'VC Bosch', 'TV Union Aire', 'Hobs Brandt', 'IT ASS ASS', 'Mic. Sharp', 'Cooker Beko', 'Thermal Mug Tank', 'Blender sary', 'Gas Heater Arion', 'Hood Ariston', 'Receiver truman', 'Complem Printer HP', 'Kitchen M SMART', 'Fan Fresh', 'F.Proc SMART', 'H.Mixer Midea', 'Gas Heater Atlantic', 'Grill Mienta', 'Wall Hood Olympic', 'Transferfeesonline01', 'Blender Touch', 'Toaster tornado', 'Kitchen M Modex', 'Mixer Black&white', 'TV Acc hama', 'Grill Zada', 'Juicer Moulinex', 'VC Daewoo', 'TV Acc Falcon', 'Ele Heater White Wha', 'B2B AC', 'Oven Touch', 'Ele Heater Union Air', 'Mixer Union Aire', 'AC Accessory Carrier', 'Hood ICook', 'TV Ultra', 'Coffee M Tefal', 'Security Ass Camera', 'H.Blend Black&decker', 'Fridge LG', 'Fridge Beko', 'Hobs GLEMGAS', 'Fridge Electrostar', 'Oven Indesit', 'H.Mixer Modex', 'D Washer White Point', 'Coffee M Nespresso', 'Washing M Zanussi', 'Warmer Akwrj', 'VC LG', 'F.Proc Modex', 'Mic. Zanussi', 'Ele Heater Toshiba', 'VC Mienta', 'Ele Heater Boman', 'Gas Heater Toshiba', 'Masher Black&white', 'Deep F White Point', 'Curl Irons Babyliss', 'M.Mincer Braun', 'AC Beko', 'Coffee M Beko', 'Frayer Ariston', 'VC Samsung', 'Fan Touch', 'Kettle Black&decker', 'Gift Ariston', 'Blender Ariete', 'Warmer veito', 'Fridge White Point', 'Fridge Samsung', 'Mic. Hoover', 'Hood Miele', 'Air Styler Rush brus', 'Oven beko', 'TV Premium', 'Mincer Bosch', 'F.Proc Braun', 'Fridge Tornado', 'Mic. SMART', 'F.Proc Kenwood', 'Fridge Bosch', 'AC Zanussi', 'Hair Dryer Rush brus', 'E.Hot Pla Home', 'WARMER Ultra', 'VC Miele', 'H.Mixer Touch', 'Hood Beko', 'VC Hitachi', 'H.Mixer Panasonic', 'H.Blend Mienta', 'F.Proc ULTRA', 'TV Acc ICONZ', 'Warmer Media Tech', 'VC Black&decker', 'Blender G.tec', 'Toaster Kenwood', 'Wall Hood Tornado', 'TV Pluto', 'Straightners Philips', 'Washer Dry ASSMiele', 'H.Blend SENCOR', 'Chopper Ariete', 'Comp Monitor Xiaomi', 'Shaving_Tri Babyliss', 'TV Syinix', 'Kettle Ariete', 'Gas Heater Kiriazi', 'Hobs Beko', 'Dryer Home', 'Gas Heater Fresh', 'Mincer Home', 'Hair Dryer Philips', 'Fridge Miele', 'Straightners Mienta', 'Kitchen M Touch', 'Oven Klass', 'Chopper Mienta', 'Gift Bosch', 'VC AccessoriesMiele', 'Coffee M Braun', 'Power Bank SBS', 'Fridge PASSAP', 'Toaster Panasonic', 'D Washer Bosch', 'M.Mincer SMART', 'Toaster Ariete', 'Comp Monitor BenQ', 'VC Solac', 'Air Cooler Home', 'Kettle Fresh', 'R.cooker Modex', 'Shaving_TriRemington', 'AC Accessory Zanussi', 'AC Carriere', 'TV Acc ilook', 'AC Midea', 'Tools Claber', 'VC Ariete', 'kettle Mienta', 'Air Fryer Tornado', 'Mobile OPPO', 'Iron Panasonic', 'Toaster Black&decker', 'TV Acc Energizer', 'Mobile Samsung', 'Iron Kenwood', 'Hobs Hoover', 'TV LG', 'Complem Gaming Sony', 'Lam Philips', 'Laptop Lenovo', 'Deep F Electrostar', 'H.Mixer Kenwood', 'VC Rovo', 'Fridge Zanussi', 'Audio', 'Audio oraimo', 'Hobs Elba', 'F.Proc Benex', 'Complent Alexa IOT', 'Iron Modex', 'Fan Sonai', 'Shaving_Tri Philips', 'Grill Media Tech', 'Washing M Sharp', 'F.Proc Panasonic', 'Coffee M Delonghi', 'Warmer Touch', 'Washing M Tornado', 'Toaster Mienta', 'Laptop VAIO', 'R.cooker Media Tech', 'Warmer Fresh', 'Ele Heater Olympic', 'Complem Camera Nikon', 'Kettle Tornado', 'Protection SBS', 'Blender Sonai', 'F.Proc Union Aire', 'Bottel Tank', 'Fridge Ideal', 'Blender Ultra', 'Hood ASS Indesit', 'TV FRESH', 'Chopper Moulinex', 'Wall Hood Toshiba', 'Hobs SMART', 'Audio Philips', 'VC Fresh', 'Mixer Modex', 'Filter Tank', 'Frayer Bergen', 'H.Blend Home', 'Washing M Toshiba', 'Fun Line Sonai', 'Warmer Delonghi', 'TV Sony', 'Kitchen M Fresh', 'VC Ultra', 'Hobs Indesit', 'AC Accessory LG', 'Gas Heater PASSAP', 'Coffee M Kenwood', 'Ele Heater Universal', 'Gift Universal', 'Hobs Zanussi', 'Ele Heater Fresh', 'TV ASS ASS', 'Laptop Huawei', 'Hood Tornado', 'M Grinder Sonai', 'Mic. Daewoo', 'Ele Heater Atlantic', 'Laptop APPLE', 'Deep F Sharp', 'Blender Home', 'H.Blend Kenwood', 'AC General Electric', 'Mic. Kenwood', 'M.Mincer Black&White', 'Hair Dryer Tornado', 'Espresso Machine Ari', 'Holders SBS', 'Oven Mienta', 'VC Tornado', 'VC Black&white', 'AC Union Aire?', 'Washing M Union Aire', 'Ele heater flyon', 'Blender Moulinex', 'Compl DESK PC Intel', 'R.cooker Black&decke', 'M.Mincer Moulinex', 'Shaving_Tri Hapillin', 'Audio Avantree', 'Fan Tornado', 'Headset SBS', 'Cooker White Point', 'Iron Media Tech', 'Frayer Home', 'Gift Fresh', 'TV Tcl', 'Mic. Ariston', 'Hobs Tornado', 'Mixer Media Tech', 'H.Mixer Sonai', 'AC Sharp', 'Cliner M Karcher', 'Mobile XIAOMI', 'Iron Home', 'Kettle Kenwood', 'Washing M Samsung', 'AC Accessory Premium', 'Hobs Fresh', 'Blender Bosch', 'WD Ultra', 'Hair Dryer Remington', 'Fun Line Solac', 'Juicer Bosch', 'Frayer Modex', 'Blender Mienta', 'Gift Samsung', 'Chopper Tornado', 'M.Mincer Bosch', 'F.Proc Home', 'Gift Nestle', 'Oven Simfer', 'Mobile INFINX', 'Mincer Black&decker', 'Gas Heater Ferroli', 'Fan Mienta', 'VC Kenwood', 'Hood Fagor', 'Fun Line Ariete', 'Audio Dob', 'Washing M Beko', 'Tools sndway', 'Juicer Home', 'F.Proc Moulinex', 'Curl Irons Rush brus', 'H.Blend Black&white', 'Mobile REALME', 'Tablet Nokia', 'Fridge Toshiba', 'Deep F Fresh', 'Fun Line Media Tech', 'Shaving_Tri Braun', 'Hobs Fagor', 'Chopper Fresh', 'VC Tefal', 'TV Caixun', 'Complem Camera CANON', 'Blender Kenwood', 'Airpods kit SBS', 'AC Accessory Fresh', 'Kitchen M Black&whit', 'Straightners Rush br', 'Kitchen M Bosch', 'F.Proc Grouhy', 'Fridge Kiriazi', 'Chopper SMART', 'Fan black&decker', 'Hood Indesit', 'Thermal Mug Tefal', 'Hood Zanussi', 'Frayer Tefal', 'Grill Black&decker', 'Grill Touch', 'AC Hisense', 'D Washer Fresh', 'Gas Heater White Poi', 'Lam Black&decker', 'Oven Fresh', 'R.cooker Tefal', 'WD PASSAP', 'Fan Panasonic', 'Tools Hitachi', 'Kettle Bosch', 'Fridge White Whale', 'Audio Toshiba', 'tv acc keendex', 'VC Modex', 'Speaker SBS', 'Oven Miele', 'Iron Solac', 'F.Proc Black&decker', 'Hood Premier', 'Chopper Media Tech', 'Washing M Indesit', 'H.Mixer Rovo', 'Mobile Hope', 'Hood Sonai', 'Cables SBS', 'Tools MPT PT', 'VC Grouhy', 'Hobs Nardi', 'Washing M Haier', 'F.Proc Black&white', 'Mic. Black&decker', 'Oven Ultra', 'Thermoses Tiger', 'Coffee M Sonai', 'Charger SBS', 'Grill Solac', 'R.cooker HOME', 'AC TORNADO', 'Oven Zanussi', 'H.Blender SEM', 'Ele Heater Clage', 'Oven Nardi', 'D Washer Miele', 'Audio sony', 'Warmer Mienta', 'Wall Hood Fresh', 'Oven Home', 'Fridge ULTRA', 'Iron Tornado', 'Deep F Ariston', 'Audio F&D', 'Gas Heater Universal', 'Frayer Mienta', 'Audio First', 'Iron Ariete', 'Fun Line Black&decke', 'Gas Heater Zanussi', 'Mic. Tornado', 'Juicer Braun', 'Iron Braun', 'Laptop ASUS', 'Fan Black&white', 'Hood Gorenje', 'Iron Touch', 'Oven Fagor', 'tv acc schneider', 'Mincer White Whale', 'Receiver Daly', 'Straightners Remingt', 'Straightners Solac', 'Com Projector Merlin', 'D Washer Beko', 'Iron Black&Decker', 'TV Acc MUTECH', 'tv acc elios', 'Laptop HP', 'H.Blend Bosch', 'Air Purifier SHARP', 'IFix', 'Coffee M Mienta', 'TV Acc Toshiba', 'Fan Ultra', 'Washing M Fresh', 'Frayer Miele', 'WD speed', 'Fun Line Zahran', 'TV Acc Fora', 'VC Bissell', 'Ele Heater Shtebel', 'D Washer Indesit', 'Blender Fresh', 'Shaving_Tri Tornado', 'Cooker White Whale', 'Iron Black&white', 'Juicer Solac', 'Warmer Tornado', 'Cooker La germanya', 'Blender Smart', 'Washer Dryer Ariston', 'Comp Monitor Dell', 'Fridge Ariston', 'Oven Gorenje', 'TV SARY', 'Iron Ultra', 'F.Proc Sonai', 'Kettle Solac', 'Juicer Home Tech', 'Audio Media Tech', 'Coffee M Zada', 'Hood Bosch', 'Juicer Modex', 'Kettle Touch', 'Frayer Philips I2', 'Receiver ETI', 'TV Acc STEEL', 'H.Mixer Tornado', 'AC Haier', 'TV Acc Tiger', 'Grill Home', 'Receiver SkyWorth Za', 'Deep F Indesit', 'Kettle Braun', 'Hobs Baumatic', 'Blender Panasonic', 'Oven Franke', 'Frayer Black&decker', 'Coffee M Home', 'Juicer Kenwood', 'Hobs Gorenje', 'TV Acc ETI', 'H.Mixer Moulinex', 'Washing M Hoover', 'Fridge Fresh', 'Kettle Panasonic', 'Comp Google Mesh IOT', 'Compl Camera GoPRO', 'WD Tank', 'Air Purifier LG', 'Coffee M White Whale', 'Oven Tornado', 'Tripod SBS', 'TV Acc FLAT', 'kitchen m sary', 'AC Premium', 'Hobs Klass', 'Air Cooler Fresh', 'Gas Heater premium', 'kettle Black&white', 'M.Mincer Touch', 'Grill Fresh', 'TABLET REALME', 'Mixer Black&decker', 'Ele Heater Zanussi', 'B.Electronic ass', 'Oven Brandt', 'Cooker Royal', 'Hood Franke', 'AC Acc Union Aire', 'Deep F Union Aire?', 'Kettle Media Tech', 'Gas Heater White Wha', 'Hobs ECOMATIC', 'Coffee M Solac', 'Fun Line Home', 'Coffee M Philips I2', 'Hair Dryer arzum', 'M.Mincer Sonai', 'Fan Kenwood', 'H.Mixer Braun', 'Straightners Braun', 'Tablet Lenovo', 'Hood Hoover', 'Mobile Huawei', 'TV View', 'Fan Union Aire?', 'AC Accessory Haier', 'Sport Machine Future', 'Coffee M Bialetti', 'Gift Indesit', 'kettle Media', 'Mobile LAVA', 'Grill Bosch', 'Comp Monitor Lenovo', 'IFixBtech', 'Cooker Bosch', 'Ice Box Tank', 'TV Acc Etrain', 'Tools MPT HT', 'Laptop DELL', 'Mixer Touch', 'AC Fresh', 'Cooker Universal', 'Masher Kenwood', 'AC Accessory Crafft', 'Mobile HONOR', 'Blender Black&decker', 'Fridge Alaska', 'F.Proc Bosch', 'F.Proc G.tec', 'Warmer Heller', 'D Washer LG', 'TV Acc NI', 'Mic. Fresh', 'Juicer Media Tech', 'Oven Sharp', 'Grill Tornado', 'Air Styler Babyliss', 'Gas Heater Union Air', 'Kettle Zahran', 'Deep F Beko', 'TV Accessory', 'Chopper Sonai', 'E.Hot Plate SMART', 'Cooker Union Aire?', 'Kitchen M Moulinex', 'Fan Nikai', 'Mic. Samsung', 'TV Samsung', 'M.Mincer Panasonic', 'Mobile APPLE', 'H.Mixer SMART', 'Washing M Miele', 'TV UG', 'H.Blend sary', 'Masher Mienta', 'Blender Tornado', 'Kitchen M G.tec', 'Blender Media Tech', 'Iron Tefal', 'Washing M Ariston', 'Straightners Babylis', 'H.Mixer Fresh', 'Kettle Home', 'WD White Whale', 'Ele Heater Ariston', 'Grill Tefal', 'Grill Modex', 'Fun Line Mienta', 'Gas Heater Olympic', 'Juicer Tornado', 'Iron Smart', 'Air Fryer Kenwood', 'VC Toshiba', 'TV Acc osn', 'Mixer Ultra', 'Boxi', 'Chopper Touch', 'Selfie Stick SBS', 'Washing M CANDY', 'TV Sharp', 'Blender Braun', 'E.Hot Touch', 'Tools Bosch', 'Stand Indesit', 'WD White Point', 'Coffee Grinder Ariet', 'Hood Elba', 'Blender sencor', 'H.Mixer Mienta', 'Chopper Bosch', 'TV Tornado', 'Cleaning SBS', 'WD Tornado', 'D Washer Zanussi', 'Laptop Microsoft', 'Filter ASS Tank', 'Blender Black&white', 'Oven Ariston', 'D Washer Ariston', 'Fridge Union Aire', 'Deep F White Whale', 'Straightners Tornado', 'Gas Heater Ariston', 'Deep F Tornado', 'E.Hot Plate Mienta', 'AC Americool', 'Coffee M SMART', 'M.Mincer Modex', 'Gas Heater Bosch', 'Laptop MSI', '0', 'Fridge Sharp', 'Hobs Franke', 'Deep F Alaska', 'AC LG', 'Kettle Housecom', 'mosq.kill Home', 'Coffee M Tornado', 'Oven Bosch', 'Coffee M Modex', 'Cappuccino Maker Ari', 'Hair Dryer Solac', 'H.Mixer Bosch', 'Chopper Rovo', 'Thermal Mug Tiger', 'Blender Modex', 'Chopper Black&decker', 'Hair Dryer Babyliss', 'Security Ass Camera ', 'Mobile NOKIA', 'Receiver Galaxi', 'Mic. Home', 'F.Proc Ariete', 'TV Hisense', 'Warmer Black&decker', 'H.Blend Tornado', 'Kitchen M Kenwood', 'Fan Smart', 'Mic. LG', 'Frayer Delonghi', 'Fan universal', 'AC Accessory Daikin', 'H.Mixer Black&white', 'Hobs Miele', 'Deep F Toshiba', 'Filter ASS philips', 'Gas Heater Panasonic', 'Gaming ASS ASS', 'Deep F Panasonic', 'Hobs Ariston', 'Toaster Braun', 'Scale Solac', 'E.Hot Plate Fresh', 'Ele Heater VEITO', 'H.Blender Braun', 'WD Bergen', 'Hood Fresh', 'Compl Printer CANON', 'Ele Heater Kiriazi', 'Juicer Mienta', 'Washing M Premium', 'Cooker Fresh', 'Frayer Fresh', 'Washing M White Poin'], 'dom_comm': ['NON', 'COMM', 'DOM', 'B.MOBILE', '0'], 'sub_category': ['TV-43', 'TV-85-SMRT-HI', 'AC-HOT/COLD-1.5HP-OUTDOOR UNIT', 'ALEXA ECHO DOT', 'WALL HOOD', 'AC-HOT/COLD-4HP-INDOOR UNIT', 'NON', 'SCALE', 'D WASHER', 'AC-COLD-1.5HP-OUTDOOR UNIT', 'SHAVING_TRI', 'CHOPPER', 'MASHER', 'AC-HOT/COLD-2.25HP-INDOOR UNIT', 'FILTER 7 STAGES', 'Wearable_Acc', 'E.HOT PLATE', 'AC-HOT/COLD-7HP-INDOOR UNIT', 'AC-HOT/COLD-5HP-INDOOR UNIT', 'CURL IRONS', 'CAPPUCCINO MAKER', 'BMOBILE ACCESSORIES', 'BUNDLE- B-IN', 'AC-COLD-3HP-INDOOR UNIT', 'HOBS', 'TV-50-SMRT-HI', 'Mobile_Acc', 'F.PROC', 'FUN LINE', 'H.BLENDER', 'AC-HOT/COLD-4HP-OUTDOOR UNIT', 'ESPRESSO MACH', 'FRAYER', 'AC-HOT/COLD-2.25HP', 'TV-86-SMRT', 'AC-HOT/COLD-4HP', 'FILTER 6 STAGES', 'AC-HOT/COLD-3HP-INDOOR UNIT', 'GAS HEATER', 'GIFT', 'TV-43-SMRT', 'VC ACCESSORIES', 'WASHER DRY ASS', 'TOOLS', 'LAPTOP', 'COFFEE M', 'TV-60-SMRT', 'STRAIGHTNERS', 'TV-40-SMRT', 'AC-COLD-1.5HP-INDOOR UNIT', 'FAN', 'TV-50-SMRT', 'R.COOKER', 'AC-COLD-7HP-OUTDOOR UNIT', 'GRILL', 'AC ACCESSORY', 'SPORT MACHINE', 'TV-65-SMRT-HI', 'VC', 'KETTLE', 'AC-HOT/COLD-1.5HP-INDOOR UNIT', 'WASHING M', 'H.MIXER', 'RECEIVER', 'IRON', 'LAM', 'AIR COOLER', 'AIR FRYER', 'DRYER', 'COMPLEMENTARY', 'AC-COLD-2.25HP-INDOOR UNIT', 'AC-HOT/COLD-2.25HP-OUTDOOR UNIT', 'OVEN', 'AC-HOT/COLD-1.5HP', 'HOOD ASS', 'WARMER', 'FILTER ASS', 'AC-HOT/COLD-5HP', 'TV-65-SMRT', 'TV-32-SMRT', '0', 'FRIDGE', 'TV-FRAME', 'WASHER DRYER', 'AC-COLD-3HP-OUTDOOR UNIT', 'TV-75-SMRT-HI', 'AIR PURIFIER', 'JUICER', 'AC-HOT/COLD-5HP-OUTDOOR UNIT', 'THERMAL VESSEL', 'HOOD', 'TANK', 'FILTER 5 STAGES', 'CLINER M', 'WD', 'MOBILE', 'TV-70-SMRT', 'MOSQ.KILL', 'AC-COLD-1.5HP', 'TV-55-SMRT', 'COOKER', 'TABLET', 'TV-55-SMRT-HI', 'M.MINCER', 'MDA ASS', 'TV-85-SMRT', 'It_Acc', 'MICROWAVE', 'AIR STYLER', 'TV-ACCESSORY', 'MIXER', 'AUDIO', 'ELE HEATER', 'AC-HOT/COLD-7HP-OUTDOOR UNIT', 'DEEP FREEZER', 'TOASTER', 'TV-40', 'FILTER 3 STAGES', 'AC-HOT/COLD-6HP-INDOOR UNIT', 'HAIR DRYER', 'TV-32', 'TV-75-SMRT', 'BLENDER', 'COOKING APPLIANCES', 'COFFEE GRINDER', 'MINCER', 'TV-50', 'AC-COLD-2.25HP', 'AC-COLD-2.25HP-OUTDOOR UNIT', 'AC-HOT/COLD-3HP', 'AC-HOT/COLD-3HP-OUTDOOR UNIT', 'KITCHEN M'], 'extended_sub_category': ['TV-85-SMRT-HI', 'WALL HOOD', 'COFFEE M', 'MINCER', 'HAIR DRYER', 'WARMER', '0', 'WD', 'TV-55-SMRT-HI', 'FILTER 5 STAGES', 'MIXER', 'AIR COOLER', 'MOBILE COMPLEMENTARY', 'AC-HOT/COLD-2.25HP', 'Network', 'FAN', 'TV COMPLEMENTARY', 'TV-60-SMRT', 'TOASTER', 'TV-75-SMRT', 'THERMAL VESSEL', 'FRAYER', 'TV-40-SMRT', 'AC-COLD-3HP', 'TV Supplies', 'TANK', 'Network-Adapter', 'GAS HEATER', 'TV-43-SMRT', 'TV-50', 'AC-HOT/COLD-7HP', 'WASHING M', 'FRIDGE', 'ELE HEATER', 'TV-70-SMRT', 'AC COMPLEMENTARY', 'TV-75-SMRT-HI', 'VC', 'TABLET', 'SCALE', 'Smart Scale', 'Smart Home', 'Bar Code Scanner', 'COOKING APPLIANCES', 'HOOD', 'MASHER', 'Gift', 'AC-HOT/COLD-6HP', 'DRYER', 'Service', 'AIR FRYER', 'IRON', 'BUNDLE- B-IN', 'COMPLEMENTARY', 'H.MIXER', 'OVEN', 'HOBS', 'ALEXA ECHO DOT', 'AC-COLD-2.25HP', 'Wearables', 'Smart tag', 'Mobile Audio', 'Storage', 'R.COOKER', 'Network-Modem', 'WASHER DRYER', 'TV-65-SMRT', 'DEEP FREEZER', 'COFFEE GRINDER', 'Mobile Holder', 'TV-65-SMRT-HI', 'AC-HOT/COLD-3HP', 'FUN LINE', 'CURL IRONS', 'M.MINCER', 'TV-85-SMRT', 'TV Cables', 'STRAIGHTNERS', 'TV-50-SMRT-HI', 'AC-HOT/COLD-1.5HP', 'MDA COMPLEMENTARY', 'GRILL', 'AIR STYLER', 'SHAVING_TRI', 'TV-32-SMRT', 'F.PROC', 'Protection', 'Power', 'AIR PURIFIER', 'Network-Switch', 'Mobile cables', 'FILTER 3 STAGES', 'Mobile Cables', 'Security', 'Bundle', 'MICROWAVE', 'NON', 'TV-50-SMRT', 'Cross Bag', 'AC-HOT/COLD-5HP', 'BMOBILE ACCESSORIES', 'Gaming', 'JUICER', 'TV-55-SMRT', 'AC-COLD-1.5HP', 'FILTER 6 STAGES', 'WL Telephone', 'SDA COMPLEMENTARY', 'KITCHEN M', 'SPORT MACHINE', 'E.HOT PLATE', 'MOBILE', 'AC-HOT/COLD-4HP', 'IOT', 'FILTER 7 STAGES', 'CAPPUCCINO MAKER', 'Computer peripherals', 'CHOPPER', 'BLENDER', 'ESPRESSO MACH', 'D WASHER', 'TV-32', 'LAPTOP', 'KETTLE', 'Mobile photography', 'TV-40', 'CLINER M', 'COOKER', 'AC-COLD-7HP', 'MOSQ.KILL', 'TV-43', 'H.BLENDER'], 'sub_category_supplier': ['AC-COLD-2.25HP-PREMIUM', 'AC-COLD-2.25HP-GENERAL ELECTRIC', 'VC-DAEWOO', 'AC-HOT/COLD-2.25HP-LG', 'TV-43-SMRT-UNION AIRE', 'H.BLENDER-SMART', 'E.HOT PLATE-HOME TECH', 'TV-32-SMRT-HAIER', 'TV-65-SMRT-TOSHIBA', 'H.MIXER-PANASONIC', 'HOBS-GORENJE', 'E.HOT PLATE-TOUCH', 'RECEIVER-GALAXI', 'SHAVING_TRI-TORNADO', 'FAN-PANASONIC', 'TV-32-SARY', 'MICROWAVE-TORNADO', 'COMPLEMENTARY-HP', 'TV-75-SMRT-HI-SAMSUNG', 'WALL HOOD-TOSHIBA', 'TV-ACCESSORY-FLAT', 'TABLET-TCL', 'TV-32-SMRT-LG', 'HAIR DRYER-SOLAC', 'DEEP FREEZER-TORNADO', 'TV-43-SMRT-SHARP', 'COMPLEMENTARY-SAMSUNG', 'MINCER-WHITE WHALE', 'THERMAL VESSEL-TEFAL', 'WARMER-MIENTA', 'COMPLEMENTARY-HAVIT', 'TV-43-CONTEX', 'AC-HOT/COLD-2.25HP-PREMIUM', 'GAS HEATER-TORNADO', 'TV-FRAME-SAMSUNG', 'H.BLENDER-TORNADO', 'FAN-BLACK AND WHITE', 'HOOD-BeKO', 'TV-32-ATA', 'HOBS-ZANUSSI', 'WARMER-SHTEBEL', 'AC-HOT/COLD-4HP-CARRIERE', 'STRAIGHTNERS-PHILIPS', 'F.PROC-MOULINEX', 'D WASHER-LG', 'WALL HOOD-OLYMPIC', 'TV-32-UNION AIRE', 'AUDIO-SAMSUNG', 'JUICER-MODEX', 'COOKER-BOSCH', 'TV-32-TOSHIBA', 'HAIR DRYER-BABYLISS', 'HOBS-HOOVER', 'HOOD-GORENJE', 'TV-32-LG', 'IRON-SMART', 'E.HOT PLATE-SMART', 'VC-SAMSUNG', 'DEEP FREEZER-WHITE POINT', 'CLINER M-KARCHER', 'TOASTER-MIENTA', 'FILTER 6 STAGES-SEASONS', 'IRON-MODEX', 'AC-HOT/COLD-6HP-CARRIERE', 'GRILL-KENWOOD', 'KETTLE-HOME TECH', 'HOOD-BEKO', 'WD-SPEED', 'TV-43-SMRT-SONY', 'FUN LINE-SONAI', 'STRAIGHTNERS-BRAUN', 'AC-COLD-1.5HP-SHARP', 'AC-COLD-2.25HP-SHARP', 'DEEP FREEZER-WHITE WHALE', 'HOOD-SONAI', 'ELE HEATER-KIRIAZI', 'TABLET-REALME', 'WD-PASSAP', 'MOBILE-VIVO', 'DEEP FREEZER-SHARP', 'TV-75-SMRT-HI-LG', 'AC-HOT/COLD-1.5HP-HAIER', 'ELE HEATER-FRESH', 'AUDIO-SONY', 'TV-65-SMRT-SHARP', 'AC-COLD-1.5HP-UNION AIRE', 'OVEN-ZANUSSI', 'OVEN-GORENJE', 'WASHING M-BEKO', 'IRON-PHILIPS', 'FRIDGE-TOSHIBA', 'BLENDER-SENCOR', 'AIR FRYER-KENWOOD', 'OVEN-FAGOR', 'COFFEE M-BOSCH', 'TV-75-SMRT-TOSHIBA', 'BUNDLE- B-IN-INDESIT', 'BLENDER-MEDIA TECH', 'TOASTER-HOME TECH', 'AIR FRYER-TORNADO', 'HOOD-HOOVER', 'F.PROC-BLACK AND WHITE', 'M.MINCER-SONAI', 'FRIDGE-PASSAP', 'DEEP FREEZER-TOSHIBA', 'WARMER-MEDIA TECH', 'TABLET-SAMSUNG', 'TV-32-SMRT-PREMIUM', 'CURL IRONS-BABYLISS', 'AC-COLD-2.25HP-UNION AIRE', 'TV-55-SMRT-HI-LG', 'COFFEE M-ZADA', 'FRIDGE-ULTRA', 'FILTER 7 STAGES-SEASONS', 'KITCHEN M-BOSCH', 'F.PROC-BENEX', 'M.MINCER-MOULINEX', 'DEEP FREEZER-ARISTON', 'HOBS-FRESH', 'OVEN-SHARP', 'TV-43-SMRT-FRESH', 'THERMAL VESSEL-TANK', 'WALL HOOD-TORNADO', 'GRILL-ZADA', 'FAN-NIKAI', 'MOBILE-APPLE', 'AUDIO-F&D', 'FILTER 3 STAGES-SEASONS', 'TV-43-SMRT-HAIER', 'FAN-BLACK AND DECAR', 'GAS HEATER-WHITE WHALE', 'JUICER-SONAI', 'FRAYER-MIENTA', 'SPORT MACHINE-KHATER', 'VC-HITACHI', 'HOBS-ECOMATIC', 'E.HOT PLATE-MIENTA', 'H.MIXER-BLACK AND WHITE', 'TV-43-UNION AIRE', 'OVEN-NARDI', 'VC-HOOVER', 'VC-TOSHIBA', 'D WASHER-INDESIT', 'KITCHEN M-FRESH', 'D WASHER-WHITE POINT', 'H.MIXER-TOUCH', 'MICROWAVE-ZANUSSI', 'OVEN-FRANKE', 'FUN LINE-ZAHRAN', 'BMOBILE ACCESSORIES-EZVIZ', 'AC ACCESSORY-LG', 'LAPTOP-VAIO', 'AC-COLD-3HP-UNION AIRE', 'FAN-SONAI', 'COOKER-LA GERMANYA', 'HOBS-FAGOR', 'GAS HEATER-OLYMPIC', 'MOBILE-REALME', 'AC-COLD-1.5HP-ULTRA', 'DEEP FREEZER-UNION AIRE', 'AC-HOT/COLD-3HP-BEKO', 'THERMAL VESSEL-WACACO', 'KETTLE-TOUCH', 'ALEXA ECHO DOT-ALEXA', 'TV-55-SMRT-TORNADO', 'HAIR DRYER-TORNADO', 'IRON-HOME TECH', 'ELE HEATER-UNIVERSAL', 'WARMER-TOUCH', 'AUDIO-TOSHIBA', 'KITCHEN M-SMART', 'F.PROC-ARIETE', 'TV-55-SMRT-SAMSUNG', 'MOSQ.KILL-HOME TECH', 'AC-HOT/COLD-2.25HP-HISENSE', 'CHOPPER-ROVO', 'HOBS-BAUMATIC', 'SHAVING_TRI-RUSH BRUSH', 'KITCHEN M-G.TEC', 'HOBS-BEKO', 'H.BLENDER-KENWOOD', 'TV-40-SMRT-SAMSUNG', 'AC-COLD-1.5HP-PREMIUM', 'AC-HOT/COLD-2.25HP-ULTRA', 'TV-65-SMRT-LG', 'CHOPPER-BLACK AND DECAR', 'LAPTOP-HUAWEI', 'HAIR DRYER-REMINGTON', 'AIR COOLER-FRESH', 'WASHING M-Toshiba', 'GAS HEATER-ARISTON', 'D WASHER-MIELE', 'DEEP FREEZER-PANASONIC', 'F.PROC-ULTRA', 'TV-ACCESSORY-HP', 'BMOBILE ACCESSORIES-LOGITECH', 'AC-HOT/COLD-1.5HP-FRESH', 'FRIDGE-WHITE POINT', 'AC-HOT/COLD-3HP-PREMIUM', 'WASHING M-FRESH', 'MICROWAVE-SMART', 'TOOLS-HITACHI', 'KETTLE-TORNADO', 'TV-32-SMRT-CAIXUN', 'COOKING APPLIANCES-ARIETE', 'DEEP FREEZER-PASSAP', 'H.BLENDER-MIENTA', 'COOKER-FRESH', 'M.MINCER-BOSCH', 'OVEN-BOSCH', 'MOBILE-OPPO', 'HOOD-ICOOK', 'AC ACCESSORY-FRESH', 'M.MINCER-MODEX', 'H.BLENDER-TOUCH', 'STRAIGHTNERS-MIENTA', 'IRON-TORNADO', 'MICROWAVE-BLACK AND DECAR', 'AC-COLD-1.5HP-MIDEA', 'GRILL-MIENTA', 'WASHER DRY ASS-MIELE', 'AC-HOT/COLD-4HP-FRESH', 'COMPLEMENTARY-EPSON', 'HOOD-ZANUSSI', 'FUN LINE-ARIETE', 'ELE HEATER-ARISTON', 'BMOBILE ACCESSORIES-OSN', 'LAM-PHILIPS', 'KETTLE-ZAHRAN', 'TV-32-SAMSUNG', 'KITCHEN M-TOUCH', 'FAN-UNION AIRE', 'VC-BLACK AND DECAR', 'AC-HOT/COLD-1.5HP-UNION AIRE', 'AC-HOT/COLD-2.25HP-UNION AIRE', 'TV-60-SMRT-TORNADO', 'KITCHEN M-BLACK AND WHITE', 'TV-43-HAIER', 'LAPTOP-DELL', 'TV-ACCESSORY-HAMA', 'FRIDGE-ARISTON', 'TOASTER-PANASONIC', 'AC-HOT/COLD-5HP-CARRIERE', 'ELE HEATER-OLYMPIC', 'VC-SMART', 'JUICER-KENWOOD', 'STRAIGHTNERS-TORNADO', 'TV-32-TORNADO', 'AC-COLD-2.25HP-ULTRA', 'COFFEE M-SONAI', 'HOOD-FRESH', 'TV-55-SMRT-ULTRA', 'FAN-UNIVERSAL', 'HAIR DRYER-RUSH BRUSH', 'WD-WHITE WHALE', 'BLENDER-BRAUN', 'VC-BISSELL', 'LAPTOP-MSI', 'COFFEE M-NESPRESSO', 'H.BLENDER-SEM', 'HOBS-GLEMGAS', 'GIFT-BOSCH', 'D WASHER-ARISTON', 'WARMER-ULTRA', 'H.MIXER-FRESH', 'SHAVING_TRI-HAPILLINE', 'TV-43-TOSHIBA', 'AC-COLD-1.5HP-HAIER', 'BMOBILE ACCESSORIES-STEEL', 'TV-32-SMRT-SHARP', 'WASHING M-KIRIAZI', 'D WASHER-BOSCH', 'TV-50-SMRT-LG', 'FAN-KENWOOD', 'WD-FRESH', 'TV-32-FRESH', 'COFFEE M-OKKA', 'OVEN-ULTRA', 'TV-43-SMRT-LG', 'WASHING M-WHITE POINT', 'KETTLE-BRAUN', 'KETTLE-PANASONIC', 'AIR PURIFIER-DAIKIN', 'E.HOT PLATE-FRESH', 'VC-BLACK AND WHITE', 'AIR PURIFIER-SHARP', 'WD-KOLDAIR', 'COFFEE M-MEDIA TECH', 'WALL HOOD-FRESH', 'BLENDER-HOME TECH', 'HOOD-MIELE', 'F.PROC-SONAI', 'GRILL-TOUCH', 'TOASTER-KENWOOD', 'COMPLEMENTARY-DELL', 'KITCHEN M-MOULINEX', 'GIFT-NESTLE', 'KITCHEN M-HOME TECH', 'RECEIVER-MUTECH', 'F.PROC-TORNADO', 'F.PROC-BLACK AND DECAR', 'IRON-BLACK AND DECAR', 'F.PROC-G.TEC', 'CHOPPER-SMART', 'FUN LINE-MIENTA', 'H.MIXER-BOSCH', 'GAS HEATER-KIRIAZI', 'AC ACCESSORY-SHARP', 'AC-HOT/COLD-1.5HP-LG', 'IRON-BRAUN', 'TV-32-ULTRA', 'KETTLE-SENCOR', 'TV-50-SMRT-ULTRA', 'TV-55-SMRT-LG', 'OVEN-HOOVER', 'MOBILE-LAVA', 'RECEIVER-TRUMAN', 'BLENDER-MODEX', 'FRAYER-ARISTON', 'GAS HEATER-UNION AIRE', 'TANK-SEASONS', 'CHOPPER-SONAI', 'M.MINCER-SMART', 'IRON-TOUCH', 'FAN-TORNADO', 'KITCHEN M-MIENTA', 'GAS HEATER-UNIVERSAL', 'KITCHEN M-SARY', 'TV-55-SMRT-SONY', 'R.COOKER-MEDIA TECH', 'TV-ACCESSORY-FALCON', 'FAN-SMART', 'MIXER-MEDIA TECH', 'COFFEE GRINDER-ARIETE', 'VC-KENWOOD', 'HOBS-SMART', 'TV-32-SMRT-NIKAI', 'H.MIXER-SMART', 'TOASTER-ARIETE', 'OVEN-ELBA', 'COOKER-WHITE POINT', 'WASHING M-HOOVER', 'BLENDER-SARY', 'FRIDGE-TORNADO', 'JUICER-TORNADO', 'AC-COLD-2.25HP-CARRIERE', 'TV-32-PLUTO', 'BMOBILE ACCESSORIES-STRONG', 'TV-ACCESSORY-LG', 'TV-50-SMRT-TOSHIBA', 'VC-PANASONIC', 'KITCHEN M-KENWOOD', 'BMOBILE ACCESSORIES-TOSHIBA', 'JUICER-SOLAC', 'COOKER-UNIVERSAL', 'MOBILE-NOKIA', 'M.MINCER-TOUCH', 'COFFEE M-BIALETTI', 'HOOD-BOSCH', 'HAIR DRYER-PHILIPS', 'AC-COLD-1.5HP-CARRIERE', 'TV-ACCESSORY-KEENDEX', 'VC-TORNADO', 'CHOPPER-MOULINEX', 'WARMER-DELONGHI', 'BMOBILE ACCESSORIES-HP', 'BMOBILE ACCESSORIES-LDNIO', 'H.BLENDER-BRAUN', 'TV-ACCESSORY-HISENSE', 'HOBS-NARDI', 'IRON-TEFAL', 'TV-85-SMRT-SAMSUNG', 'RECEIVER-DALY', 'JUICER-MIENTA', 'MIXER-ULTRA', 'TV-ACCESSORY-SYINIX', 'TV-70-SMRT-SAMSUNG', 'WARMER-FRESH', 'WASHING M-TOSHIBA', 'WASHER DRYER-LG', 'BLENDER-MIENTA', 'GRILL-BLACK AND DECAR', 'TV-43-SMRT-TORNADO', 'AC-HOT/COLD-3HP-MIDEA', 'H.BLENDER-BLACK AND DECAR', 'BLENDER-ULTRA', 'FRIDGE-ZANUSSI', 'TV-55-SMRT-HI-SAMSUNG', 'GIFT-SAMSUNG', 'DEEP FREEZER-TOSHIBA Midea', 'TV-43-CAIXUN', 'TV-ACCESSORY-ELIOS', 'AC ACCESSORY-DAIKIN', 'GAS HEATER-WHITE POINT', 'TV-32-HAIER', 'AC-HOT/COLD-2.25HP-GENERAL ELECTRIC', 'AC-HOT/COLD-1.5HP-ZANUSSI', 'AIR COOLER-SONAI', 'TOOLS-BOSCH', 'SHAVING_TRI-BABYLISS', 'FRAYER-HOME TECH', 'HOOD-ARISTON', 'FRIDGE-FRESH', 'AUDIO-MEDIA TECH', 'TV-65-SMRT-UNION AIRE', 'D WASHER-BEKO', 'BLENDER-SONAI', 'WARMER-TORNADO', 'FRIDGE-MIELE', 'CHOPPER-KENWOOD', 'KETTLE-SOLAC', 'FAN-MIENTA', 'AUDIO-AVANTREE', 'CHOPPER-MEDIA TECH', 'TV-55-SMRT-SHARP', 'TV-32-SMRT-SAMSUNG', 'AC ACCESSORY-CRAFT', 'KETTLE-KENWOOD', 'GIFT-LG', 'TV-ACCESSORY-ILOOK', 'CHOPPER-TORNADO', 'TV-65-SMRT-TORNADO', 'AC-COLD-1.5HP-CRAFT', 'TV-43-SMRT-TOSHIBA', 'IRON-BLACK AND WHITE', 'TV-ACCESSORY-MEDIA TECH', 'IRON-SOLAC', 'AC-HOT/COLD-5HP-SHARP', 'TABLET-LENOVO', 'GRILL-BOSCH', 'WASHING M-ARISTON', 'ELE HEATER-CLAGE', 'ELE HEATER-TOSHIBA', 'SCALE-SOLAC', 'BLENDER-ARIETE', 'H.BLENDER-MEDIA TECH', 'TV-75-SMRT-LG', 'DEEP FREEZER-FRESH', 'AC-HOT/COLD-4HP-SHARP', 'FAN-FRESH', 'FUN LINE-HOME TECH', 'MICROWAVE-HOME TECH', 'TV-32-SMRT-TOSHIBA', 'WASHING M-SAMSUNG', 'HOOD-PREMIER', 'TV-32-PREMIUM', 'AC-HOT/COLD-1.5HP-AMERICOOL', 'TV-43-NIKAI', 'F.PROC-BRAUN', 'KETTLE-MODEX', 'AC-HOT/COLD-2.25HP-TORNADO', 'WARMER-BLACK AND DECAR', 'TABLET-HUAWEI', 'WASHING M-HAIER', 'OVEN-FRESH', 'WASHING M-ZANUSSI', 'ELE HEATER-ATLANTIC', 'WASHING M-CANDY', 'STRAIGHTNERS-BABYLISS', 'GAS HEATER-FERROLI', 'H.BLENDER-G.TEC', 'RECEIVER-SKYWORTH ZAPPER', 'MINCER-HOME TECH', 'CHOPPER-ULTRA', 'SHAVING_TRI-BRAUN', 'KITCHEN M-MODEX', 'MOBILE-HONOR', 'ELE HEATER-SHTEBEL', 'FRAYER-MODEX', 'MICROWAVE-LG', 'AIR COOLER-HOME TECH', 'MIXER-UNION AIRE', 'AC ACCESSORY-CARRIERE', 'GIFT-ARISTON', 'MINCER-BLACK AND DECAR', 'GRILL-TORNADO', 'OVEN-KLASS', 'STRAIGHTNERS-REMINGTON', 'MICROWAVE-ARISTON', 'VC-MIELE', 'R.COOKER-BLACK AND DECAR', 'TOASTER-BRAUN', 'FRAYER-PHILIPS', 'ELE HEATER-UNION AIRE', 'AC ACCESSORY-HAIER', 'OVEN-BEKO', 'AC-COLD-1.5HP-FRESH', 'IRON-ULTRA', 'ELE HEATER-TORNADO', 'DRYER-HOME TECH', 'OVEN-BRANDT', 'AC-HOT/COLD-2.25HP-MIDEA', 'AUDIO-DOB', 'H.MIXER-KENWOOD', 'ELE HEATER-VEITO', 'BLENDER-SMART', 'GAS HEATER-FRESH', 'MICROWAVE-SAMSUNG', 'COOKER-ZANUSSI', 'AC-COLD-2.25HP-FRESH', 'TV-43-TORNADO', 'AC-HOT/COLD-3HP-UNION AIRE', 'TV-ACCESSORY-ORIGINAL', 'COFFEE M-TEFAL', 'COMPLEMENTARY-XIAOMI', 'TV-32-SONY', 'TABLET-APPLE', 'IRON-PANASONIC', 'KETTLE-BOSCH', 'HOOD-PANASONIC', 'KETTLE-SMART', 'AIR COOLER-TORNADO', 'GRILL-MODEX', 'AIR PURIFIER-LG', 'LAPTOP-HP', 'COOKER-BEKO', 'BLENDER-G.TEC', 'AUDIO-FIRST', 'OVEN-SIMFER', 'HOOD-TOUCH', 'IRON-ARIETE', 'FRAYER-BLACK AND DECAR', 'GAS HEATER-ZANUSSI', 'VC-ARIETE', 'AC-HOT/COLD-2.25HP-CARRIERE', 'VC-LG', 'TV-43-SMRT-PLUTO', 'TV-65-SMRT-HI-LG', 'HOOD-FAGOR', 'FRIDGE-LG', 'AIR FRYER-SOLAC', 'BMOBILE ACCESSORIES-NI', 'AUDIO-ORAIMO', 'COFFEE M-MIENTA', 'MIXER-MODEX', 'WASHING M-TORNADO', 'SHAVING_TRI-PHILIPS', 'GAS HEATER-ATLANTIC', 'HOBS-ELBA', 'HOBS-INDESIT', 'TV-50-SMRT-HAIER', 'TV-50-SMRT-PLUTO', 'COFFEE M-PHILIPS', 'AC ACCESSORY-UNION AIRE', 'KETTLE-ZADA', 'CHOPPER-ARIETE', 'TV-32-UG', 'TV-50-SMRT-UNION AIRE', 'F.PROC-UNION AIRE', 'BMOBILE ACCESSORIES-MUSIC HERO', 'AC ACCESSORY-ZANUSSI', 'AC-HOT/COLD-2.25HP-BEKO', 'OVEN-HOME TECH', 'TV-55-SMRT-PREMIUM', 'FAN-TEFAL', 'FRIDGE-INDESIT', 'FRIDGE-KIRIAZI', 'KETTLE-BLACK AND WHITE', 'MOBILE-SAMSUNG', 'KETTLE-BLACK AND DECAR', 'H.MIXER-BRAUN', 'COMPLEMENTARY-BENQ', 'TV-55-SMRT-TCL', 'KETTLE-FRESH', 'GAS HEATER-LONGLIFE', 'THERMAL VESSEL-SEASONS', 'MICROWAVE-KENWOOD', 'COMPLEMENTARY-INTEL', 'COFFEE M-SMART', 'GAS HEATER-ARION', 'FAN-ARION', 'HOBS-TORNADO', 'TV-86-SMRT-UNION AIRE', 'VC-MIENTA', 'MICROWAVE-DAEWOO', 'FRIDGE-BOSCH', 'WD-TORNADO', 'BMOBILE ACCESSORIES-LAVVENTO', 'TV-43-LG', 'TV-50-ULTRA', 'TOASTER-TORNADO', 'COMPLEMENTARY-LENOVO', 'CHOPPER-MIENTA', 'COOKER-PREMIUM', 'BLENDER-KENWOOD', 'F.PROC-BOSCH', 'BLENDER-FRESH', 'TV-50-SMRT-PREMIUM', 'AC-HOT/COLD-7HP-CARRIERE', 'KETTLE-MEDIA TECH', 'WD-WHITE POINT', 'COOKER-WHITE WHALE', 'JUICER-MEDIA TECH', 'FRIDGE-ELECTROSTAR', 'AC-COLD-3HP-FRESH', 'DEEP FREEZER-MIELE', 'COFFEE M-WHITE WHALE', 'TV-50-SMRT-TORNADO', 'TOOLS-MPT HT', 'KETTLE-HOUSECOM', 'KETTLE-ARIETE', 'COMPLEMENTARY-CANON', 'AC-COLD-3HP-CARRIERE', 'TV-ACCESSORY-ETI', 'TV-65-SMRT-TCL', 'FRIDGE-WHITE WHALE', 'VC-SOLAC', 'JUICER-MOULINEX', 'AUDIO-PHILIPS', 'FILTER 5 STAGES-SEASONS', 'COFFEE M-BRAUN', 'WARMER-AKWRJ', 'TV-55-SMRT-TOSHIBA', 'MOBILE-INFINX', 'DRYER-ARISTON', 'H.MIXER-SONAI', 'RECIEVER-TIGER', 'ELE HEATER-FLYON', 'TV-ACCESSORY-TRUMAN', 'AC-HOT/COLD-1.5HP-SHARP', 'TV-75-SMRT-HI-SHARP', 'FRAYER-FRESH', 'OVEN-TORNADO', 'BLENDER-TOUCH', 'MIXER-BLACK AND WHITE', 'LAPTOP-MICROSOFT', 'VC-ULTRA', 'COFFEE M-TORNADO', 'TOOLS-CLABER', 'F.PROC-MIENTA', 'R.COOKER-HOME TECH', 'WASHING M-PREMIUM', 'HOOD-TORNADO', 'AC-HOT/COLD-1.5HP-BEKO', 'HOBS-ARISTON', 'LAPTOP-ASUS', 'WD-ULTRA', 'WARMER-VEITO', 'ELE HEATER-WHITE WHALE', 'AC-HOT/COLD-4HP-LG', 'F.PROC-GROUHY', 'ELE HEATER-ZANUSSI', 'DEEP FREEZER-KIRIAZI', 'FRAYER-MIELE', 'OVEN-MIENTA', 'F.PROC-SMART', 'TV-32-SMRT-SONY', 'FAN-TOUCH', 'GRILL-TEFAL', 'GRILL-HOME TECH', 'D WASHER-ZANUSSI', 'TV-43-SMRT-ULTRA', 'H.BLENDER-HOME TECH', 'AC-HOT/COLD-1.5HP-TORNADO', 'COFFEE M-SOLAC', 'WASHING M-INDESIT', 'DEEP FREEZER-LG', 'AC-COLD-2.25HP-CRAFT', 'KITCHEN M-ARIETE', 'GAS HEATER-PREMIUM', 'TOOLS-MPT PT', 'FRIDGE-HAIER', 'MDA-ZANUSSI', 'TV-55-SMRT-PLUTO', 'WASHING M-MIELE', 'BLENDER-PANASONIC', 'AC-HOT/COLD-1.5HP-CARRIERE', 'CHOPPER-FRESH', 'JUICER-BRAUN', 'H.BLENDER-SENCOR', 'AC-HOT/COLD-3HP-CARRIERE', 'F.PROC-PANASONIC', 'JUICER-HOME TECH', 'IRON-MIENTA', 'H.MIXER-MODEX', 'HOOD ASS-INDESIT', 'MINCER-BOSCH', 'AC-COLD-3HP-TORNADO', 'RECEIVER-ETI', 'MDA ASS-INDESIT', 'COOKER-KIRIAZI', 'KETTLE-ARION', 'AC ACCESSORY-PREMIUM', 'CAPPUCCINO MAKER-ARIETE', 'FUN LINE-TORNADO', 'CHOPPER-BOSCH', 'TV-85-SMRT-HI-LG', 'COMPLEMENTARY-SONY', 'TV-32-TCL', 'SHAVING_TRI-REMINGTON', 'TV-ACCESSORY-ITEL', 'FRIDGE-IDEAL', 'TV-65-SMRT-SAMSUNG', 'MOBILE-XIAOMI', 'F.PROC-MODEX', 'OVEN-TOUCH', 'MICROWAVE-SHARP', 'KETTLE-SONAI', 'MICROWAVE-HOOVER', 'TV-ACCESSORY-FRESH', 'VC-BOSCH', 'WASHING M-BOSCH', 'VC-MODEX', 'WARMER-HELLER', 'MASHER-MIENTA', 'FUN LINE-MEDIA TECH', 'MASHER-BLACK AND WHITE', 'FRIDGE-UNION AIRE', 'TV-50-SMRT-SAMSUNG', 'GAS HEATER-PASSAP', 'FILTER ASS-PHILIPS', 'AC-COLD-1.5HP-LG', 'TV-86-SMRT-LG', 'VC-ROVO', 'HOBS-KLASS', 'R.COOKER-MODEX', 'HOBS-BOSCH', 'DEEP FREEZER-ELECTROSTAR', 'GIFT-FRESH', 'TV-65-SMRT-HI-SAMSUNG', 'TV-43-ULTRA', 'WASHING M-FAGOR', 'TV-85-SMRT-HI-SAMSUNG', 'AC-COLD-3HP-PREMIUM', 'GIFT-INFINX', 'AC-COLD-7HP-CARRIERE', 'AC-HOT/COLD-3HP-LG', '0', 'TV-50-SMRT-HI-LG', 'COFFEE M-BLACK AND DECAR', 'AC-HOT/COLD-1.5HP-HISENSE', 'AC-HOT/COLD-1.5HP-MIDEA', 'AC-HOT/COLD-5HP-FRESH', 'M.MINCER-BRAUN', 'H.MIXER-ROVO', 'AC-COLD-1.5HP-TORNADO', 'LAPTOP-LENOVO', 'IRON-MEDIA TECH', 'WD-BERGEN', 'COFFEE M-MODEX', 'FUN LINE-BLACK AND DECAR', 'VC-FRESH', 'CHOPPER-TOUCH', 'OVEN-ARISTON', 'MIXER-TOUCH', 'ELE HEATER-BOMAN', 'M.MINCER-PANASONIC', 'TV-40-SMRT-VIEW', 'M.MINCER-KENWOOD', 'FILTER ASS-SEASONS', 'TV-50-SMRT-SONY', 'D WASHER-FRESH', 'AC-HOT/COLD-2.25HP-SHARP', 'IRON-KENWOOD', 'TV-32-SMRT-FRESH', 'H.BLENDER-BOSCH', 'HOBS-BRANDT', 'TV-40-SMRT-UNION AIRE', 'JUICER-BOSCH', 'FUN LINE-SOLAC', 'TV-ACCESSORY-FORA', 'BMOBILE ACCESSORIES', 'H.MIXER-MEDIA TECH', 'BLENDER-TORNADO', 'AC-COLD-2.25HP-MIDEA', 'COOKER-ROYAL', 'KETTLE-MIENTA', 'AC-HOT/COLD-1.5HP-PREMIUM', 'WASHING M-SHARP', 'BLENDER-BLACK AND DECAR', 'M.MINCER-TORNADO', 'TV-70-SMRT-LG', 'AIR STYLER-BABYLISS', 'AC-COLD-3HP-ULTRA', 'AC-HOT/COLD-5HP-LG', 'TV-40-CONTEX', 'GRILL-SOLAC', 'AC-COLD-2.25HP-LG', 'WASHING M-LG', 'AC-HOT/COLD-3HP-ULTRA', 'GIFT-UNIVERSAL', 'VC-TEFAL', 'TV-50-SMRT-SHARP', 'DEEP FREEZER-BEKO', 'COMPLEMENTARY-NIKON', 'HOOD-FRANKE', 'FRIDGE-BEKO', 'GRILL-MEDIA TECH', 'ESPRESSO MACH-ARIETE', 'AC-HOT/COLD-3HP-TORNADO', 'FRAYER-TEFAL', 'TV-43-SMRT-SAMSUNG', 'AC-HOT/COLD-3HP-SHARP', 'COFFEE M-KENWOOD', 'AC-HOT/COLD-1.5HP-ULTRA', 'SPORT MACHINE-FUTURE', 'AUDIO-LG', 'H.MIXER-MOULINEX', 'AC-COLD-1.5HP-AMERICOOL', 'DEEP FREEZER-INDESIT', 'HAIR DRYER-ARZUM', 'H.MIXER-TORNADO', 'WASHING M-UNION AIRE', 'COFFEE M-DELONGHI', 'TV-43-SMRT-PREMIUM', 'BMOBILE ACCESSORIES-DAHUA', 'AC-HOT/COLD-3HP-FRESH', 'GAS HEATER-PANASONIC', 'MASHER-KENWOOD', 'TV-32-SMRT-TORNADO', 'BLENDER-BLACK AND WHITE', 'FRAYER-DELONGHI', 'AC-COLD-2.25HP-TORNADO', 'H.BLENDER-BLACK AND WHITE', 'BLENDER-BOSCH', 'OVEN-MIELE', 'HOOD-INDESIT', 'R.COOKER-TEFAL', 'NON', 'HOBS-MIELE', 'GAS HEATER-BOSCH', 'AC-HOT/COLD-3HP-GENERAL ELECTRIC', 'THERMAL VESSEL-TIGER', 'TV-ACCESSORY-ICONZ', 'LAPTOP-APPLE', 'GIFT-INDESIT', 'TV-75-SMRT-SAMSUNG', 'AC-COLD-3HP-CRAFT', 'TV-75-SMRT-UNION AIRE', 'TOASTER-BLACK AND DECAR', 'AC-HOT/COLD-2.25HP-FRESH', 'F.PROC-HOME TECH', 'HOBS-ICOOK', 'STRAIGHTNERS-RUSH BRUSH', 'MOBILE-HUAWEI', 'LAM-BLACK AND DECAR', 'HOOD-ELBA', 'AC-COLD-3HP-MIDEA', 'MOBILE-HOPE', 'HOBS-FRANKE', 'TV-50-SMRT-TCL', 'COFFEE M-HOME TECH', 'BMOBILE ACCESSORIES-SONY', 'AIR STYLER-RUSH BRUSH', 'COOKER-UNION AIRE', 'H.BLENDER-SARY', 'FRIDGE-SAMSUNG', 'TV-ACCESSORY-NOUR TECH', 'MICROWAVE-FRESH', 'AC-COLD-3HP-LG', 'FRAYER-BERGEN', 'VC-GROUHY', 'TV-ACCESSORY-SCHNEIDER', 'M.MINCER-BLACK AND WHITE', 'F.PROC-KENWOOD', 'GRILL-FRESH', 'DEEP FREEZER-ALASKA', 'COFFEE M-BEKO', 'OVEN-INDESIT', 'VC ACCESSORIES-MIELE', 'H.MIXER-MIENTA', 'MIXER-BLACK AND DECAR', 'BMOBILE ACCESSORIES-ORIGINAL', 'D WASHER-BeKO', 'H.BLENDER-MOULINEX', 'TOOLS-SNDWAY', 'FRIDGE-SHARP', 'CURL IRONS-RUSH BRUSH', 'FAN-ULTRA', 'BLENDER-MOULINEX']} the_received_subfilter
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
703.645535248 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('3808.2279845884907466')), ('initial_average_retail_price', Decimal('13546.286790801940')), ('proposed_sellthru_percent', Decimal('48.5697521451849194')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('32.8921390558196550')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.892139055819655), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 12831169972.79654), ('budget_cost', 5601449879.567297), ('deficit', Decimal('12831169973.2249')), ('Original_BudgetAmount', Decimal('12831169973.2249')), ('budget_percent', Decimal('96.7618')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 2370360.0), ('ACT_FCT', Decimal('1536036625.7300')), ('Original_BudgetCostofGoods', Decimal('5601449879.5660')), ('PO', Decimal('40890387740.5243')), ('COSTPRICE', 4831880617.746758), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('1536036625.7300')), ('stock_on_hand_qty', Decimal('3240370')), ('net_sales_ly', Decimal('8462602914.6000')), ('net_sales_lly', Decimal('1008665929.1300')), ('gross_sales_ly', Decimal('8785316371.4840')), ('total_sku_count', Decimal('516989')), ('ly_customer_disc', Decimal('322713456.8840')), ('SupplyCost', Decimal('5321377385.5893')), ('SALESQTY', 2301685.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('88.8880')), ('budget_qty_act_fct_percent', Decimal('214704057.1205')), ('budget_vs_py_qty_percent', Decimal('132335726.8010')), ('budget_vs_ppy_qty_percent', Decimal('224766467.3714')), ('QTY_Buy_By_SKU', Decimal('2370360.0000')), ('total_sku_count_ty', Decimal('117451464721')), ('total_sku_count_lly', Decimal('36593')), ('total_sku_count_ly', Decimal('258604')), ('quantity_mix_percent', Decimal('101.9082')), ('quantity_act_forecast', Decimal('2628399.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('1656628.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('145914400.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.1049')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('5601449879.5660')), ('budget_vs_py_cost_percent', Decimal('322455471823.7000')), ('budget_vs_ppy_cost_percent', Decimal('34687483914.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('1019331382.8400')), ('cost_of_goods_ly', Decimal('3517052337.0670')), ('cost_act_forecast', Decimal('6620781262.4060')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('735862049080.9877')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('521496390.6500')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('1.9483')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('24819.1229')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('24819.1229')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
703.843055556 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 3808.2279 ┆ 13546.286 ┆ … ┆ 0.0       ┆ 24819.122 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆ 85        ┆ 791       ┆   ┆           ┆ 9         ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 58.440064         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 3.2271e8   ┆ 8.4626e9   ┆ 1.2831e10  ┆ 58.527731 ┆ 1.3320e10 ┆ 48.569752 ┆ 2.7425e10 ┆ 3.673328  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x7697469EFBB0>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x7697469EC1C0>, <Expr ['col("SalesActualsByForecast").…'] at 0x7697469EFE50>, <Expr ['col("initial_average_retail_pr…'] at 0x7697469EFD30>, <Expr ['col("proposed_sellthru_percent…'] at 0x7697469EFA30>, <Expr ['col("retail_value_including_ma…'] at 0x7697469EF7C0>, <Expr ['col("budget_gross_margin_perce…'] at 0x7697469EF8E0>, <Expr ['col("Logistic%").mean()'] at 0x7697469EFE20>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x7697469EC1F0>, <Expr ['col("MarkdownValue").mean()'] at 0x7697469EF6D0>, <Expr ['col("markdown_percent").mean()'] at 0x7697469EC220>, <Expr ['col("DisplayItemValue").mean()'] at 0x7697469EFC40>, <Expr ['col("budget_amount").sum()'] at 0x7697469EF790>, <Expr ['col("budget_cost").sum()'] at 0x7697469ECDC0>, <Expr ['col("deficit").sum()'] at 0x7697469EC190>, <Expr ['col("Original_BudgetAmount").s…'] at 0x7697469EF760>, <Expr ['col("budget_percent").sum()'] at 0x7697469EFD00>, <Expr ['col("relative_budget_percent")…'] at 0x7697469EE770>, <Expr ['col("History_Net_Sales").sum()'] at 0x7697469EE710>, <Expr ['col("budget_qty").sum()'] at 0x7697469EE7D0>, <Expr ['col("ACT_FCT").sum()'] at 0x7697469EF8B0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x7697469EE6B0>, <Expr ['col("PO").sum()'] at 0x7697469EE6E0>, <Expr ['col("COSTPRICE").sum()'] at 0x7697469EE650>, <Expr ['col("Historical_Gross_Margin")…'] at 0x7697469EC0A0>, <Expr ['col("sales_actual").sum()'] at 0x7697469EE8C0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x7697469EEAA0>, <Expr ['col("net_sales_ly").sum()'] at 0x7697469EE950>, <Expr ['col("net_sales_lly").sum()'] at 0x7697469EEA70>, <Expr ['col("gross_sales_ly").sum()'] at 0x7697469EE890>, <Expr ['col("total_sku_count").sum()'] at 0x7697469EE9E0>, <Expr ['col("ly_customer_disc").sum()'] at 0x7697469EED10>, <Expr ['col("SupplyCost").sum()'] at 0x7697469EEE60>, <Expr ['col("SALESQTY").sum()'] at 0x7697469EE8F0>, <Expr ['col("DisplayItemQty").sum()'] at 0x7697469EEB00>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x7697469EEE90>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x7697469EEE00>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x7697469EC070>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x7697469EECB0>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x7697469EC130>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x7697469EF040>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x7697469EF0D0>, <Expr ['col("total_sku_count_lly").sum…'] at 0x7697469EEF20>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x7697469EEB90>, <Expr ['col("quantity_mix_percent").su…'] at 0x7697469EF0A0>, <Expr ['col("quantity_act_forecast").s…'] at 0x7697469EEFE0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697469EF280>, <Expr ['col("sold_qty_ly").sum()'] at 0x7697469EEF50>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697469EF370>, <Expr ['col("quantity_act_or_forecast_…'] at 0x7697469EEBC0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697469EF220>, <Expr ['col("budget_cost_percent").sum…'] at 0x7697469EF4C0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x7697469EF460>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x7697469EF580>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x7697469EF3D0>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x7697469EF400>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x7697469EF160>, <Expr ['col("cost_mix_percent").sum()'] at 0x7697469EF610>, <Expr ['col("cost_actuals").sum()'] at 0x7697469EFF40>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x7697469EF520>, <Expr ['col("cost_act_forecast").sum()'] at 0x7697469EF250>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x7697469EC2B0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x7697469EC2E0>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x7697469EC3A0>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x7697469EF490>, <Expr ['col("budget_margin_percent").s…'] at 0x7697469EF640>, <Expr ['col("budget_margin_mix_percent…'] at 0x7697469EC340>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x7697469EC520>, <Expr ['col("margin_actuals").sum()'] at 0x7697469EFEB0>, <Expr ['col("margin_act_forecast").sum…'] at 0x7697469EC640>, <Expr ['col("units_per_sku_total").sum…'] at 0x7697469EC370>, <Expr ['col("units_per_sku_lly").sum()'] at 0x7697469EFA90>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x7697469EEC20>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x7697469EC6A0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x7697469EC400>, <Expr ['col("initial_average_retail_pr…'] at 0x7697469EC700>, <Expr ['col("initial_average_retail_pr…'] at 0x7697469EC760>, <Expr ['col("budget_per_sku").sum()'] at 0x7697469EC250>, <Expr ['col("budget_qty_ty").sum()'] at 0x7697469EC8E0>, <Expr ['col("Check_box").max()'] at 0x7697469EC670>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,3808.2279845885,13546.2867908019,48.5697521452,13320474653.587305069,56.3449795191,5.0,56.3449795191,32271345688.4000015259,3.6733276667,0.0,12831169972.7965393066,5601449879.5672969818,12831169973.224899292,12831169973.224899292,100.0,100.0,0.0,2370360.0,1536036625.7300000191,5601449879.5659999847,40890387740.5242996216,4831880617.746758461,0.0,1536036625.7300000191,3240370.0,8462602914.6000003815,1008665929.1299999952,8785316371.4839992523,516989.0,322713456.8840000033,5321377385.5893001556,2301685.0,0.0,0.0,88.888,214704057.1204999983,132335726.800999999,224766467.3713999987,2370360.0,117451464721.0,36593.0,258604.0,101.9082,2628399.0,0.0,1656628.0,145914400.0,0.0,0.0,0.1049,0.0,0.0,5601449879.5659999847,322455471823.700012207,34687483914.0,0.0,1019331382.8400000334,3517052337.0669999123,6620781262.4060001373,0.0,0.0,0.0,0.0,735862049080.9876708984,0.0,0.0,521496390.6499999762,0.0,1.9483,0.0,24819.1229,0.0,0.0,0.0,0.0,24819.1229,0.0,0.0,151.6220257796,1272.0931283823,18.1508767602,5939.7249297381,100.0,4197624.2060776651,58.5277305431,43894981328.3108825684,58.4400642148,4945550577.533000946,0.0,0.0,7229720093.2292423248,123711706.8636342585,43894981328.3108825684,18242726052.9859313965,43894981328.3108825684,13320474653.587305069,12831169972.796541214,27425453219.8757858276,11373957859.1192588806,4813106.4868199034]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":3808.2279845885,"initial_average_retail_price":13546.2867908019,"proposed_sellthru_percent":48.5697521452,"retail_value_including_markdown":13320474653.587305069,"budget_gross_margin_percent":56.3449795191,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":56.3449795191,"MarkdownValue":32271345688.4000015259,"markdown_percent":3.6733276667,"DisplayItemValue":0.0,"budget_amount":12831169972.7965393066,"budget_cost":5601449879.5672969818,"deficit":12831169973.224899292,"Original_BudgetAmount":12831169973.224899292,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":2370360.0,"ACT_FCT":1536036625.7300000191,"Original_BudgetCostofGoods":5601449879.5659999847,"PO":40890387740.5242996216,"COSTPRICE":4831880617.746758461,"Historical_Gross_Margin":0.0,"sales_actual":1536036625.0,"stock_on_hand_qty":3240370.0,"net_sales_ly":8462602914.6000003815,"net_sales_lly":1008665929.1299999952,"gross_sales_ly":8785316371.4839992523,"total_sku_count":516989.0,"ly_customer_disc":322713456.8840000033,"SupplyCost":5321377385.5893001556,"SALESQTY":2301685.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":88.888,"budget_qty_act_fct_percent":214704057.1204999983,"budget_vs_py_qty_percent":132335726.800999999,"budget_vs_ppy_qty_percent":224766467.3713999987,"QTY_Buy_By_SKU":2370360.0,"total_sku_count_ty":117451464721.0,"total_sku_count_lly":36593.0,"total_sku_count_ly":258604.0,"quantity_mix_percent":101.9082,"quantity_act_forecast":2628399.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":1656628.0,"quantity_act_forecast_vs_ly_percent":145914400.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.1049,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":5601449879.5659999847,"budget_vs_py_cost_percent":322455471823.700012207,"budget_vs_ppy_cost_percent":34687483914.0,"cost_mix_percent":0.0,"cost_actuals":1019331382.8400000334,"cost_of_goods_ly":3517052337.0669999123,"cost_act_forecast":6620781262.4060001373,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":735862049080.9876708984,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":521496390.6499999762,"margin_act_forecast":0.0,"units_per_sku_total":1.9483,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":24819.1229,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":24819.1229,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":58.4400642148,"FirstMargin_percent":58.5277305431,"budget_vpy":151.6220257796,"budget_vppy":1272.0931283823,"StockatRetailPrice":43894981328.3108825684,"TYForecast":43894981328.3108825684,"LYvsACT_FCT_percent":100.0,"supply_retail_value":12831169972.796541214} }INFO:     connection closed
 data_json
WebSocket connection closed unexpectedly
{'history_date_range': {'fro': '2023-01-01', 'to': '2023-12-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-12-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': True, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-01-01', to='2023-12-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-12-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
704.861577003 start_to_execute main the stored procedure
conn established
sp executed
704.940294458 end of main the stored procedure
conn established
sku wise calc executed
704.9950387 end of sku wise stored proc
we called the sku wise stored procedure_init
We are getting data from ra_and_stock
704.998182421 started to fetch data
conn established
<function getData.<locals>.<lambda> at 0x769ca60f0ca0> dfafghaf
925.362726324 end of fetch data
(535152, 168) output data shape
111111111111111111111111111111111111111111111
processing...
we are calling main groupby process
INFO:     45.156.129.125:0 - "GET /cgi-bin/authLogin.cgi HTTP/1.1" 404 Not Found
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     connection open
1
WebSocket connection closed unexpectedly
1
WebSocket connection closed unexpectedly
1
conn established
sku wise calc executed
929.485822786 end of sku wise stored proc
conn established
[OrderedDict([('id', 244880), ('store', None), ('region', None), ('area', None), ('Channel', 'B.TECH X'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 244881), ('store', None), ('region', None), ('area', None), ('Channel', 'MINI'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 244882), ('store', None), ('region', None), ('area', None), ('Channel', 'WAREHOUSE'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 244883), ('store', None), ('region', None), ('area', None), ('Channel', 'ARKAN'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 244884), ('store', None), ('region', None), ('area', None), ('Channel', 'Retail'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)])] 3303 getData dictsize
929.601454558 end of fetch data
shape: (3_303, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 244880 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 244881 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 244882 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 244883 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 244884 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 248178 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 248179 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 248180 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 248181 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 248182 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the filter dataframe
shape: (3_303, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 244880 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 244881 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 244882 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 244883 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 244884 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 248178 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 248179 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 248180 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 248181 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 248182 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the_fiter_data
id Int64
store String
region String
area Int32
Channel String
budget_year Int32
budget_quarter String
budget_month String
budget_weekday Int64
budget_day String
budget_dates Int32
historical_year Int64
history_Quarter String
history_month String
history_week String
history_Day String
history_datess Int32
family String
sub_Family String
Supplier String
Category String
Dom_Comm String
Sub_Category String
Extended_sub_category String
Sub_Category_supplier String
Article_Score Int32
last_v store store
last_v region region
last_v Channel Channel
last_v Quarter budget_quarter
last_v month budget_month
last_v week budget_weekday
last_v Day budget_day
last_v history_Quarter history_Quarter
last_v history_month history_month
last_v history_Day history_Day
last_v family family
last_v sub_family sub_Family
last_v supplier Supplier
last_v category Category
last_v dom_comm Dom_Comm
last_v sub_category Sub_Category
last_v extended_sub_category Extended_sub_category
last_v sub_category_supplier Sub_Category_supplier
{'store': ['BTECHX Midor', 'Gesr El Suez Branch', 'BTECHX ElRehab Mall1', 'Ain Shams Branch - Mostafa Hafez St.', 'El-Elsoudan Street Branch', 'CFC Mall', 'Show Room - Corp. Sale-38', 'BTECHX Roxcy', 'El Tahrir', 'Zahra El Asher Branch', 'El Seyouf Branch', 'Faisal Branch', 'Roxy Branch', 'Alex_ Tusun', 'BTECHX El Menia', 'BTECHX San_Stefano Mall', 'Luxor Branch', 'BTECH Mini Air Force House', 'BTECHX ElRehab North', 'Makram Ebaid Branch', 'Qena Branch', 'Beni Suef Branch', 'El-Gouna Branch', 'BTECHXMataria', 'BTECHX El Mosher Axis', 'Misr elgdida', 'BTECH2Fayoum', 'BTECHX Ramses Station', 'Ismaila Branch-Railway station', 'Town Center El Salam', 'BTECHX Assuit', 'Shebin El Koum Branch', 'Mansoura Branch', 'Mega Helwan', '26Th July Branch', 'BTECHXCFC', 'BTECHX Kafr ElSheikh', 'Mahalla Branch', 'BTECHX Sidi Bishr', 'Amwaj ranch', 'El Galaa', 'BTECHX Gihan3 Abasia', 'BTECHX City Stars Mall', 'BTECHX CityCenter Alex', 'B.TECH X AUC', 'BTECHX Maadi Grand Mall', '9025Show Room Alex', 'BTECHX ASU', 'El Sayeda Zainab', 'Damanhour Branch', 'Nagaa Hamadi Branch', 'New Dumietta Branch', 'Cairo Retail Warehouses', 'Asafra Branch', 'Hadek El Kobba Branch', '10th Tech Club WH', 'Marassi-North-Coast Branch', 'BTECHX Dokki', 'Haram Branch', 'Jumia Seller Store', 'BTECHX Safwa Zaid ', 'BTECH mini Egyptian Shooting ', 'El Betash Branch', 'Aswan WH', '0', 'Qalyub', 'Dakernis Branch', 'El Fayoum Branch', 'Deel Asyut WH', 'Noon Seller Store1', 'BTECHX Moharam Bek', 'Corporate Sales', 'Alex WH', 'BTECHX Triumph Tagamo', 'Mega Fisal', 'Abbas El-Akkad Branch', 'Ismalia Branch-City Council Square', 'BTECHX Sporting Club', 'B.TECHX El Mandara', 'Maadi Branch-El Laselky St.', 'Asyut WH', 'BTECHX Ismailia Square', 'BTECHX Shebin El koum', 'Mall Of Egypt Branch', 'Assuit Mega Branch', 'Masara', '3Tanta Mall', 'Sky Mall El Sherouk Branch', 'Marina Branch', 'BTECHX Kasr El Einy', 'Uni Mall El Obour', 'Aswan Mega  Branch', 'Hassan El Maamon', 'Delta Tanta Mega Store', 'Ain Shams Branch - Ibrahim Abdel Razek St.', 'B2B Gov', 'Tanta Branch', 'Malawi Branch', 'Sohag Branch', 'Banha warehouse', 'Suez Branch', 'Marina Kaian Branch', 'HQ Call Center', 'Shubra El Kheima Branch', 'B.ONLINE', 'Agami Branch', 'BTECHX El Sherouk', 'Winget Branch', 'BTECHX Saad El Din El Shazly', 'QENA-Warehouse', 'New Roxy', '10th Show Room WH', 'Berket Elsabaa Branch', 'Almaza Branch', 'Eldahar Mega Branch', 'BTECH Mini MPC', 'BTECHX Sheraton', 'Oraby Branch', 'Sale With Cost W.H', 'Elagamy2', 'Dar El Salam Branch', 'Fakous Branch', 'Zagazig Branch', 'El Sadat Branch', 'Desouk Branch', 'EL Matria', 'Mall Of October Branch', '1Imbaba', 'BTECHX 2Mansoura', 'BTECHX Sohag', 'Salah Salim Branch', 'Mall Of Arabia Branch', 'Makadi Bay', 'Ras Ghareb Branch', 'BTECHX Mahala', 'Miela Arkan WH', 'El Menia Mega Branch', 'BTECHX GardeniaTagamo', 'El Tagamou 2 Branch', 'BTECHX Truck Alex', 'ElBahr ElAzam', 'BTECHX Mansoura', 'BTECHX Zagazig', 'BTECHX Manial', 'El Helmya', 'El Mokattam Branch', 'Mega Alex Sidi Gaber', 'El Zaher', 'Assiut Branch - Ibn Sina Tower', 'El Kanater Branch', 'BTECHX Airport', 'El Tagamou 1 Branch', 'Port Said', 'BTECHX ElShams Club', 'BTECHX The Yard Mall', 'BTECHX Hegaz', 'Tanta WH', 'Flag Mall Branch', 'El Nozha Branch', 'Dumietta Branch', 'Quesna Branch', 'Loran Branch', 'BTECHX 45', 'BTECHX Open Air Mall', 'BTECHX Gehan2 Dewaka', 'BTECHX Shinzo Abe', 'New Damanhour', 'EL Amiria Branch', 'Smouha Branch', 'BTECHX CityCenterMaadi', 'October-WH', '10th of Ramadan WH', 'GateWay Mall El Rehab', 'Zayton Branch', 'B.TECH STAFF', 'Miela Arkan Mall', 'New sohag', 'Banha Branch', 'BTECHX Obour2', 'Alamein Masa Mall', 'Shoubra Branch'], 'region': ['0', 'HURGHADA', 'UPPER EGYPT', 'ALEXANDRIA', 'DELTA', 'CAIRO'], 'season': [], 'area': [], 'Channel': ['B.TECH X', 'CALL CENTER', 'DEEL', 'NON', 'MINI', 'Retail', 'B2B', '0', 'ONLINE', 'ARKAN', 'WAREHOUSE'], 'budget_year': [0.0], 'Quarter': ['0', '4', '3'], 'month': ['August   ', 'October  ', 'December ', 'November ', 'September', '0', 'July     '], 'week': [0, 1, 2, 3, 4, 5, 6, 7], 'date': ['20011', '20059', '20041', '20043', '19982', '20008', '19985', '20012', '20080', '20021', '19915', '20066', '20053', '19913', '19999', '19946', '19911', '20088', '20074', '19921', '19987', '20001', '19952', '19925', '20037', '19966', '19932', '20022', '19949', '19940', '20050', '19906', '19965', '20033', '20086', '19956', '20045', '19988', '19916', '20028', '20032', '20002', '19954', '19964', '20005', '20058', '20054', '20016', '20024', '19961', '19942', '19947', '20078', '19990', '20010', '20071', '20062', '20029', '20003', '20064', '19974', '19929', '19975', '19941', '20046', '20057', '20031', '19938', '19962', '20025', '20013', '19978', '19953', '19924', '19977', '19935', '20017', '20076', '19909', '19996', '19930', '19959', '19919', '19970', '20065', '20038', '19992', '19989', '20007', '19984', '20069', '19945', '20063', '19910', '19976', '19922', '19958', '19944', '19971', '20087', '20068', '19991', '20084', '19972', '19950', '20060', '19920', '19995', '19957', '20044', '20051', '19907', '20072', '19998', '20056', '19905', '19926', '19934', '19997', '20042', '20052', '20070', '20082', '19955', '20004', '19993', '19948', '19933', '19979', '19908', '20079', '20006', '19939', '20009', '19943', '20014', '19927', '20020', '19963', '20083', '20030', '20047', '19936', '20039', '20000', '20073', '19928', '20061', '20067', '20035', '20015', '20023', '20075', '20027', '19918', '19994', '19931', '20019', '20036', '19973', '20049', '20048', '19981', '20081', '19914', '20055', '20026', '19923', '19968', '19912', '20034', '19983', '19917', '19951', '19969', '0', '19967', '20040', '20077', '19986', '19960', '20018', '20085', '19980', '19937'], 'Day': ['Wednesday', 'Tuesday  ', 'Monday   ', 'Friday   ', 'Sunday   ', '0', 'Thursday ', 'Saturday '], 'historical_year': [], 'history_Quarter': ['1', '2', '0', '3', '4'], 'history_month': ['April    ', 'September', 'June     ', 'July     ', 'March    ', 'February ', 'January  ', 'May      ', 'October  ', 'November ', 'August   ', '0', 'December '], 'history_week': ['0', '1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '3', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '4', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '5', '50', '51', '52', '6', '7', '8', '9'], 'history_Day': ['Monday   ', 'Sunday   ', '0', 'Friday   ', 'Tuesday  ', 'Wednesday', 'Thursday ', 'Saturday '], 'history_dates': [0, 18997, 19003, 19005, 19010, 19011, 19015, 19016, 19017, 19022, 19023, 19038, 19040, 19044, 19050, 19052, 19053, 19057, 19059, 19066, 19068, 19072, 19073, 19074, 19078, 19079, 19080, 19085, 19086, 19087, 19088, 19089, 19095, 19101, 19102, 19106, 19108, 19109, 19110, 19120, 19121, 19122, 19123, 19124, 19127, 19128, 19129, 19130, 19131, 19134, 19135, 19136, 19137, 19138, 19141, 19143, 19145, 19148, 19152, 19155, 19156, 19158, 19159, 19162, 19163, 19164, 19165, 19166, 19170, 19171, 19172, 19176, 19178, 19179, 19180, 19186, 19190, 19192, 19193, 19200, 19201, 19204, 19206, 19208, 19211, 19212, 19213, 19214, 19215, 19218, 19220, 19221, 19222, 19226, 19227, 19228, 19229, 19232, 19233, 19235, 19236, 19239, 19240, 19241, 19243, 19245, 19246, 19247, 19248, 19249, 19250, 19252, 19253, 19254, 19255, 19256, 19257, 19259, 19260, 19261, 19262, 19263, 19264, 19266, 19267, 19268, 19269, 19270, 19271, 19273, 19274, 19275, 19276, 19277, 19278, 19279, 19280, 19281, 19282, 19283, 19284, 19285, 19286, 19287, 19288, 19289, 19290, 19291, 19292, 19293, 19294, 19295, 19296, 19297, 19298, 19299, 19300, 19301, 19302, 19303, 19304, 19305, 19306, 19307, 19308, 19309, 19310, 19311, 19312, 19313, 19314, 19315, 19316, 19317, 19318, 19319, 19320, 19321, 19322, 19323, 19324, 19325, 19326, 19327, 19328, 19329, 19330, 19331, 19332, 19333, 19334, 19335, 19336, 19337, 19338, 19339, 19340, 19341, 19342, 19343, 19344, 19345, 19346, 19347, 19348, 19349, 19350, 19351, 19352, 19353, 19354, 19355, 19356, 19357, 19358, 19359, 19360, 19361, 19362, 19363, 19364, 19365, 19366, 19367, 19368, 19369, 19370, 19371, 19372, 19373, 19374, 19375, 19376, 19377, 19378, 19379, 19380, 19381, 19382, 19383, 19384, 19385, 19386, 19387, 19388, 19389, 19390, 19391, 19392, 19393, 19394, 19395, 19396, 19397, 19398, 19399, 19400, 19401, 19402, 19403, 19404, 19405, 19406, 19407, 19408, 19409, 19410, 19411, 19412, 19413, 19414, 19415, 19416, 19417, 19418, 19419, 19420, 19421, 19422, 19423, 19424, 19425, 19426, 19427, 19428, 19429, 19430, 19431, 19432, 19433, 19434, 19435, 19436, 19437, 19438, 19439, 19440, 19441, 19442, 19443, 19444, 19445, 19446, 19447, 19448, 19449, 19450, 19451, 19452, 19453, 19454, 19455, 19456, 19457, 19458, 19459, 19460, 19461, 19462, 19463, 19464, 19465, 19466, 19467, 19468, 19469, 19470, 19471, 19472, 19473, 19474, 19475, 19476, 19477, 19478, 19479, 19480, 19481, 19482, 19483, 19484, 19485, 19486, 19487, 19488, 19489, 19490, 19491, 19492, 19493, 19494, 19495, 19496, 19497, 19498, 19499, 19500, 19501, 19502, 19503, 19504, 19505, 19506, 19507, 19508, 19509, 19510, 19511, 19512, 19513, 19514, 19515, 19516, 19517, 19518, 19519, 19520, 19521, 19522, 19523, 19524, 19525, 19526, 19527, 19528, 19529, 19530, 19531, 19532, 19533, 19534, 19535, 19536, 19537, 19538, 19539, 19540, 19541, 19542, 19543, 19544, 19545, 19546, 19547, 19548, 19549, 19550, 19551, 19552, 19553, 19554, 19555, 19556, 19557, 19558, 19559, 19560, 19561, 19562, 19563, 19564, 19565, 19566, 19567, 19568, 19569, 19570, 19571, 19572, 19573, 19574, 19575, 19576, 19577, 19578, 19579, 19580, 19581, 19582, 19583, 19584, 19585, 19586, 19587, 19588, 19589, 19590, 19591, 19592, 19593, 19594, 19595, 19596, 19597, 19598, 19599, 19600, 19601, 19602, 19603, 19604, 19605, 19606, 19607, 19608, 19609, 19610, 19611, 19612, 19613, 19614, 19615, 19616, 19617, 19618, 19619, 19620, 19621, 19622, 19623, 19624, 19625, 19626, 19627, 19628, 19629, 19630, 19631, 19632, 19633, 19634, 19635, 19636, 19637, 19638, 19639, 19640, 19641, 19642, 19643, 19644, 19645, 19646, 19647, 19648, 19649, 19650, 19651, 19652, 19653, 19654, 19655, 19656, 19657, 19658, 19659, 19660, 19661, 19662, 19663, 19664, 19665, 19666, 19667, 19668, 19669, 19670, 19671, 19672, 19673, 19674, 19675, 19676, 19677, 19678, 19679, 19680, 19681, 19682, 19683, 19684, 19685, 19686, 19687, 19688, 19689, 19690, 19691, 19692, 19693, 19694, 19695, 19696, 19697, 19698, 19699, 19700, 19701, 19702, 19703, 19704, 19705, 19706, 19707, 19708, 19709, 19710, 19711, 19712, 19713, 19714, 19715, 19716, 19717, 19718, 19719, 19720, 19721, 19722, 19723, 19724, 19725, 19726, 19727, 19728, 19729, 19730, 19731, 19732, 19733, 19734, 19735, 19736, 19737, 19738, 19739, 19740, 19741, 19742, 19743, 19744, 19745, 19746, 19747, 19748, 19749, 19750, 19751, 19752, 19753, 19754, 19755, 19756, 19757, 19758, 19759, 19760, 19761, 19762, 19763, 19764, 19765, 19766, 19767, 19768, 19769, 19770, 19771, 19772, 19773, 19774, 19775, 19776, 19777, 19778, 19779, 19780, 19781, 19782, 19783, 19784, 19785, 19786, 19787, 19788, 19789, 19790, 19791, 19792, 19793, 19794, 19795, 19796, 19797, 19798, 19799, 19800, 19801, 19802, 19803, 19804, 19805, 19806, 19807, 19808, 19809, 19810, 19811, 19812, 19813, 19814, 19815, 19816, 19817, 19818, 19819, 19820, 19821, 19823, 19824, 19825, 19826, 19827, 19828, 19829, 19830, 19831, 19832, 19833, 19834, 19835, 19836, 19837, 19838, 19839, 19840, 19841, 19842, 19843, 19844, 19845, 19846, 19847, 19848, 19849, 19850, 19851, 19852, 19853, 19854, 19855, 19856, 19857, 19858, 19859, 19860, 19861, 19862, 19863, 19864, 19865, 19866, 19867, 19868, 19869, 19870, 19871, 19872, 19873, 19874], 'article_score': ['sale', 'abc', 'ae', 'speed', 'terminal', 'margin', 'sell', 'markdown', 'core', 'quartile', 'sortimeter'], 'history_year': [0.0, 2022.0, 2023.0, 2024.0], 'family': ['NON', 'COMPLEMENTARY', 'TABLET', 'TV', 'MOBILE', 'MDA', 'AC', 'LAPTOP', 'SDA', 'BMOBILE ACCESSORIES', '0'], 'sub_family': ['AC DOM', 'TV DOM', 'MDA DOM', 'SDA COM', 'BMOBILE', '0', 'AC COM', 'TV COM', 'SDA DOM', 'NON', 'MDA COM'], 'supplier': ['ETI', 'GLEMGAS', 'ICOOK', 'SEM', 'KENWOOD', 'HELLER', 'LONGLIFE', 'CRAFT', 'MIENTA', 'STEEL', 'ELECTROSTAR', 'ARZUM', 'VEITO', 'SAMSUNG', 'GALAXI', 'BIALETTI', 'TORNADO', 'MSI', 'OSN', 'ZADA', 'OZO', 'APPLE', 'DELONGHI', 'SARY', 'INFINX', 'BRAUN', 'OKKA', 'LG', 'BABYLISS', 'SANDISK', 'ASUS', 'FRANKE', 'FLYON', 'S.LINK', 'LAVA', 'ZANUSSI', 'PLUTO', 'STRONG', 'VIVO', 'HAIER', 'ILOOK', 'DAHUA', 'TEFAL', 'EPSON', 'BERGEN', 'SONY', 'HAVIT', 'ORIGINAL', 'MUTECH', 'FIRST', 'HOPE', 'ARISTON', 'VIEW', 'ELIOS', 'CAIXUN', 'ELBA', 'HONOR', 'SEASONS', 'TOSHIBA Midea', 'MICROSOFT', 'SPEED', 'GENERAL ELECTRIC', 'MPT PT', 'FRESH', 'ICONZ', 'TIGER', 'KIOXIA', 'HAMA', 'BeKO', 'SOLAC', 'PHILIPS', 'HOME TECH', 'RUSH BRUSH', 'ROVO', 'SNDWAY', 'ULTRA', 'CANON', 'FALCON', 'BENQ', 'HP', 'INFINIX', 'ARIETE', 'SKYWORTH ZAPPER', 'EZVIZ', 'HITACHI', 'AKWRJ', 'BISSELL', 'IDEAL', 'XIAOMI', 'DALY', 'BRANDT', 'WHITE POINT', 'TOUCH', 'KEENDEX', 'TCL', 'ITEL', 'ZAHRAN', 'BLACK AND DECAR', 'NON', 'BMOBILE ACCESSORIES', 'KARCHER', 'NESPRESSO', 'PASSAP', 'KOLDAIR', 'INDESIT', 'FAGOR', 'DELL', 'HISENSE', 'LOGITECH', 'SIMFER', '0', 'LDNIO', 'HAPILLINE', 'SYINIX', 'G.TEC', 'CARRIERE', 'NESTLE', 'BOSCH', 'NIKON', 'NOKIA', 'BAUMATIC', 'MEDIA TECH', 'BLACK AND WHITE', 'ALASKA', 'KHATER', 'PREMIER', 'ALEXA', 'SONAI', 'DAEWOO', 'TANK', 'MOULINEX', 'NOUR TECH', 'PREMIUM', 'MIDEA', 'UNIVERSAL', 'MUSIC HERO', 'GROUHY', 'AMAZONE', 'TRUMAN', 'F&D', 'HOME', 'TOSHIBA', 'INTEL', 'CHOETECH', 'FORA', 'VAIO', 'NARDI', 'ARION', 'FUTURE', 'GORENJE', 'UNION AIRE', 'PANASONIC', 'MODEX', 'CANDY', 'AVANTREE', 'HOUSECOM', 'KIRIAZI', 'FERROLI', 'SHARP', 'UG', 'MODEM', 'XAIOMI', 'ROYAL', 'BOMAN', 'SMART', 'SCHNEIDER', 'MIELE', 'HUAWEI', 'HOOVER', 'LA GERMANYA', 'LENOVO', 'OLYMPIC', 'BENEX', 'AMERICOOL', 'REALME', 'FLAT', 'ATA', 'ORAIMO', 'CONTEX', 'DOB', 'LAVVENTO', 'ATLANTIC', 'NIKAI', 'SENCOR', 'DAIKIN', 'CLAGE', 'KLASS', 'WHITE WHALE', 'SHTEBEL', 'NI', 'ECOMATIC', 'OPPO', 'BEKO', 'CLABER', 'REMINGTON', 'WACACO', 'MPT HT'], 'category': ['Washing M Zanussi', 'Kettle Ariete', 'H.Mixer Kenwood', 'Audio LG', 'Gift Universal', 'Coffee M Delonghi', 'Cooker Zanussi', 'H.Mixer Black&white', 'Ele Heater Universal', 'Kettle SMART', 'M.Mincer Black&White', 'Air Cooler Fresh', 'VC Black&white', 'Cleaning SBS', 'AC Accessory Crafft', 'Lam Philips', 'Grill Zada', 'AC TORNADO', 'Mobile Samsung', 'F.Proc Home', 'Security Ass Camera ', 'Cooker Fresh', 'Oven Franke', 'Toaster Braun', 'Fan Fresh', 'H.Blend Mienta', 'Washing M White Poin', 'Blender sary', 'Hood Elba', 'IT ASS ASS', 'Coffee M Bosch', 'D Washer Zanussi', 'TV Acc Fora', 'TV Sharp', 'Toaster Panasonic', 'AC Beko', 'Filter Tank', 'AC Americool', 'D Washer Miele', 'Mobile VIVO', 'Frayer Miele', 'Gas Heater Tornado', 'Chopper Sonai', 'Laptop ASUS', 'tv acc elios', 'Kettle Solac', 'Fan Nikai', 'Iron Ultra', 'Shaving_Tri Braun', 'H.Blend Moulinex', 'Ele Heater Atlantic', 'Kettle Braun', 'Chopper Kenwood', 'Fan black&decker', 'Blender Modex', 'Hobs Baumatic', 'Fan Ultra', 'Iron Media Tech', 'Washing M Hoover', 'Air Purifier SHARP', 'M.Mincer Panasonic', 'Kettle Zada', 'Mixer Modex', 'Masher Kenwood', 'Blender Ultra', 'Chopper Ultra', 'Hobs Fagor', 'Warmer Heller', 'Complem Printer HP', 'Mic. Black&decker', 'Straightners Tornado', 'Hobs Zanussi', 'TV Tcl', 'Enquiry Fees', 'Fridge Kiriazi', 'Blender Tornado', 'mosq.kill Home', 'Straightners Rush br', 'Grill Kenwood', 'D Washer Indesit', 'Comp Google Mesh IOT', 'AC Accessory Sharp', 'M.Mincer Touch', 'Hood Miele', 'Scale Solac', 'Fun Line Solac', 'Deep F Union Aire?', 'Blender Mienta', 'WD Ultra', 'Oven Brandt', 'Gas Heater Olympic', 'F.Proc Mienta', 'Tripod SBS', 'Fridge White Point', 'Blender Kenwood', 'Fan Sonai', 'Oven Hoover', 'WD White Whale', 'Com Projector Merlin', '0', 'Gas Heater Ariston', 'Mixer Black&decker', 'Oven Home', 'Laptop DELL', 'Washer Dry ASSMiele', 'Hair Dryer Tornado', 'Mic. Hoover', 'Frayer Fresh', 'Iron Tefal', 'TV Contex', 'Audio Samsung', 'Kettle SENCOR', 'Oven beko', 'Iron Panasonic', 'Masher Black&white', 'Hobs Beko', 'Hobs Ariston', 'Coffee M Tornado', 'Tools Bosch', 'H.Mixer Moulinex', 'Iron Ariete', 'Fun Line Ariete', 'Washing M Tornado', 'AC Crafft', 'VC Tornado', 'Thermoses Tiger', 'TV ASS ASS', 'TV UG', 'VC Smart', 'Straightners Philips', 'Warmer Black&decker', 'Cables SBS', 'F.Proc Benex', 'Laptop APPLE', 'Complem Camera Nikon', 'Oven Fagor', 'AC Haier', 'Washing M Sharp', 'Shaving_TriRemington', 'VC Bosch', 'TV Acc FLAT', 'Coffee M White Whale', 'Fridge Ideal', 'TV Rowa', 'TV Acc NI', 'VC Tefal', 'Mixer Ultra', 'TV Nikai', 'WD Fresh', 'VC Rovo', 'Coffee M SMART', 'H.Mixer Midea', 'Receiver truman', 'Grill Bosch', 'Compl Camera GoPRO', 'Tools Claber', 'Ele Heater TORNADO', 'Cooker White Point', 'Mobile Hope', 'Deep F White Point', 'Receiver', 'Mobile XIAOMI', 'AC Daikin', 'TV SARY', 'Filter ASS philips', 'Boxi', 'WD Tornado', 'VC Toshiba', 'Audio Toshiba', 'Fridge Fresh', 'F.Proc Panasonic', 'VC Miele', 'Tools sndway', 'Fridge Beko', 'Air Styler Babyliss', 'AC Accessory Zanussi', 'Washing M Toshiba', 'H.Mixer Mienta', 'Hobs ECOMATIC', 'E.Hot Plate SMART', 'TV LG', 'Kettle Black&decker', 'Gas Heater PASSAP', 'Washer Dryer Ariston', 'TV Samsung', 'Washing M Haier', 'Dryer Home', 'Mic. Fresh', 'Chopper Rovo', 'Washing M Indesit', 'Juicer Moulinex', 'Gas Heater Toshiba', 'Washing M CANDY', 'Gas Heater Universal', 'Gas Heater Kiriazi', 'Gas Heater White Poi', 'Tablet Samsung', 'Kettle Modex', 'Deep F Beko', 'Deep F White Whale', 'Audio F&D', 'Kitchen M Bosch', 'Kitchen M Touch', 'Lam Black&decker', 'B2B AC', 'Complent Alexa IOT', 'Blender Bosch', 'Hood Ariston', 'Laptop Lenovo', 'Grill Touch', 'Audio Philips', 'Comp Monitor Samsung', 'E.Hot Plate Fresh', 'Hood Sonai', 'Thermal Mug Tiger', 'Protection SBS', 'Warmer Shtebel', 'F.Proc Black&decker', 'Fun Line Home', 'Gas Heater Arion', 'Oven Touch', 'R.cooker Modex', 'Straightners Remingt', 'Iron Smart', 'Hair Dryer Rush brus', 'Gas Heater Union Air', 'Cooker White Whale', 'Selfie Stick SBS', 'TV Acc ETI', 'Kettle Arion', 'F.Proc Black&white', 'Wall Hood Tornado', 'Compl Printer CANON', 'TV ATA', 'Juicer Home Tech', 'Gift Bosch', 'Blender Black&white', 'Hobs Brandt', 'Ele Heater Shtebel', 'Frayer Mienta', 'Mixer Union Aire', 'Mic. LG', 'Toaster Black&decker', 'Fridge Indesit', 'Iron Kenwood', 'Deep F Sharp', 'TV Caixun', 'Deep F Fresh', 'Thermal Mug Tefal', 'Coffee M Nespresso', 'Oven Sharp', 'Gaming ASS ASS', 'Cooker Universal', 'Fun Line Black&decke', 'Mobile Huawei', 'H.Mixer Rovo', 'Audio First', 'Complem Camera CANON', 'Fridge Union Aire', 'Deep F PASSAP', 'Kettle Kenwood', 'AC General Electric', 'Frayer Philips I2', 'Blender Smart', 'Gas Heater Ferroli', 'Chopper Fresh', 'Coffee M Home', 'VC Modex', 'Bundle- b-in Indesit', 'Kitchen M Moulinex', 'IFix', 'H.Blender SEM', 'Toaster Mienta', 'D Washer White Point', 'Mixer Media Tech', 'Hood Touch', 'Shaving_Tri Hapillin', 'Ele Heater Fresh', 'Laptop MSI', 'Ele Heater Kiriazi', 'TV Acc STRONG', 'Oven Indesit', 'Cooker Premium', 'Deep F LG', 'TV Acc ilook', 'Audio Dob', 'Sport Machine Khater', 'Kettle Sonai', 'H.Mixer Modex', 'Hood Zanussi', 'Blender Braun', 'Coffee M Bialetti', 'Cooker Royal', 'Coffee M Braun', 'Juicer Modex', 'Hood Hoover', 'Gas Heater Panasonic', 'Kitchen M Home', 'Chopper Bosch', 'Hobs Bosch', 'Blender Fresh', 'Kettle Home', 'AC Premium', 'Cooker Union Aire?', 'Thermal Mug Tank', 'AC Accessory Carrier', 'Kettle Tornado', 'Fan universal', 'Grill Tefal', 'Mincer Home', 'Wall Hood Olympic', 'D Washer Beko', 'Fan Smart', 'Grill Media Tech', 'H.Mixer Sonai', 'VC Fresh', 'Oven Fresh', 'F.Proc Kenwood', 'Warmer Fresh', 'Chopper SMART', 'Washing M Bosch', 'TV Acc STEEL', 'Holders SBS', 'Mic. Kenwood', 'Audio Media Tech', 'Hair Dryer Babyliss', 'Air Styler Rush brus', 'Coffee M Mienta', 'Grill Tornado', 'Hood Tornado', 'Ele Heater Boman', 'Gift LG', 'Fan Touch', 'Blender Black&decker', 'Speaker SBS', 'H.Mixer Panasonic', 'F.Proc SMART', 'Shaving_Tri Babyliss', 'Oven Tornado', 'Complem Gaming Sony', 'Straightners Braun', 'TV Syinix', 'Laptop Huawei', 'M.Mincer Tornado', 'Hood Fagor', 'Deep F Electrostar', 'Coffee M Beko', 'Fun Line Media Tech', 'kitchen m sary', 'Oven Bosch', 'WD PASSAP', 'Washing M Union Aire', 'VC Daewoo', 'Gift Indesit', 'Hood Gorenje', 'H.Blend Kenwood', 'Tools MPT PT', 'Fridge ULTRA', 'Espresso Machine Ari', 'Deep F Alaska', 'Frayer Modex', 'Toaster Ariete', 'Fan Tefal', 'Mixer Black&white', 'Grill Fresh', 'M.Mincer Braun', 'Straightners Babylis', 'Warmer veito', 'D Washer Bosch', 'H.Mixer SMART', 'VC Ariete', 'Fridge Sharp', 'R.cooker Black&decke', 'Warmer Media Tech', 'TV Union Aire', 'VC Mienta', 'Air Purifier LG', 'B.Electronic ass', 'Cooking Appliances A', 'Fridge Electrostar', 'TV View', 'Air Cooler Tornado', 'Cooker La germanya', 'VC Ultra', 'Hobs Tornado', 'Coffee M Philips I2', 'Mincer White Whale', 'tv acc keendex', 'Fan Tornado', 'Cooker Bosch', 'Ele Heater Toshiba', 'Fridge Bosch', 'Masher Mienta', 'Kitchen M Mienta', 'AC Accessory LG', 'Mobile HONOR', 'Mobile REALME', 'F.Proc Tornado', 'Hood Premier', 'Gift Samsung', 'E.Hot Touch', 'Comp Printer Epson', 'Warmer Mienta', 'Kettle Housecom', 'AC Midea', 'Oven Ultra', 'Coffee M Solac', 'TV Ultra', 'Iron Philips I2', 'Hobs Hoover', 'VC LG', 'AC Acc Union Aire', 'Tablet Lenovo', 'F.Proc Union Aire', 'Hood Indesit', 'Hair Dryer Remington', 'H.Blend Media Tech', 'TV Acc osn', 'Warmer Tornado', 'Cooker Kiriazi', 'Straightners Solac', 'Kettle Bosch', 'Gift Ariston', 'Fan Kenwood', 'Juicer Sonai', 'Deep F Tornado', 'Hobs SMART', 'Oven Ariston', 'D Washer Ariston', 'Fan Arion', 'Kettle Fresh', 'Blender Ariete', 'H.Mixer Touch', 'F.Proc G.tec', 'F.Proc ULTRA', 'Kitchen M G.tec', 'Fridge Samsung', 'Chopper Moulinex', 'AC Carriere', 'Mic. Tornado', 'Iron Tornado', 'Ele heater flyon', 'Power Bank SBS', 'Juicer Kenwood', 'R.cooker Tefal', 'Airpods kit SBS', 'VC Bissell', 'Shaving_Tri Philips', 'H.Blend G.tec', 'Hair Dryer arzum', 'H.Blend sary', 'Deep F Panasonic', 'Hood Bosch', 'F.Proc Modex', 'Wall Hood Fresh', 'Bottel Tank', 'H.Blend Home', 'Charger SBS', 'Hair Dryer Philips', 'Coffee M okka', 'Chopper Touch', 'Ele Heater Olympic', 'Juicer Mienta', 'Oven Gorenje', 'Kitchen M Modex', 'AC Fresh', 'Oven Elba', 'Coffee Grinder Ariet', 'TV Pluto', 'TV Acc ICONZ', 'Warmer Akwrj', 'Ele Heater Zanussi', 'Mincer Bosch', 'Air Fryer Tornado', 'TV Acc Itel', 'H.Blend Bosch', 'H.Blend Touch', 'AC Hisense', 'Iron Home', 'M Grinder Sonai', 'Blender Media Tech', 'F.Proc Moulinex', 'Air Fryer Kenwood', 'Juicer Solac', 'E.Hot Plate Mienta', 'B.ElectronicServices', 'Mobile INFINX', 'Ele Heater VEITO', 'VC Solac', 'Washing M Beko', 'Receiver SkyWorth Za', 'Kettle Zahran', 'Kettle Media Tech', 'Chopper Tornado', 'Receiver ETI', 'Fridge Toshiba', 'H.Mixer Braun', 'Frayer Bergen', 'D Washer Fresh', 'Hood ASS Indesit', 'Blender Touch', 'Kettle Touch', 'Ice Tank Tank', 'Grill Modex', 'Iron Modex', 'Cooker Beko', 'Grill Solac', 'R.cooker HOME', 'TV Acc hama', 'Fridge LG', 'Cappuccino Maker Ari', 'Juicer Media Tech', 'Tools Hitachi', 'TV FRESH', 'M.Mincer Sonai', 'Comp Monitor Xiaomi', 'Chopper Black&decker', 'Hood Panasonic', 'VC AccessoriesMiele', 'Fun Line Mienta', 'H.Mixer Tornado', 'Kitchen M SMART', 'AC Accessory Daikin', 'Washing M Fagor', 'Fridge Zanussi', 'Kitchen M Ariete', 'Washing M Ariston', 'Mincer Black&decker', 'Grill Mienta', 'H.Blend Tornado', 'Mic. Home', 'H.Blend Black&decker', 'Frayer Ariston', 'Iron Solac', 'Compl DESK PC Intel', 'Thermal Mug WACACO', 'Juicer Home', 'TV Acc MUTECH', 'Gift Nestle', 'Fan Panasonic', 'Iron Black&white', 'Fun Line Tornado', 'Ele Heater Ariston', 'Chopper Ariete', 'Mobile APPLE', 'TV Tornado', 'VC Panasonic', 'TV Toshiba', 'Hobs Franke', 'Mic. Daewoo', 'Chopper Mienta', 'Coffee M Zada', 'tv acc schneider', 'Coffee M Black&decke', 'TV Sony', 'Oven Simfer', 'H.Blend SENCOR', 'Audio Avantree', 'Oven Klass', 'VC Hoover', 'Fridge PASSAP', 'Blender Home', 'Security Ass Camera', 'tv acc truman', 'Iron Black&Decker', 'Fridge Tornado', 'Comp Monitor Lenovo', 'Washing M Premium', 'Frayer Home', 'Gas Heater premium', 'Ice Box Tank', 'Gas Heater Bosch', 'Mobile OPPO', 'Kettle Panasonic', 'Straightners Mienta', 'Hair Dryer Solac', 'Mixer Touch', 'Mobile LAVA', 'Juicer Tornado', 'VC Hitachi', 'Coffee M Tefal', 'TV Acc Tiger', 'Oven Nardi', 'Fan Black&white', 'Gas Heater Fresh', 'Fridge White Whale', 'Fun Line Sonai', 'kettle Media', 'Hood ICook', 'Warmer Touch', 'Hobs Nardi', 'Headset SBS', 'Transferfeesonline01', 'TV Acc Energizer', 'Stand Indesit', 'TV Premium', 'Grill Home', 'Hobs Klass', 'Mic. Ariston', 'Laptop VAIO', 'Comp Monitor Dell', 'Mic. Zanussi', 'Deep F Miele', 'Ele Heater Clage', 'Coffee M Modex', 'AC Zanussi', 'Blender sencor', 'TV Haier', 'Audio', 'Juicer Braun', 'Oven Zanussi', 'TABLET REALME', 'Hood Franke', 'AC Accessory Haier', 'WD Tank', 'Gas Heater LongLife', 'Grill Black&decker', 'M.Mincer Moulinex', 'Deep F Kiriazi', 'F.Proc Ariete', 'Hobs Elba', 'M.Mincer Kenwood', 'WD speed', 'VC Grouhy', 'Tablet TCL', 'Iron Touch', 'Receiver Galaxi', 'Hobs Miele', 'H.Blender Smart', 'Hood Fresh', 'Mixer Kenwood', 'Fan Union Aire?', 'Laptop HP', 'VC Samsung', 'Filter ASS Tank', 'Blender Sonai', 'Fridge Ariston', 'D Washer LG', 'Tools MPT HT', 'Hobs Indesit', 'TV Acc Media Tech', 'TV Hisense', 'Oven Mienta', 'Juicer Bosch', 'Mobile NOKIA', 'Ele Heater Union Air', 'Mic. Samsung', 'Coffee M Kenwood', 'Gas Heater Atlantic', 'Frayer Tefal', 'Washing M Samsung', 'Wall Hood Toshiba', 'TV Acc HP', 'Fridge Alaska', 'Blender Panasonic', 'TV Acc Falcon', 'Kitchen M Fresh', 'Toaster tornado', 'kettle Mienta', 'Fun Line Zahran', 'TV Acc Toshiba', 'WD Bergen', 'Air Cooler Sonai', 'Deep F Ariston', 'Washing M Fresh', 'Coffee M Media Tech', 'E.Hot Pla Home', 'Blender G.tec', 'Hobs ICook', 'IFixBtech', 'F.Proc Bosch', 'VC Kenwood', 'WD White Point', 'Fan Mienta', 'R.cooker Media Tech', 'kettle Black&white', 'Frayer Delonghi', 'F.Proc Braun', 'Hobs Fresh', 'Comp Monitor BenQ', 'Iron Braun', 'H.Blender Braun', 'TV Accessory', 'Gas Heater White Wha', 'Kitchen M Black&whit', 'Deep F Toshiba', 'H.Mixer Bosch', 'Dryer LG', 'M.Mincer SMART', 'M.Mincer Bosch', 'Fridge Haier', 'AC Accessory Fresh', 'Chopper Media Tech', 'Hobs Gorenje', 'H.Mixer Fresh', 'Tablet Nokia', 'Oven Miele', 'Sport Machine Future', 'Iron Mienta', 'Toaster Kenwood', 'Audio oraimo', 'M.Mincer Modex', 'Shaving_Tri Tornado', 'Hood Beko', 'AC Union Aire?', 'Coffee M Sonai', 'AC LG', 'Warmer Delonghi', 'TV Acc Etrain', 'Mic. Sharp', 'Gift Fresh', 'Washing M Kiriazi', 'AC ULTRA', 'Ele Heater White Wha', 'Audio sony', 'Air Cooler Home', 'WARMER Ultra', 'Curl Irons Babyliss', 'VC Black&decker', 'Gas Heater Zanussi', 'Fridge Miele', 'Blender Moulinex', 'Laptop Microsoft', 'F.Proc Sonai', 'Kitchen M Kenwood', 'Frayer Black&decker', 'F.Proc Grouhy', 'Cliner M Karcher', 'AC Sharp', 'H.Blend Black&white', 'Tablet Huawei', 'Toaster Home', 'Curl Irons Rush brus', 'Hobs GLEMGAS', 'Washing M Miele', 'Mic. SMART', 'Deep F Indesit', 'Receiver Daly', 'Tablet APPLE', 'Washing M LG', 'AC Accessory Premium'], 'dom_comm': ['B.MOBILE', 'DOM', 'COMM', 'NON', '0'], 'sub_category': ['WALL HOOD', 'AC-HOT/COLD-4HP-OUTDOOR UNIT', 'COMPLEMENTARY', 'AC-COLD-7HP-INDOOR UNIT', 'AC-HOT/COLD-5HP-OUTDOOR UNIT', 'TV-40', 'HOOD', 'TANK', 'LAM', 'TV-65-SMRT-HI', 'D WASHER', 'STRAIGHTNERS', 'AC-HOT/COLD-4HP-INDOOR UNIT', 'R.COOKER', 'SCALE', 'AC-COLD-1.5HP-INDOOR UNIT', 'COFFEE GRINDER', 'F.PROC', 'MOBILE', 'BMOBILE ACCESSORIES', 'TV-50-SMRT-HI', 'TABLET', 'AC-HOT/COLD-7HP-INDOOR UNIT', 'AC-HOT/COLD-3HP', 'WD', 'AC-HOT/COLD-1.5HP-OUTDOOR UNIT', 'VC ACCESSORIES', 'MIXER', 'MOSQ.KILL', 'JUICER', 'H.BLENDER', 'TV-85-SMRT', 'COFFEE M', 'FUN LINE', 'TV-40-SMRT', 'MICROWAVE', 'TV-43', 'FAN', 'H.MIXER', 'TV-43-SMRT', 'GRILL', 'AC-HOT/COLD-7HP-OUTDOOR UNIT', 'COOKING APPLIANCES', 'LAPTOP', 'Mobile_Acc', 'WASHER DRY ASS', 'AUDIO', 'AC-HOT/COLD-6HP-INDOOR UNIT', 'AC-HOT/COLD-2.25HP-OUTDOOR UNIT', 'AC-HOT/COLD-2.25HP', 'KETTLE', 'THERMAL VESSEL', 'FILTER ASS', 'FRIDGE', 'AC-HOT/COLD-4HP', 'SPORT MACHINE', 'TV-60-SMRT', 'TOASTER', 'TV-55-SMRT-HI', 'TV-50', 'AC ACCESSORY', 'OVEN', 'TV-50-SMRT', 'CLINER M', 'KITCHEN M', 'WASHING M', 'BUNDLE- B-IN', 'COOKER', 'TV-32-SMRT', 'E.HOT PLATE', 'AIR COOLER', 'TV-FRAME', 'AC-HOT/COLD-3HP-OUTDOOR UNIT', 'AC-COLD-1.5HP', 'DEEP FREEZER', 'AC-COLD-2.25HP-INDOOR UNIT', 'TV-32', 'AIR PURIFIER', 'AC-HOT/COLD-3HP-INDOOR UNIT', 'AC-COLD-3HP-OUTDOOR UNIT', 'AC-HOT/COLD-1.5HP-INDOOR UNIT', 'VC', 'TV-75-SMRT-HI', 'MDA ASS', 'MASHER', 'CAPPUCCINO MAKER', 'AC-COLD-2.25HP', 'AC-COLD-3HP-INDOOR UNIT', 'TV-75-SMRT', 'GAS HEATER', 'HAIR DRYER', 'CHOPPER', 'AIR FRYER', 'HOBS', 'TV-65-SMRT', 'CURL IRONS', 'TOOLS', 'AC-COLD-1.5HP-OUTDOOR UNIT', 'SHAVING_TRI', 'GIFT', 'AIR STYLER', 'AC-HOT/COLD-2.25HP-INDOOR UNIT', 'FILTER 3 STAGES', 'M.MINCER', 'FILTER 6 STAGES', 'ELE HEATER', 'AC-COLD-2.25HP-OUTDOOR UNIT', 'BLENDER', 'NON', 'WASHER DRYER', '0', 'DRYER', 'FRAYER', 'WARMER', 'FILTER 5 STAGES', 'HOOD ASS', 'TV-86-SMRT', 'AC-HOT/COLD-5HP-INDOOR UNIT', 'MINCER', 'AC-COLD-7HP-OUTDOOR UNIT', 'Wearable_Acc', 'ESPRESSO MACH', 'IRON', 'TV-55-SMRT', 'TV-85-SMRT-HI', 'FILTER 7 STAGES', 'ALEXA ECHO DOT', 'It_Acc', 'AC-HOT/COLD-5HP', 'AC-HOT/COLD-1.5HP', 'TV-ACCESSORY', 'TV-70-SMRT', 'RECEIVER'], 'extended_sub_category': ['Network-Switch', 'KETTLE', 'HOOD', 'STRAIGHTNERS', 'SPORT MACHINE', 'SDA COMPLEMENTARY', 'MIXER', 'MICROWAVE', 'TV-70-SMRT', 'MOBILE', 'BMOBILE ACCESSORIES', 'NON', 'Gaming', '0', 'ESPRESSO MACH', 'TV-50-SMRT', 'AC-HOT/COLD-7HP', 'Cross Bag', 'IRON', 'THERMAL VESSEL', 'COFFEE GRINDER', 'E.HOT PLATE', 'FRAYER', 'COFFEE M', 'Mobile photography', 'AC-HOT/COLD-1.5HP', 'H.MIXER', 'Mobile Cables', 'AC-HOT/COLD-2.25HP', 'FILTER 7 STAGES', 'Smart Home', 'Network-Modem', 'TV-55-SMRT', 'CHOPPER', 'TV-40-SMRT', 'FUN LINE', 'Smart Scale', 'TV Supplies', 'TV COMPLEMENTARY', 'WASHING M', 'LAPTOP', 'AC-HOT/COLD-3HP', 'TV-85-SMRT-HI', 'MDA COMPLEMENTARY', 'TV-65-SMRT-HI', 'FILTER 6 STAGES', 'Smart tag', 'TV-50-SMRT-HI', 'AC-HOT/COLD-6HP', 'Mobile Audio', 'AC-HOT/COLD-4HP', 'VC', 'IOT', 'Network-Adapter', 'CLINER M', 'HOBS', 'AIR FRYER', 'BUNDLE- B-IN', 'Storage', 'Wearables', 'COOKER', 'MOSQ.KILL', 'M.MINCER', 'TV-43', 'BLENDER', 'FILTER 3 STAGES', 'JUICER', 'Bar Code Scanner', 'MASHER', 'HAIR DRYER', 'Protection', 'TV-40', 'WL Telephone', 'Security', 'FRIDGE', 'TV-65-SMRT', 'TV-60-SMRT', 'Bundle', 'CAPPUCCINO MAKER', 'KITCHEN M', 'AC-COLD-7HP', 'TV-55-SMRT-HI', 'AIR PURIFIER', 'TV-75-SMRT', 'Gift', 'Mobile Holder', 'GRILL', 'WD', 'FILTER 5 STAGES', 'TANK', 'TV-32', 'COOKING APPLIANCES', 'TV-85-SMRT', 'COMPLEMENTARY', 'MINCER', 'FAN', 'AC COMPLEMENTARY', 'WASHER DRYER', 'ELE HEATER', 'WALL HOOD', 'Network', 'TV Cables', 'DRYER', 'AIR COOLER', 'TABLET', 'Computer peripherals', 'Service', 'MOBILE COMPLEMENTARY', 'R.COOKER', 'F.PROC', 'DEEP FREEZER', 'TV-32-SMRT', 'AIR STYLER', 'GAS HEATER', 'Power', 'AC-COLD-3HP', 'ALEXA ECHO DOT', 'SCALE', 'CURL IRONS', 'WARMER', 'Mobile cables', 'TV-75-SMRT-HI', 'OVEN', 'TV-50', 'AC-HOT/COLD-5HP', 'TOASTER', 'AC-COLD-1.5HP', 'D WASHER', 'H.BLENDER', 'SHAVING_TRI', 'TV-43-SMRT', 'AC-COLD-2.25HP'], 'sub_category_supplier': ['H.MIXER-SMART', 'JUICER-HOME TECH', 'TV-ACCESSORY-LG', 'AIR COOLER-TORNADO', 'RECEIVER-ETI', 'IRON-KENWOOD', 'M.MINCER-MOULINEX', 'FAN-NIKAI', 'COOKER-WHITE WHALE', 'AUDIO-DOB', 'F.PROC-ULTRA', 'VC-SAMSUNG', 'FRIDGE-ZANUSSI', 'RECEIVER-GALAXI', 'GRILL-MIENTA', 'JUICER-BOSCH', 'AUDIO-F&D', 'WASHING M-MIELE', 'AUDIO-SONY', 'BLENDER-TOUCH', 'WASHING M-WHITE POINT', 'FRAYER-PHILIPS', 'WARMER-HELLER', 'CHOPPER-KENWOOD', 'HOBS-BOSCH', 'TV-32-SAMSUNG', 'MICROWAVE-SMART', 'TV-75-SMRT-HI-LG', 'E.HOT PLATE-HOME TECH', 'TV-65-SMRT-SHARP', 'TV-65-SMRT-LG', 'F.PROC-MIENTA', 'AC-HOT/COLD-2.25HP-TORNADO', 'D WASHER-ZANUSSI', 'TV-43-SMRT-PLUTO', 'H.BLENDER-BRAUN', 'AUDIO-TOSHIBA', 'AC-HOT/COLD-2.25HP-MIDEA', 'AC-HOT/COLD-1.5HP-AMERICOOL', 'TV-32-FRESH', 'LAPTOP-APPLE', 'OVEN-BRANDT', 'TV-43-UNION AIRE', 'IRON-PHILIPS', 'AC-COLD-1.5HP-FRESH', 'FAN-ARION', 'KITCHEN M-FRESH', 'TV-55-SMRT-LG', 'VC-MIENTA', 'COFFEE M-KENWOOD', 'MASHER-KENWOOD', 'TV-ACCESSORY-ITEL', 'OVEN-BOSCH', 'TV-55-SMRT-PLUTO', 'AC-HOT/COLD-2.25HP-UNION AIRE', 'GIFT-ARISTON', 'MINCER-BOSCH', 'ELE HEATER-SHTEBEL', 'FAN-FRESH', 'COOKER-ZANUSSI', 'E.HOT PLATE-TOUCH', 'COOKER-ROYAL', 'FRAYER-MODEX', 'HOBS-BEKO', 'FAN-TOUCH', 'VC-BLACK AND DECAR', 'AC-HOT/COLD-2.25HP-SHARP', 'AC-COLD-2.25HP-FRESH', 'F.PROC-PANASONIC', 'AC-HOT/COLD-4HP-FRESH', 'R.COOKER-BLACK AND DECAR', 'FUN LINE-TORNADO', 'TV-60-SMRT-TORNADO', 'FRAYER-MIELE', 'MIXER-UNION AIRE', 'M.MINCER-SMART', 'ELE HEATER-TORNADO', 'AC ACCESSORY-LG', 'WASHING M-SAMSUNG', 'WASHING M-BEKO', 'COOKER-FRESH', 'WASHING M-SHARP', 'SHAVING_TRI-REMINGTON', 'AIR STYLER-RUSH BRUSH', 'JUICER-MOULINEX', 'OVEN-HOOVER', 'TV-50-SMRT-HI-LG', 'COOKER-UNIVERSAL', 'ELE HEATER-UNION AIRE', 'D WASHER-LG', 'WD-ULTRA', 'HOBS-GORENJE', 'TV-65-SMRT-UNION AIRE', 'AC ACCESSORY-FRESH', 'COOKER-LA GERMANYA', 'CHOPPER-TOUCH', 'AC-HOT/COLD-2.25HP-BEKO', 'TV-32-SMRT-TOSHIBA', 'KETTLE-SOLAC', 'COFFEE M-SOLAC', 'VC-SMART', 'H.BLENDER-BLACK AND DECAR', 'GRILL-TORNADO', 'FUN LINE-ZAHRAN', 'LAPTOP-HUAWEI', 'TV-43-CAIXUN', 'TV-ACCESSORY-HAMA', 'SPORT MACHINE-KHATER', 'VC-LG', 'TOOLS-CLABER', 'HOOD-ARISTON', 'AC ACCESSORY-ZANUSSI', 'KETTLE-TOUCH', 'TV-32-ULTRA', 'AC ACCESSORY-UNION AIRE', 'DEEP FREEZER-BEKO', 'CHOPPER-SONAI', 'MINCER-HOME TECH', 'TV-50-SMRT-SAMSUNG', 'AC-HOT/COLD-6HP-CARRIERE', 'BLENDER-HOME TECH', 'M.MINCER-TORNADO', 'GRILL-BLACK AND DECAR', 'TV-ACCESSORY-ETI', 'WD-FRESH', 'E.HOT PLATE-FRESH', 'F.PROC-BRAUN', 'AC-COLD-2.25HP-CARRIERE', 'H.BLENDER-SENCOR', 'HAIR DRYER-ARZUM', 'MOBILE-OPPO', 'IRON-BRAUN', 'TV-32-SONY', 'WD-TORNADO', 'D WASHER-INDESIT', 'H.MIXER-BLACK AND WHITE', 'DEEP FREEZER-UNION AIRE', 'M.MINCER-SONAI', 'OVEN-ELBA', 'TV-65-SMRT-TOSHIBA', 'H.MIXER-SONAI', 'AC-COLD-1.5HP-HAIER', 'TV-43-SMRT-HAIER', 'R.COOKER-MODEX', 'AC-HOT/COLD-2.25HP-CARRIERE', 'VC-HITACHI', 'AUDIO-ORAIMO', 'ELE HEATER-UNIVERSAL', 'GAS HEATER-PASSAP', 'AC-COLD-1.5HP-TORNADO', 'OVEN-MIELE', 'MINCER-WHITE WHALE', 'ESPRESSO MACH-ARIETE', 'TV-43-CONTEX', 'FILTER ASS-SEASONS', 'FILTER 3 STAGES-SEASONS', 'BLENDER-SMART', 'TV-43-SMRT-ULTRA', 'MOBILE-REALME', 'F.PROC-MODEX', 'DEEP FREEZER-FRESH', 'AC-COLD-1.5HP-CRAFT', 'DEEP FREEZER-WHITE POINT', 'TV-75-SMRT-HI-SAMSUNG', 'OVEN-ZANUSSI', 'AC ACCESSORY-PREMIUM', 'H.MIXER-MOULINEX', 'AC-COLD-2.25HP-PREMIUM', 'HOOD-ZANUSSI', 'TV-55-SMRT-TORNADO', 'HOBS-FAGOR', 'TV-32-SMRT-SAMSUNG', 'FRIDGE-WHITE POINT', 'MICROWAVE-BLACK AND DECAR', 'TV-43-NIKAI', 'MOBILE-HONOR', 'HOBS-FRANKE', 'ELE HEATER-WHITE WHALE', 'FUN LINE-MEDIA TECH', 'TOASTER-BRAUN', 'TV-70-SMRT-SAMSUNG', 'HOOD-BOSCH', 'AC-COLD-1.5HP-ULTRA', 'H.BLENDER-SEM', 'OVEN-SIMFER', 'KITCHEN M-BOSCH', 'BUNDLE- B-IN-INDESIT', 'BLENDER-BLACK AND WHITE', 'H.BLENDER-G.TEC', 'OVEN-GORENJE', 'TV-32-SMRT-FRESH', 'MICROWAVE-DAEWOO', 'AIR PURIFIER-LG', 'FRIDGE-TOSHIBA', 'TV-ACCESSORY-TRUMAN', 'TV-ACCESSORY-FALCON', 'FUN LINE-ARIETE', 'WARMER-TOUCH', 'TV-FRAME-SAMSUNG', 'TV-43-SMRT-UNION AIRE', 'LAM-PHILIPS', 'HOOD-FAGOR', 'COFFEE M-BLACK AND DECAR', 'BMOBILE ACCESSORIES-MUSIC HERO', 'VC-BLACK AND WHITE', 'DEEP FREEZER-ELECTROSTAR', 'AC-HOT/COLD-1.5HP-HAIER', 'COMPLEMENTARY-SONY', 'AC-HOT/COLD-2.25HP-GENERAL ELECTRIC', 'TV-32-HAIER', 'TABLET-APPLE', 'WARMER-VEITO', 'OVEN-FAGOR', 'JUICER-MODEX', 'BLENDER-KENWOOD', 'TV-32-SMRT-NIKAI', 'AC-COLD-2.25HP-MIDEA', 'BMOBILE ACCESSORIES-ORIGINAL', 'TV-43-TOSHIBA', 'KETTLE-HOUSECOM', 'TV-32-SMRT-CAIXUN', 'TV-50-SMRT-SONY', 'H.BLENDER-TORNADO', 'HOOD-PREMIER', 'KITCHEN M-MOULINEX', 'AC-HOT/COLD-1.5HP-ZANUSSI', 'MICROWAVE-HOME TECH', 'H.MIXER-MIENTA', 'CHOPPER-ARIETE', 'KETTLE-BRAUN', 'LAPTOP-HP', 'TV-50-SMRT-UNION AIRE', 'TV-ACCESSORY-SYINIX', 'BMOBILE ACCESSORIES', 'KITCHEN M-KENWOOD', 'IRON-MODEX', 'AC-HOT/COLD-1.5HP-CARRIERE', 'TV-32-LG', 'IRON-MIENTA', 'H.MIXER-PANASONIC', 'BLENDER-MIENTA', 'AC-COLD-3HP-UNION AIRE', 'MOBILE-LAVA', 'WARMER-MEDIA TECH', 'H.MIXER-TORNADO', 'THERMAL VESSEL-TIGER', 'OVEN-NARDI', 'IRON-PANASONIC', 'GAS HEATER-FRESH', 'AUDIO-PHILIPS', 'FRIDGE-INDESIT', 'AC-HOT/COLD-3HP-SHARP', 'KETTLE-PANASONIC', 'COOKER-UNION AIRE', 'AC-HOT/COLD-3HP-UNION AIRE', 'AC-COLD-3HP-PREMIUM', 'AC-COLD-1.5HP-MIDEA', 'VC-DAEWOO', 'BLENDER-ARIETE', 'TANK-SEASONS', 'WASHING M-CANDY', 'DEEP FREEZER-KIRIAZI', 'F.PROC-TORNADO', 'GRILL-TEFAL', 'GRILL-KENWOOD', 'COOKING APPLIANCES-ARIETE', 'AC-HOT/COLD-1.5HP-SHARP', 'ELE HEATER-ARISTON', 'TV-55-SMRT-TOSHIBA', 'TV-ACCESSORY-FLAT', 'AIR COOLER-HOME TECH', 'TV-32-UNION AIRE', 'WALL HOOD-OLYMPIC', 'OVEN-MIENTA', 'FAN-TEFAL', 'TV-55-SMRT-SAMSUNG', 'AC-COLD-3HP-ULTRA', 'WASHING M-BOSCH', 'KETTLE-MIENTA', 'AC-HOT/COLD-4HP-LG', 'COMPLEMENTARY-NIKON', 'HAIR DRYER-REMINGTON', 'FUN LINE-BLACK AND DECAR', 'HOOD-GORENJE', 'SCALE-SOLAC', 'COFFEE M-MODEX', 'BLENDER-MOULINEX', 'DEEP FREEZER-SHARP', 'OVEN-FRESH', 'M.MINCER-BOSCH', 'TV-43-SMRT-TOSHIBA', 'GIFT-NESTLE', 'AC-COLD-1.5HP-SHARP', 'D WASHER-BeKO', 'BLENDER-G.TEC', 'ELE HEATER-ATLANTIC', 'GRILL-ZADA', 'HOBS-ZANUSSI', 'WARMER-DELONGHI', 'KETTLE-SENCOR', 'SHAVING_TRI-PHILIPS', 'HOBS-FRESH', 'MICROWAVE-LG', 'AC ACCESSORY-SHARP', 'ELE HEATER-KIRIAZI', 'TV-ACCESSORY-HP', 'LAPTOP-VAIO', 'ELE HEATER-TOSHIBA', 'DEEP FREEZER-LG', 'AC-COLD-2.25HP-ULTRA', 'GAS HEATER-ARION', 'AIR PURIFIER-DAIKIN', 'RECEIVER-SKYWORTH ZAPPER', 'AC-COLD-3HP-FRESH', 'GAS HEATER-UNION AIRE', 'TV-55-SMRT-ULTRA', 'FRIDGE-FRESH', 'MIXER-TOUCH', 'FRIDGE-ELECTROSTAR', 'TV-75-SMRT-SAMSUNG', 'BLENDER-FRESH', 'TV-ACCESSORY-ICONZ', 'GRILL-BOSCH', 'TV-43-HAIER', 'M.MINCER-KENWOOD', 'F.PROC-BOSCH', 'JUICER-KENWOOD', 'KETTLE-MODEX', 'AC-COLD-1.5HP-UNION AIRE', 'OVEN-ULTRA', 'JUICER-TORNADO', 'H.MIXER-TOUCH', 'LAM-BLACK AND DECAR', 'TV-86-SMRT-LG', 'BMOBILE ACCESSORIES-EZVIZ', 'DEEP FREEZER-PASSAP', 'OVEN-FRANKE', 'FAN-TORNADO', 'KETTLE-BOSCH', 'HOBS-MIELE', 'KETTLE-MEDIA TECH', 'TV-50-SMRT-PREMIUM', 'MOBILE-HUAWEI', 'FUN LINE-HOME TECH', 'TV-86-SMRT-UNION AIRE', 'BMOBILE ACCESSORIES-LAVVENTO', 'AC-HOT/COLD-1.5HP-BEKO', 'BLENDER-BLACK AND DECAR', 'FRIDGE-WHITE WHALE', 'VC-PANASONIC', 'GRILL-FRESH', 'H.BLENDER-MIENTA', 'AC-HOT/COLD-1.5HP-FRESH', 'GAS HEATER-ZANUSSI', 'H.MIXER-ROVO', 'TV-55-SMRT-SONY', 'OVEN-KLASS', 'OVEN-HOME TECH', 'MICROWAVE-FRESH', 'GIFT-INFINX', 'DRYER-HOME TECH', 'AC-COLD-1.5HP-CARRIERE', 'VC-TEFAL', 'IRON-ARIETE', 'D WASHER-MIELE', 'COMPLEMENTARY-HAVIT', 'AC-HOT/COLD-3HP-CARRIERE', 'AC-COLD-3HP-CRAFT', 'BLENDER-MEDIA TECH', 'IRON-TORNADO', 'COOKER-KIRIAZI', 'RECIEVER-TIGER', 'F.PROC-SMART', 'WARMER-MIENTA', 'M.MINCER-TOUCH', 'BLENDER-ULTRA', 'TV-40-SMRT-SAMSUNG', 'TV-43-SMRT-FRESH', 'AC-COLD-1.5HP-AMERICOOL', 'TV-43-SMRT-LG', 'HOOD-HOOVER', 'WD-BERGEN', 'HOOD-ICOOK', 'HOOD-BEKO', 'TOASTER-ARIETE', 'BLENDER-BOSCH', 'FRIDGE-KIRIAZI', 'AC-HOT/COLD-3HP-ULTRA', 'DRYER-ARISTON', 'FAN-ULTRA', 'TV-ACCESSORY-KEENDEX', 'TV-40-SMRT-VIEW', 'CHOPPER-BOSCH', 'VC-ARIETE', 'JUICER-SOLAC', 'DEEP FREEZER-PANASONIC', 'WASHING M-KIRIAZI', 'COMPLEMENTARY-HP', 'AC-HOT/COLD-7HP-CARRIERE', 'DEEP FREEZER-TOSHIBA Midea', 'F.PROC-GROUHY', 'FRIDGE-LG', 'AC-COLD-2.25HP-GENERAL ELECTRIC', 'GRILL-HOME TECH', 'FRAYER-FRESH', 'HOBS-SMART', 'VC-TORNADO', 'AIR PURIFIER-SHARP', 'AC-HOT/COLD-3HP-LG', 'AC-HOT/COLD-1.5HP-ULTRA', 'F.PROC-ARIETE', 'KITCHEN M-SARY', 'KITCHEN M-SMART', 'TV-50-SMRT-TOSHIBA', 'GAS HEATER-WHITE POINT', 'ELE HEATER-CLAGE', 'BMOBILE ACCESSORIES-NI', 'TV-43-SMRT-PREMIUM', 'THERMAL VESSEL-TANK', 'COMPLEMENTARY-CANON', 'COMPLEMENTARY-INTEL', 'GAS HEATER-WHITE WHALE', 'IRON-SMART', 'KITCHEN M-G.TEC', 'TV-32-TORNADO', 'SHAVING_TRI-RUSH BRUSH', 'GRILL-MEDIA TECH', 'COOKER-PREMIUM', 'TV-43-SMRT-SONY', 'KITCHEN M-BLACK AND WHITE', 'AIR COOLER-SONAI', 'FUN LINE-SONAI', 'TOASTER-PANASONIC', 'WASHING M-HOOVER', 'KETTLE-KENWOOD', 'DEEP FREEZER-ARISTON', 'H.MIXER-FRESH', 'HOBS-HOOVER', 'STRAIGHTNERS-MIENTA', 'TV-50-SMRT-PLUTO', 'IRON-BLACK AND DECAR', 'H.BLENDER-SMART', 'IRON-HOME TECH', 'JUICER-SONAI', 'GAS HEATER-FERROLI', 'VC-GROUHY', 'CHOPPER-MOULINEX', 'TV-40-CONTEX', 'TV-70-SMRT-LG', 'STRAIGHTNERS-TORNADO', 'OVEN-TORNADO', 'AC-HOT/COLD-3HP-PREMIUM', 'MOBILE-XIAOMI', 'MOBILE-INFINX', 'GAS HEATER-PREMIUM', 'HOOD-BeKO', 'COFFEE M-ZADA', 'GIFT-LG', 'BMOBILE ACCESSORIES-SONY', 'TV-32-SARY', 'TV-ACCESSORY-FRESH', 'TABLET-LENOVO', 'ELE HEATER-FLYON', 'AC-HOT/COLD-3HP-GENERAL ELECTRIC', 'TOASTER-TORNADO', 'TV-65-SMRT-SAMSUNG', 'MICROWAVE-SHARP', 'AC-HOT/COLD-1.5HP-MIDEA', 'TV-32-PREMIUM', 'M.MINCER-PANASONIC', 'CLINER M-KARCHER', 'OVEN-ARISTON', 'MICROWAVE-ARISTON', 'FUN LINE-MIENTA', 'H.BLENDER-BLACK AND WHITE', 'DEEP FREEZER-WHITE WHALE', 'AC-COLD-2.25HP-UNION AIRE', 'TV-50-SMRT-TCL', 'AC-COLD-3HP-LG', 'FRAYER-ARISTON', 'AC-COLD-2.25HP-SHARP', 'TOASTER-KENWOOD', 'IRON-TOUCH', 'KETTLE-BLACK AND DECAR', 'IRON-TEFAL', 'THERMAL VESSEL-TEFAL', 'COFFEE M-BOSCH', 'DEEP FREEZER-ALASKA', 'WASHING M-TOSHIBA', 'RECEIVER-DALY', 'GAS HEATER-ARISTON', 'AC-HOT/COLD-3HP-FRESH', 'HOBS-NARDI', 'FAN-MIENTA', 'KETTLE-HOME TECH', 'VC ACCESSORIES-MIELE', 'TOOLS-MPT HT', 'F.PROC-BLACK AND DECAR', 'FILTER 5 STAGES-SEASONS', 'F.PROC-BLACK AND WHITE', 'KETTLE-FRESH', 'CHOPPER-BLACK AND DECAR', 'COFFEE M-DELONGHI', 'VC-KENWOOD', 'TV-43-ULTRA', 'TV-43-TORNADO', 'WASHER DRYER-LG', 'HOOD-FRANKE', 'D WASHER-BOSCH', 'FRAYER-TEFAL', 'AUDIO-MEDIA TECH', 'AC-HOT/COLD-3HP-BEKO', 'H.MIXER-BRAUN', 'AC-HOT/COLD-5HP-CARRIERE', 'LAPTOP-MSI', 'KITCHEN M-TOUCH', 'BMOBILE ACCESSORIES-HP', 'M.MINCER-BRAUN', 'VC-TOSHIBA', 'TV-32-SMRT-HAIER', 'TABLET-SAMSUNG', 'BLENDER-MODEX', 'AC-COLD-3HP-CARRIERE', 'E.HOT PLATE-SMART', 'TV-65-SMRT-HI-LG', 'VC-HOOVER', 'AC-HOT/COLD-1.5HP-TORNADO', 'TV-55-SMRT-HI-LG', 'HOOD ASS-INDESIT', 'CAPPUCCINO MAKER-ARIETE', 'COFFEE M-TEFAL', 'TV-ACCESSORY-NOUR TECH', 'WASHING M-PREMIUM', 'COFFEE M-NESPRESSO', 'BMOBILE ACCESSORIES-DAHUA', 'TV-65-SMRT-HI-SAMSUNG', 'ELE HEATER-VEITO', 'NON', 'H.BLENDER-HOME TECH', 'D WASHER-WHITE POINT', 'MIXER-BLACK AND DECAR', 'WASHING M-HAIER', 'CHOPPER-ROVO', 'TV-75-SMRT-HI-SHARP', 'TV-50-ULTRA', 'CHOPPER-FRESH', 'TOASTER-MIENTA', 'TV-ACCESSORY-MEDIA TECH', 'FRIDGE-TORNADO', 'COFFEE M-HOME TECH', 'TV-ACCESSORY-ORIGINAL', 'MICROWAVE-SAMSUNG', 'WASHING M-INDESIT', 'OVEN-SHARP', 'TV-65-SMRT-TORNADO', 'TV-43-SMRT-SAMSUNG', 'MASHER-BLACK AND WHITE', 'STRAIGHTNERS-BABYLISS', 'KITCHEN M-MODEX', 'H.BLENDER-MOULINEX', 'TV-50-SMRT-ULTRA', 'MIXER-MODEX', 'HAIR DRYER-PHILIPS', 'TV-55-SMRT-PREMIUM', 'FRIDGE-PASSAP', 'E.HOT PLATE-MIENTA', 'AIR FRYER-TORNADO', 'AC-COLD-1.5HP-LG', 'AUDIO-LG', 'VC-ROVO', 'GAS HEATER-LONGLIFE', 'HOBS-BAUMATIC', 'FRIDGE-UNION AIRE', 'CHOPPER-ULTRA', 'ELE HEATER-OLYMPIC', 'MOBILE-NOKIA', 'GAS HEATER-ATLANTIC', 'HOBS-GLEMGAS', 'GAS HEATER-PANASONIC', 'HOOD-PANASONIC', 'GRILL-SOLAC', 'FRIDGE-IDEAL', 'WARMER-ULTRA', 'OVEN-INDESIT', 'AUDIO-SAMSUNG', 'VC-BOSCH', 'MOBILE-APPLE', 'HOOD-INDESIT', 'FRAYER-BLACK AND DECAR', 'TV-ACCESSORY-FORA', 'BMOBILE ACCESSORIES-LOGITECH', 'AC-HOT/COLD-1.5HP-LG', '0', 'H.BLENDER-TOUCH', 'AC-COLD-2.25HP-LG', 'TV-32-SMRT-LG', 'COFFEE M-SONAI', 'SPORT MACHINE-FUTURE', 'STRAIGHTNERS-PHILIPS', 'CHOPPER-MEDIA TECH', 'AC-COLD-2.25HP-CRAFT', 'HOBS-INDESIT', 'WARMER-BLACK AND DECAR', 'R.COOKER-TEFAL', 'HOOD-SONAI', 'WD-WHITE WHALE', 'TV-32-UG', 'JUICER-MEDIA TECH', 'COFFEE M-MEDIA TECH', 'COMPLEMENTARY-LENOVO', 'GIFT-UNIVERSAL', 'KITCHEN M-ARIETE', 'FRIDGE-BEKO', 'AC ACCESSORY-DAIKIN', 'BMOBILE ACCESSORIES-LDNIO', 'F.PROC-HOME TECH', 'M.MINCER-BLACK AND WHITE', 'COFFEE M-SMART', 'BLENDER-SENCOR', 'WD-KOLDAIR', 'FAN-BLACK AND WHITE', 'COMPLEMENTARY-BENQ', 'AC-HOT/COLD-1.5HP-HISENSE', 'HAIR DRYER-BABYLISS', 'AC-COLD-1.5HP-PREMIUM', 'WASHING M-ARISTON', 'STRAIGHTNERS-REMINGTON', 'BLENDER-PANASONIC', 'WARMER-SHTEBEL', 'CHOPPER-TORNADO', 'GIFT-FRESH', 'D WASHER-BEKO', 'MOBILE-SAMSUNG', 'KETTLE-ZADA', 'FAN-SONAI', 'MICROWAVE-KENWOOD', 'HOBS-ICOOK', 'TABLET-TCL', 'HOOD-FRESH', 'F.PROC-UNION AIRE', 'KETTLE-ARION', 'IRON-BLACK AND WHITE', 'BMOBILE ACCESSORIES-OSN', 'GRILL-TOUCH', 'LAPTOP-MICROSOFT', 'D WASHER-FRESH', 'KETTLE-SMART', 'H.BLENDER-BOSCH', 'TV-32-SMRT-SHARP', 'TV-50-SMRT-HAIER', 'MICROWAVE-ZANUSSI', 'DEEP FREEZER-MIELE', 'WARMER-TORNADO', 'WD-PASSAP', 'AUDIO-FIRST', 'LAPTOP-ASUS', 'COFFEE M-PHILIPS', 'DEEP FREEZER-TORNADO', 'GAS HEATER-UNIVERSAL', 'TV-32-SMRT-PREMIUM', 'BLENDER-SARY', 'MOSQ.KILL-HOME TECH', 'WD-WHITE POINT', 'WALL HOOD-TORNADO', 'M.MINCER-MODEX', 'WASHING M-FRESH', 'TV-65-SMRT-TCL', 'JUICER-BRAUN', 'FUN LINE-SOLAC', 'GIFT-BOSCH', 'ALEXA ECHO DOT-ALEXA', 'TV-50-SMRT-SHARP', 'HOBS-ECOMATIC', 'R.COOKER-HOME TECH', 'HOOD-ELBA', 'AIR STYLER-BABYLISS', 'HAIR DRYER-RUSH BRUSH', 'THERMAL VESSEL-WACACO', 'TV-40-SMRT-UNION AIRE', 'SHAVING_TRI-HAPILLINE', 'THERMAL VESSEL-SEASONS', 'SHAVING_TRI-BABYLISS', 'AC-HOT/COLD-5HP-LG', 'AC-HOT/COLD-2.25HP-FRESH', 'ELE HEATER-FRESH', 'TV-75-SMRT-TOSHIBA', 'TV-55-SMRT-HI-SAMSUNG', 'JUICER-MIENTA', 'TV-85-SMRT-SAMSUNG', 'H.MIXER-MEDIA TECH', 'TOASTER-BLACK AND DECAR', 'HOOD-MIELE', 'TV-55-SMRT-TCL', 'SHAVING_TRI-TORNADO', 'MICROWAVE-HOOVER', 'WALL HOOD-TOSHIBA', 'COFFEE M-MIENTA', 'VC-MODEX', 'AC-HOT/COLD-5HP-SHARP', 'TABLET-HUAWEI', 'FAN-SMART', 'FRIDGE-SAMSUNG', 'AC-COLD-3HP-MIDEA', 'AC-HOT/COLD-2.25HP-ULTRA', 'F.PROC-BENEX', 'MASHER-MIENTA', 'TV-85-SMRT-HI-LG', 'HOOD-TOUCH', 'AC ACCESSORY-CRAFT', 'AC ACCESSORY-CARRIERE', 'BLENDER-TORNADO', 'FAN-KENWOOD', 'COFFEE GRINDER-ARIETE', 'AC-HOT/COLD-3HP-MIDEA', 'COFFEE M-BEKO', 'COMPLEMENTARY-DELL', 'ELE HEATER-BOMAN', 'BMOBILE ACCESSORIES-STEEL', 'F.PROC-SONAI', 'AIR FRYER-KENWOOD', 'F.PROC-MOULINEX', 'COMPLEMENTARY-SAMSUNG', 'WASHING M-TORNADO', 'KETTLE-ARIETE', 'FILTER ASS-PHILIPS', 'TV-43-SMRT-SHARP', 'AUDIO-AVANTREE', 'MOBILE-HOPE', 'TV-75-SMRT-LG', 'TOOLS-BOSCH', 'H.BLENDER-KENWOOD', 'MIXER-ULTRA', 'LAPTOP-DELL', 'H.BLENDER-SARY', 'AC-HOT/COLD-5HP-FRESH', 'TV-43-SMRT-TORNADO', 'CURL IRONS-BABYLISS', 'AC-HOT/COLD-2.25HP-PREMIUM', 'FRIDGE-ULTRA', 'TV-32-TCL', 'TOOLS-SNDWAY', 'H.MIXER-KENWOOD', 'TV-32-PLUTO', 'TV-ACCESSORY-HISENSE', 'AC-HOT/COLD-2.25HP-HISENSE', 'MIXER-MEDIA TECH', 'STRAIGHTNERS-BRAUN', 'TV-ACCESSORY-ILOOK', 'TOOLS-MPT PT', 'COFFEE M-TORNADO', 'TV-ACCESSORY-ELIOS', 'HAIR DRYER-TORNADO', 'KETTLE-BLACK AND WHITE', 'GIFT-INDESIT', 'WASHING M-UNION AIRE', 'RECEIVER-TRUMAN', 'H.MIXER-MODEX', 'WASHING M-FAGOR', 'TOASTER-HOME TECH', 'CURL IRONS-RUSH BRUSH', 'GRILL-MODEX', 'COOKER-BEKO', 'TV-55-SMRT-SHARP', 'BMOBILE ACCESSORIES-TOSHIBA', 'KITCHEN M-MIENTA', 'DEEP FREEZER-TOSHIBA', 'KETTLE-ZAHRAN', 'OVEN-TOUCH', 'SHAVING_TRI-BRAUN', 'COMPLEMENTARY-XIAOMI', 'MIXER-BLACK AND WHITE', 'COOKER-WHITE POINT', 'TV-32-TOSHIBA', 'GAS HEATER-KIRIAZI', 'BMOBILE ACCESSORIES-STRONG', 'MOBILE-VIVO', 'BLENDER-BRAUN', 'WARMER-FRESH', 'GAS HEATER-TORNADO', 'TV-50-SMRT-LG', 'F.PROC-KENWOOD', 'AIR FRYER-SOLAC', 'WD-SPEED', 'TABLET-REALME', 'ELE HEATER-ZANUSSI', 'FRAYER-DELONGHI', 'WASHING M-ZANUSSI', 'CHOPPER-SMART', 'WALL HOOD-FRESH', 'VC-BISSELL', 'HOBS-BRANDT', 'KITCHEN M-HOME TECH', 'D WASHER-ARISTON', 'GAS HEATER-BOSCH', 'TV-85-SMRT-HI-SAMSUNG', 'HOBS-ELBA', 'COOKER-BOSCH', 'WARMER-AKWRJ', 'H.MIXER-BOSCH', 'GIFT-SAMSUNG', 'FRAYER-BERGEN', 'TOOLS-HITACHI', 'AC-COLD-2.25HP-TORNADO', 'AC-HOT/COLD-1.5HP-UNION AIRE', 'WASHING M-Toshiba', 'FRIDGE-MIELE', 'H.BLENDER-MEDIA TECH', 'AC-HOT/COLD-4HP-SHARP', 'DEEP FREEZER-INDESIT', 'LAPTOP-LENOVO', 'MICROWAVE-TORNADO', 'AC-HOT/COLD-4HP-CARRIERE', 'IRON-SOLAC', 'TV-ACCESSORY-SCHNEIDER', 'COFFEE M-BRAUN', 'FAN-BLACK AND DECAR', 'TV-32-ATA', 'KETTLE-TORNADO', 'HOBS-KLASS', 'VC-ULTRA', 'AC-HOT/COLD-1.5HP-PREMIUM', 'HAIR DRYER-SOLAC', 'CHOPPER-MIENTA', 'R.COOKER-MEDIA TECH', 'MDA-ZANUSSI', 'TV-50-SMRT-TORNADO', 'TV-75-SMRT-UNION AIRE', 'FAN-PANASONIC', 'AC ACCESSORY-HAIER', 'AC-COLD-3HP-TORNADO', 'VC-SOLAC', 'VC-FRESH', 'TV-32-SMRT-TORNADO', 'FAN-UNION AIRE', 'FAN-UNIVERSAL', 'FRIDGE-HAIER', 'VC-MIELE', 'HOOD-TORNADO', 'FRAYER-MIENTA', 'TV-43-LG', 'MDA ASS-INDESIT', 'FRIDGE-ARISTON', 'FRIDGE-SHARP', 'MINCER-BLACK AND DECAR', 'COFFEE M-OKKA', 'KETTLE-SONAI', 'FRAYER-HOME TECH', 'IRON-ULTRA', 'COMPLEMENTARY-EPSON', 'FILTER 6 STAGES-SEASONS', 'F.PROC-G.TEC', 'OVEN-BEKO', 'AC-HOT/COLD-3HP-TORNADO', 'HOBS-ARISTON', 'AC-COLD-7HP-CARRIERE', 'GAS HEATER-OLYMPIC', 'TV-32-SMRT-SONY', 'COFFEE M-WHITE WHALE', 'FILTER 7 STAGES-SEASONS', 'AIR COOLER-FRESH', 'COFFEE M-BIALETTI', 'WASHER DRY ASS-MIELE', 'FRIDGE-BOSCH', 'IRON-MEDIA TECH', 'HOBS-TORNADO', 'AC-HOT/COLD-2.25HP-LG', 'WASHING M-LG', 'BLENDER-SONAI', 'STRAIGHTNERS-RUSH BRUSH', 'RECEIVER-MUTECH']} the_received_subfilter
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
929.785748941 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('3827.4551393256495351')), ('initial_average_retail_price', Decimal('13577.520611027390')), ('proposed_sellthru_percent', Decimal('48.6368358896164080')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('32.4136208030615601')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.41362080306156), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 12776103995.917412), ('budget_cost', 5619173156.667113), ('deficit', Decimal('12776103996.3836')), ('Original_BudgetAmount', Decimal('12776103996.3836')), ('budget_percent', Decimal('96.5767')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 2358236.0), ('ACT_FCT', Decimal('1526457517.3700')), ('Original_BudgetCostofGoods', Decimal('5619173156.6660')), ('PO', Decimal('40489680498.2363')), ('COSTPRICE', 4850630415.656907), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('1526457517.3700')), ('stock_on_hand_qty', Decimal('3224994')), ('net_sales_ly', Decimal('8457177703.7700')), ('net_sales_lly', Decimal('979919493.1300')), ('gross_sales_ly', Decimal('8776997771.7820')), ('total_sku_count', Decimal('516929')), ('ly_customer_disc', Decimal('319820068.0120')), ('SupplyCost', Decimal('5338214498.8343')), ('SALESQTY', 2259896.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('88.6379')), ('budget_qty_act_fct_percent', Decimal('213527143.8374')), ('budget_vs_py_qty_percent', Decimal('131680338.6267')), ('budget_vs_ppy_qty_percent', Decimal('224144496.6150')), ('QTY_Buy_By_SKU', Decimal('2358236.0000')), ('total_sku_count_ty', Decimal('117403970775')), ('total_sku_count_lly', Decimal('36128')), ('total_sku_count_ly', Decimal('258979')), ('quantity_mix_percent', Decimal('101.7138')), ('quantity_act_forecast', Decimal('2615650.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('1637216.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('145531700.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.1049')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('5619173156.6660')), ('budget_vs_py_cost_percent', Decimal('324617380041.7000')), ('budget_vs_ppy_cost_percent', Decimal('34745744036.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('1014407140.3700')), ('cost_of_goods_ly', Decimal('3541134944.9270')), ('cost_act_forecast', Decimal('6633580297.0360')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('728664590034.1046')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('516925396.3600')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('1.9665')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('24715.3830')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('24715.3830')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
929.987740791 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 3827.4551 ┆ 13577.520 ┆ … ┆ 0.0       ┆ 24715.383 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆ 39        ┆ 611       ┆   ┆           ┆           ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 58.128644         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 3.1982e8   ┆ 8.4572e9   ┆ 1.2776e10  ┆ 58.217196 ┆ 1.3259e10 ┆ 48.636836 ┆ 2.7262e10 ┆ 3.643844  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x7697328EBD00>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x7697328E82E0>, <Expr ['col("SalesActualsByForecast").…'] at 0x7697328EBF10>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328EBD60>, <Expr ['col("proposed_sellthru_percent…'] at 0x7697328EBEB0>, <Expr ['col("retail_value_including_ma…'] at 0x7697328EB7F0>, <Expr ['col("budget_gross_margin_perce…'] at 0x7697328EB910>, <Expr ['col("Logistic%").mean()'] at 0x7697328EBFA0>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x7697328E8310>, <Expr ['col("MarkdownValue").mean()'] at 0x7697328EB700>, <Expr ['col("markdown_percent").mean()'] at 0x7697328E8340>, <Expr ['col("DisplayItemValue").mean()'] at 0x7697328EBDF0>, <Expr ['col("budget_amount").sum()'] at 0x7697328EB7C0>, <Expr ['col("budget_cost").sum()'] at 0x7697328E8EE0>, <Expr ['col("deficit").sum()'] at 0x7697328E82B0>, <Expr ['col("Original_BudgetAmount").s…'] at 0x7697328EB790>, <Expr ['col("budget_percent").sum()'] at 0x7697328EBDC0>, <Expr ['col("relative_budget_percent")…'] at 0x7697328EA7A0>, <Expr ['col("History_Net_Sales").sum()'] at 0x7697328E8070>, <Expr ['col("budget_qty").sum()'] at 0x7697328EA800>, <Expr ['col("ACT_FCT").sum()'] at 0x7697328EB8E0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x7697328E80D0>, <Expr ['col("PO").sum()'] at 0x7697328E80A0>, <Expr ['col("COSTPRICE").sum()'] at 0x7697328E8130>, <Expr ['col("Historical_Gross_Margin")…'] at 0x7697328E81C0>, <Expr ['col("sales_actual").sum()'] at 0x7697328EA8F0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x7697328EAAD0>, <Expr ['col("net_sales_ly").sum()'] at 0x7697328EA980>, <Expr ['col("net_sales_lly").sum()'] at 0x7697328EAAA0>, <Expr ['col("gross_sales_ly").sum()'] at 0x7697328EA8C0>, <Expr ['col("total_sku_count").sum()'] at 0x7697328EAA10>, <Expr ['col("ly_customer_disc").sum()'] at 0x7697328EAD40>, <Expr ['col("SupplyCost").sum()'] at 0x7697328EAE90>, <Expr ['col("SALESQTY").sum()'] at 0x7697328EA920>, <Expr ['col("DisplayItemQty").sum()'] at 0x7697328EAB30>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x7697328EAEC0>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x7697328EAE30>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x7697328E8190>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x7697328EACE0>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x7697328E8250>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x7697328EB070>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x7697328EB100>, <Expr ['col("total_sku_count_lly").sum…'] at 0x7697328EAF50>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x7697328EABC0>, <Expr ['col("quantity_mix_percent").su…'] at 0x7697328EB0D0>, <Expr ['col("quantity_act_forecast").s…'] at 0x7697328EB010>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328EB2B0>, <Expr ['col("sold_qty_ly").sum()'] at 0x7697328EAF80>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328EB3A0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x7697328EABF0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328EB250>, <Expr ['col("budget_cost_percent").sum…'] at 0x7697328EB520>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x7697328EB490>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x7697328EB5B0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x7697328EB400>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x7697328EB430>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x7697328EB190>, <Expr ['col("cost_mix_percent").sum()'] at 0x7697328EB640>, <Expr ['col("cost_actuals").sum()'] at 0x7697328EBF40>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x7697328EBEE0>, <Expr ['col("cost_act_forecast").sum()'] at 0x7697328EB280>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x7697328E8400>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x7697328E8430>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x7697328E84F0>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x7697328EB4C0>, <Expr ['col("budget_margin_percent").s…'] at 0x7697328EB670>, <Expr ['col("budget_margin_mix_percent…'] at 0x7697328E8490>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x7697328E8640>, <Expr ['col("margin_actuals").sum()'] at 0x7697328EBD30>, <Expr ['col("margin_act_forecast").sum…'] at 0x7697328E83D0>, <Expr ['col("units_per_sku_total").sum…'] at 0x7697328E84C0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x7697328EBB20>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x7697328EAC50>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x7697328E87C0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x7697328E8520>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328E87F0>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328E8880>, <Expr ['col("budget_per_sku").sum()'] at 0x7697328E8370>, <Expr ['col("budget_qty_ty").sum()'] at 0x7697328E8A00>, <Expr ['col("Check_box").max()'] at 0x7697328E8790>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,3827.4551393256,13577.5206110274,48.6368358896,13259250335.2784976959,56.0181009918,5.0,56.0181009918,31982006801.2000007629,3.6438435594,0.0,12776103995.9174118042,5619173156.6671133041,12776103996.383600235,12776103996.383600235,100.0,100.0,0.0,2358236.0,1526457517.3699998856,5619173156.6660003662,40489680498.2362976074,4850630415.6569070816,0.0,1526457517.3699998856,3224994.0,8457177703.7700004578,979919493.1299999952,8776997771.781999588,516929.0,319820068.0120000243,5338214498.8343000412,2259896.0,0.0,0.0,88.6379,213527143.8373999894,131680338.626699999,224144496.6150000095,2358236.0,117403970775.0,36128.0,258979.0,101.7138,2615650.0,0.0,1637216.0,145531700.0,0.0,0.0,0.1049,0.0,0.0,5619173156.6660003662,324617380041.700012207,34745744036.0,0.0,1014407140.3700000048,3541134944.9270000458,6633580297.0360002518,0.0,0.0,0.0,0.0,728664590034.1046142578,0.0,0.0,516925396.3600000143,0.0,1.9665,0.0,24715.383,0.0,0.0,0.0,0.0,24715.383,0.0,0.0,151.068174791,1303.7911874892,18.0492543829,5894.1362711648,100.0,4225137.0609222762,58.2171959422,43787422505.439666748,58.1286444608,4916042758.843000412,0.0,0.0,7156930839.2502985001,123122273.1174469739,43787422505.439666748,18334387358.7017936707,43787422505.439666748,13259250335.2785015106,12776103995.9174098969,27261745326.87733078,11390721632.664264679,4780420.3699001595]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":3827.4551393256,"initial_average_retail_price":13577.5206110274,"proposed_sellthru_percent":48.6368358896,"retail_value_including_markdown":13259250335.2784976959,"budget_gross_margin_percent":56.0181009918,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":56.0181009918,"MarkdownValue":31982006801.2000007629,"markdown_percent":3.6438435594,"DisplayItemValue":0.0,"budget_amount":12776103995.9174118042,"budget_cost":5619173156.6671133041,"deficit":12776103996.383600235,"Original_BudgetAmount":12776103996.383600235,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":2358236.0,"ACT_FCT":1526457517.3699998856,"Original_BudgetCostofGoods":5619173156.6660003662,"PO":40489680498.2362976074,"COSTPRICE":4850630415.6569070816,"Historical_Gross_Margin":0.0,"sales_actual":1526457517.0,"stock_on_hand_qty":3224994.0,"net_sales_ly":8457177703.7700004578,"net_sales_lly":979919493.1299999952,"gross_sales_ly":8776997771.781999588,"total_sku_count":516929.0,"ly_customer_disc":319820068.0120000243,"SupplyCost":5338214498.8343000412,"SALESQTY":2259896.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":88.6379,"budget_qty_act_fct_percent":213527143.8373999894,"budget_vs_py_qty_percent":131680338.626699999,"budget_vs_ppy_qty_percent":224144496.6150000095,"QTY_Buy_By_SKU":2358236.0,"total_sku_count_ty":117403970775.0,"total_sku_count_lly":36128.0,"total_sku_count_ly":258979.0,"quantity_mix_percent":101.7138,"quantity_act_forecast":2615650.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":1637216.0,"quantity_act_forecast_vs_ly_percent":145531700.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.1049,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":5619173156.6660003662,"budget_vs_py_cost_percent":324617380041.700012207,"budget_vs_ppy_cost_percent":34745744036.0,"cost_mix_percent":0.0,"cost_actuals":1014407140.3700000048,"cost_of_goods_ly":3541134944.9270000458,"cost_act_forecast":6633580297.0360002518,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":728664590034.1046142578,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":516925396.3600000143,"margin_act_forecast":0.0,"units_per_sku_total":1.9665,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":24715.383,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":24715.383,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":58.1286444608,"FirstMargin_percent":58.2171959422,"budget_vpy":151.068174791,"budget_vppy":1303.7911874892,"StockatRetailPrice":43787422505.439666748,"TYForecast":43787422505.439666748,"LYvsACT_FCT_percent":100.0,"supply_retail_value":12776103995.9174098969} } data_json
WebSocket connection closed unexpectedly
INFO:     45.156.129.125:0 - "GET / HTTP/1.1" 200 OK
INFO:     45.156.129.125:0 - "GET /api/session/properties HTTP/1.1" 404 Not Found
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     connection open
{'history_date_range': {'fro': '2023-01-01', 'to': '2023-12-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-12-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': True, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-01-01', to='2023-12-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-12-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
930.97199558 start_to_execute main the stored procedure
conn established
sp executed
931.04998913 end of main the stored procedure
conn established
sku wise calc executed
931.102809223 end of sku wise stored proc
we called the sku wise stored procedure_init
We are getting data from ra_and_stock
931.102927082 started to fetch data
conn established
<function getData.<locals>.<lambda> at 0x76a59b3c3400> dfafghaf
1132.951557235 end of fetch data
(535152, 168) output data shape
111111111111111111111111111111111111111111111
processing...
we are calling main groupby process
1
WebSocket connection closed unexpectedly
1
WebSocket connection closed unexpectedly
1
conn established
sku wise calc executed
1137.107252611 end of sku wise stored proc
conn established
[OrderedDict([('id', 248183), ('store', None), ('region', None), ('area', None), ('Channel', 'B.TECH X'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 248184), ('store', None), ('region', None), ('area', None), ('Channel', 'MINI'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 248185), ('store', None), ('region', None), ('area', None), ('Channel', 'WAREHOUSE'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 248186), ('store', None), ('region', None), ('area', None), ('Channel', 'ARKAN'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 248187), ('store', None), ('region', None), ('area', None), ('Channel', 'Retail'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)])] 3309 getData dictsize
1137.323572429 end of fetch data
shape: (3_309, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 248183 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 248184 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 248185 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 248186 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 248187 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 251487 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 251488 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 251489 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 251490 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 251491 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the filter dataframe
shape: (3_309, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 248183 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 248184 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 248185 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 248186 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 248187 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 251487 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 251488 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 251489 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 251490 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 251491 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the_fiter_data
id Int64
store String
region String
area Int32
Channel String
budget_year Int32
budget_quarter String
budget_month String
budget_weekday Int64
budget_day String
budget_dates Int32
historical_year Int64
history_Quarter String
history_month String
history_week String
history_Day String
history_datess Int32
family String
sub_Family String
Supplier String
Category String
Dom_Comm String
Sub_Category String
Extended_sub_category String
Sub_Category_supplier String
Article_Score Int32
last_v store store
last_v region region
last_v Channel Channel
last_v Quarter budget_quarter
last_v month budget_month
last_v week budget_weekday
last_v Day budget_day
last_v history_Quarter history_Quarter
last_v history_month history_month
last_v history_Day history_Day
last_v family family
last_v sub_family sub_Family
last_v supplier Supplier
last_v category Category
last_v dom_comm Dom_Comm
last_v sub_category Sub_Category
last_v extended_sub_category Extended_sub_category
last_v sub_category_supplier Sub_Category_supplier
{'store': ['Dakernis Branch', 'ElBahr ElAzam', 'Nagaa Hamadi Branch', 'Alamein Masa Mall', 'Smouha Branch', 'Faisal Branch', 'Roxy Branch', 'BTECHX Ismailia Square', 'El Kanater Branch', '0', 'Malawi Branch', 'New Dumietta Branch', 'Delta Tanta Mega Store', 'Miela Arkan Mall', 'Mega Fisal', 'El Nozha Branch', 'BTECHX Assuit', 'BTECHX Safwa Zaid ', 'BTECHX ASU', 'B2B Gov', 'BTECHX El Menia', 'BTECHX Sporting Club', 'Ain Shams Branch - Mostafa Hafez St.', 'GateWay Mall El Rehab', 'EL Amiria Branch', 'Noon Seller Store1', 'Port Said', 'Ismaila Branch-Railway station', 'BTECHX Maadi Grand Mall', 'Masara', 'Fakous Branch', 'Winget Branch', 'El Tahrir', 'New sohag', 'Misr elgdida', 'Corporate Sales', 'Qalyub', 'BTECHX Triumph Tagamo', 'BTECHX Sheraton', 'Maadi Branch-El Laselky St.', 'BTECHX City Stars Mall', 'Hadek El Kobba Branch', 'Quesna Branch', 'BTECHX Airport', 'BTECHX Sidi Bishr', 'BTECHX ElRehab Mall1', 'Luxor Branch', 'Almaza Branch', 'El Sadat Branch', 'Damanhour Branch', 'Ismalia Branch-City Council Square', 'October-WH', 'BTECHX Open Air Mall', 'Miela Arkan WH', 'BTECHX The Yard Mall', 'Alex WH', 'El Mokattam Branch', 'Dumietta Branch', 'Qena Branch', 'El Fayoum Branch', 'CFC Mall', '9025Show Room Alex', 'Amwaj ranch', 'BTECHX 45', 'New Damanhour', 'Town Center El Salam', '10th of Ramadan WH', 'Deel Asyut WH', 'Uni Mall El Obour', 'Suez Branch', 'BTECHX Sohag', 'Desouk Branch', 'Marina Branch', 'Marina Kaian Branch', 'El-Elsoudan Street Branch', 'BTECHX San_Stefano Mall', 'El Galaa', 'El Betash Branch', 'Beni Suef Branch', 'BTECH Mini MPC', 'Marassi-North-Coast Branch', 'New Roxy', 'Loran Branch', 'BTECHX CityCenterMaadi', 'Tanta Branch', 'Zahra El Asher Branch', 'BTECHX GardeniaTagamo', 'El Sayeda Zainab', 'EL Matria', 'BTECHX Kafr ElSheikh', 'El Helmya', 'BTECHX Kasr El Einy', 'El Tagamou 2 Branch', 'BTECH2Fayoum', 'BTECHX Manial', 'BTECHX ElRehab North', 'Shebin El Koum Branch', 'Salah Salim Branch', 'BTECHXCFC', '3Tanta Mall', 'Sky Mall El Sherouk Branch', 'BTECHX Mansoura', 'Eldahar Mega Branch', 'Banha Branch', 'BTECH mini Egyptian Shooting ', 'Jumia Seller Store', 'Mall Of Arabia Branch', 'Mahalla Branch', 'El-Gouna Branch', 'Gesr El Suez Branch', 'El Tagamou 1 Branch', 'Zagazig Branch', 'El Menia Mega Branch', 'BTECH Mini Air Force House', 'Banha warehouse', 'Zayton Branch', 'BTECHX Obour2', 'Makadi Bay', 'BTECHX El Sherouk', 'Aswan WH', 'B.ONLINE', 'BTECHX CityCenter Alex', 'BTECHX Truck Alex', 'El Seyouf Branch', '26Th July Branch', 'El Zaher', 'B.TECHX El Mandara', 'Dar El Salam Branch', 'Mansoura Branch', 'BTECHX Mahala', 'BTECHX Saad El Din El Shazly', 'Show Room - Corp. Sale-38', 'Cairo Retail Warehouses', 'Berket Elsabaa Branch', 'Assuit Mega Branch', 'BTECHX Ramses Station', 'BTECHX Gihan3 Abasia', 'Abbas El-Akkad Branch', 'QENA-Warehouse', 'Flag Mall Branch', 'Agami Branch', 'BTECHX ElShams Club', 'Makram Ebaid Branch', 'Alex_ Tusun', 'Sale With Cost W.H', 'Asyut WH', 'Aswan Mega  Branch', 'Ain Shams Branch - Ibrahim Abdel Razek St.', 'BTECHX Gehan2 Dewaka', 'Hassan El Maamon', 'Mega Alex Sidi Gaber', 'B.TECH X AUC', 'Shubra El Kheima Branch', 'Assiut Branch - Ibn Sina Tower', 'Sohag Branch', '1Imbaba', 'Asafra Branch', 'BTECHX Midor', '10th Show Room WH', 'HQ Call Center', 'Elagamy2', 'BTECHX Dokki', 'Ras Ghareb Branch', 'Oraby Branch', 'BTECHX Moharam Bek', 'Mall Of Egypt Branch', 'BTECHX Hegaz', 'Haram Branch', 'BTECHX 2Mansoura', 'BTECHXMataria', 'Mega Helwan', 'BTECHX Shebin El koum', 'Mall Of October Branch', 'BTECHX Shinzo Abe', 'BTECHX Zagazig', '10th Tech Club WH', 'Shoubra Branch', 'B.TECH STAFF', 'Tanta WH', 'BTECHX Roxcy', 'BTECHX El Mosher Axis'], 'region': ['UPPER EGYPT', 'HURGHADA', 'CAIRO', '0', 'ALEXANDRIA', 'DELTA'], 'season': [], 'area': [], 'Channel': ['B2B', 'ARKAN', 'Retail', 'NON', 'CALL CENTER', '0', 'MINI', 'WAREHOUSE', 'ONLINE', 'B.TECH X', 'DEEL'], 'budget_year': [0.0], 'Quarter': ['0', '3', '4'], 'month': ['September', 'August   ', 'December ', 'November ', '0', 'October  ', 'July     '], 'week': [0, 1, 2, 3, 4, 5, 6, 7], 'date': ['19911', '19905', '19955', '19964', '19974', '20009', '19924', '19922', '20010', '20064', '20036', '19967', '20008', '19952', '19950', '19966', '19957', '19947', '20071', '20069', '0', '19975', '19919', '20020', '19970', '19972', '19923', '20086', '19995', '19913', '20056', '20047', '19917', '20057', '20066', '20024', '19976', '20043', '20053', '19918', '20027', '19931', '20031', '19937', '19926', '19921', '19997', '20041', '19934', '20050', '20070', '19943', '19965', '20051', '20048', '20073', '20028', '19935', '20017', '20085', '19908', '20063', '20030', '20052', '19991', '20026', '20002', '20025', '19953', '20007', '19945', '19909', '19939', '19927', '20039', '20078', '19949', '19962', '19979', '20074', '20045', '19963', '20065', '20079', '20059', '20032', '19956', '20055', '19914', '20034', '20062', '20088', '19959', '19915', '20004', '20012', '19998', '19969', '20018', '19944', '19920', '19983', '20001', '19986', '19948', '20068', '19960', '20037', '20076', '20040', '20005', '19912', '20011', '20042', '19978', '19992', '19985', '20038', '20006', '19933', '19907', '20033', '20067', '20035', '19990', '19910', '19938', '20075', '19984', '19916', '20016', '20081', '20080', '19929', '20049', '20084', '20015', '20022', '19994', '19971', '19928', '20087', '20021', '20077', '19936', '19989', '19981', '19925', '20082', '19980', '19987', '19958', '19954', '19946', '19993', '20014', '19973', '20072', '19951', '20060', '20000', '20058', '19932', '20046', '19999', '19942', '20029', '19961', '20013', '20061', '19977', '19982', '19968', '19988', '20054', '20019', '19906', '20023', '19940', '19941', '19930', '20083', '20003', '20044', '19996'], 'Day': ['Thursday ', 'Monday   ', 'Sunday   ', 'Friday   ', 'Tuesday  ', 'Saturday ', '0', 'Wednesday'], 'historical_year': [], 'history_Quarter': ['2', '0', '1', '4', '3'], 'history_month': ['August   ', 'July     ', 'January  ', 'December ', 'March    ', 'June     ', 'September', 'April    ', '0', 'May      ', 'February ', 'November ', 'October  '], 'history_week': ['0', '1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '3', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '4', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '5', '50', '51', '52', '6', '7', '8', '9'], 'history_Day': ['Wednesday', 'Tuesday  ', 'Friday   ', 'Monday   ', 'Sunday   ', 'Saturday ', '0', 'Thursday '], 'history_dates': [0, 18997, 19003, 19005, 19010, 19011, 19015, 19016, 19017, 19022, 19023, 19038, 19040, 19044, 19049, 19050, 19052, 19053, 19057, 19059, 19066, 19068, 19072, 19073, 19074, 19078, 19079, 19080, 19085, 19086, 19087, 19088, 19089, 19095, 19101, 19102, 19103, 19106, 19108, 19109, 19110, 19120, 19121, 19122, 19123, 19124, 19127, 19128, 19129, 19130, 19131, 19134, 19135, 19136, 19137, 19138, 19141, 19143, 19145, 19148, 19150, 19152, 19155, 19156, 19158, 19159, 19162, 19163, 19164, 19165, 19166, 19170, 19171, 19172, 19176, 19178, 19179, 19180, 19186, 19187, 19190, 19192, 19193, 19198, 19200, 19201, 19204, 19206, 19208, 19211, 19212, 19213, 19214, 19215, 19218, 19220, 19221, 19222, 19226, 19227, 19228, 19229, 19232, 19233, 19235, 19236, 19239, 19240, 19241, 19243, 19245, 19246, 19247, 19248, 19249, 19250, 19252, 19253, 19254, 19255, 19256, 19257, 19259, 19260, 19261, 19262, 19263, 19264, 19266, 19267, 19268, 19269, 19270, 19271, 19273, 19274, 19275, 19276, 19277, 19278, 19279, 19280, 19281, 19282, 19283, 19284, 19285, 19286, 19287, 19288, 19289, 19290, 19291, 19292, 19293, 19294, 19295, 19296, 19297, 19298, 19299, 19300, 19301, 19302, 19303, 19304, 19305, 19306, 19307, 19308, 19309, 19310, 19311, 19312, 19313, 19314, 19315, 19316, 19317, 19318, 19319, 19320, 19321, 19322, 19323, 19324, 19325, 19326, 19327, 19328, 19329, 19330, 19331, 19332, 19333, 19334, 19335, 19336, 19337, 19338, 19339, 19340, 19341, 19342, 19343, 19344, 19345, 19346, 19347, 19348, 19349, 19350, 19351, 19352, 19353, 19354, 19355, 19356, 19357, 19358, 19359, 19360, 19361, 19362, 19363, 19364, 19365, 19366, 19367, 19368, 19369, 19370, 19371, 19372, 19373, 19374, 19375, 19376, 19377, 19378, 19379, 19380, 19381, 19382, 19383, 19384, 19385, 19386, 19387, 19388, 19389, 19390, 19391, 19392, 19393, 19394, 19395, 19396, 19397, 19398, 19399, 19400, 19401, 19402, 19403, 19404, 19405, 19406, 19407, 19408, 19409, 19410, 19411, 19412, 19413, 19414, 19415, 19416, 19417, 19418, 19419, 19420, 19421, 19422, 19423, 19424, 19425, 19426, 19427, 19428, 19429, 19430, 19431, 19432, 19433, 19434, 19435, 19436, 19437, 19438, 19439, 19440, 19441, 19442, 19443, 19444, 19445, 19446, 19447, 19448, 19449, 19450, 19451, 19452, 19453, 19454, 19455, 19456, 19457, 19458, 19459, 19460, 19461, 19462, 19463, 19464, 19465, 19466, 19467, 19468, 19469, 19470, 19471, 19472, 19473, 19474, 19475, 19476, 19477, 19478, 19479, 19480, 19481, 19482, 19483, 19484, 19485, 19486, 19487, 19488, 19489, 19490, 19491, 19492, 19493, 19494, 19495, 19496, 19497, 19498, 19499, 19500, 19501, 19502, 19503, 19504, 19505, 19506, 19507, 19508, 19509, 19510, 19511, 19512, 19513, 19514, 19515, 19516, 19517, 19518, 19519, 19520, 19521, 19522, 19523, 19524, 19525, 19526, 19527, 19528, 19529, 19530, 19531, 19532, 19533, 19534, 19535, 19536, 19537, 19538, 19539, 19540, 19541, 19542, 19543, 19544, 19545, 19546, 19547, 19548, 19549, 19550, 19551, 19552, 19553, 19554, 19555, 19556, 19557, 19558, 19559, 19560, 19561, 19562, 19563, 19564, 19565, 19566, 19567, 19568, 19569, 19570, 19571, 19572, 19573, 19574, 19575, 19576, 19577, 19578, 19579, 19580, 19581, 19582, 19583, 19584, 19585, 19586, 19587, 19588, 19589, 19590, 19591, 19592, 19593, 19594, 19595, 19596, 19597, 19598, 19599, 19600, 19601, 19602, 19603, 19604, 19605, 19606, 19607, 19608, 19609, 19610, 19611, 19612, 19613, 19614, 19615, 19616, 19617, 19618, 19619, 19620, 19621, 19622, 19623, 19624, 19625, 19626, 19627, 19628, 19629, 19630, 19631, 19632, 19633, 19634, 19635, 19636, 19637, 19638, 19639, 19640, 19641, 19642, 19643, 19644, 19645, 19646, 19647, 19648, 19649, 19650, 19651, 19652, 19653, 19654, 19655, 19656, 19657, 19658, 19659, 19660, 19661, 19662, 19663, 19664, 19665, 19666, 19667, 19668, 19669, 19670, 19671, 19672, 19673, 19674, 19675, 19676, 19677, 19678, 19679, 19680, 19681, 19682, 19683, 19684, 19685, 19686, 19687, 19688, 19689, 19690, 19691, 19692, 19693, 19694, 19695, 19696, 19697, 19698, 19699, 19700, 19701, 19702, 19703, 19704, 19705, 19706, 19707, 19708, 19709, 19710, 19711, 19712, 19713, 19714, 19715, 19716, 19717, 19718, 19719, 19720, 19721, 19722, 19723, 19724, 19725, 19726, 19727, 19728, 19729, 19730, 19731, 19732, 19733, 19734, 19735, 19736, 19737, 19738, 19739, 19740, 19741, 19742, 19743, 19744, 19745, 19746, 19747, 19748, 19749, 19750, 19751, 19752, 19753, 19754, 19755, 19756, 19757, 19758, 19759, 19760, 19761, 19762, 19763, 19764, 19765, 19766, 19767, 19768, 19769, 19770, 19771, 19772, 19773, 19774, 19775, 19776, 19777, 19778, 19779, 19780, 19781, 19782, 19783, 19784, 19785, 19786, 19787, 19788, 19789, 19790, 19791, 19792, 19793, 19794, 19795, 19796, 19797, 19798, 19799, 19800, 19801, 19802, 19803, 19804, 19805, 19806, 19807, 19808, 19809, 19810, 19811, 19812, 19813, 19814, 19815, 19816, 19817, 19818, 19819, 19820, 19821, 19822, 19823, 19824, 19825, 19826, 19827, 19828, 19829, 19830, 19831, 19832, 19833, 19834, 19835, 19836, 19837, 19838, 19839, 19840, 19841, 19842, 19843, 19844, 19845, 19846, 19847, 19848, 19849, 19850, 19851, 19852, 19853, 19854, 19855, 19856, 19857, 19858, 19859, 19860, 19861, 19862, 19863, 19864, 19865, 19866, 19867, 19868, 19869, 19870, 19871, 19872, 19873, 19874], 'article_score': ['sale', 'abc', 'ae', 'speed', 'terminal', 'margin', 'sell', 'markdown', 'core', 'quartile', 'sortimeter'], 'history_year': [0.0, 2022.0, 2023.0, 2024.0], 'family': ['NON', '0', 'MDA', 'COMPLEMENTARY', 'AC', 'BMOBILE ACCESSORIES', 'SDA', 'TABLET', 'LAPTOP', 'MOBILE', 'TV'], 'sub_family': ['MDA COM', 'AC DOM', 'NON', 'SDA COM', '0', 'AC COM', 'TV DOM', 'BMOBILE', 'MDA DOM', 'SDA DOM', 'TV COM'], 'supplier': ['ORAIMO', 'G.TEC', 'VIVO', 'BMOBILE ACCESSORIES', 'OKKA', 'MODEM', 'FLYON', 'F&D', 'CLABER', 'CHOETECH', 'PASSAP', 'MEDIA TECH', 'TRUMAN', 'BRAUN', 'MIELE', 'LG', 'MSI', 'ASUS', 'AMAZONE', 'PANASONIC', 'S.LINK', 'ELBA', 'SAMSUNG', 'CANDY', 'ROYAL', 'SNDWAY', 'ECOMATIC', 'ITEL', 'TCL', 'FIRST', 'IDEAL', 'BENEX', 'OLYMPIC', 'TIGER', 'NOUR TECH', 'VIEW', 'ZADA', 'SYINIX', 'VEITO', 'FLAT', 'BeKO', 'AVANTREE', 'STEEL', 'TANK', 'FRANKE', 'SENCOR', 'PREMIUM', 'LA GERMANYA', 'XAIOMI', 'BOSCH', 'SONAI', 'UNIVERSAL', 'INFINX', '0', 'CAIXUN', 'LAVA', 'TOUCH', 'SONY', 'BENQ', 'SCHNEIDER', 'DELL', 'HP', 'DAIKIN', 'LONGLIFE', 'SIMFER', 'SEASONS', 'HONOR', 'DAEWOO', 'BLACK AND DECAR', 'CANON', 'ROVO', 'HISENSE', 'GROUHY', 'ARIETE', 'HAVIT', 'SARY', 'INFINIX', 'MIDEA', 'UNION AIRE', 'ICONZ', 'OPPO', 'MUSIC HERO', 'APPLE', 'SANDISK', 'SHARP', 'GORENJE', 'DAHUA', 'KOLDAIR', 'SEM', 'EPSON', 'BERGEN', 'GENERAL ELECTRIC', 'SHTEBEL', 'RUSH BRUSH', 'REMINGTON', 'KENWOOD', 'AMERICOOL', 'TEFAL', 'WHITE WHALE', 'ELECTROSTAR', 'DALY', 'PREMIER', 'OZO', 'BISSELL', 'SMART', 'FORA', 'HOME TECH', 'ELIOS', 'HOME', 'ARISTON', 'ETI', 'CRAFT', 'BIALETTI', 'ATA', 'MIENTA', 'INTEL', 'BEKO', 'ARION', 'MPT PT', 'KLASS', 'MODEX', 'LDNIO', 'VAIO', 'MUTECH', 'ULTRA', 'OSN', 'ILOOK', 'LAVVENTO', 'TORNADO', 'INDESIT', 'NOKIA', 'TOSHIBA', 'HAPILLINE', 'ARZUM', 'TOSHIBA Midea', 'KIOXIA', 'SPEED', 'HITACHI', 'CONTEX', 'HAIER', 'CARRIERE', 'NARDI', 'KHATER', 'NIKON', 'KARCHER', 'FUTURE', 'DELONGHI', 'HELLER', 'AKWRJ', 'NI', 'MOULINEX', 'WHITE POINT', 'LENOVO', 'ZAHRAN', 'HOOVER', 'NESTLE', 'BRANDT', 'ORIGINAL', 'SOLAC', 'BABYLISS', 'FALCON', 'GALAXI', 'ALEXA', 'LOGITECH', 'KEENDEX', 'GLEMGAS', 'REALME', 'ICOOK', 'PLUTO', 'HAMA', 'FAGOR', 'NESPRESSO', 'PHILIPS', 'MPT HT', 'DOB', 'FRESH', 'FERROLI', 'SKYWORTH ZAPPER', 'NON', 'BOMAN', 'STRONG', 'WACACO', 'HOPE', 'ALASKA', 'HUAWEI', 'MICROSOFT', 'ZANUSSI', 'NIKAI', 'CLAGE', 'ATLANTIC', 'HOUSECOM', 'EZVIZ', 'KIRIAZI', 'XIAOMI', 'UG', 'BLACK AND WHITE', 'BAUMATIC'], 'category': ['Fridge White Point', 'Tools Claber', 'Mobile LAVA', 'Cooker Union Aire?', 'E.Hot Pla Home', 'Ele Heater Kiriazi', 'TV ATA', 'Comp Printer Epson', 'Ele heater flyon', 'Thermal Mug Tefal', 'AC ULTRA', 'Kitchen M Home', 'Fridge Indesit', 'Mobile XIAOMI', 'B.Electronic ass', 'Fun Line Tornado', 'H.Blender Braun', 'VC Tornado', 'Warmer Mienta', 'Hair Dryer Babyliss', 'tv acc elios', 'Ice Tank Tank', 'H.Blend Mienta', 'Mincer Home', 'Boxi', 'Air Cooler Home', 'F.Proc Black&white', 'Straightners Remingt', 'Headset SBS', 'F.Proc Braun', 'Washing M Zanussi', 'Ele Heater Ariston', 'Curl Irons Babyliss', 'WD Tornado', 'TV Rowa', 'Hair Dryer arzum', 'Cooker Beko', 'Mobile OPPO', 'Kettle Home', 'Hobs GLEMGAS', 'Cooker White Whale', 'TV Acc hama', 'Tools MPT HT', 'WD Fresh', 'AC Accessory Sharp', 'Warmer Shtebel', 'Frayer Delonghi', 'H.Blend Media Tech', 'Compl Camera GoPRO', 'TV Tcl', 'Blender Sonai', 'Mic. Fresh', 'Oven Sharp', 'Cooker Bosch', 'TV Caixun', 'TV Toshiba', 'IFixBtech', 'Laptop Huawei', 'Security Ass Camera', 'Tablet Nokia', 'Oven Zanussi', 'Audio Philips', 'Frayer Tefal', 'TV Nikai', 'Coffee Grinder Ariet', 'kitchen m sary', 'Air Cooler Fresh', 'Audio LG', 'TV Ultra', 'H.Mixer Modex', 'Iron Solac', 'Gift LG', 'Hood Fagor', 'Juicer Bosch', 'Coffee M Philips I2', 'VC Black&decker', 'Straightners Philips', 'TV Acc Falcon', 'Mixer Kenwood', 'Deep F Ariston', 'Iron Touch', 'Hobs Indesit', 'AC Accessory Carrier', 'Deep F Kiriazi', 'Oven Klass', 'Air Fryer Tornado', 'F.Proc Black&decker', 'Grill Fresh', 'Fan Touch', 'Thermal Mug WACACO', 'Oven Fagor', 'AC Americool', 'Juicer Kenwood', 'VC Daewoo', 'Toaster Braun', 'Gas Heater Kiriazi', 'AC LG', 'Mixer Modex', 'Audio Avantree', 'TV Acc STRONG', 'Gift Indesit', 'AC Haier', 'Kitchen M Touch', 'Hood Elba', 'H.Blend Black&white', 'Grill Media Tech', 'TV Haier', 'AC Carriere', 'H.Blend Black&decker', 'Chopper Rovo', 'Cooking Appliances A', 'AC Daikin', 'VC Tefal', 'AC Acc Union Aire', 'Receiver truman', 'Hobs Brandt', 'Juicer Media Tech', 'Fridge LG', 'Fridge Alaska', 'H.Blend Bosch', 'TV Acc Etrain', 'Fun Line Solac', 'Juicer Sonai', 'TV Acc ilook', 'Gas Heater Fresh', 'Receiver SkyWorth Za', 'Straightners Mienta', 'Laptop APPLE', 'Complem Gaming Sony', 'Oven Hoover', 'Audio oraimo', 'TV Hisense', 'TV Acc HP', 'H.Mixer Panasonic', 'Fan Smart', 'Gas Heater premium', 'Grill Tornado', 'Gas Heater Universal', 'Ele Heater Olympic', 'Protection SBS', 'Laptop ASUS', 'Blender Bosch', 'H.Mixer Mienta', 'AC Accessory LG', 'Compl DESK PC Intel', 'Filter Tank', 'WD speed', 'Washing M Fresh', 'Kitchen M Bosch', 'Comp Monitor Lenovo', 'Fan Arion', 'Mincer Bosch', 'Washing M Indesit', 'Shaving_Tri Babyliss', 'Washing M Tornado', 'Iron Philips I2', 'Receiver ETI', 'Hood Zanussi', 'Frayer Modex', 'Blender Home', 'Oven Miele', 'Juicer Braun', 'Deep F Miele', 'Deep F Panasonic', 'AC Accessory Crafft', 'IT ASS ASS', 'H.Blend Kenwood', 'Coffee M Mienta', 'H.Mixer Touch', 'Gas Heater Olympic', 'TV Samsung', 'WD Ultra', 'H.Blend Tornado', 'Blender Panasonic', 'AC Premium', 'Audio Toshiba', 'Warmer Delonghi', 'Fan Fresh', 'Mic. Kenwood', 'Iron Mienta', 'Gas Heater Arion', 'Deep F Tornado', 'Oven Nardi', 'F.Proc Panasonic', 'Ele Heater Zanussi', 'F.Proc Sonai', 'Fun Line Black&decke', 'Gas Heater Ferroli', 'Deep F Sharp', 'Gift Universal', 'TV Premium', 'Iron Tornado', 'Tablet Samsung', 'R.cooker Media Tech', 'H.Mixer Black&white', 'Blender G.tec', 'TV Sharp', 'F.Proc Benex', 'Hobs Ariston', 'Mixer Black&white', 'H.Mixer SMART', 'TV Acc Itel', 'Washing M Kiriazi', 'Washing M Premium', 'Hobs Klass', 'Ele Heater Atlantic', 'Oven Gorenje', 'TV LG', 'Air Cooler Sonai', 'Kettle Solac', 'WARMER Ultra', 'Washing M LG', 'Gas Heater Atlantic', 'Masher Black&white', 'Coffee M SMART', 'TV Acc Fora', 'Bottel Tank', 'Gas Heater LongLife', 'Mic. Ariston', 'Audio', 'Filter ASS Tank', 'M.Mincer Touch', 'Gift Samsung', 'Oven Mienta', 'VC Grouhy', 'M.Mincer Modex', 'TV Acc ICONZ', 'AC Zanussi', 'TV Accessory', 'Washing M Union Aire', 'Holders SBS', 'Oven beko', 'Coffee M Bosch', 'Tablet Lenovo', 'Oven Home', 'Mic. Home', 'TV Acc MUTECH', 'Receiver Daly', 'AC General Electric', 'AC TORNADO', 'H.Blender Smart', 'kettle Mienta', 'Chopper SMART', 'Iron Black&Decker', 'Toaster Panasonic', 'Shaving_Tri Tornado', 'Hobs Fagor', 'Fan Black&white', 'Coffee M Solac', 'Fan black&decker', 'VC Bissell', 'TV Acc Media Tech', 'Complem Camera CANON', 'Fridge ULTRA', 'Gas Heater Tornado', 'F.Proc SMART', 'Hood Beko', 'H.Blend Moulinex', 'Sport Machine Khater', 'Hobs Elba', 'Juicer Modex', 'Toaster tornado', 'Chopper Sonai', 'Tools MPT PT', 'M.Mincer Tornado', 'Iron Braun', 'Oven Elba', 'Kettle Housecom', 'Hobs Beko', 'Kettle Braun', 'Toaster Ariete', 'Tools sndway', 'H.Blender SEM', 'Compl Printer CANON', 'VC Ultra', 'E.Hot Touch', 'Tripod SBS', 'H.Mixer Tornado', 'M.Mincer Panasonic', 'Air Purifier SHARP', 'Hood Tornado', 'Deep F Alaska', 'Hobs SMART', 'Grill Kenwood', 'AC Accessory Daikin', 'Thermoses Tiger', 'Washer Dryer Ariston', 'Washing M Fagor', 'Tools Hitachi', 'D Washer White Point', 'Gas Heater PASSAP', 'TV Sony', 'Bundle- b-in Indesit', 'AC Accessory Premium', 'Thermal Mug Tiger', 'Blender Black&decker', 'Kitchen M Mienta', 'Fan Mienta', 'Gas Heater Union Air', 'VC Toshiba', 'Mincer Black&decker', 'Warmer Media Tech', 'Hood Panasonic', 'Hobs Franke', 'Coffee M Media Tech', 'Chopper Mienta', 'Kitchen M Black&whit', 'Blender Smart', 'Airpods kit SBS', 'Frayer Philips I2', 'Cooker La germanya', 'Kettle Touch', 'Blender Ultra', 'Ele Heater Universal', 'AC Fresh', 'Comp Monitor BenQ', 'Deep F PASSAP', 'Oven Bosch', 'Air Purifier LG', 'F.Proc Grouhy', 'TV Contex', 'Warmer Fresh', 'Fun Line Media Tech', 'AC Hisense', 'Mixer Black&decker', 'AC Beko', 'AC Sharp', 'kettle Black&white', 'Enquiry Fees', 'Iron Home', 'Grill Black&decker', 'Gas Heater Toshiba', 'Laptop DELL', 'Deep F Indesit', 'Deep F LG', 'Blender Ariete', 'Kitchen M Kenwood', 'Juicer Moulinex', 'Coffee M Kenwood', 'Straightners Braun', 'E.Hot Plate Fresh', 'Ele Heater VEITO', 'Hood Franke', 'Kitchen M Modex', 'Ele Heater Shtebel', 'Deep F White Point', 'D Washer Beko', 'Washing M Beko', 'Transferfeesonline01', 'VC Modex', 'Deep F White Whale', 'Straightners Tornado', 'Gift Fresh', 'Mincer White Whale', 'Blender Tornado', 'Kettle Modex', 'F.Proc Tornado', 'Com Projector Merlin', 'Ele Heater Clage', 'Kettle Sonai', 'Ice Box Tank', 'Washing M Samsung', 'Fridge Kiriazi', 'Hood Fresh', 'Coffee M okka', 'Iron Black&white', 'Chopper Kenwood', 'AC Accessory Zanussi', 'M.Mincer Black&White', 'Mixer Media Tech', 'VC Miele', 'Coffee M Bialetti', 'Fun Line Zahran', 'Fridge Electrostar', 'Juicer Home', 'Fridge Ariston', 'Tablet TCL', 'Grill Bosch', 'Fan Union Aire?', 'Hood Hoover', 'WD Bergen', 'Comp Monitor Xiaomi', 'Toaster Black&decker', 'Grill Mienta', 'Chopper Ultra', 'Oven Fresh', 'Masher Kenwood', 'VC LG', 'TV Acc osn', 'Audio Samsung', 'TV Acc Tiger', 'Washing M White Poin', 'Grill Modex', 'Blender Touch', 'TV Acc ETI', 'H.Mixer Midea', 'Mic. Daewoo', 'Toaster Home', 'Hood Gorenje', 'TV Union Aire', 'Mic. Tornado', 'Chopper Bosch', 'Laptop Lenovo', 'Kitchen M SMART', 'Mic. Samsung', 'WD White Point', 'Hobs Hoover', 'Blender Kenwood', 'Iron Media Tech', 'Washing M Toshiba', 'Deep F Beko', 'F.Proc Moulinex', 'Juicer Home Tech', 'F.Proc Home', 'Iron Kenwood', 'Fan Ultra', 'Laptop HP', 'F.Proc Modex', 'Curl Irons Rush brus', 'Ele Heater White Wha', 'TV SARY', 'TV View', 'Iron Ultra', 'F.Proc Ariete', 'Hobs ECOMATIC', 'Fridge Fresh', 'Mobile INFINX', 'Gift Nestle', 'VC Fresh', 'M.Mincer Bosch', 'Tablet Huawei', 'Hood ICook', 'Frayer Miele', 'Mobile NOKIA', 'Fridge Beko', 'Deep F Electrostar', 'Ele Heater Union Air', 'VC Hitachi', 'Washing M CANDY', 'Frayer Home', 'H.Mixer Moulinex', 'Warmer Black&decker', 'Coffee M Nespresso', 'Fridge Ideal', 'tv acc schneider', 'Receiver Galaxi', 'Straightners Solac', 'Oven Touch', 'Warmer Tornado', 'Oven Tornado', 'Cooker Universal', 'Washing M Sharp', 'H.Mixer Bosch', 'Fridge Union Aire', 'Gift Bosch', 'Hobs Bosch', 'Hobs Tornado', '0', 'TV Acc FLAT', 'IFix', 'VC Solac', 'Chopper Fresh', 'Fun Line Sonai', 'Hobs Nardi', 'VC Ariete', 'Mobile Huawei', 'Fan Tornado', 'Fridge Zanussi', 'Cliner M Karcher', 'Washing M Haier', 'Grill Zada', 'Mic. Zanussi', 'Gift Ariston', 'Selfie Stick SBS', 'Kettle Zahran', 'VC Black&white', 'H.Mixer Sonai', 'Mixer Ultra', 'AC Crafft', 'Coffee M Tefal', 'Cables SBS', 'Blender Modex', 'M.Mincer SMART', 'Air Styler Babyliss', 'WD White Whale', 'Mobile Samsung', 'Receiver', 'TV Acc NI', 'VC Kenwood', 'Wall Hood Toshiba', 'Shaving_Tri Braun', 'Gas Heater White Wha', 'Hobs Fresh', 'Frayer Fresh', 'M.Mincer Braun', 'Comp Monitor Samsung', 'Coffee M Delonghi', 'Juicer Mienta', 'M.Mincer Sonai', 'F.Proc Bosch', 'tv acc truman', 'Coffee M Home', 'Wall Hood Olympic', 'Audio Media Tech', 'Stand Indesit', 'F.Proc Union Aire', 'B.ElectronicServices', 'R.cooker Tefal', 'Thermal Mug Tank', 'Oven Brandt', 'Laptop VAIO', 'Juicer Tornado', 'Fun Line Home', 'Frayer Mienta', 'Air Styler Rush brus', 'Mobile REALME', 'Hair Dryer Rush brus', 'Fridge Miele', 'Oven Franke', 'Gas Heater Zanussi', 'kettle Media', 'H.Blend sary', 'AC Accessory Fresh', 'Mobile HONOR', 'Ele Heater Fresh', 'Juicer Solac', 'Hood Sonai', 'mosq.kill Home', 'Straightners Rush br', 'Air Fryer Kenwood', 'VC Rovo', 'Lam Black&decker', 'TV ASS ASS', 'Cooker Kiriazi', 'VC Smart', 'Washing M Bosch', 'Masher Mienta', 'Ele Heater Boman', 'Complent Alexa IOT', 'Espresso Machine Ari', 'Chopper Black&decker', 'Hood Miele', 'Hood ASS Indesit', 'Comp Monitor Dell', 'Kettle SENCOR', 'Blender sencor', 'Mixer Touch', 'D Washer LG', 'Air Cooler Tornado', 'Blender Moulinex', 'Fan Nikai', 'H.Blend Home', 'Security Ass Camera ', 'Warmer Heller', 'Blender Braun', 'Kettle Arion', 'H.Blend Touch', 'D Washer Ariston', 'Hood Bosch', 'TV Acc Energizer', 'Oven Simfer', 'Ele Heater TORNADO', 'Washing M Miele', 'Coffee M Beko', 'TV Pluto', 'TV FRESH', 'R.cooker Black&decke', 'Comp Google Mesh IOT', 'D Washer Fresh', 'Hair Dryer Solac', 'Kettle Panasonic', 'Wall Hood Fresh', 'Fun Line Mienta', 'Gas Heater White Poi', 'VC Hoover', 'H.Mixer Kenwood', 'F.Proc G.tec', 'Kettle Ariete', 'Grill Solac', 'D Washer Miele', 'Dryer LG', 'Kitchen M Ariete', 'Grill Home', 'Blender Black&white', 'Lam Philips', 'Chopper Touch', 'H.Mixer Braun', 'Coffee M Zada', 'Audio F&D', 'Fridge Samsung', 'H.Blend G.tec', 'VC AccessoriesMiele', 'AC Accessory Haier', 'VC Samsung', 'Iron Modex', 'M.Mincer Moulinex', 'Fan Tefal', 'Iron Tefal', 'Fan universal', 'Hobs Zanussi', 'Mic. Black&decker', 'Laptop Microsoft', 'Mobile APPLE', 'tv acc keendex', 'Shaving_Tri Philips', 'Hood Ariston', 'Cooker White Point', 'M.Mincer Kenwood', 'Cooker Royal', 'Blender sary', 'Hood Premier', 'Sport Machine Future', 'Shaving_TriRemington', 'Coffee M Sonai', 'Toaster Mienta', 'Fun Line Ariete', 'F.Proc Kenwood', 'VC Panasonic', 'Kitchen M Fresh', 'Cappuccino Maker Ari', 'Washing M Hoover', 'Filter ASS philips', 'Chopper Moulinex', 'B2B AC', 'VC Bosch', 'AC Union Aire?', 'Iron Ariete', 'TV Acc STEEL', 'WD Tank', 'Mobile VIVO', 'Hobs Baumatic', 'Wall Hood Tornado', 'TV Syinix', 'D Washer Zanussi', 'Mobile Hope', 'Straightners Babylis', 'Coffee M Braun', 'Fridge Bosch', 'Frayer Ariston', 'Oven Indesit', 'Fridge Haier', 'E.Hot Plate Mienta', 'Kettle Fresh', 'Deep F Union Aire?', 'Shaving_Tri Hapillin', 'Washing M Ariston', 'Gaming ASS ASS', 'TABLET REALME', 'TV Tornado', 'E.Hot Plate SMART', 'Warmer Touch', 'H.Mixer Rovo', 'H.Mixer Fresh', 'Chopper Media Tech', 'Kettle Black&decker', 'Toaster Kenwood', 'Fridge White Whale', 'Warmer veito', 'Hobs ICook', 'Deep F Fresh', 'H.Blend SENCOR', 'Mixer Union Aire', 'Audio First', 'Dryer Home', 'Gas Heater Bosch', 'Fan Sonai', 'Chopper Ariete', 'Tools Bosch', 'Kettle Bosch', 'Cooker Premium', 'Hobs Gorenje', 'Blender Media Tech', 'Audio Dob', 'R.cooker Modex', 'Iron Panasonic', 'F.Proc ULTRA', 'Fridge Tornado', 'Kettle Media Tech', 'Coffee M Tornado', 'Kettle Zada', 'Fridge PASSAP', 'Kettle SMART', 'Audio sony', 'D Washer Indesit', 'D Washer Bosch', 'TV Acc Toshiba', 'Kettle Kenwood', 'Oven Ultra', 'Kitchen M Moulinex', 'Coffee M Black&decke', 'Deep F Toshiba', 'Ele Heater Toshiba', 'Grill Touch', 'Gas Heater Panasonic', 'Mic. LG', 'R.cooker HOME', 'Fan Kenwood', 'Hair Dryer Remington', 'Cleaning SBS', 'Coffee M Modex', 'Tablet APPLE', 'AC Midea', 'Grill Tefal', 'Mic. SMART', 'TV UG', 'M Grinder Sonai', 'Iron Smart', 'Washer Dry ASSMiele', 'Fan Panasonic', 'Mic. Hoover', 'Mic. Sharp', 'F.Proc Mienta', 'Power Bank SBS', 'Fridge Toshiba', 'Hair Dryer Tornado', 'Charger SBS', 'Fridge Sharp', 'VC Mienta', 'Laptop MSI', 'Speaker SBS', 'Hobs Miele', 'Kitchen M G.tec', 'Chopper Tornado', 'Blender Fresh', 'Gas Heater Ariston', 'Scale Solac', 'Complem Printer HP', 'Cooker Zanussi', 'Kettle Tornado', 'Frayer Black&decker', 'Warmer Akwrj', 'Blender Mienta', 'Frayer Bergen', 'Coffee M White Whale', 'Hood Touch', 'Hood Indesit', 'WD PASSAP', 'Cooker Fresh', 'Hair Dryer Philips', 'Oven Ariston', 'Complem Camera Nikon'], 'dom_comm': ['NON', 'COMM', 'DOM', '0', 'B.MOBILE'], 'sub_category': ['TV-86-SMRT', 'M.MINCER', 'FILTER 6 STAGES', 'ELE HEATER', 'AIR STYLER', 'WASHER DRY ASS', 'AC-COLD-2.25HP-INDOOR UNIT', 'TV-75-SMRT', 'SPORT MACHINE', 'TV-65-SMRT-HI', 'AC-COLD-2.25HP', 'SCALE', 'FRAYER', 'FAN', 'TV-43', 'TV-60-SMRT', 'AC-HOT/COLD-1.5HP', 'AC-COLD-7HP-OUTDOOR UNIT', 'CHOPPER', 'AIR PURIFIER', 'AC ACCESSORY', 'GAS HEATER', 'AC-HOT/COLD-3HP', 'AC-HOT/COLD-1.5HP-INDOOR UNIT', 'AC-COLD-3HP-INDOOR UNIT', 'AC-HOT/COLD-3HP-INDOOR UNIT', 'TV-ACCESSORY', 'AC-HOT/COLD-4HP-INDOOR UNIT', 'FRIDGE', 'KETTLE', 'R.COOKER', 'COFFEE M', 'AC-HOT/COLD-7HP-OUTDOOR UNIT', 'AC-HOT/COLD-4HP', 'WASHING M', 'TV-50-SMRT-HI', 'MDA ASS', 'KITCHEN M', 'OVEN', 'AC-COLD-3HP-OUTDOOR UNIT', 'MOBILE', 'MICROWAVE', 'FILTER 3 STAGES', 'AC-HOT/COLD-5HP-INDOOR UNIT', 'COOKING APPLIANCES', 'TV-85-SMRT', 'H.BLENDER', 'It_Acc', 'BLENDER', 'TOOLS', '0', 'AIR COOLER', 'FILTER 7 STAGES', 'AC-HOT/COLD-1.5HP-OUTDOOR UNIT', 'NON', 'TV-85-SMRT-HI', 'AUDIO', 'WASHER DRYER', 'FUN LINE', 'GRILL', 'HOOD', 'TV-50-SMRT', 'Mobile_Acc', 'F.PROC', 'RECEIVER', 'TV-32', 'AC-COLD-1.5HP-OUTDOOR UNIT', 'Wearable_Acc', 'BUNDLE- B-IN', 'CLINER M', 'TV-55-SMRT-HI', 'TABLET', 'HAIR DRYER', 'DRYER', 'MOSQ.KILL', 'SHAVING_TRI', 'TV-65-SMRT', 'TV-43-SMRT', 'TANK', 'TV-32-SMRT', 'TV-50', 'IRON', 'D WASHER', 'FILTER ASS', 'LAM', 'AC-HOT/COLD-3HP-OUTDOOR UNIT', 'TOASTER', 'JUICER', 'COMPLEMENTARY', 'FILTER 5 STAGES', 'TV-FRAME', 'AIR FRYER', 'AC-HOT/COLD-6HP-INDOOR UNIT', 'BMOBILE ACCESSORIES', 'TV-70-SMRT', 'GIFT', 'AC-HOT/COLD-5HP', 'E.HOT PLATE', 'VC ACCESSORIES', 'STRAIGHTNERS', 'TV-40-SMRT', 'ESPRESSO MACH', 'WALL HOOD', 'COFFEE GRINDER', 'DEEP FREEZER', 'TV-75-SMRT-HI', 'MIXER', 'THERMAL VESSEL', 'LAPTOP', 'HOBS', 'HOOD ASS', 'TV-55-SMRT', 'AC-HOT/COLD-2.25HP', 'CAPPUCCINO MAKER', 'MINCER', 'AC-HOT/COLD-5HP-OUTDOOR UNIT', 'AC-HOT/COLD-2.25HP-INDOOR UNIT', 'AC-COLD-2.25HP-OUTDOOR UNIT', 'H.MIXER', 'COOKER', 'AC-HOT/COLD-7HP-INDOOR UNIT', 'WARMER', 'WD', 'AC-HOT/COLD-4HP-OUTDOOR UNIT', 'CURL IRONS', 'AC-COLD-1.5HP-INDOOR UNIT', 'AC-COLD-7HP-INDOOR UNIT', 'AC-COLD-1.5HP', 'ALEXA ECHO DOT', 'TV-40', 'AC-HOT/COLD-2.25HP-OUTDOOR UNIT', 'VC', 'MASHER'], 'extended_sub_category': ['H.MIXER', 'AIR PURIFIER', 'AC-HOT/COLD-4HP', 'AC-HOT/COLD-2.25HP', 'WASHER DRYER', 'COOKING APPLIANCES', 'AC COMPLEMENTARY', 'HOOD', 'WD', 'COFFEE GRINDER', 'Power', 'TV-40', 'MOSQ.KILL', 'Mobile Audio', 'CAPPUCCINO MAKER', 'TV-43', 'Gift', 'OVEN', 'AC-COLD-1.5HP', 'MOBILE COMPLEMENTARY', 'DEEP FREEZER', 'Network-Switch', 'TV COMPLEMENTARY', 'Wearables', 'BMOBILE ACCESSORIES', 'R.COOKER', 'AC-HOT/COLD-1.5HP', 'TV-55-SMRT', 'KITCHEN M', 'ELE HEATER', 'TV-70-SMRT', 'FRIDGE', 'TV-50-SMRT-HI', 'BLENDER', 'TV-55-SMRT-HI', 'WARMER', 'CURL IRONS', 'AC-HOT/COLD-7HP', 'AIR COOLER', 'TV-85-SMRT', 'Gaming', 'Smart Scale', 'Mobile Holder', 'FILTER 7 STAGES', 'TV-65-SMRT', 'AC-HOT/COLD-6HP', 'FILTER 5 STAGES', 'IOT', 'MIXER', 'TV Supplies', 'AC-COLD-7HP', 'GRILL', '0', 'CLINER M', 'KETTLE', 'Storage', 'Mobile photography', 'AC-COLD-2.25HP', 'IRON', 'SCALE', 'Protection', 'COMPLEMENTARY', 'TOASTER', 'WASHING M', 'F.PROC', 'WL Telephone', 'TV-32-SMRT', 'JUICER', 'MDA COMPLEMENTARY', 'TV-75-SMRT', 'COOKER', 'Network-Adapter', 'HAIR DRYER', 'MICROWAVE', 'Cross Bag', 'WALL HOOD', 'Computer peripherals', 'DRYER', 'SDA COMPLEMENTARY', 'AC-HOT/COLD-3HP', 'E.HOT PLATE', 'COFFEE M', 'Bundle', 'AIR FRYER', 'D WASHER', 'TV-65-SMRT-HI', 'LAPTOP', 'VC', 'MOBILE', 'TV-50', 'Mobile Cables', 'TABLET', 'NON', 'Bar Code Scanner', 'Mobile cables', 'SPORT MACHINE', 'AC-COLD-3HP', 'CHOPPER', 'TV-40-SMRT', 'Smart tag', 'ESPRESSO MACH', 'Smart Home', 'TV-85-SMRT-HI', 'ALEXA ECHO DOT', 'TV-43-SMRT', 'Network-Modem', 'TV-50-SMRT', 'TV-32', 'TANK', 'H.BLENDER', 'FUN LINE', 'MINCER', 'TV Cables', 'Service', 'Network', 'FILTER 6 STAGES', 'AIR STYLER', 'FAN', 'FRAYER', 'Security', 'FILTER 3 STAGES', 'STRAIGHTNERS', 'THERMAL VESSEL', 'HOBS', 'TV-60-SMRT', 'MASHER', 'TV-75-SMRT-HI', 'GAS HEATER', 'AC-HOT/COLD-5HP', 'M.MINCER', 'BUNDLE- B-IN', 'SHAVING_TRI'], 'sub_category_supplier': ['AC-HOT/COLD-3HP-UNION AIRE', 'AC-HOT/COLD-3HP-LG', 'VC-SOLAC', 'MIXER-BLACK AND WHITE', 'AC-HOT/COLD-2.25HP-PREMIUM', 'TV-43-SMRT-SONY', 'ELE HEATER-OLYMPIC', 'COFFEE M-OKKA', 'M.MINCER-MOULINEX', 'WD-FRESH', 'OVEN-BEKO', 'GRILL-MEDIA TECH', 'OVEN-TOUCH', 'KITCHEN M-BLACK AND WHITE', 'TOASTER-ARIETE', 'AC-COLD-1.5HP-CARRIERE', 'FRAYER-BLACK AND DECAR', 'FRIDGE-BEKO', 'TV-FRAME-SAMSUNG', 'MASHER-BLACK AND WHITE', 'HOOD-ELBA', 'AC-HOT/COLD-2.25HP-SHARP', 'JUICER-MIENTA', 'TV-32-SMRT-SHARP', 'FRAYER-MODEX', 'D WASHER-BEKO', 'HAIR DRYER-BABYLISS', 'TV-32-FRESH', 'E.HOT PLATE-TOUCH', 'CURL IRONS-RUSH BRUSH', 'TOOLS-SNDWAY', 'CHOPPER-TORNADO', 'F.PROC-HOME TECH', 'TV-50-SMRT-UNION AIRE', '0', 'BLENDER-ULTRA', 'COFFEE M-SMART', 'AC-COLD-3HP-PREMIUM', 'TV-ACCESSORY-SYINIX', 'AIR PURIFIER-DAIKIN', 'TOASTER-BLACK AND DECAR', 'AC-COLD-1.5HP-SHARP', 'WASHING M-HOOVER', 'KETTLE-PANASONIC', 'H.BLENDER-BOSCH', 'AUDIO-AVANTREE', 'HOOD-INDESIT', 'AC-HOT/COLD-3HP-BEKO', 'FAN-TEFAL', 'H.MIXER-PANASONIC', 'TOASTER-TORNADO', 'TV-32-PLUTO', 'FILTER ASS-PHILIPS', 'AIR COOLER-HOME TECH', 'OVEN-FAGOR', 'TV-ACCESSORY-ETI', 'TV-65-SMRT-HI-LG', 'IRON-BLACK AND DECAR', 'OVEN-KLASS', 'MICROWAVE-ZANUSSI', 'BLENDER-KENWOOD', 'WARMER-TORNADO', 'FUN LINE-TORNADO', 'FRIDGE-LG', 'IRON-ULTRA', 'HAIR DRYER-ARZUM', 'OVEN-ZANUSSI', 'CHOPPER-TOUCH', 'KITCHEN M-ARIETE', 'FAN-PANASONIC', 'TV-ACCESSORY-ILOOK', 'HOBS-NARDI', 'AC-COLD-3HP-ULTRA', 'TV-55-SMRT-PREMIUM', 'IRON-MEDIA TECH', 'TV-43-SMRT-UNION AIRE', 'SPORT MACHINE-KHATER', 'IRON-PHILIPS', 'TV-55-SMRT-HI-LG', 'HOBS-GORENJE', 'TV-32-SMRT-TORNADO', 'BLENDER-BLACK AND DECAR', 'ELE HEATER-ATLANTIC', 'AC-HOT/COLD-3HP-SHARP', 'WASHING M-SHARP', 'FUN LINE-MEDIA TECH', 'MOBILE-HOPE', 'FRAYER-MIENTA', 'CLINER M-KARCHER', 'ELE HEATER-BOMAN', 'GAS HEATER-WHITE WHALE', 'KETTLE-ZADA', 'KITCHEN M-SARY', 'TV-43-SMRT-FRESH', 'WALL HOOD-FRESH', 'KITCHEN M-MODEX', 'VC-ROVO', 'AC-HOT/COLD-1.5HP-TORNADO', 'HOBS-FRESH', 'DEEP FREEZER-ALASKA', 'BLENDER-MEDIA TECH', 'H.MIXER-TORNADO', 'D WASHER-INDESIT', 'COMPLEMENTARY-CANON', 'GAS HEATER-LONGLIFE', 'TV-55-SMRT-TCL', 'TV-ACCESSORY-FLAT', 'FRIDGE-FRESH', 'VC-TORNADO', 'DEEP FREEZER-FRESH', 'FAN-FRESH', 'VC-MIENTA', 'GAS HEATER-FRESH', 'HOBS-KLASS', 'AUDIO-SONY', 'TV-50-SMRT-TORNADO', 'WD-SPEED', 'STRAIGHTNERS-RUSH BRUSH', 'BMOBILE ACCESSORIES-LDNIO', 'BMOBILE ACCESSORIES-SONY', 'R.COOKER-MEDIA TECH', 'GAS HEATER-PREMIUM', 'MIXER-BLACK AND DECAR', 'TV-32-SMRT-SAMSUNG', 'BLENDER-BOSCH', 'WARMER-MIENTA', 'OVEN-HOME TECH', 'MINCER-WHITE WHALE', 'AC-COLD-1.5HP-MIDEA', 'OVEN-ARISTON', 'GRILL-MODEX', 'LAPTOP-MSI', 'KITCHEN M-G.TEC', 'GIFT-LG', 'GAS HEATER-PANASONIC', 'TV-55-SMRT-ULTRA', 'TV-65-SMRT-TOSHIBA', 'R.COOKER-HOME TECH', 'LAPTOP-APPLE', 'VC-BISSELL', 'MICROWAVE-SHARP', 'FUN LINE-ZAHRAN', 'R.COOKER-BLACK AND DECAR', 'HOOD-ZANUSSI', 'STRAIGHTNERS-MIENTA', 'MICROWAVE-TORNADO', 'HOOD-BeKO', 'AC-COLD-2.25HP-CARRIERE', 'H.BLENDER-MIENTA', 'COMPLEMENTARY-LENOVO', 'F.PROC-TORNADO', 'TV-75-SMRT-UNION AIRE', 'SHAVING_TRI-HAPILLINE', 'VC-TEFAL', 'KETTLE-SONAI', 'MIXER-ULTRA', 'AC ACCESSORY-ZANUSSI', 'GRILL-KENWOOD', 'M.MINCER-TOUCH', 'RECEIVER-TRUMAN', 'FAN-BLACK AND WHITE', 'AC-COLD-1.5HP-FRESH', 'GAS HEATER-WHITE POINT', 'TABLET-REALME', 'ELE HEATER-TORNADO', 'FRIDGE-TOSHIBA', 'GAS HEATER-KIRIAZI', 'TV-40-SMRT-UNION AIRE', 'MICROWAVE-HOME TECH', 'JUICER-TORNADO', 'IRON-KENWOOD', 'TOASTER-KENWOOD', 'TV-55-SMRT-TOSHIBA', 'F.PROC-G.TEC', 'AIR FRYER-KENWOOD', 'BMOBILE ACCESSORIES-MUSIC HERO', 'H.MIXER-BOSCH', 'HOOD-FRANKE', 'SHAVING_TRI-BABYLISS', 'FUN LINE-BLACK AND DECAR', 'FILTER 3 STAGES-SEASONS', 'TV-50-SMRT-SONY', 'MOBILE-XIAOMI', 'COFFEE M-TEFAL', 'MOBILE-APPLE', 'COOKER-UNIVERSAL', 'OVEN-BOSCH', 'BLENDER-SONAI', 'COMPLEMENTARY-SAMSUNG', 'COFFEE M-SOLAC', 'IRON-MODEX', 'H.MIXER-BRAUN', 'TV-43-TORNADO', 'AC-HOT/COLD-2.25HP-ULTRA', 'TV-75-SMRT-LG', 'TV-40-SMRT-SAMSUNG', 'DEEP FREEZER-UNION AIRE', 'H.BLENDER-MOULINEX', 'IRON-HOME TECH', 'TV-50-SMRT-SHARP', 'TV-43-NIKAI', 'WASHING M-LG', 'AC-HOT/COLD-5HP-LG', 'HOBS-TORNADO', 'H.BLENDER-BRAUN', 'MOBILE-OPPO', 'COMPLEMENTARY-XIAOMI', 'HOOD-HOOVER', 'M.MINCER-BLACK AND WHITE', 'DEEP FREEZER-PANASONIC', 'KETTLE-TORNADO', 'COOKER-ROYAL', 'FRAYER-FRESH', 'WD-TORNADO', 'WASHING M-FAGOR', 'BMOBILE ACCESSORIES-EZVIZ', 'HOOD-GORENJE', 'TV-50-SMRT-SAMSUNG', 'H.BLENDER-TOUCH', 'BMOBILE ACCESSORIES', 'AC-COLD-2.25HP-FRESH', 'COFFEE M-PHILIPS', 'TV-32-SAMSUNG', 'TOASTER-BRAUN', 'MIXER-MODEX', 'KITCHEN M-MOULINEX', 'TV-65-SMRT-HI-SAMSUNG', 'AC-HOT/COLD-1.5HP-HAIER', 'FUN LINE-MIENTA', 'SHAVING_TRI-REMINGTON', 'FILTER 5 STAGES-SEASONS', 'GRILL-SOLAC', 'CHOPPER-BOSCH', 'WALL HOOD-TOSHIBA', 'AUDIO-TOSHIBA', 'WASHING M-TOSHIBA', 'F.PROC-BLACK AND DECAR', 'TANK-SEASONS', 'GRILL-BOSCH', 'OVEN-MIENTA', 'TV-86-SMRT-UNION AIRE', 'GRILL-TORNADO', 'H.BLENDER-HOME TECH', 'D WASHER-FRESH', 'FRAYER-TEFAL', 'TV-43-SMRT-HAIER', 'DEEP FREEZER-INDESIT', 'TV-75-SMRT-HI-SAMSUNG', 'CHOPPER-ULTRA', 'HOOD-TORNADO', 'WARMER-SHTEBEL', 'FRIDGE-TORNADO', 'H.MIXER-SMART', 'STRAIGHTNERS-PHILIPS', 'BLENDER-TOUCH', 'H.MIXER-MEDIA TECH', 'TV-40-SMRT-VIEW', 'TV-ACCESSORY-FRESH', 'TV-43-UNION AIRE', 'WARMER-AKWRJ', 'BLENDER-BRAUN', 'WASHING M-KIRIAZI', 'KETTLE-MODEX', 'DEEP FREEZER-BEKO', 'WASHING M-MIELE', 'AC-COLD-3HP-UNION AIRE', 'TV-32-SMRT-HAIER', 'COOKER-BEKO', 'COMPLEMENTARY-EPSON', 'STRAIGHTNERS-BABYLISS', 'WASHING M-PREMIUM', 'AC-HOT/COLD-2.25HP-FRESH', 'TV-70-SMRT-LG', 'AIR COOLER-TORNADO', 'TV-32-SMRT-LG', 'WD-WHITE WHALE', 'BMOBILE ACCESSORIES-STRONG', 'AC-HOT/COLD-5HP-FRESH', 'HOOD-MIELE', 'OVEN-INDESIT', 'BLENDER-TORNADO', 'WASHER DRY ASS-MIELE', 'WARMER-ULTRA', 'STRAIGHTNERS-REMINGTON', 'HOBS-ELBA', 'TV-32-ATA', 'RECEIVER-ETI', 'AC-COLD-3HP-TORNADO', 'AC-HOT/COLD-1.5HP-FRESH', 'THERMAL VESSEL-TEFAL', 'TV-85-SMRT-HI-SAMSUNG', 'AC-HOT/COLD-1.5HP-SHARP', 'WASHING M-SAMSUNG', 'TV-43-TOSHIBA', 'WASHER DRYER-LG', 'KETTLE-KENWOOD', 'TV-32-SMRT-TOSHIBA', 'IRON-TORNADO', 'COFFEE M-BIALETTI', 'D WASHER-ZANUSSI', 'WASHING M-Toshiba', 'FRIDGE-SHARP', 'AC-COLD-1.5HP-CRAFT', 'HAIR DRYER-RUSH BRUSH', 'MICROWAVE-SAMSUNG', 'TV-50-SMRT-HI-LG', 'KITCHEN M-BOSCH', 'OVEN-BRANDT', 'HOOD-PREMIER', 'SHAVING_TRI-BRAUN', 'TV-ACCESSORY-KEENDEX', 'BMOBILE ACCESSORIES-ORIGINAL', 'MASHER-MIENTA', 'BLENDER-ARIETE', 'MINCER-BOSCH', 'AC-HOT/COLD-3HP-TORNADO', 'E.HOT PLATE-MIENTA', 'KETTLE-SOLAC', 'KETTLE-BLACK AND WHITE', 'FRIDGE-ZANUSSI', 'COFFEE M-MEDIA TECH', 'FILTER 7 STAGES-SEASONS', 'GAS HEATER-FERROLI', 'COOKER-FRESH', 'WASHING M-HAIER', 'FRIDGE-PASSAP', 'COOKER-KIRIAZI', 'FAN-ARION', 'LAM-PHILIPS', 'TV-32-SONY', 'HOBS-ICOOK', 'RECIEVER-TIGER', 'TV-75-SMRT-SAMSUNG', 'CHOPPER-SONAI', 'VC-BOSCH', 'FRAYER-MIELE', 'IRON-ARIETE', 'GAS HEATER-OLYMPIC', 'AC-HOT/COLD-2.25HP-UNION AIRE', 'AC-HOT/COLD-3HP-FRESH', 'GAS HEATER-UNIVERSAL', 'VC-BLACK AND DECAR', 'AC ACCESSORY-UNION AIRE', 'ESPRESSO MACH-ARIETE', 'TV-43-SMRT-PREMIUM', 'AC-COLD-2.25HP-UNION AIRE', 'FRAYER-HOME TECH', 'TV-55-SMRT-PLUTO', 'BLENDER-PANASONIC', 'GRILL-FRESH', 'CAPPUCCINO MAKER-ARIETE', 'AC-HOT/COLD-1.5HP-CARRIERE', 'FUN LINE-SOLAC', 'D WASHER-BOSCH', 'AC ACCESSORY-HAIER', 'THERMAL VESSEL-SEASONS', 'ELE HEATER-FLYON', 'IRON-TOUCH', 'MOBILE-INFINX', 'COOKER-PREMIUM', 'E.HOT PLATE-HOME TECH', 'M.MINCER-TORNADO', 'KITCHEN M-TOUCH', 'TV-50-SMRT-HAIER', 'OVEN-MIELE', 'JUICER-HOME TECH', 'AC-HOT/COLD-1.5HP-AMERICOOL', 'WASHING M-INDESIT', 'TV-55-SMRT-LG', 'IRON-BLACK AND WHITE', 'LAPTOP-HUAWEI', 'HOOD-FAGOR', 'VC-MIELE', 'AC-COLD-1.5HP-UNION AIRE', 'TV-ACCESSORY-MEDIA TECH', 'OVEN-FRESH', 'FRIDGE-ULTRA', 'TV-55-SMRT-SAMSUNG', 'COFFEE M-DELONGHI', 'TV-50-SMRT-PLUTO', 'HOBS-BOSCH', 'D WASHER-BeKO', 'D WASHER-ARISTON', 'AC-HOT/COLD-1.5HP-HISENSE', 'DEEP FREEZER-SHARP', 'MOBILE-REALME', 'AC-COLD-2.25HP-MIDEA', 'HOBS-GLEMGAS', 'TV-43-SMRT-PLUTO', 'AC-HOT/COLD-3HP-CARRIERE', 'AC ACCESSORY-FRESH', 'AC-HOT/COLD-6HP-CARRIERE', 'FRIDGE-SAMSUNG', 'F.PROC-UNION AIRE', 'OVEN-GORENJE', 'FRIDGE-BOSCH', 'AC-HOT/COLD-2.25HP-MIDEA', 'HOBS-FRANKE', 'IRON-MIENTA', 'TV-32-SMRT-PREMIUM', 'TV-32-TORNADO', 'DEEP FREEZER-TOSHIBA Midea', 'AC ACCESSORY-CARRIERE', 'VC-KENWOOD', 'CHOPPER-BLACK AND DECAR', 'VC-HITACHI', 'MOBILE-NOKIA', 'HOBS-BEKO', 'TV-75-SMRT-HI-LG', 'WARMER-DELONGHI', 'GAS HEATER-ARION', 'H.MIXER-KENWOOD', 'FILTER 6 STAGES-SEASONS', 'M.MINCER-PANASONIC', 'DEEP FREEZER-WHITE POINT', 'GAS HEATER-ARISTON', 'E.HOT PLATE-SMART', 'BLENDER-MIENTA', 'GAS HEATER-TORNADO', 'AC-COLD-2.25HP-PREMIUM', 'FRIDGE-IDEAL', 'M.MINCER-MODEX', 'TOOLS-MPT HT', 'AC-HOT/COLD-2.25HP-CARRIERE', 'COFFEE M-WHITE WHALE', 'FAN-TORNADO', 'TV-43-SMRT-ULTRA', 'AC ACCESSORY-DAIKIN', 'KITCHEN M-SMART', 'TV-65-SMRT-LG', 'MINCER-HOME TECH', 'KETTLE-ARIETE', 'HAIR DRYER-REMINGTON', 'THERMAL VESSEL-TANK', 'WALL HOOD-OLYMPIC', 'KETTLE-ARION', 'VC-PANASONIC', 'THERMAL VESSEL-TIGER', 'BMOBILE ACCESSORIES-LOGITECH', 'H.BLENDER-SENCOR', 'MOBILE-HONOR', 'MIXER-UNION AIRE', 'TV-65-SMRT-TORNADO', 'H.MIXER-MIENTA', 'COFFEE M-TORNADO', 'AC-HOT/COLD-5HP-CARRIERE', 'HAIR DRYER-SOLAC', 'GRILL-BLACK AND DECAR', 'COMPLEMENTARY-HAVIT', 'TV-65-SMRT-UNION AIRE', 'KETTLE-BLACK AND DECAR', 'WD-BERGEN', 'AC-COLD-1.5HP-PREMIUM', 'HOOD-FRESH', 'TABLET-LENOVO', 'RECEIVER-MUTECH', 'TV-43-SMRT-TOSHIBA', 'DEEP FREEZER-ARISTON', 'OVEN-HOOVER', 'F.PROC-GROUHY', 'ELE HEATER-ARISTON', 'SHAVING_TRI-PHILIPS', 'AUDIO-LG', 'FAN-SONAI', 'AC-HOT/COLD-1.5HP-LG', 'BLENDER-MOULINEX', 'AC-HOT/COLD-2.25HP-LG', 'H.MIXER-FRESH', 'AC-HOT/COLD-1.5HP-ULTRA', 'FRAYER-ARISTON', 'KETTLE-MEDIA TECH', 'M.MINCER-KENWOOD', 'HOOD-ICOOK', 'H.BLENDER-BLACK AND DECAR', 'COFFEE M-MIENTA', 'OVEN-ELBA', 'FAN-NIKAI', 'KETTLE-BOSCH', 'AC-HOT/COLD-1.5HP-UNION AIRE', 'JUICER-SOLAC', 'MDA-ZANUSSI', 'KETTLE-SMART', 'TV-50-SMRT-LG', 'AC-COLD-1.5HP-TORNADO', 'AIR PURIFIER-LG', 'AC-HOT/COLD-3HP-PREMIUM', 'CHOPPER-FRESH', 'AIR PURIFIER-SHARP', 'TV-ACCESSORY-TRUMAN', 'H.BLENDER-SEM', 'OVEN-ULTRA', 'HOBS-SMART', 'AUDIO-FIRST', 'IRON-PANASONIC', 'CHOPPER-ARIETE', 'FUN LINE-ARIETE', 'MICROWAVE-LG', 'RECEIVER-DALY', 'TOOLS-MPT PT', 'FRIDGE-ARISTON', 'AIR STYLER-BABYLISS', 'GIFT-FRESH', 'H.BLENDER-KENWOOD', 'CHOPPER-KENWOOD', 'FRIDGE-HAIER', 'F.PROC-KENWOOD', 'HAIR DRYER-TORNADO', 'AC-COLD-2.25HP-GENERAL ELECTRIC', 'KETTLE-HOUSECOM', 'FRIDGE-KIRIAZI', 'COOKER-UNION AIRE', 'AC-HOT/COLD-5HP-SHARP', 'LAPTOP-DELL', 'KITCHEN M-KENWOOD', 'ELE HEATER-UNIVERSAL', 'TV-ACCESSORY-HAMA', 'AC-HOT/COLD-2.25HP-BEKO', 'TV-32-LG', 'WD-WHITE POINT', 'TV-43-SMRT-LG', 'F.PROC-MODEX', 'COOKING APPLIANCES-ARIETE', 'F.PROC-SMART', 'AC-HOT/COLD-3HP-ULTRA', 'H.MIXER-SONAI', 'TV-55-SMRT-SHARP', 'SPORT MACHINE-FUTURE', 'DEEP FREEZER-PASSAP', 'GRILL-MIENTA', 'BMOBILE ACCESSORIES-STEEL', 'MICROWAVE-HOOVER', 'F.PROC-ULTRA', 'MOBILE-VIVO', 'COFFEE M-BRAUN', 'KETTLE-HOME TECH', 'TV-70-SMRT-SAMSUNG', 'HOBS-BAUMATIC', 'GIFT-NESTLE', 'TV-ACCESSORY-HISENSE', 'COMPLEMENTARY-BENQ', 'TV-50-SMRT-ULTRA', 'TV-32-SMRT-FRESH', 'TOOLS-CLABER', 'FRIDGE-ELECTROSTAR', 'AUDIO-SAMSUNG', 'H.MIXER-ROVO', 'E.HOT PLATE-FRESH', 'DEEP FREEZER-LG', 'H.BLENDER-SMART', 'FRAYER-BERGEN', 'MIXER-TOUCH', 'DEEP FREEZER-ELECTROSTAR', 'F.PROC-MIENTA', 'LAPTOP-VAIO', 'RECEIVER-SKYWORTH ZAPPER', 'DEEP FREEZER-TOSHIBA', 'COOKER-BOSCH', 'VC-BLACK AND WHITE', 'TV-32-UNION AIRE', 'CHOPPER-ROVO', 'WASHING M-WHITE POINT', 'TOOLS-HITACHI', 'AC ACCESSORY-LG', 'AC-HOT/COLD-1.5HP-MIDEA', 'TV-32-SMRT-CAIXUN', 'COFFEE M-SONAI', 'KITCHEN M-MIENTA', 'F.PROC-PANASONIC', 'CHOPPER-MIENTA', 'AUDIO-DOB', 'VC-DAEWOO', 'JUICER-MOULINEX', 'RECEIVER-GALAXI', 'GIFT-SAMSUNG', 'FAN-KENWOOD', 'BLENDER-MODEX', 'TABLET-TCL', 'VC-HOOVER', 'F.PROC-MOULINEX', 'ELE HEATER-UNION AIRE', 'FAN-SMART', 'M.MINCER-BRAUN', 'TOOLS-BOSCH', 'VC-LG', 'F.PROC-SONAI', 'AC-HOT/COLD-3HP-GENERAL ELECTRIC', 'FAN-UNION AIRE', 'COOKER-ZANUSSI', 'WARMER-HELLER', 'TV-43-HAIER', 'VC-MODEX', 'WALL HOOD-TORNADO', 'HAIR DRYER-PHILIPS', 'AC-HOT/COLD-4HP-CARRIERE', 'FAN-BLACK AND DECAR', 'COMPLEMENTARY-SONY', 'ELE HEATER-VEITO', 'FRAYER-PHILIPS', 'TV-32-TCL', 'CHOPPER-SMART', 'JUICER-KENWOOD', 'HOOD-BOSCH', 'D WASHER-WHITE POINT', 'AIR FRYER-SOLAC', 'OVEN-FRANKE', 'F.PROC-ARIETE', 'IRON-TEFAL', 'BLENDER-SMART', 'HOBS-ARISTON', 'MOBILE-HUAWEI', 'AC ACCESSORY-CRAFT', 'GAS HEATER-ZANUSSI', 'WASHING M-CANDY', 'AC-HOT/COLD-4HP-SHARP', 'TABLET-SAMSUNG', 'TV-75-SMRT-TOSHIBA', 'H.BLENDER-TORNADO', 'WASHING M-ARISTON', 'AC-HOT/COLD-4HP-FRESH', 'COFFEE M-NESPRESSO', 'AC-COLD-2.25HP-LG', 'AUDIO-ORAIMO', 'HOBS-BRANDT', 'BMOBILE ACCESSORIES-NI', 'GRILL-ZADA', 'H.MIXER-BLACK AND WHITE', 'WD-PASSAP', 'FUN LINE-HOME TECH', 'TV-43-CAIXUN', 'COMPLEMENTARY-HP', 'WD-KOLDAIR', 'D WASHER-MIELE', 'MINCER-BLACK AND DECAR', 'TOASTER-MIENTA', 'WASHING M-UNION AIRE', 'TV-32-HAIER', 'AC-COLD-3HP-MIDEA', 'H.MIXER-MODEX', 'CHOPPER-MEDIA TECH', 'AC-COLD-1.5HP-LG', 'SHAVING_TRI-TORNADO', 'AIR FRYER-TORNADO', 'AC-HOT/COLD-4HP-LG', 'DEEP FREEZER-KIRIAZI', 'AC-HOT/COLD-2.25HP-TORNADO', 'TV-ACCESSORY-LG', 'TV-43-SMRT-SHARP', 'MOBILE-SAMSUNG', 'HOBS-FAGOR', 'FILTER ASS-SEASONS', 'FAN-TOUCH', 'TV-ACCESSORY-ORIGINAL', 'TV-55-SMRT-HI-SAMSUNG', 'DEEP FREEZER-WHITE WHALE', 'ELE HEATER-WHITE WHALE', 'GAS HEATER-BOSCH', 'HOBS-ZANUSSI', 'TV-85-SMRT-SAMSUNG', 'FRIDGE-UNION AIRE', 'AC-HOT/COLD-7HP-CARRIERE', 'IRON-SOLAC', 'H.BLENDER-G.TEC', 'TV-85-SMRT-HI-LG', 'H.BLENDER-MEDIA TECH', 'TV-32-PREMIUM', 'TV-43-CONTEX', 'FUN LINE-SONAI', 'KETTLE-BRAUN', 'TV-75-SMRT-HI-SHARP', 'AUDIO-PHILIPS', 'VC-SAMSUNG', 'HOOD ASS-INDESIT', 'GRILL-TOUCH', 'H.BLENDER-BLACK AND WHITE', 'BMOBILE ACCESSORIES-HP', 'ELE HEATER-KIRIAZI', 'TV-65-SMRT-SAMSUNG', 'GIFT-ARISTON', 'AC-HOT/COLD-2.25HP-GENERAL ELECTRIC', 'AC-COLD-1.5HP-ULTRA', 'AC-COLD-2.25HP-CRAFT', 'DRYER-HOME TECH', 'MIXER-MEDIA TECH', 'DRYER-ARISTON', 'MOBILE-LAVA', 'KITCHEN M-HOME TECH', 'WARMER-MEDIA TECH', 'TV-50-SMRT-PREMIUM', 'AC-COLD-3HP-CRAFT', 'TV-50-ULTRA', 'VC-TOSHIBA', 'KETTLE-FRESH', 'AC-HOT/COLD-3HP-MIDEA', 'GRILL-HOME TECH', 'KETTLE-ZAHRAN', 'TV-55-SMRT-SONY', 'DEEP FREEZER-MIELE', 'BMOBILE ACCESSORIES-LAVVENTO', 'WARMER-BLACK AND DECAR', 'GRILL-TEFAL', 'COFFEE M-HOME TECH', 'GIFT-UNIVERSAL', 'ALEXA ECHO DOT-ALEXA', 'TV-ACCESSORY-ELIOS', 'WASHING M-BEKO', 'F.PROC-BRAUN', 'AC-COLD-2.25HP-SHARP', 'MASHER-KENWOOD', 'BUNDLE- B-IN-INDESIT', 'TV-55-SMRT-TORNADO', 'WARMER-TOUCH', 'FAN-MIENTA', 'HOBS-ECOMATIC', 'AC-COLD-3HP-CARRIERE', 'FRIDGE-WHITE POINT', 'WD-ULTRA', 'GIFT-INDESIT', 'LAPTOP-HP', 'BLENDER-G.TEC', 'IRON-SMART', 'JUICER-BRAUN', 'FAN-UNIVERSAL', 'HOBS-HOOVER', 'KETTLE-MIENTA', 'GIFT-BOSCH', 'JUICER-SONAI', 'AC ACCESSORY-SHARP', 'M.MINCER-SONAI', 'TV-40-CONTEX', 'STRAIGHTNERS-TORNADO', 'TV-43-SMRT-TORNADO', 'TV-32-SMRT-SONY', 'AC-COLD-1.5HP-AMERICOOL', 'COMPLEMENTARY-NIKON', 'AUDIO-MEDIA TECH', 'GIFT-INFINX', 'F.PROC-BLACK AND WHITE', 'TABLET-HUAWEI', 'OVEN-NARDI', 'WASHING M-BOSCH', 'COFFEE M-BOSCH', 'LAPTOP-ASUS', 'WASHING M-FRESH', 'TV-32-SARY', 'TV-65-SMRT-SHARP', 'OVEN-TORNADO', 'TV-32-SMRT-NIKAI', 'BLENDER-SARY', 'TV-ACCESSORY-NOUR TECH', 'VC-FRESH', 'AC-HOT/COLD-1.5HP-BEKO', 'FRAYER-DELONGHI', 'TV-50-SMRT-TOSHIBA', 'FRIDGE-MIELE', 'AC-COLD-2.25HP-ULTRA', 'BMOBILE ACCESSORIES-TOSHIBA', 'GAS HEATER-PASSAP', 'MICROWAVE-SMART', 'WARMER-VEITO', 'JUICER-BOSCH', 'MDA ASS-INDESIT', 'HOBS-MIELE', 'AC-COLD-2.25HP-TORNADO', 'MICROWAVE-BLACK AND DECAR', 'ELE HEATER-FRESH', 'BLENDER-SENCOR', 'HOBS-INDESIT', 'AC ACCESSORY-PREMIUM', 'VC-SMART', 'COOKER-WHITE POINT', 'M.MINCER-BOSCH', 'COOKER-LA GERMANYA', 'AC-COLD-3HP-FRESH', 'COFFEE M-ZADA', 'BLENDER-FRESH', 'WARMER-FRESH', 'AC-COLD-1.5HP-HAIER', 'TABLET-APPLE', 'R.COOKER-MODEX', 'WASHING M-ZANUSSI', 'COFFEE M-BEKO', 'ELE HEATER-CLAGE', 'AUDIO-F&D', 'VC-ARIETE', 'TV-50-SMRT-TCL', 'TV-32-UG', 'LAPTOP-MICROSOFT', 'MICROWAVE-KENWOOD', 'KETTLE-SENCOR', 'COFFEE GRINDER-ARIETE', 'TV-ACCESSORY-FALCON', 'BMOBILE ACCESSORIES-DAHUA', 'COOKER-WHITE WHALE', 'MICROWAVE-FRESH', 'GAS HEATER-UNION AIRE', 'TV-32-TOSHIBA', 'F.PROC-BOSCH', 'D WASHER-LG', 'FRIDGE-INDESIT', 'OVEN-SIMFER', 'LAPTOP-LENOVO', 'TV-32-ULTRA', 'COMPLEMENTARY-DELL', 'F.PROC-BENEX', 'AC-HOT/COLD-2.25HP-HISENSE', 'SHAVING_TRI-RUSH BRUSH', 'AIR COOLER-SONAI', 'AIR STYLER-RUSH BRUSH', 'OVEN-SHARP', 'MICROWAVE-ARISTON', 'TOASTER-HOME TECH', 'HOOD-BEKO', 'TV-43-SMRT-SAMSUNG', 'DEEP FREEZER-TORNADO', 'H.MIXER-TOUCH', 'NON', 'TV-65-SMRT-TCL', 'MICROWAVE-DAEWOO', 'TV-86-SMRT-LG', 'THERMAL VESSEL-WACACO', 'BMOBILE ACCESSORIES-OSN', 'COFFEE M-KENWOOD', 'TOASTER-PANASONIC', 'COFFEE M-MODEX', 'HOOD-ARISTON', 'COMPLEMENTARY-INTEL', 'FRIDGE-WHITE WHALE', 'GAS HEATER-ATLANTIC', 'AIR COOLER-FRESH', 'AC-COLD-7HP-CARRIERE', 'VC-GROUHY', 'COFFEE M-BLACK AND DECAR', 'AC-HOT/COLD-1.5HP-ZANUSSI', 'H.BLENDER-SARY', 'ELE HEATER-TOSHIBA', 'JUICER-MEDIA TECH', 'TV-ACCESSORY-FORA', 'CURL IRONS-BABYLISS', 'VC ACCESSORIES-MIELE', 'BLENDER-HOME TECH', 'ELE HEATER-SHTEBEL', 'TV-ACCESSORY-ITEL', 'HOOD-SONAI', 'LAM-BLACK AND DECAR', 'SCALE-SOLAC', 'ELE HEATER-ZANUSSI', 'AC-COLD-3HP-LG', 'HOOD-PANASONIC', 'KITCHEN M-FRESH', 'H.MIXER-MOULINEX', 'TV-ACCESSORY-HP', 'R.COOKER-TEFAL', 'MOSQ.KILL-HOME TECH', 'AC-HOT/COLD-1.5HP-PREMIUM', 'FAN-ULTRA', 'TV-60-SMRT-TORNADO', 'JUICER-MODEX', 'M.MINCER-SMART', 'CHOPPER-MOULINEX', 'TV-43-ULTRA', 'WASHING M-TORNADO', 'BLENDER-BLACK AND WHITE', 'KETTLE-TOUCH', 'VC-ULTRA', 'IRON-BRAUN', 'TV-43-LG', 'STRAIGHTNERS-BRAUN', 'HOOD-TOUCH', 'TV-ACCESSORY-ICONZ', 'TV-ACCESSORY-SCHNEIDER']} the_received_subfilter
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
1137.526316717 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('3836.9355140311537657')), ('initial_average_retail_price', Decimal('13227.025756560711')), ('proposed_sellthru_percent', Decimal('48.3995201363350973')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('32.5305315125422310')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.53053151254223), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 12498285930.458853), ('budget_cost', 5499748837.427255), ('deficit', Decimal('12498285930.9492')), ('Original_BudgetAmount', Decimal('12498285930.9492')), ('budget_percent', Decimal('96.4426')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 2364023.0), ('ACT_FCT', Decimal('1538774940.3700')), ('Original_BudgetCostofGoods', Decimal('5499748837.4260')), ('PO', Decimal('40554597306.4584')), ('COSTPRICE', 4711842377.561937), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('1538774940.3700')), ('stock_on_hand_qty', Decimal('3277493')), ('net_sales_ly', Decimal('8170139178.1600')), ('net_sales_lly', Decimal('1002854189.1300')), ('gross_sales_ly', Decimal('8473068450.4120')), ('total_sku_count', Decimal('516936')), ('ly_customer_disc', Decimal('302929272.2520')), ('SupplyCost', Decimal('5224761395.5563')), ('SALESQTY', 2292287.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('88.5503')), ('budget_qty_act_fct_percent', Decimal('214238425.0800')), ('budget_vs_py_qty_percent', Decimal('131805424.7361')), ('budget_vs_ppy_qty_percent', Decimal('224196485.1039')), ('QTY_Buy_By_SKU', Decimal('2364023.0000')), ('total_sku_count_ty', Decimal('117030702652')), ('total_sku_count_lly', Decimal('36628')), ('total_sku_count_ly', Decimal('257701')), ('quantity_mix_percent', Decimal('101.8771')), ('quantity_act_forecast', Decimal('2621461.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('1648822.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('145548100.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.1049')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('5499748837.4260')), ('budget_vs_py_cost_percent', Decimal('312459904440.7000')), ('budget_vs_ppy_cost_percent', Decimal('34724953840.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('1024414021.9600')), ('cost_of_goods_ly', Decimal('3388279952.0820')), ('cost_act_forecast', Decimal('6524162859.3860')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('712872044534.1956')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('519999761.1300')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('1.9657')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('24177.5838')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('24177.5838')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
1137.725871802 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 3836.9355 ┆ 13227.025 ┆ … ┆ 0.0       ┆ 24177.583 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆ 14        ┆ 757       ┆   ┆           ┆ 8         ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 58.528492         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 3.0293e8   ┆ 8.1701e9   ┆ 1.2498e10  ┆ 58.196176 ┆ 1.2962e10 ┆ 48.39952  ┆ 2.6781e10 ┆ 3.575202  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76971F57FD90>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76971F57E4D0>, <Expr ['col("SalesActualsByForecast").…'] at 0x76971F57FAC0>, <Expr ['col("initial_average_retail_pr…'] at 0x76971F57FC10>, <Expr ['col("proposed_sellthru_percent…'] at 0x76971F57FD00>, <Expr ['col("retail_value_including_ma…'] at 0x76971F57F7F0>, <Expr ['col("budget_gross_margin_perce…'] at 0x76971F57F910>, <Expr ['col("Logistic%").mean()'] at 0x76971F57FF10>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76971F57E4A0>, <Expr ['col("MarkdownValue").mean()'] at 0x76971F57F700>, <Expr ['col("markdown_percent").mean()'] at 0x76971F57E470>, <Expr ['col("DisplayItemValue").mean()'] at 0x76971F57FDC0>, <Expr ['col("budget_amount").sum()'] at 0x76971F57F7C0>, <Expr ['col("budget_cost").sum()'] at 0x76971F57D8A0>, <Expr ['col("deficit").sum()'] at 0x76971F57E500>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76971F57F790>, <Expr ['col("budget_percent").sum()'] at 0x76971F57FC70>, <Expr ['col("relative_budget_percent")…'] at 0x76971F57E7D0>, <Expr ['col("History_Net_Sales").sum()'] at 0x76971F57E710>, <Expr ['col("budget_qty").sum()'] at 0x76971F57E830>, <Expr ['col("ACT_FCT").sum()'] at 0x76971F57F8E0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76971F57E740>, <Expr ['col("PO").sum()'] at 0x76971F57E770>, <Expr ['col("COSTPRICE").sum()'] at 0x76971F57E6E0>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76971F57E620>, <Expr ['col("sales_actual").sum()'] at 0x76971F57E920>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76971F57EB00>, <Expr ['col("net_sales_ly").sum()'] at 0x76971F57E9B0>, <Expr ['col("net_sales_lly").sum()'] at 0x76971F57EA40>, <Expr ['col("gross_sales_ly").sum()'] at 0x76971F57E8F0>, <Expr ['col("total_sku_count").sum()'] at 0x76971F57EAA0>, <Expr ['col("ly_customer_disc").sum()'] at 0x76971F57EE90>, <Expr ['col("SupplyCost").sum()'] at 0x76971F57EDA0>, <Expr ['col("SALESQTY").sum()'] at 0x76971F57E980>, <Expr ['col("DisplayItemQty").sum()'] at 0x76971F57EAD0>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76971F57EEF0>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76971F57EE60>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76971F57E650>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76971F57ED70>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76971F57E560>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76971F57F0A0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76971F57F1F0>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76971F57EEC0>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76971F57EBF0>, <Expr ['col("quantity_mix_percent").su…'] at 0x76971F57F100>, <Expr ['col("quantity_act_forecast").s…'] at 0x76971F57F070>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76971F57F2E0>, <Expr ['col("sold_qty_ly").sum()'] at 0x76971F57EFB0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76971F57F3D0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76971F57EC20>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76971F57F280>, <Expr ['col("budget_cost_percent").sum…'] at 0x76971F57FEE0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76971F57F4C0>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76971F57F5E0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76971F57F430>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76971F57F460>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76971F57F1C0>, <Expr ['col("cost_mix_percent").sum()'] at 0x76971F57F670>, <Expr ['col("cost_actuals").sum()'] at 0x76971F57FF70>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76971F57F550>, <Expr ['col("cost_act_forecast").sum()'] at 0x76971F57F2B0>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76971F57E3B0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76971F57E380>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76971F57E2C0>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76971F57F520>, <Expr ['col("budget_margin_percent").s…'] at 0x76971F57F6A0>, <Expr ['col("budget_margin_mix_percent…'] at 0x76971F57E320>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76971F57E170>, <Expr ['col("margin_actuals").sum()'] at 0x76971F57FAF0>, <Expr ['col("margin_act_forecast").sum…'] at 0x76971F57E050>, <Expr ['col("units_per_sku_total").sum…'] at 0x76971F57E2F0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76971F57E440>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76971F57ECB0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76971F57DFC0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76971F57E290>, <Expr ['col("initial_average_retail_pr…'] at 0x76971F57DF60>, <Expr ['col("initial_average_retail_pr…'] at 0x76971F57DF00>, <Expr ['col("budget_per_sku").sum()'] at 0x76971F57E410>, <Expr ['col("budget_qty_ty").sum()'] at 0x76971F57DD80>, <Expr ['col("Check_box").max()'] at 0x76971F57DFF0>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,3836.9355140312,13227.0257565607,48.3995201363,12961692560.2298755646,55.9959752239,5.0,55.9959752239,30292927225.1999931335,3.5752015226,0.0,12498285930.4588527679,5499748837.4272546768,12498285930.9491996765,12498285930.9491996765,100.0,100.0,0.0,2364023.0,1538774940.3699998856,5499748837.4259996414,40554597306.4583969116,4711842377.5619373322,0.0,1538774940.3699998856,3277493.0,8170139178.1599998474,1002854189.1299999952,8473068450.4119997025,516936.0,302929272.2519999743,5224761395.5563001633,2292287.0,0.0,0.0,88.5503,214238425.0800000131,131805424.7361000031,224196485.1038999856,2364023.0,117030702652.0,36628.0,257701.0,101.8771,2621461.0,0.0,1648822.0,145548100.0,0.0,0.0,0.1049,0.0,0.0,5499748837.4259996414,312459904440.700012207,34724953840.0,0.0,1024414021.9600000381,3388279952.0819997787,6524162859.3859996796,0.0,0.0,0.0,0.0,712872044534.1955566406,0.0,0.0,519999761.1299999952,0.0,1.9657,0.0,24177.5838,0.0,0.0,0.0,0.0,24177.5838,0.0,0.0,152.9751899927,1246.2714984819,18.8341337499,5971.1640248583,100.0,4201089.1677678283,58.1961764627,43351484327.9474334717,58.5284916426,4781859226.0780000687,0.0,0.0,6998537093.0315980911,119574875.3575933427,43351484327.9474334717,17978514446.122543335,43351484327.9474334717,12961692560.2298755646,12498285930.4588546753,26780622046.9097366333,11195323982.6815929413,4812220.3703926792]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":3836.9355140312,"initial_average_retail_price":13227.0257565607,"proposed_sellthru_percent":48.3995201363,"retail_value_including_markdown":12961692560.2298755646,"budget_gross_margin_percent":55.9959752239,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":55.9959752239,"MarkdownValue":30292927225.1999931335,"markdown_percent":3.5752015226,"DisplayItemValue":0.0,"budget_amount":12498285930.4588527679,"budget_cost":5499748837.4272546768,"deficit":12498285930.9491996765,"Original_BudgetAmount":12498285930.9491996765,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":2364023.0,"ACT_FCT":1538774940.3699998856,"Original_BudgetCostofGoods":5499748837.4259996414,"PO":40554597306.4583969116,"COSTPRICE":4711842377.5619373322,"Historical_Gross_Margin":0.0,"sales_actual":1538774940.0,"stock_on_hand_qty":3277493.0,"net_sales_ly":8170139178.1599998474,"net_sales_lly":1002854189.1299999952,"gross_sales_ly":8473068450.4119997025,"total_sku_count":516936.0,"ly_customer_disc":302929272.2519999743,"SupplyCost":5224761395.5563001633,"SALESQTY":2292287.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":88.5503,"budget_qty_act_fct_percent":214238425.0800000131,"budget_vs_py_qty_percent":131805424.7361000031,"budget_vs_ppy_qty_percent":224196485.1038999856,"QTY_Buy_By_SKU":2364023.0,"total_sku_count_ty":117030702652.0,"total_sku_count_lly":36628.0,"total_sku_count_ly":257701.0,"quantity_mix_percent":101.8771,"quantity_act_forecast":2621461.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":1648822.0,"quantity_act_forecast_vs_ly_percent":145548100.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.1049,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":5499748837.4259996414,"budget_vs_py_cost_percent":312459904440.700012207,"budget_vs_ppy_cost_percent":34724953840.0,"cost_mix_percent":0.0,"cost_actuals":1024414021.9600000381,"cost_of_goods_ly":3388279952.0819997787,"cost_act_forecast":6524162859.3859996796,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":712872044534.1955566406,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":519999761.1299999952,"margin_act_forecast":0.0,"units_per_sku_total":1.9657,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":24177.5838,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":24177.5838,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":58.5284916426,"FirstMargin_percent":58.1961764627,"budget_vpy":152.9751899927,"budget_vppy":1246.2714984819,"StockatRetailPrice":43351484327.9474334717,"TYForecast":43351484327.9474334717,"LYvsACT_FCT_percent":100.0,"supply_retail_value":12498285930.4588546753} }INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection closed
INFO:     ('106.51.119.229', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection open
 data_json
WebSocket connection closed unexpectedly
{'history_date_range': {'fro': '2023-01-01', 'to': '2023-12-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-12-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': True, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-01-01', to='2023-12-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-12-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
1138.841611426 start_to_execute main the stored procedure
conn established
sp executed
1138.918797937 end of main the stored procedure
conn established
sku wise calc executed
1138.96955076 end of sku wise stored proc
we called the sku wise stored procedure_init
We are getting data from ra_and_stock
1138.96967014 started to fetch data
conn established
<function getData.<locals>.<lambda> at 0x76a59b3c2ef0> dfafghaf
1315.091287466 end of fetch data
(535152, 168) output data shape
111111111111111111111111111111111111111111111
processing...
we are calling main groupby process
1
WebSocket connection closed unexpectedly
1
conn established
sku wise calc executed
1319.158421569 end of sku wise stored proc
conn established
[OrderedDict([('id', 251492), ('store', None), ('region', None), ('area', None), ('Channel', 'B.TECH X'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 251493), ('store', None), ('region', None), ('area', None), ('Channel', 'MINI'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 251494), ('store', None), ('region', None), ('area', None), ('Channel', 'WAREHOUSE'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 251495), ('store', None), ('region', None), ('area', None), ('Channel', 'ARKAN'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 251496), ('store', None), ('region', None), ('area', None), ('Channel', 'Retail'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)])] 3304 getData dictsize
1319.266605887 end of fetch data
shape: (3_304, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 251492 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 251493 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 251494 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 251495 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 251496 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 254791 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 254792 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 254793 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 254794 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 254795 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the filter dataframe
shape: (3_304, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 251492 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 251493 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 251494 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 251495 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 251496 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 254791 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-C ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ARRIERE       ┆              │
│ 254792 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ CHOPPER-MOULI ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ NEX           ┆              │
│ 254793 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ GRILL-MODEX   ┆ 0            │
│ 254794 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WARMER-BLACK  ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ AND DECAR     ┆              │
│ 254795 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ VC-SMART      ┆ 0            │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the_fiter_data
id Int64
store String
region String
area Int32
Channel String
budget_year Int32
budget_quarter String
budget_month String
budget_weekday Int64
budget_day String
budget_dates Int32
historical_year Int64
history_Quarter String
history_month String
history_week String
history_Day String
history_datess Int32
family String
sub_Family String
Supplier String
Category String
Dom_Comm String
Sub_Category String
Extended_sub_category String
Sub_Category_supplier String
Article_Score Int32
last_v store store
last_v region region
last_v Channel Channel
last_v Quarter budget_quarter
last_v month budget_month
last_v week budget_weekday
last_v Day budget_day
last_v history_Quarter history_Quarter
last_v history_month history_month
last_v history_Day history_Day
last_v family family
last_v sub_family sub_Family
last_v supplier Supplier
last_v category Category
last_v dom_comm Dom_Comm
last_v sub_category Sub_Category
last_v extended_sub_category Extended_sub_category
last_v sub_category_supplier Sub_Category_supplier
{'store': ['Sohag Branch', 'Alex_ Tusun', 'BTECHX Mansoura', 'BTECHX Moharam Bek', 'Winget Branch', 'El Sadat Branch', 'Loran Branch', 'EL Matria', '26Th July Branch', 'BTECHX Gehan2 Dewaka', 'Asafra Branch', 'Ismalia Branch-City Council Square', '10th Show Room WH', 'B.ONLINE', 'El Zaher', 'Almaza Branch', 'B2B Gov', 'Mahalla Branch', 'BTECH2Fayoum', 'BTECHX GardeniaTagamo', 'BTECHX Maadi Grand Mall', 'BTECHX The Yard Mall', 'Misr elgdida', 'BTECHXMataria', '3Tanta Mall', 'Hadek El Kobba Branch', 'Dakernis Branch', 'Nagaa Hamadi Branch', 'Qena Branch', 'BTECHX Kafr ElSheikh', 'Suez Branch', 'Assuit Mega Branch', 'BTECHX Obour2', 'Damanhour Branch', 'Shoubra Branch', '10th of Ramadan WH', 'BTECHX ElRehab Mall1', 'ElBahr ElAzam', 'Ain Shams Branch - Mostafa Hafez St.', 'New Damanhour', 'Makram Ebaid Branch', 'El Tagamou 1 Branch', 'BTECHX City Stars Mall', 'QENA-Warehouse', 'BTECHX ElRehab North', 'BTECH mini Egyptian Shooting ', 'BTECH Mini MPC', 'Gesr El Suez Branch', 'Abbas El-Akkad Branch', 'Dumietta Branch', 'Quesna Branch', 'BTECHX Sidi Bishr', 'El Menia Mega Branch', 'BTECH Mini Air Force House', 'El Fayoum Branch', 'Agami Branch', 'Ain Shams Branch - Ibrahim Abdel Razek St.', 'Jumia Seller Store', 'EL Amiria Branch', 'BTECHX Sporting Club', 'Banha warehouse', 'Miela Arkan WH', 'BTECHX CityCenter Alex', 'Shubra El Kheima Branch', 'Salah Salim Branch', 'October-WH', 'BTECHX Hegaz', 'Port Said', 'BTECHX San_Stefano Mall', 'Oraby Branch', 'El Helmya', 'Desouk Branch', 'Sky Mall El Sherouk Branch', 'Zagazig Branch', 'Sale With Cost W.H', 'Mega Alex Sidi Gaber', 'Shebin El Koum Branch', 'Marassi-North-Coast Branch', 'Alamein Masa Mall', 'BTECHX Kasr El Einy', 'Zayton Branch', 'New Dumietta Branch', 'BTECHX Sohag', 'Asyut WH', 'Cairo Retail Warehouses', 'BTECHXCFC', 'Marina Branch', 'BTECHX 2Mansoura', 'El Kanater Branch', 'Miela Arkan Mall', 'BTECHX Gihan3 Abasia', 'BTECHX Zagazig', 'Uni Mall El Obour', 'BTECHX Mahala', 'BTECHX Triumph Tagamo', 'Mega Helwan', 'Banha Branch', 'Noon Seller Store1', 'BTECHX Airport', 'El Betash Branch', 'BTECHX Midor', 'BTECHX 45', 'B.TECHX El Mandara', 'El Tahrir', 'BTECHX El Menia', 'Assiut Branch - Ibn Sina Tower', 'Mall Of Arabia Branch', '10th Tech Club WH', 'El Mokattam Branch', 'Corporate Sales', 'Mansoura Branch', 'Qalyub', 'Alex WH', 'BTECHX ElShams Club', 'GateWay Mall El Rehab', '9025Show Room Alex', 'Aswan Mega  Branch', 'BTECHX Shebin El koum', 'Haram Branch', 'BTECHX ASU', 'El Tagamou 2 Branch', 'Makadi Bay', 'Dar El Salam Branch', 'Maadi Branch-El Laselky St.', 'Deel Asyut WH', 'El Sayeda Zainab', 'BTECHX Sheraton', 'BTECHX Saad El Din El Shazly', 'El Seyouf Branch', 'B.TECH X AUC', 'El Nozha Branch', 'BTECHX Dokki', 'Tanta Branch', 'Elagamy2', 'BTECHX Truck Alex', 'Luxor Branch', 'Mall Of October Branch', 'BTECHX Open Air Mall', 'BTECHX Assuit', 'BTECHX Ramses Station', 'New sohag', 'Berket Elsabaa Branch', 'Marina Kaian Branch', 'Malawi Branch', 'BTECHX Manial', '0', 'Ismaila Branch-Railway station', 'BTECHX Safwa Zaid ', 'Beni Suef Branch', 'Hassan El Maamon', 'HQ Call Center', 'Flag Mall Branch', 'Mega Fisal', 'Faisal Branch', 'CFC Mall', 'BTECHX Ismailia Square', 'BTECHX El Sherouk', 'Roxy Branch', 'El-Gouna Branch', 'BTECHX El Mosher Axis', 'BTECHX CityCenterMaadi', 'Delta Tanta Mega Store', 'Zahra El Asher Branch', 'BTECHX Shinzo Abe', 'Eldahar Mega Branch', 'Show Room - Corp. Sale-38', 'Mall Of Egypt Branch', 'Masara', 'Town Center El Salam', 'Tanta WH', 'New Roxy', 'Ras Ghareb Branch', 'Smouha Branch', 'El-Elsoudan Street Branch', '1Imbaba', 'Amwaj ranch', 'El Galaa', 'BTECHX Roxcy', 'B.TECH STAFF', 'Aswan WH', 'Fakous Branch'], 'region': ['CAIRO', 'DELTA', 'ALEXANDRIA', '0', 'HURGHADA', 'UPPER EGYPT'], 'season': [], 'area': [], 'Channel': ['NON', 'Retail', 'ARKAN', 'B2B', 'ONLINE', 'DEEL', '0', 'B.TECH X', 'WAREHOUSE', 'CALL CENTER', 'MINI'], 'budget_year': [0.0], 'Quarter': ['0', '4', '3'], 'month': ['September', 'August   ', 'July     ', '0', 'November ', 'October  ', 'December '], 'week': [0, 1, 2, 3, 4, 5, 6, 7], 'date': ['19978', '20057', '20080', '20047', '20037', '19908', '19956', '19945', '20081', '19954', '19911', '20083', '19936', '19927', '20008', '19958', '20079', '20050', '20056', '19991', '19925', '20011', '19973', '20076', '19915', '20036', '20032', '20038', '19920', '20049', '19934', '20003', '19967', '19914', '20016', '19923', '0', '20055', '19963', '19980', '19961', '19929', '19924', '20039', '19976', '19965', '20087', '20045', '19975', '19931', '19940', '20040', '19974', '19972', '20028', '20053', '20027', '19966', '20001', '20005', '20072', '19993', '20035', '19952', '20062', '20075', '19983', '19932', '20058', '19988', '20044', '20022', '19971', '19994', '19964', '19957', '20042', '19969', '20031', '19909', '19996', '20002', '20033', '19922', '19985', '19947', '19912', '19921', '19941', '19968', '20063', '19928', '20046', '20012', '19982', '19990', '19926', '19939', '19950', '19960', '20070', '20025', '20029', '19962', '20060', '20064', '19930', '19999', '20010', '19949', '19970', '20078', '19986', '19918', '19997', '20015', '20041', '20023', '19944', '20017', '19906', '20085', '20007', '19942', '19935', '20086', '20024', '20043', '20054', '20009', '19981', '19955', '20073', '20065', '19905', '20069', '20048', '19948', '20074', '20006', '20000', '19959', '20071', '19933', '20061', '19943', '19917', '20026', '19998', '20052', '20059', '19984', '20014', '19937', '19913', '20020', '19979', '20021', '20067', '19916', '20018', '19938', '19977', '20082', '20013', '20084', '19987', '19953', '20051', '19995', '19992', '19910', '19946', '19919', '20066', '19989', '20019', '20077', '20030', '20004', '19907', '20068', '20034', '19951', '20088'], 'Day': ['Sunday   ', '0', 'Wednesday', 'Tuesday  ', 'Friday   ', 'Monday   ', 'Thursday ', 'Saturday '], 'historical_year': [], 'history_Quarter': ['4', '1', '3', '2', '0'], 'history_month': ['August   ', '0', 'June     ', 'November ', 'March    ', 'July     ', 'April    ', 'February ', 'October  ', 'January  ', 'September', 'December ', 'May      '], 'history_week': ['0', '1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '3', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '4', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '5', '50', '51', '52', '6', '7', '8', '9'], 'history_Day': ['Friday   ', 'Thursday ', 'Tuesday  ', 'Monday   ', 'Sunday   ', 'Wednesday', 'Saturday ', '0'], 'history_dates': [0, 18997, 19003, 19005, 19010, 19011, 19015, 19016, 19017, 19022, 19023, 19038, 19040, 19044, 19050, 19052, 19053, 19057, 19059, 19066, 19068, 19072, 19073, 19074, 19078, 19079, 19080, 19085, 19086, 19087, 19088, 19089, 19095, 19101, 19102, 19106, 19108, 19109, 19110, 19120, 19121, 19122, 19123, 19124, 19127, 19128, 19129, 19130, 19131, 19134, 19135, 19136, 19137, 19138, 19141, 19143, 19145, 19148, 19152, 19155, 19156, 19158, 19159, 19162, 19163, 19164, 19165, 19166, 19170, 19171, 19172, 19176, 19178, 19179, 19180, 19186, 19190, 19192, 19193, 19200, 19201, 19204, 19206, 19208, 19211, 19212, 19213, 19214, 19215, 19218, 19220, 19221, 19222, 19226, 19227, 19228, 19229, 19232, 19233, 19235, 19236, 19239, 19240, 19241, 19242, 19243, 19245, 19246, 19247, 19248, 19249, 19250, 19252, 19253, 19254, 19255, 19256, 19257, 19259, 19260, 19261, 19262, 19263, 19264, 19266, 19267, 19268, 19269, 19270, 19271, 19273, 19274, 19275, 19276, 19277, 19278, 19279, 19280, 19281, 19282, 19283, 19284, 19285, 19286, 19287, 19288, 19289, 19290, 19291, 19292, 19293, 19294, 19295, 19296, 19297, 19298, 19299, 19300, 19301, 19302, 19303, 19304, 19305, 19306, 19307, 19308, 19309, 19310, 19311, 19312, 19313, 19314, 19315, 19316, 19317, 19318, 19319, 19320, 19321, 19322, 19323, 19324, 19325, 19326, 19327, 19328, 19329, 19330, 19331, 19332, 19333, 19334, 19335, 19336, 19337, 19338, 19339, 19340, 19341, 19342, 19343, 19344, 19345, 19346, 19347, 19348, 19349, 19350, 19351, 19352, 19353, 19354, 19355, 19356, 19357, 19358, 19359, 19360, 19361, 19362, 19363, 19364, 19365, 19366, 19367, 19368, 19369, 19370, 19371, 19372, 19373, 19374, 19375, 19376, 19377, 19378, 19379, 19380, 19381, 19382, 19383, 19384, 19385, 19386, 19387, 19388, 19389, 19390, 19391, 19392, 19393, 19394, 19395, 19396, 19397, 19398, 19399, 19400, 19401, 19402, 19403, 19404, 19405, 19406, 19407, 19408, 19409, 19410, 19411, 19412, 19413, 19414, 19415, 19416, 19417, 19418, 19419, 19420, 19421, 19422, 19423, 19424, 19425, 19426, 19427, 19428, 19429, 19430, 19431, 19432, 19433, 19434, 19435, 19436, 19437, 19438, 19439, 19440, 19441, 19442, 19443, 19444, 19445, 19446, 19447, 19448, 19449, 19450, 19451, 19452, 19453, 19454, 19455, 19456, 19457, 19458, 19459, 19460, 19461, 19462, 19463, 19464, 19465, 19466, 19467, 19468, 19469, 19470, 19471, 19472, 19473, 19474, 19475, 19476, 19477, 19478, 19479, 19480, 19481, 19482, 19483, 19484, 19485, 19486, 19487, 19488, 19489, 19490, 19491, 19492, 19493, 19494, 19495, 19496, 19497, 19498, 19499, 19500, 19501, 19502, 19503, 19504, 19505, 19506, 19507, 19508, 19509, 19510, 19511, 19512, 19513, 19514, 19515, 19516, 19517, 19518, 19519, 19520, 19521, 19522, 19523, 19524, 19525, 19526, 19527, 19528, 19529, 19530, 19531, 19532, 19533, 19534, 19535, 19536, 19537, 19538, 19539, 19540, 19541, 19542, 19543, 19544, 19545, 19546, 19547, 19548, 19549, 19550, 19551, 19552, 19553, 19554, 19555, 19556, 19557, 19558, 19559, 19560, 19561, 19562, 19563, 19564, 19565, 19566, 19567, 19568, 19569, 19570, 19571, 19572, 19573, 19574, 19575, 19576, 19577, 19578, 19579, 19580, 19581, 19582, 19583, 19584, 19585, 19586, 19587, 19588, 19589, 19590, 19591, 19592, 19593, 19594, 19595, 19596, 19597, 19598, 19599, 19600, 19601, 19602, 19603, 19604, 19605, 19606, 19607, 19608, 19609, 19610, 19611, 19612, 19613, 19614, 19615, 19616, 19617, 19618, 19619, 19620, 19621, 19622, 19623, 19624, 19625, 19626, 19627, 19628, 19629, 19630, 19631, 19632, 19633, 19634, 19635, 19636, 19637, 19638, 19639, 19640, 19641, 19642, 19643, 19644, 19645, 19646, 19647, 19648, 19649, 19650, 19651, 19652, 19653, 19654, 19655, 19656, 19657, 19658, 19659, 19660, 19661, 19662, 19663, 19664, 19665, 19666, 19667, 19668, 19669, 19670, 19671, 19672, 19673, 19674, 19675, 19676, 19677, 19678, 19679, 19680, 19681, 19682, 19683, 19684, 19685, 19686, 19687, 19688, 19689, 19690, 19691, 19692, 19693, 19694, 19695, 19696, 19697, 19698, 19699, 19700, 19701, 19702, 19703, 19704, 19705, 19706, 19707, 19708, 19709, 19710, 19711, 19712, 19713, 19714, 19715, 19716, 19717, 19718, 19719, 19720, 19721, 19722, 19723, 19724, 19725, 19726, 19727, 19728, 19729, 19730, 19731, 19732, 19733, 19734, 19735, 19736, 19737, 19738, 19739, 19740, 19741, 19742, 19743, 19744, 19745, 19746, 19747, 19748, 19749, 19750, 19751, 19752, 19753, 19754, 19755, 19756, 19757, 19758, 19759, 19760, 19761, 19762, 19763, 19764, 19765, 19766, 19767, 19768, 19769, 19770, 19771, 19772, 19773, 19774, 19775, 19776, 19777, 19778, 19779, 19780, 19781, 19782, 19783, 19784, 19785, 19786, 19787, 19788, 19789, 19790, 19791, 19792, 19793, 19794, 19795, 19796, 19797, 19798, 19799, 19800, 19801, 19802, 19803, 19804, 19805, 19806, 19807, 19808, 19809, 19810, 19811, 19812, 19813, 19814, 19815, 19816, 19817, 19818, 19819, 19820, 19821, 19823, 19824, 19825, 19826, 19827, 19828, 19829, 19830, 19831, 19832, 19833, 19834, 19835, 19836, 19837, 19838, 19839, 19840, 19841, 19842, 19843, 19844, 19845, 19846, 19847, 19848, 19849, 19850, 19851, 19852, 19853, 19854, 19855, 19856, 19857, 19858, 19859, 19860, 19861, 19862, 19863, 19864, 19865, 19866, 19867, 19868, 19869, 19870, 19871, 19872, 19873, 19874], 'article_score': ['sale', 'abc', 'ae', 'speed', 'terminal', 'margin', 'sell', 'markdown', 'core', 'quartile', 'sortimeter'], 'history_year': [0.0, 2022.0, 2023.0, 2024.0], 'family': ['0', 'LAPTOP', 'AC', 'TV', 'COMPLEMENTARY', 'BMOBILE ACCESSORIES', 'TABLET', 'MOBILE', 'MDA', 'SDA', 'NON'], 'sub_family': ['NON', 'SDA DOM', '0', 'AC DOM', 'AC COM', 'TV COM', 'MDA COM', 'SDA COM', 'BMOBILE', 'TV DOM', 'MDA DOM'], 'supplier': ['HOUSECOM', 'MIELE', 'MODEX', 'EPSON', 'TOSHIBA Midea', 'FLYON', 'ARZUM', 'LA GERMANYA', 'SPEED', 'FAGOR', 'PLUTO', 'ALEXA', 'DAIKIN', 'F&D', 'GORENJE', 'VAIO', 'ELBA', 'KARCHER', 'BOSCH', 'HELLER', 'WHITE WHALE', 'BeKO', 'WHITE POINT', 'CAIXUN', 'ALASKA', 'ORIGINAL', 'FUTURE', 'OSN', 'ORAIMO', 'ECOMATIC', 'ARION', 'LOGITECH', 'CANON', 'SKYWORTH ZAPPER', 'KEENDEX', 'DAHUA', 'TANK', 'SNDWAY', 'AMAZONE', 'ATLANTIC', 'APPLE', 'IDEAL', 'ICOOK', 'ELIOS', 'RUSH BRUSH', 'LAVA', 'MUSIC HERO', '0', 'FORA', 'CLABER', 'BRANDT', 'S.LINK', 'GLEMGAS', 'ARISTON', 'ETI', 'UNIVERSAL', 'FRESH', 'LENOVO', 'KOLDAIR', 'KIOXIA', 'BRAUN', 'MICROSOFT', 'BMOBILE ACCESSORIES', 'ILOOK', 'ICONZ', 'SONAI', 'STRONG', 'BAUMATIC', 'HAVIT', 'SANDISK', 'SYINIX', 'G.TEC', 'NON', 'AVANTREE', 'BISSELL', 'MPT PT', 'GALAXI', 'HAPILLINE', 'NOKIA', 'OLYMPIC', 'EZVIZ', 'VIVO', 'HUAWEI', 'TOUCH', 'UG', 'ITEL', 'DAEWOO', 'MODEM', 'TOSHIBA', 'TORNADO', 'REALME', 'NI', 'MPT HT', 'PANASONIC', 'SHARP', 'MUTECH', 'ELECTROSTAR', 'LDNIO', 'VEITO', 'INTEL', 'SCHNEIDER', 'DELL', 'HONOR', 'SAMSUNG', 'WACACO', 'PASSAP', 'INDESIT', 'ROVO', 'STEEL', 'BENQ', 'SMART', 'BOMAN', 'FERROLI', 'FALCON', 'DOB', 'HITACHI', 'VIEW', 'XIAOMI', 'ARIETE', 'SIMFER', 'PREMIUM', 'SEM', 'BEKO', 'LAVVENTO', 'NARDI', 'FLAT', 'OKKA', 'BABYLISS', 'KLASS', 'FRANKE', 'SARY', 'NIKON', 'PHILIPS', 'NIKAI', 'CONTEX', 'PREMIER', 'AKWRJ', 'TIGER', 'SENCOR', 'KENWOOD', 'OZO', 'BLACK AND DECAR', 'KIRIAZI', 'MOULINEX', 'ULTRA', 'REMINGTON', 'HOME', 'KHATER', 'BIALETTI', 'UNION AIRE', 'OPPO', 'CRAFT', 'NESTLE', 'HP', 'ZANUSSI', 'BERGEN', 'TRUMAN', 'CHOETECH', 'HAMA', 'ATA', 'ZADA', 'SHTEBEL', 'XAIOMI', 'HISENSE', 'MSI', 'DALY', 'CARRIERE', 'HOME TECH', 'GENERAL ELECTRIC', 'INFINIX', 'NOUR TECH', 'MIENTA', 'ASUS', 'INFINX', 'BENEX', 'HOPE', 'CLAGE', 'GROUHY', 'FIRST', 'SEASONS', 'LG', 'ZAHRAN', 'MIDEA', 'CANDY', 'SONY', 'DELONGHI', 'HOOVER', 'MEDIA TECH', 'HAIER', 'TCL', 'NESPRESSO', 'TEFAL', 'BLACK AND WHITE', 'SOLAC', 'ROYAL', 'LONGLIFE', 'AMERICOOL'], 'category': ['Deep F Miele', 'Fun Line Zahran', 'TV Samsung', 'H.Mixer Braun', 'Kettle Solac', 'Mobile LAVA', 'H.Blend Kenwood', 'Fridge Tornado', 'Mic. Daewoo', 'Gas Heater Toshiba', 'Fan Fresh', 'TV Acc ilook', 'H.Mixer Rovo', 'Fridge Indesit', 'Mic. Tornado', 'Fridge White Point', 'Grill Media Tech', 'E.Hot Plate SMART', 'Mobile Hope', 'Hobs Indesit', 'Selfie Stick SBS', 'VC Fresh', 'Fridge Union Aire', 'Oven Klass', 'Gas Heater Ariston', 'tv acc truman', 'VC Tornado', 'Hood Zanussi', 'Kitchen M Touch', 'Mobile VIVO', 'F.Proc Modex', 'Hobs Fagor', 'AC Daikin', 'Washing M Bosch', 'Ele Heater TORNADO', 'Iron Ariete', 'Masher Black&white', 'Washing M Samsung', 'Air Cooler Sonai', 'Coffee M Media Tech', 'Fan Touch', 'Iron Ultra', 'Gas Heater White Poi', 'Deep F Fresh', 'Hobs Bosch', 'Blender Black&white', 'Toaster Home', 'Boxi', 'Frayer Modex', 'Hair Dryer Philips', 'TV Acc MUTECH', 'Iron Braun', 'AC Sharp', 'Grill Tefal', 'Thermal Mug WACACO', 'Ele Heater Olympic', 'F.Proc Black&decker', 'Juicer Home Tech', 'Ele Heater Fresh', 'VC Rovo', 'Iron Mienta', 'M.Mincer Moulinex', 'TV SARY', 'Mincer Home', 'Fridge Bosch', 'Gas Heater Kiriazi', 'Fridge Fresh', 'Tools MPT PT', 'Audio sony', 'Kettle Media Tech', 'H.Mixer Tornado', 'Chopper Bosch', 'Coffee M Braun', 'Laptop DELL', 'Oven Hoover', 'M.Mincer Panasonic', 'M.Mincer Touch', 'Deep F Indesit', 'Frayer Tefal', 'D Washer Miele', 'Protection SBS', 'Iron Black&white', 'Laptop Microsoft', 'Tablet Nokia', 'Audio F&D', 'Fridge Alaska', 'D Washer Ariston', 'Gas Heater White Wha', 'TV Toshiba', 'Warmer Akwrj', 'Gift Samsung', 'VC Black&white', 'Fan Tornado', 'Mobile Huawei', 'Warmer Tornado', 'Oven Tornado', 'Mic. Samsung', 'Washing M Zanussi', 'Kettle Arion', 'Deep F Beko', 'Kettle Home', 'TV LG', 'Coffee M SMART', 'Kettle Zada', 'Blender Smart', 'Kitchen M Mienta', 'Hood Indesit', 'Mincer Bosch', 'Hobs Brandt', 'kettle Media', 'H.Blend Black&decker', 'WD Bergen', 'Gas Heater Arion', 'F.Proc Benex', 'Mic. Home', 'tv acc keendex', 'Deep F Ariston', 'Ele Heater Toshiba', 'AC Carriere', 'H.Blender SEM', 'Cooker Beko', 'Wall Hood Tornado', 'Gas Heater Panasonic', 'Mixer Black&decker', 'Coffee M Beko', 'Fun Line Tornado', 'Chopper Media Tech', 'Air Purifier SHARP', 'Gas Heater Zanussi', 'Headset SBS', 'Air Cooler Home', 'Comp Monitor BenQ', 'Juicer Kenwood', 'Oven Bosch', 'B.Electronic ass', 'H.Blend Black&white', 'Fridge Beko', 'Hobs Elba', 'TV Acc Tiger', 'Kitchen M Fresh', 'Ele Heater Universal', 'Bottel Tank', 'R.cooker Black&decke', 'Laptop Huawei', 'Frayer Mienta', 'TV Nikai', 'Blender Modex', 'VC Grouhy', 'Mixer Ultra', 'VC Modex', 'Washing M Sharp', 'Washing M Union Aire', 'Oven Simfer', 'Straightners Mienta', 'Air Cooler Fresh', 'E.Hot Plate Fresh', 'H.Mixer Touch', 'TV Premium', 'Kitchen M G.tec', 'Coffee M okka', 'WARMER Ultra', 'D Washer Indesit', 'Audio oraimo', 'F.Proc Black&white', '0', 'H.Blend Moulinex', 'Tools sndway', 'Charger SBS', 'M.Mincer Sonai', 'Frayer Philips I2', 'Fun Line Solac', 'Stand Indesit', 'Kitchen M SMART', 'TV Union Aire', 'Deep F Panasonic', 'H.Blend Mienta', 'Thermal Mug Tefal', 'Receiver SkyWorth Za', 'Straightners Rush br', 'TV FRESH', 'Washing M CANDY', 'Hobs Nardi', 'Ele Heater Ariston', 'Wall Hood Toshiba', 'Deep F Electrostar', 'F.Proc ULTRA', 'Air Styler Babyliss', 'Washing M Tornado', 'F.Proc Home', 'Comp Printer Epson', 'Fan Panasonic', 'Warmer Media Tech', 'Holders SBS', 'AC Accessory Sharp', 'Oven Touch', 'Air Fryer Tornado', 'Kitchen M Ariete', 'Cooking Appliances A', 'Chopper Kenwood', 'Mobile INFINX', 'Hood ASS Indesit', 'Oven Home', 'Frayer Bergen', 'Audio Avantree', 'Mic. Black&decker', 'Complent Alexa IOT', 'Gas Heater premium', 'AC Midea', 'Kettle Modex', 'E.Hot Pla Home', 'Ele Heater Union Air', 'Grill Home', 'Hood Franke', 'tv acc schneider', 'Gas Heater Olympic', 'AC Haier', 'Blender Black&decker', 'tv acc elios', 'Fan Arion', 'Enquiry Fees', 'Bundle- b-in Indesit', 'WD Fresh', 'Hood Beko', 'Laptop VAIO', 'VC Bosch', 'Hobs Klass', 'Coffee M Zada', 'B2B AC', 'Fridge Ariston', 'H.Mixer Mienta', 'TV Acc Etrain', 'Mixer Media Tech', 'Blender Moulinex', 'AC TORNADO', 'Blender Ariete', 'Mic. LG', 'Kettle Black&decker', 'kettle Mienta', 'Gift LG', 'H.Blend G.tec', 'AC Hisense', 'Sport Machine Future', 'Deep F Union Aire?', 'H.Blend Home', 'H.Mixer SMART', 'Coffee M Home', 'Kitchen M Kenwood', 'Kitchen M Moulinex', 'Iron Media Tech', 'Cleaning SBS', 'Shaving_Tri Philips', 'Hobs Gorenje', 'Blender Fresh', 'D Washer Zanussi', 'Chopper Touch', 'Gaming ASS ASS', 'Coffee M White Whale', 'Tripod SBS', 'F.Proc Bosch', 'Deep F PASSAP', 'Cliner M Karcher', 'Gift Indesit', 'Grill Kenwood', 'VC Mienta', 'Ele Heater White Wha', 'Gas Heater Fresh', 'Oven Ariston', 'TV Hisense', 'Warmer Heller', 'Fan black&decker', 'TV Accessory', 'VC Toshiba', 'Kettle Tornado', 'Washing M Premium', 'Cooker Premium', 'Espresso Machine Ari', 'Deep F White Whale', 'AC Crafft', 'Toaster Black&decker', 'Mic. Fresh', 'Kitchen M Bosch', 'Air Purifier LG', 'Oven Zanussi', 'Cables SBS', 'Chopper Ariete', 'Scale Solac', 'Chopper Mienta', 'WD Ultra', 'Cooker White Whale', 'Fridge Ideal', 'VC Black&decker', 'F.Proc SMART', 'Iron Kenwood', 'H.Mixer Panasonic', 'TV View', 'Iron Smart', 'H.Blender Braun', 'WD White Whale', 'Blender Panasonic', 'WD White Point', 'TV Caixun', 'Blender Ultra', 'Hood Fresh', 'VC LG', 'Grill Zada', 'Gift Bosch', 'Ice Tank Tank', 'Coffee M Sonai', 'AC ULTRA', 'Cooker Zanussi', 'Filter ASS philips', 'TV Haier', 'Audio LG', 'Juicer Moulinex', 'Warmer Fresh', 'VC Miele', 'M.Mincer Modex', 'H.Mixer Black&white', 'Oven beko', 'Hair Dryer Tornado', 'AC Accessory LG', 'Grill Modex', 'F.Proc Kenwood', 'D Washer LG', 'Hood Tornado', 'Shaving_TriRemington', 'Mic. Sharp', 'Iron Panasonic', 'Mincer Black&decker', 'Ele Heater Kiriazi', 'Fan universal', 'Grill Solac', 'H.Blend Bosch', 'Gas Heater Ferroli', 'Chopper Fresh', 'Gas Heater Bosch', 'TV ASS ASS', 'Ele Heater VEITO', 'Fridge ULTRA', 'Wall Hood Olympic', 'Hood Hoover', 'Security Ass Camera', 'Fan Smart', 'Hobs Zanussi', 'Dryer LG', 'Coffee M Solac', 'TV Acc Fora', 'Lam Black&decker', 'AC Accessory Zanussi', 'Mixer Touch', 'Chopper Tornado', 'Compl Camera GoPRO', 'Straightners Remingt', 'VC Solac', 'Gift Fresh', 'F.Proc Union Aire', 'M.Mincer Tornado', 'Audio', 'Coffee Grinder Ariet', 'AC Accessory Carrier', 'AC General Electric', 'TV Ultra', 'Kettle Zahran', 'TV Acc ETI', 'R.cooker HOME', 'Hobs SMART', 'Hood Elba', 'Dryer Home', 'AC Acc Union Aire', 'VC Smart', 'Warmer Delonghi', 'TV Acc Toshiba', 'F.Proc Grouhy', 'Fun Line Mienta', 'Mobile NOKIA', 'Gas Heater Tornado', 'Masher Kenwood', 'Comp Google Mesh IOT', 'Fridge Electrostar', 'Cooker Fresh', 'Mobile XIAOMI', 'Coffee M Tornado', 'Oven Gorenje', 'VC Bissell', 'Lam Philips', 'Gas Heater Atlantic', 'Filter ASS Tank', 'Kettle Bosch', 'Receiver Galaxi', 'TV Sharp', 'Gas Heater Universal', 'TV Rowa', 'Fridge PASSAP', 'H.Mixer Kenwood', 'TV Acc hama', 'VC Tefal', 'Audio Dob', 'Blender Touch', 'Hood Ariston', 'Deep F Tornado', 'Deep F White Point', 'TV UG', 'Coffee M Modex', 'Fridge Sharp', 'TV Sony', 'Chopper SMART', 'Juicer Media Tech', 'Coffee M Nespresso', 'Air Fryer Kenwood', 'VC Daewoo', 'Blender Kenwood', 'Kettle Touch', 'Mic. Hoover', 'Blender Mienta', 'Coffee M Tefal', 'Toaster Braun', 'F.Proc Braun', 'WD PASSAP', 'Warmer Touch', 'Deep F Kiriazi', 'Toaster Panasonic', 'Fan Ultra', 'Kettle Braun', 'Chopper Ultra', 'Washing M Haier', 'Hobs Ariston', 'WD Tank', 'Kettle Ariete', 'Masher Mienta', 'H.Mixer Bosch', 'Kettle SMART', 'Thermal Mug Tiger', 'TV Contex', 'R.cooker Modex', 'Hair Dryer Solac', 'Chopper Rovo', 'Laptop Lenovo', 'Coffee M Black&decke', 'H.Blender Smart', 'Washing M Ariston', 'Deep F LG', 'TV Acc Itel', 'Fan Tefal', 'AC Fresh', 'Mic. Ariston', 'TV ATA', 'Comp Monitor Samsung', 'Security Ass Camera ', 'Hair Dryer arzum', 'Mic. Kenwood', 'Fridge Samsung', 'TV Acc NI', 'Fun Line Media Tech', 'Warmer Mienta', 'Hood Sonai', 'Fridge Kiriazi', 'Toaster tornado', 'Speaker SBS', 'Washer Dryer Ariston', 'M.Mincer Bosch', 'AC Beko', 'Washing M Indesit', 'AC Premium', 'Transferfeesonline01', 'Fridge Toshiba', 'H.Mixer Modex', 'Oven Miele', 'Hobs ECOMATIC', 'TV Acc FLAT', 'Comp Monitor Lenovo', 'Kitchen M Home', 'Mic. SMART', 'Frayer Miele', 'Iron Philips I2', 'Washing M Miele', 'Straightners Babylis', 'Laptop ASUS', 'Air Cooler Tornado', 'Fridge Zanussi', 'Juicer Braun', 'Kettle Panasonic', 'F.Proc Panasonic', 'Fridge White Whale', 'H.Blend SENCOR', 'Mixer Black&white', 'Audio Samsung', 'Mic. Zanussi', 'Warmer Black&decker', 'Coffee M Delonghi', 'Fridge Miele', 'Receiver truman', 'Complem Gaming Sony', 'Hobs GLEMGAS', 'Hobs Fresh', 'Mobile HONOR', 'Compl Printer CANON', 'Shaving_Tri Braun', 'VC Hoover', 'Iron Solac', 'Washing M Beko', 'Thermoses Tiger', 'Curl Irons Babyliss', 'Juicer Home', 'H.Mixer Sonai', 'Iron Modex', 'Oven Ultra', 'Cooker Universal', 'Hobs Miele', 'Fun Line Sonai', 'H.Blend Touch', 'TV Acc osn', 'TV Pluto', 'Coffee M Philips I2', 'F.Proc Sonai', 'Juicer Modex', 'Kettle Housecom', 'Curl Irons Rush brus', 'F.Proc Moulinex', 'Iron Tornado', 'Hobs Franke', 'mosq.kill Home', 'Chopper Sonai', 'Iron Tefal', 'Kettle SENCOR', 'Fridge LG', 'Straightners Solac', 'kitchen m sary', 'Chopper Moulinex', 'Mixer Modex', 'Iron Black&Decker', 'Coffee M Bialetti', 'Blender Tornado', 'Oven Fresh', 'Warmer Shtebel', 'Ice Box Tank', 'TV Tornado', 'Ele heater flyon', 'Kitchen M Black&whit', 'H.Mixer Midea', 'Comp Monitor Xiaomi', 'Blender Home', 'Hair Dryer Rush brus', 'VC Kenwood', 'Frayer Delonghi', 'AC Americool', 'Frayer Home', 'Com Projector Merlin', 'TV Acc Media Tech', 'Blender Bosch', 'Frayer Fresh', 'Hobs Baumatic', 'Compl DESK PC Intel', 'Mixer Kenwood', 'Grill Bosch', 'Audio First', 'Frayer Ariston', 'Mobile Samsung', 'Gift Universal', 'Coffee M Mienta', 'Gift Nestle', 'Tools MPT HT', 'D Washer Fresh', 'VC Samsung', 'Washing M Hoover', 'B.ElectronicServices', 'Laptop MSI', 'Juicer Mienta', 'Washing M Fagor', 'Ele Heater Clage', 'Wall Hood Fresh', 'Grill Touch', 'Ele Heater Shtebel', 'Audio Toshiba', 'Mincer White Whale', 'Oven Mienta', 'TV Syinix', 'Hobs Tornado', 'Gift Ariston', 'IT ASS ASS', 'Washing M White Poin', 'R.cooker Tefal', 'Fan Mienta', 'Washing M Kiriazi', 'Deep F Alaska', 'Tools Hitachi', 'Blender Braun', 'Chopper Black&decker', 'Filter Tank', 'Tools Bosch', 'Kettle Fresh', 'Gas Heater LongLife', 'M.Mincer Braun', 'Fan Black&white', 'TV Acc Falcon', 'Straightners Philips', 'Fan Sonai', 'Grill Black&decker', 'F.Proc G.tec', 'Blender sencor', 'Kitchen M Modex', 'Mobile APPLE', 'Hood Touch', 'VC Hitachi', 'Juicer Sonai', 'M.Mincer Black&White', 'IFixBtech', 'E.Hot Touch', 'H.Blend sary', 'Fan Nikai', 'VC Ariete', 'Deep F Toshiba', 'R.cooker Media Tech', 'Grill Mienta', 'Iron Touch', 'Oven Elba', 'D Washer Bosch', 'TV Tcl', 'Mixer Union Aire', 'Laptop APPLE', 'Toaster Kenwood', 'Juicer Tornado', 'Toaster Ariete', 'VC Ultra', 'Oven Nardi', 'Oven Sharp', 'Hobs Beko', 'Receiver Daly', 'Laptop HP', 'Ele Heater Atlantic', 'Tablet APPLE', 'TV Acc STRONG', 'AC Accessory Premium', 'Receiver ETI', 'Washing M LG', 'Cooker Kiriazi', 'Coffee M Bosch', 'Fan Union Aire?', 'Airpods kit SBS', 'AC Union Aire?', 'VC Panasonic', 'Ele Heater Zanussi', 'Fun Line Black&decke', 'Hobs ICook', 'H.Blend Media Tech', 'Cappuccino Maker Ari', 'Sport Machine Khater', 'Mobile OPPO', 'E.Hot Plate Mienta', 'Straightners Tornado', 'AC Zanussi', 'Air Styler Rush brus', 'Shaving_Tri Babyliss', 'Kettle Kenwood', 'Tablet TCL', 'Complem Printer HP', 'M.Mincer SMART', 'Hood Bosch', 'AC LG', 'Hobs Hoover', 'Cooker Bosch', 'Tablet Samsung', 'Washer Dry ASSMiele', 'Juicer Solac', 'Fan Kenwood', 'Cooker Union Aire?', 'Cooker Royal', 'H.Blend Tornado', 'Toaster Mienta', 'Frayer Black&decker', 'Fun Line Home', 'Grill Fresh', 'TV Acc Energizer', 'Tablet Huawei', 'Thermal Mug Tank', 'Oven Brandt', 'Shaving_Tri Tornado', 'Hood Fagor', 'Receiver', 'M Grinder Sonai', 'Blender G.tec', 'Audio Philips', 'Straightners Braun', 'Juicer Bosch', 'Hood Panasonic', 'Oven Indesit', 'Hood ICook', 'Comp Monitor Dell', 'AC Accessory Fresh', 'Hood Premier', 'TABLET REALME', 'Blender Media Tech', 'IFix', 'TV Acc ICONZ', 'Fridge Haier', 'VC AccessoriesMiele', 'AC Accessory Daikin', 'Hair Dryer Babyliss', 'Gas Heater PASSAP', 'F.Proc Mienta', 'H.Mixer Fresh', 'kettle Black&white', 'Cooker La germanya', 'Washing M Toshiba', 'TV Acc STEEL', 'Tools Claber', 'Power Bank SBS', 'TV Acc HP', 'Iron Home', 'Kettle Sonai', 'Hair Dryer Remington', 'WD speed', 'F.Proc Ariete', 'Oven Franke', 'Hood Gorenje', 'Oven Fagor', 'Blender sary', 'Fun Line Ariete', 'Warmer veito', 'Shaving_Tri Hapillin', 'D Washer Beko', 'M.Mincer Kenwood', 'D Washer White Point', 'Mobile REALME', 'Deep F Sharp', 'Cooker White Point', 'Audio Media Tech', 'WD Tornado', 'Complem Camera Nikon', 'Gas Heater Union Air', 'Hood Miele', 'Ele Heater Boman', 'Complem Camera CANON', 'Coffee M Kenwood', 'F.Proc Tornado', 'AC Accessory Crafft', 'Grill Tornado', 'Blender Sonai', 'Tablet Lenovo', 'AC Accessory Haier', 'H.Mixer Moulinex', 'Washing M Fresh'], 'dom_comm': ['0', 'DOM', 'NON', 'COMM', 'B.MOBILE'], 'sub_category': ['TV-40-SMRT', 'COOKING APPLIANCES', 'Mobile_Acc', 'AIR COOLER', 'HOOD', 'M.MINCER', 'AC-COLD-3HP-INDOOR UNIT', 'SPORT MACHINE', 'TV-85-SMRT', 'HOBS', 'ALEXA ECHO DOT', 'AC-HOT/COLD-3HP-OUTDOOR UNIT', 'TV-43', 'AC-COLD-2.25HP-OUTDOOR UNIT', 'AC-HOT/COLD-4HP-INDOOR UNIT', 'SCALE', 'RECEIVER', 'TV-40', 'AC-COLD-7HP-INDOOR UNIT', 'TV-50', 'AC-HOT/COLD-4HP', 'BLENDER', 'FILTER 3 STAGES', 'LAPTOP', 'MICROWAVE', 'F.PROC', 'TABLET', 'TV-32', 'ESPRESSO MACH', 'GIFT', 'TV-65-SMRT', 'COOKER', 'TV-75-SMRT', 'BUNDLE- B-IN', 'DEEP FREEZER', 'SHAVING_TRI', '0', 'WASHING M', 'AC-COLD-1.5HP-OUTDOOR UNIT', 'TV-75-SMRT-HI', 'E.HOT PLATE', 'FRIDGE', 'NON', 'TV-65-SMRT-HI', 'TOASTER', 'MIXER', 'MDA ASS', 'AC-HOT/COLD-7HP-INDOOR UNIT', 'OVEN', 'AC-HOT/COLD-4HP-OUTDOOR UNIT', 'DRYER', 'TV-ACCESSORY', 'JUICER', 'TV-50-SMRT-HI', 'TV-FRAME', 'TV-55-SMRT', 'FILTER 7 STAGES', 'TANK', 'TOOLS', 'BMOBILE ACCESSORIES', 'LAM', 'TV-55-SMRT-HI', 'FUN LINE', 'COFFEE GRINDER', 'TV-86-SMRT', 'AC-HOT/COLD-3HP', 'MASHER', 'AC-HOT/COLD-3HP-INDOOR UNIT', 'COFFEE M', 'TV-85-SMRT-HI', 'D WASHER', 'CHOPPER', 'VC ACCESSORIES', 'CLINER M', 'FAN', 'TV-60-SMRT', 'TV-50-SMRT', 'AC-COLD-1.5HP-INDOOR UNIT', 'AC-HOT/COLD-2.25HP-OUTDOOR UNIT', 'STRAIGHTNERS', 'KETTLE', 'FILTER 5 STAGES', 'H.MIXER', 'AC-HOT/COLD-1.5HP-OUTDOOR UNIT', 'AC-COLD-7HP-OUTDOOR UNIT', 'WASHER DRY ASS', 'THERMAL VESSEL', 'R.COOKER', 'TV-70-SMRT', 'AC-COLD-1.5HP', 'VC', 'GAS HEATER', 'AC-HOT/COLD-7HP-OUTDOOR UNIT', 'AC-HOT/COLD-5HP', 'H.BLENDER', 'AC-COLD-2.25HP', 'HAIR DRYER', 'FRAYER', 'FILTER ASS', 'GRILL', 'AC ACCESSORY', 'AC-HOT/COLD-5HP-OUTDOOR UNIT', 'MINCER', 'COMPLEMENTARY', 'MOBILE', 'WD', 'FILTER 6 STAGES', 'CURL IRONS', 'AC-HOT/COLD-5HP-INDOOR UNIT', 'CAPPUCCINO MAKER', 'AIR PURIFIER', 'AC-HOT/COLD-2.25HP-INDOOR UNIT', 'IRON', 'TV-32-SMRT', 'AIR STYLER', 'KITCHEN M', 'AC-HOT/COLD-1.5HP', 'AIR FRYER', 'AC-HOT/COLD-6HP-INDOOR UNIT', 'AC-HOT/COLD-1.5HP-INDOOR UNIT', 'It_Acc', 'Wearable_Acc', 'WASHER DRYER', 'ELE HEATER', 'AC-HOT/COLD-2.25HP', 'HOOD ASS', 'WALL HOOD', 'AC-COLD-3HP-OUTDOOR UNIT', 'AUDIO', 'TV-43-SMRT', 'WARMER', 'MOSQ.KILL', 'AC-COLD-2.25HP-INDOOR UNIT'], 'extended_sub_category': ['FRAYER', 'H.BLENDER', 'HOBS', 'WL Telephone', 'ESPRESSO MACH', 'WARMER', 'CHOPPER', 'TV-50', 'TV-75-SMRT-HI', 'TANK', 'AC-HOT/COLD-5HP', 'KETTLE', 'CAPPUCCINO MAKER', 'TV-75-SMRT', 'Network', 'Network-Switch', 'WASHER DRYER', 'AC COMPLEMENTARY', 'M.MINCER', 'Mobile Cables', 'HOOD', 'MDA COMPLEMENTARY', 'FILTER 6 STAGES', 'F.PROC', 'DEEP FREEZER', 'AC-HOT/COLD-1.5HP', 'AC-COLD-2.25HP', 'DRYER', 'TV Cables', 'TV Supplies', 'TV-60-SMRT', 'TV-85-SMRT-HI', 'BUNDLE- B-IN', 'AC-COLD-7HP', 'Security', 'MIXER', 'TV-65-SMRT', 'MASHER', 'IRON', 'Cross Bag', 'FILTER 3 STAGES', 'AC-COLD-3HP', 'Service', 'Network-Modem', 'AC-COLD-1.5HP', 'AIR PURIFIER', 'AIR COOLER', 'FAN', 'TV-50-SMRT', 'CLINER M', 'TV COMPLEMENTARY', 'OVEN', 'Protection', 'TV-32-SMRT', 'MOBILE COMPLEMENTARY', 'TV-43', 'SPORT MACHINE', 'SDA COMPLEMENTARY', 'Network-Adapter', 'IOT', 'TV-85-SMRT', 'FRIDGE', 'AIR STYLER', 'Mobile cables', 'H.MIXER', 'Storage', 'ALEXA ECHO DOT', 'SCALE', 'Gift', 'TV-32', 'Bundle', 'MICROWAVE', 'AC-HOT/COLD-4HP', 'GRILL', 'R.COOKER', 'TABLET', 'Mobile Audio', 'Mobile Holder', 'Smart Home', 'FILTER 7 STAGES', 'Wearables', '0', 'ELE HEATER', 'SHAVING_TRI', 'TOASTER', 'COFFEE M', 'CURL IRONS', 'KITCHEN M', 'Gaming', 'TV-43-SMRT', 'BLENDER', 'COMPLEMENTARY', 'VC', 'HAIR DRYER', 'AC-HOT/COLD-7HP', 'MOBILE', 'BMOBILE ACCESSORIES', 'E.HOT PLATE', 'JUICER', 'TV-40', 'GAS HEATER', 'STRAIGHTNERS', 'TV-50-SMRT-HI', 'NON', 'TV-65-SMRT-HI', 'TV-40-SMRT', 'TV-55-SMRT-HI', 'FILTER 5 STAGES', 'D WASHER', 'WASHING M', 'TV-55-SMRT', 'FUN LINE', 'Smart Scale', 'THERMAL VESSEL', 'COOKING APPLIANCES', 'MINCER', 'Bar Code Scanner', 'AC-HOT/COLD-6HP', 'MOSQ.KILL', 'AC-HOT/COLD-3HP', 'WD', 'Power', 'Smart tag', 'AC-HOT/COLD-2.25HP', 'Mobile photography', 'TV-70-SMRT', 'LAPTOP', 'COOKER', 'AIR FRYER', 'COFFEE GRINDER', 'Computer peripherals', 'WALL HOOD'], 'sub_category_supplier': ['TV-55-SMRT-SONY', 'AC-HOT/COLD-1.5HP-CARRIERE', 'WARMER-FRESH', 'TV-50-SMRT-SAMSUNG', 'TOOLS-MPT HT', 'MOBILE-HUAWEI', 'AUDIO-DOB', 'KETTLE-MODEX', 'VC-TOSHIBA', 'VC-SAMSUNG', 'TV-43-SMRT-PREMIUM', 'COMPLEMENTARY-HP', 'AC-HOT/COLD-1.5HP-AMERICOOL', 'BMOBILE ACCESSORIES-STRONG', 'AC ACCESSORY-FRESH', 'OVEN-BEKO', 'TV-32-TORNADO', 'HAIR DRYER-BABYLISS', 'BMOBILE ACCESSORIES-NI', 'DEEP FREEZER-PANASONIC', 'BMOBILE ACCESSORIES-ORIGINAL', 'COOKER-ROYAL', 'H.MIXER-KENWOOD', 'WD-PASSAP', 'HOBS-BAUMATIC', 'GIFT-INFINX', 'KETTLE-HOUSECOM', 'FAN-BLACK AND DECAR', 'HOOD-FRESH', 'F.PROC-BRAUN', 'TV-43-SMRT-SAMSUNG', 'H.BLENDER-HOME TECH', 'AUDIO-TOSHIBA', 'TV-55-SMRT-SAMSUNG', 'STRAIGHTNERS-BRAUN', 'COFFEE M-MEDIA TECH', 'MASHER-BLACK AND WHITE', 'AC-COLD-2.25HP-CRAFT', 'OVEN-ZANUSSI', 'WD-SPEED', 'DEEP FREEZER-TOSHIBA Midea', 'COOKER-KIRIAZI', 'AIR PURIFIER-DAIKIN', 'AIR COOLER-FRESH', 'AC-HOT/COLD-2.25HP-UNION AIRE', 'ELE HEATER-UNION AIRE', 'MDA-ZANUSSI', 'GIFT-ARISTON', 'AC-HOT/COLD-1.5HP-TORNADO', 'OVEN-FAGOR', 'AC-COLD-1.5HP-CRAFT', 'COFFEE M-SOLAC', 'FRIDGE-WHITE WHALE', 'HOBS-BOSCH', 'WARMER-BLACK AND DECAR', 'CHOPPER-KENWOOD', 'BLENDER-SARY', 'TV-32-UNION AIRE', 'AC-HOT/COLD-1.5HP-UNION AIRE', 'TV-32-UG', 'FRIDGE-BEKO', 'AC-HOT/COLD-3HP-LG', 'BLENDER-MEDIA TECH', 'AC-HOT/COLD-2.25HP-MIDEA', 'HOBS-GORENJE', 'MICROWAVE-SAMSUNG', 'TOASTER-HOME TECH', 'TV-ACCESSORY-ITEL', 'AC-COLD-3HP-PREMIUM', 'MICROWAVE-ARISTON', 'LAPTOP-LENOVO', 'AC-HOT/COLD-3HP-MIDEA', 'AC-COLD-1.5HP-AMERICOOL', 'BLENDER-BOSCH', 'BMOBILE ACCESSORIES-STEEL', 'AC-HOT/COLD-5HP-FRESH', 'GAS HEATER-OLYMPIC', 'COFFEE M-HOME TECH', 'TV-ACCESSORY-FRESH', 'TV-ACCESSORY-KEENDEX', 'IRON-PANASONIC', 'AC-HOT/COLD-5HP-SHARP', 'KITCHEN M-SARY', 'HOOD-ZANUSSI', 'TV-86-SMRT-UNION AIRE', 'STRAIGHTNERS-MIENTA', 'RECEIVER-MUTECH', 'FRAYER-BERGEN', 'FRIDGE-ULTRA', 'TV-43-CONTEX', 'TV-50-SMRT-PREMIUM', 'GAS HEATER-UNIVERSAL', 'DEEP FREEZER-UNION AIRE', 'COMPLEMENTARY-BENQ', 'KETTLE-SOLAC', 'LAPTOP-ASUS', 'AC-HOT/COLD-3HP-UNION AIRE', 'MASHER-KENWOOD', 'AC-HOT/COLD-4HP-CARRIERE', 'HOBS-INDESIT', 'SHAVING_TRI-REMINGTON', 'H.MIXER-PANASONIC', 'TV-60-SMRT-TORNADO', 'TV-32-FRESH', 'AC-HOT/COLD-2.25HP-BEKO', 'VC-TEFAL', 'FRIDGE-TOSHIBA', 'FRIDGE-FRESH', 'TV-43-SMRT-ULTRA', 'IRON-BLACK AND DECAR', 'HOOD-GORENJE', 'R.COOKER-TEFAL', 'AIR FRYER-KENWOOD', 'TV-ACCESSORY-MEDIA TECH', 'WASHING M-INDESIT', 'GAS HEATER-WHITE POINT', 'AC-COLD-1.5HP-PREMIUM', 'H.MIXER-BRAUN', 'TV-43-SMRT-UNION AIRE', 'AUDIO-F&D', 'GAS HEATER-PREMIUM', 'BLENDER-BLACK AND DECAR', 'H.MIXER-ROVO', 'FRIDGE-ZANUSSI', 'TV-55-SMRT-ULTRA', 'COFFEE M-MIENTA', 'HOBS-HOOVER', 'D WASHER-FRESH', 'AIR COOLER-SONAI', 'FUN LINE-MIENTA', 'H.BLENDER-BOSCH', 'F.PROC-UNION AIRE', 'NON', 'TV-43-NIKAI', 'IRON-HOME TECH', 'TV-65-SMRT-SAMSUNG', 'AIR PURIFIER-SHARP', 'VC-BISSELL', 'TV-32-SMRT-CAIXUN', 'FILTER 5 STAGES-SEASONS', 'CHOPPER-MEDIA TECH', 'TV-32-SMRT-PREMIUM', 'GAS HEATER-WHITE WHALE', 'THERMAL VESSEL-WACACO', 'COFFEE M-PHILIPS', 'WARMER-SHTEBEL', 'KITCHEN M-FRESH', 'AC-COLD-3HP-CARRIERE', 'GAS HEATER-TORNADO', 'AC ACCESSORY-CRAFT', 'CHOPPER-FRESH', 'COOKER-UNION AIRE', 'CAPPUCCINO MAKER-ARIETE', 'HOBS-NARDI', 'BMOBILE ACCESSORIES-LDNIO', 'TV-50-SMRT-SONY', 'JUICER-TORNADO', 'TV-43-LG', 'MINCER-BOSCH', 'FAN-TEFAL', 'FRIDGE-SHARP', 'COFFEE M-KENWOOD', 'WASHING M-PREMIUM', 'CHOPPER-BLACK AND DECAR', 'TV-75-SMRT-HI-LG', 'SHAVING_TRI-HAPILLINE', 'MOBILE-VIVO', 'LAPTOP-VAIO', 'TV-43-SMRT-FRESH', 'MICROWAVE-SHARP', 'COMPLEMENTARY-DELL', 'H.BLENDER-KENWOOD', 'D WASHER-WHITE POINT', 'AC-COLD-3HP-UNION AIRE', 'TV-50-SMRT-HAIER', 'HOBS-ECOMATIC', 'COFFEE M-BIALETTI', 'FRIDGE-HAIER', 'JUICER-SONAI', 'BLENDER-BRAUN', 'TV-32-SMRT-HAIER', 'TV-50-SMRT-HI-LG', 'TV-55-SMRT-TOSHIBA', 'FILTER 3 STAGES-SEASONS', 'H.MIXER-MOULINEX', 'HOOD-FAGOR', 'D WASHER-ARISTON', 'TV-40-SMRT-UNION AIRE', 'F.PROC-PANASONIC', 'MOBILE-XIAOMI', 'H.BLENDER-SARY', 'FRAYER-MIELE', 'FAN-PANASONIC', 'WASHING M-KIRIAZI', 'FAN-UNIVERSAL', 'SHAVING_TRI-PHILIPS', 'HAIR DRYER-PHILIPS', 'MDA ASS-INDESIT', 'TV-43-SMRT-PLUTO', 'AC-COLD-1.5HP-FRESH', 'VC-SMART', 'AC-HOT/COLD-1.5HP-ZANUSSI', 'AC-COLD-1.5HP-ULTRA', 'OVEN-HOOVER', 'TV-55-SMRT-PLUTO', 'IRON-ULTRA', 'TV-ACCESSORY-SYINIX', 'GRILL-SOLAC', 'D WASHER-MIELE', 'DEEP FREEZER-MIELE', 'IRON-TORNADO', 'M.MINCER-SMART', 'AUDIO-LG', 'FAN-KENWOOD', 'FRIDGE-ELECTROSTAR', 'COFFEE M-BOSCH', 'CLINER M-KARCHER', 'ELE HEATER-TORNADO', 'M.MINCER-PANASONIC', 'BMOBILE ACCESSORIES-OSN', 'DEEP FREEZER-ARISTON', 'AIR PURIFIER-LG', 'H.BLENDER-BRAUN', 'GRILL-MEDIA TECH', 'D WASHER-LG', 'AUDIO-SONY', 'HOBS-TORNADO', 'WASHING M-Toshiba', 'HOOD-TORNADO', 'CURL IRONS-BABYLISS', 'KETTLE-MEDIA TECH', 'ELE HEATER-CLAGE', 'FRIDGE-BOSCH', 'MOBILE-INFINX', 'HOBS-BRANDT', 'R.COOKER-MEDIA TECH', 'AC-HOT/COLD-3HP-FRESH', 'FUN LINE-HOME TECH', 'FAN-SONAI', 'GIFT-UNIVERSAL', 'ELE HEATER-BOMAN', 'D WASHER-BOSCH', 'OVEN-SHARP', 'AC ACCESSORY-CARRIERE', 'AC-HOT/COLD-1.5HP-FRESH', 'HAIR DRYER-TORNADO', 'TV-32-ULTRA', 'RECEIVER-SKYWORTH ZAPPER', 'H.BLENDER-SENCOR', 'FILTER ASS-SEASONS', 'COOKER-LA GERMANYA', 'GIFT-INDESIT', 'LAPTOP-HUAWEI', 'GAS HEATER-ATLANTIC', 'GAS HEATER-BOSCH', 'AC-HOT/COLD-2.25HP-ULTRA', 'AC-COLD-2.25HP-LG', 'FRAYER-DELONGHI', 'AUDIO-FIRST', 'WALL HOOD-FRESH', 'FRAYER-FRESH', 'OVEN-MIENTA', 'MICROWAVE-ZANUSSI', 'HAIR DRYER-RUSH BRUSH', 'TV-75-SMRT-TOSHIBA', 'E.HOT PLATE-TOUCH', 'AC-COLD-3HP-LG', 'TV-75-SMRT-SAMSUNG', 'TV-FRAME-SAMSUNG', 'BLENDER-G.TEC', 'KITCHEN M-G.TEC', 'AC-COLD-2.25HP-PREMIUM', 'KITCHEN M-BLACK AND WHITE', 'AC-HOT/COLD-3HP-TORNADO', 'R.COOKER-HOME TECH', 'TV-ACCESSORY-SCHNEIDER', 'TV-85-SMRT-HI-LG', 'GAS HEATER-FERROLI', 'COMPLEMENTARY-XIAOMI', 'GIFT-BOSCH', 'BLENDER-MIENTA', 'AC ACCESSORY-DAIKIN', 'TV-86-SMRT-LG', 'KITCHEN M-HOME TECH', 'TV-65-SMRT-UNION AIRE', 'COMPLEMENTARY-SONY', 'FRIDGE-KIRIAZI', 'AC-HOT/COLD-5HP-CARRIERE', 'LAPTOP-DELL', 'WASHING M-TORNADO', 'AUDIO-PHILIPS', 'MASHER-MIENTA', 'AC-COLD-2.25HP-TORNADO', 'TV-ACCESSORY-ELIOS', 'KETTLE-BOSCH', 'THERMAL VESSEL-SEASONS', 'COFFEE M-MODEX', 'WD-KOLDAIR', 'F.PROC-SONAI', 'AC-COLD-2.25HP-ULTRA', 'AC-COLD-7HP-CARRIERE', 'LAM-PHILIPS', 'FRAYER-MIENTA', 'FRIDGE-MIELE', 'MOBILE-APPLE', 'TV-ACCESSORY-HP', 'CHOPPER-BOSCH', 'MICROWAVE-SMART', 'GRILL-MODEX', 'H.BLENDER-BLACK AND WHITE', 'VC-FRESH', 'AC-HOT/COLD-2.25HP-FRESH', 'H.BLENDER-MIENTA', 'AC-HOT/COLD-3HP-CARRIERE', 'ELE HEATER-WHITE WHALE', 'TV-50-SMRT-LG', 'AC-COLD-1.5HP-SHARP', 'COFFEE M-BLACK AND DECAR', 'AC-HOT/COLD-2.25HP-HISENSE', 'TV-ACCESSORY-TRUMAN', 'ELE HEATER-FRESH', 'TV-32-SAMSUNG', 'WASHING M-FRESH', 'AC-COLD-2.25HP-MIDEA', 'TV-ACCESSORY-HISENSE', 'HOBS-FRANKE', 'COOKER-ZANUSSI', 'VC-BLACK AND DECAR', 'TV-55-SMRT-SHARP', 'DEEP FREEZER-ELECTROSTAR', 'MIXER-ULTRA', 'TV-85-SMRT-SAMSUNG', 'MOBILE-HOPE', 'D WASHER-BeKO', 'TOASTER-BLACK AND DECAR', 'BMOBILE ACCESSORIES', 'KETTLE-TOUCH', 'HOBS-ICOOK', 'WASHER DRYER-LG', 'KITCHEN M-MOULINEX', 'TOOLS-MPT PT', 'HOOD-FRANKE', 'TOASTER-BRAUN', 'BLENDER-ULTRA', 'TV-75-SMRT-UNION AIRE', 'TV-ACCESSORY-FALCON', 'WARMER-MIENTA', 'F.PROC-MODEX', 'M.MINCER-BRAUN', 'TV-32-TCL', 'COMPLEMENTARY-HAVIT', 'WD-FRESH', 'COMPLEMENTARY-SAMSUNG', 'TV-65-SMRT-HI-LG', 'TV-ACCESSORY-LG', 'TV-55-SMRT-LG', 'OVEN-BRANDT', 'GIFT-FRESH', 'H.MIXER-BOSCH', 'AC-HOT/COLD-2.25HP-PREMIUM', 'E.HOT PLATE-HOME TECH', 'LAPTOP-MICROSOFT', 'ELE HEATER-TOSHIBA', 'AC-HOT/COLD-1.5HP-LG', 'HAIR DRYER-REMINGTON', 'TV-55-SMRT-HI-LG', 'GRILL-KENWOOD', 'BLENDER-HOME TECH', 'SPORT MACHINE-KHATER', 'WARMER-HELLER', 'IRON-ARIETE', 'H.MIXER-TOUCH', 'H.MIXER-BLACK AND WHITE', 'ELE HEATER-SHTEBEL', 'TV-65-SMRT-TOSHIBA', 'AC-HOT/COLD-5HP-LG', 'GAS HEATER-KIRIAZI', 'HOBS-SMART', 'AUDIO-ORAIMO', 'H.BLENDER-MOULINEX', 'DEEP FREEZER-FRESH', 'VC-TORNADO', 'TOOLS-SNDWAY', 'ALEXA ECHO DOT-ALEXA', 'BMOBILE ACCESSORIES-MUSIC HERO', 'THERMAL VESSEL-TANK', 'TV-32-LG', 'KETTLE-HOME TECH', 'AC-HOT/COLD-3HP-PREMIUM', 'BLENDER-MOULINEX', 'MIXER-TOUCH', 'COOKER-WHITE WHALE', 'COFFEE M-ZADA', 'MOBILE-REALME', 'IRON-MEDIA TECH', 'TV-ACCESSORY-HAMA', 'GAS HEATER-ARION', 'KETTLE-KENWOOD', 'AC ACCESSORY-UNION AIRE', 'DEEP FREEZER-WHITE POINT', 'TV-ACCESSORY-ILOOK', 'WASHING M-SHARP', 'FAN-SMART', 'TV-32-SMRT-LG', 'TABLET-HUAWEI', 'ELE HEATER-VEITO', 'VC-GROUHY', 'JUICER-MOULINEX', 'H.MIXER-MODEX', 'CHOPPER-SONAI', 'COFFEE M-SMART', 'TV-ACCESSORY-ICONZ', 'FRAYER-MODEX', 'KITCHEN M-MIENTA', 'M.MINCER-TORNADO', 'DEEP FREEZER-BEKO', 'F.PROC-BLACK AND DECAR', 'HAIR DRYER-SOLAC', 'AC-COLD-1.5HP-TORNADO', 'ELE HEATER-OLYMPIC', 'VC-ROVO', '0', 'TV-32-HAIER', 'ELE HEATER-KIRIAZI', 'JUICER-MODEX', 'COOKING APPLIANCES-ARIETE', 'H.MIXER-FRESH', 'KETTLE-ZAHRAN', 'WASHING M-LG', 'ELE HEATER-FLYON', 'COFFEE M-NESPRESSO', 'TV-32-PREMIUM', 'F.PROC-ULTRA', 'DEEP FREEZER-PASSAP', 'TV-32-SMRT-NIKAI', 'TV-43-TOSHIBA', 'LAM-BLACK AND DECAR', 'DEEP FREEZER-ALASKA', 'DEEP FREEZER-SHARP', 'WARMER-MEDIA TECH', 'ESPRESSO MACH-ARIETE', 'IRON-TEFAL', 'WALL HOOD-TOSHIBA', 'FRIDGE-SAMSUNG', 'STRAIGHTNERS-REMINGTON', 'WASHING M-TOSHIBA', 'FRIDGE-WHITE POINT', 'KETTLE-TORNADO', 'OVEN-TORNADO', 'KETTLE-ARION', 'VC-KENWOOD', 'FAN-TORNADO', 'OVEN-HOME TECH', 'AIR FRYER-SOLAC', 'TV-32-SARY', 'MICROWAVE-FRESH', 'KETTLE-SENCOR', 'KETTLE-BRAUN', 'AC ACCESSORY-HAIER', 'KITCHEN M-KENWOOD', 'COOKER-WHITE POINT', 'AC ACCESSORY-SHARP', 'OVEN-ULTRA', 'KITCHEN M-ARIETE', 'HOOD-TOUCH', 'AC-HOT/COLD-1.5HP-BEKO', 'WARMER-AKWRJ', 'TABLET-APPLE', 'TV-65-SMRT-LG', 'TABLET-LENOVO', 'CHOPPER-ROVO', 'OVEN-KLASS', 'TV-50-SMRT-TORNADO', 'OVEN-ELBA', 'BLENDER-MODEX', 'MOBILE-NOKIA', 'AC-COLD-3HP-ULTRA', 'JUICER-KENWOOD', 'H.BLENDER-BLACK AND DECAR', 'FRIDGE-LG', 'WASHING M-HAIER', 'WASHING M-UNION AIRE', 'FUN LINE-SOLAC', 'CHOPPER-SMART', 'AC-HOT/COLD-1.5HP-HISENSE', 'TV-32-SMRT-FRESH', 'OVEN-SIMFER', 'FUN LINE-ARIETE', 'BMOBILE ACCESSORIES-LOGITECH', 'D WASHER-BEKO', 'DRYER-HOME TECH', 'GAS HEATER-ZANUSSI', 'HOBS-FAGOR', 'OVEN-ARISTON', 'H.MIXER-MEDIA TECH', 'AC-HOT/COLD-3HP-ULTRA', 'CHOPPER-MOULINEX', 'AC-COLD-2.25HP-CARRIERE', 'TV-43-TORNADO', 'TV-65-SMRT-SHARP', 'MINCER-HOME TECH', 'TV-32-SMRT-SAMSUNG', 'RECEIVER-GALAXI', 'M.MINCER-MODEX', 'WASHING M-HOOVER', 'FRAYER-TEFAL', 'MIXER-MEDIA TECH', 'TV-32-SMRT-TORNADO', 'M.MINCER-MOULINEX', 'KITCHEN M-BOSCH', 'KETTLE-PANASONIC', 'TV-55-SMRT-HI-SAMSUNG', 'TV-32-SMRT-SONY', 'OVEN-MIELE', 'DEEP FREEZER-TORNADO', 'HOBS-BEKO', 'TV-43-HAIER', 'VC-BLACK AND WHITE', 'VC-ARIETE', 'R.COOKER-MODEX', 'HOOD-ICOOK', 'GRILL-MIENTA', 'HOOD-HOOVER', 'COFFEE M-SONAI', 'MOBILE-SAMSUNG', 'COMPLEMENTARY-INTEL', 'COFFEE M-OKKA', 'WARMER-VEITO', 'FAN-UNION AIRE', 'HOOD-ELBA', 'HAIR DRYER-ARZUM', 'H.BLENDER-TOUCH', 'AC-COLD-2.25HP-GENERAL ELECTRIC', 'WASHING M-MIELE', 'M.MINCER-BLACK AND WHITE', 'TV-43-SMRT-SONY', 'BLENDER-SMART', 'TV-40-SMRT-VIEW', 'BLENDER-SENCOR', 'WD-TORNADO', 'AC-COLD-2.25HP-SHARP', 'E.HOT PLATE-FRESH', 'WD-BERGEN', 'VC-BOSCH', 'IRON-SOLAC', 'GAS HEATER-LONGLIFE', 'F.PROC-BENEX', 'FRAYER-BLACK AND DECAR', 'GIFT-NESTLE', 'AC-COLD-2.25HP-FRESH', 'DEEP FREEZER-KIRIAZI', 'KETTLE-BLACK AND DECAR', 'OVEN-NARDI', 'VC-MODEX', 'AC-COLD-1.5HP-UNION AIRE', 'WASHING M-BOSCH', 'AIR COOLER-TORNADO', 'MICROWAVE-KENWOOD', 'COOKER-PREMIUM', 'F.PROC-GROUHY', 'FRIDGE-PASSAP', 'TV-75-SMRT-HI-SAMSUNG', 'WASHING M-CANDY', 'TOASTER-TORNADO', 'STRAIGHTNERS-RUSH BRUSH', 'HOBS-ARISTON', 'TV-43-ULTRA', 'H.MIXER-SMART', 'CHOPPER-TORNADO', 'BMOBILE ACCESSORIES-SONY', 'H.BLENDER-MEDIA TECH', 'GRILL-TORNADO', 'COFFEE M-BEKO', 'STRAIGHTNERS-BABYLISS', 'H.MIXER-MIENTA', 'COMPLEMENTARY-EPSON', 'AC-COLD-2.25HP-UNION AIRE', 'F.PROC-BLACK AND WHITE', 'BMOBILE ACCESSORIES-TOSHIBA', 'AUDIO-MEDIA TECH', 'HOBS-KLASS', 'COOKER-BEKO', 'MIXER-UNION AIRE', 'RECEIVER-TRUMAN', 'VC-MIELE', 'GRILL-HOME TECH', 'GAS HEATER-PASSAP', 'MICROWAVE-LG', 'TV-70-SMRT-LG', 'KETTLE-SMART', 'AC ACCESSORY-ZANUSSI', 'WD-WHITE POINT', 'DEEP FREEZER-INDESIT', 'MOBILE-HONOR', 'AC-HOT/COLD-1.5HP-SHARP', 'AC-HOT/COLD-3HP-BEKO', 'WARMER-TORNADO', 'OVEN-FRESH', 'AC-HOT/COLD-1.5HP-PREMIUM', 'GAS HEATER-FRESH', 'AC-COLD-1.5HP-LG', 'GRILL-TOUCH', 'TV-43-CAIXUN', 'D WASHER-INDESIT', 'AUDIO-AVANTREE', 'AC-COLD-1.5HP-CARRIERE', 'AC-HOT/COLD-4HP-SHARP', 'GAS HEATER-ARISTON', 'FILTER 7 STAGES-SEASONS', 'AC-HOT/COLD-4HP-FRESH', 'R.COOKER-BLACK AND DECAR', 'E.HOT PLATE-SMART', 'OVEN-INDESIT', 'VC ACCESSORIES-MIELE', 'KITCHEN M-TOUCH', 'TV-ACCESSORY-ORIGINAL', 'IRON-TOUCH', 'ELE HEATER-ARISTON', 'HOBS-ELBA', 'VC-DAEWOO', 'CURL IRONS-RUSH BRUSH', 'MICROWAVE-HOOVER', 'TV-75-SMRT-HI-SHARP', 'AIR FRYER-TORNADO', 'IRON-BRAUN', 'AIR COOLER-HOME TECH', 'COOKER-BOSCH', 'HOOD ASS-INDESIT', 'E.HOT PLATE-MIENTA', 'WASHING M-ZANUSSI', 'AC ACCESSORY-PREMIUM', 'TV-43-SMRT-TOSHIBA', 'TV-50-SMRT-ULTRA', 'CHOPPER-ULTRA', 'ELE HEATER-ZANUSSI', 'HOOD-INDESIT', 'AC-COLD-3HP-TORNADO', 'TABLET-TCL', 'GAS HEATER-PANASONIC', 'TV-65-SMRT-TORNADO', 'TV-50-SMRT-UNION AIRE', 'JUICER-MEDIA TECH', 'KITCHEN M-SMART', 'BLENDER-ARIETE', 'HOBS-MIELE', 'LAPTOP-MSI', 'RECIEVER-TIGER', 'TV-ACCESSORY-FORA', 'AC-HOT/COLD-7HP-CARRIERE', 'KETTLE-ZADA', 'FILTER ASS-PHILIPS', 'TV-55-SMRT-TCL', 'KETTLE-MIENTA', 'COMPLEMENTARY-LENOVO', 'FRAYER-PHILIPS', 'AC-COLD-1.5HP-HAIER', 'JUICER-BRAUN', 'TV-43-SMRT-LG', 'FRIDGE-INDESIT', 'TV-32-SMRT-TOSHIBA', 'TV-85-SMRT-HI-SAMSUNG', 'AC-HOT/COLD-1.5HP-MIDEA', 'BLENDER-SONAI', 'AC-HOT/COLD-1.5HP-ULTRA', 'COOKER-FRESH', 'AC-HOT/COLD-2.25HP-GENERAL ELECTRIC', 'TV-50-SMRT-SHARP', 'FRAYER-ARISTON', 'TV-50-SMRT-TOSHIBA', 'SCALE-SOLAC', 'SPORT MACHINE-FUTURE', 'M.MINCER-KENWOOD', 'HOBS-ZANUSSI', 'ELE HEATER-UNIVERSAL', 'HOOD-SONAI', 'H.MIXER-SONAI', 'WASHING M-WHITE POINT', 'KETTLE-BLACK AND WHITE', 'CHOPPER-MIENTA', 'TV-75-SMRT-LG', 'AC-HOT/COLD-2.25HP-SHARP', 'GRILL-FRESH', 'F.PROC-BOSCH', 'F.PROC-MOULINEX', 'TV-40-CONTEX', 'OVEN-FRANKE', 'COOKER-UNIVERSAL', 'AC-HOT/COLD-1.5HP-HAIER', 'FRIDGE-TORNADO', 'THERMAL VESSEL-TIGER', 'KETTLE-FRESH', 'FAN-FRESH', 'HOOD-BOSCH', 'BLENDER-TOUCH', 'MIXER-MODEX', 'HOOD-BEKO', 'GRILL-BOSCH', 'BMOBILE ACCESSORIES-LAVVENTO', 'KETTLE-ARIETE', 'TV-43-UNION AIRE', 'COFFEE M-DELONGHI', 'M.MINCER-BOSCH', 'H.BLENDER-TORNADO', 'GRILL-BLACK AND DECAR', 'TV-32-ATA', 'TV-43-SMRT-TORNADO', 'FAN-MIENTA', 'SHAVING_TRI-TORNADO', 'VC-PANASONIC', 'FRIDGE-IDEAL', 'AIR STYLER-RUSH BRUSH', 'TOASTER-KENWOOD', 'RECEIVER-ETI', 'TV-50-ULTRA', 'HOOD-ARISTON', 'FUN LINE-ZAHRAN', 'WALL HOOD-OLYMPIC', 'F.PROC-TORNADO', 'DRYER-ARISTON', 'STRAIGHTNERS-TORNADO', 'IRON-PHILIPS', 'IRON-MODEX', 'KETTLE-SONAI', 'GIFT-SAMSUNG', 'MICROWAVE-BLACK AND DECAR', 'VC-MIENTA', 'MICROWAVE-DAEWOO', 'AC-HOT/COLD-3HP-GENERAL ELECTRIC', 'STRAIGHTNERS-PHILIPS', 'IRON-SMART', 'VC-HITACHI', 'TV-50-SMRT-PLUTO', 'MINCER-BLACK AND DECAR', 'TV-65-SMRT-HI-SAMSUNG', 'HOOD-MIELE', 'MOBILE-LAVA', 'GRILL-TEFAL', 'HOOD-PREMIER', 'TV-ACCESSORY-ETI', 'F.PROC-KENWOOD', 'D WASHER-ZANUSSI', 'FRIDGE-UNION AIRE', 'FUN LINE-SONAI', 'CHOPPER-TOUCH', 'ELE HEATER-ATLANTIC', 'VC-SOLAC', 'TV-32-TOSHIBA', 'LAPTOP-HP', 'GAS HEATER-UNION AIRE', 'AC-COLD-3HP-FRESH', 'OVEN-BOSCH', 'HOBS-FRESH', 'BUNDLE- B-IN-INDESIT', 'VC-LG', 'WARMER-TOUCH', 'TOASTER-PANASONIC', 'WASHER DRY ASS-MIELE', 'AC-HOT/COLD-2.25HP-CARRIERE', 'AC-HOT/COLD-2.25HP-TORNADO', 'WARMER-ULTRA', 'H.BLENDER-SEM', 'WD-WHITE WHALE', 'F.PROC-G.TEC', 'WASHING M-FAGOR', 'TV-70-SMRT-SAMSUNG', 'IRON-MIENTA', 'BLENDER-FRESH', 'DEEP FREEZER-WHITE WHALE', 'TV-55-SMRT-TORNADO', 'FAN-ULTRA', 'TV-32-PLUTO', 'AC-COLD-3HP-CRAFT', 'TV-ACCESSORY-FLAT', 'WD-ULTRA', 'TV-43-SMRT-HAIER', 'AC-HOT/COLD-2.25HP-LG', 'TV-32-SMRT-SHARP', 'LAPTOP-APPLE', 'TV-65-SMRT-TCL', 'SHAVING_TRI-RUSH BRUSH', 'BLENDER-PANASONIC', 'TV-ACCESSORY-NOUR TECH', 'JUICER-MIENTA', 'VC-ULTRA', 'H.BLENDER-G.TEC', 'FAN-BLACK AND WHITE', 'FAN-TOUCH', 'WASHING M-BEKO', 'BLENDER-KENWOOD', 'TANK-SEASONS', 'MICROWAVE-HOME TECH', 'COFFEE GRINDER-ARIETE', 'DEEP FREEZER-TOSHIBA', 'FUN LINE-BLACK AND DECAR', 'GRILL-ZADA', 'MICROWAVE-TORNADO', 'DEEP FREEZER-LG', 'FAN-ARION', 'TOASTER-MIENTA', 'MOBILE-OPPO', 'WALL HOOD-TORNADO', 'JUICER-HOME TECH', 'COMPLEMENTARY-NIKON', 'BLENDER-TORNADO', 'TV-43-SMRT-SHARP', 'SHAVING_TRI-BRAUN', 'MINCER-WHITE WHALE', 'AC-COLD-1.5HP-MIDEA', 'TOOLS-HITACHI', 'MIXER-BLACK AND DECAR', 'HOOD-PANASONIC', 'BLENDER-BLACK AND WHITE', 'TV-40-SMRT-SAMSUNG', 'F.PROC-ARIETE', 'COFFEE M-TORNADO', 'AIR STYLER-BABYLISS', 'H.BLENDER-SMART', 'FRAYER-HOME TECH', 'JUICER-BOSCH', 'WASHING M-SAMSUNG', 'AC-HOT/COLD-6HP-CARRIERE', 'IRON-BLACK AND WHITE', 'COFFEE M-BRAUN', 'TABLET-REALME', 'F.PROC-MIENTA', 'BMOBILE ACCESSORIES-HP', 'VC-HOOVER', 'F.PROC-HOME TECH', 'COMPLEMENTARY-CANON', 'BMOBILE ACCESSORIES-EZVIZ', 'M.MINCER-SONAI', 'M.MINCER-TOUCH', 'HOOD-BeKO', 'CHOPPER-ARIETE', 'OVEN-TOUCH', 'AC-HOT/COLD-4HP-LG', 'RECEIVER-DALY', 'FUN LINE-TORNADO', 'MIXER-BLACK AND WHITE', 'TABLET-SAMSUNG', 'F.PROC-SMART', 'FILTER 6 STAGES-SEASONS', 'FAN-NIKAI', 'COFFEE M-TEFAL', 'BMOBILE ACCESSORIES-DAHUA', 'AC ACCESSORY-LG', 'WARMER-DELONGHI', 'GIFT-LG', 'H.MIXER-TORNADO', 'TV-55-SMRT-PREMIUM', 'AC-COLD-3HP-MIDEA', 'TOOLS-BOSCH', 'JUICER-SOLAC', 'COFFEE M-WHITE WHALE', 'TOOLS-CLABER', 'TV-32-SONY', 'FUN LINE-MEDIA TECH', 'OVEN-GORENJE', 'TOASTER-ARIETE', 'AC-HOT/COLD-3HP-SHARP', 'SHAVING_TRI-BABYLISS', 'AUDIO-SAMSUNG', 'WASHING M-ARISTON', 'FRIDGE-ARISTON', 'IRON-KENWOOD', 'TV-50-SMRT-TCL', 'HOBS-GLEMGAS', 'THERMAL VESSEL-TEFAL', 'MOSQ.KILL-HOME TECH', 'KITCHEN M-MODEX']} the_received_subfilter
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
1319.444795548 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('3315.6932402801447066')), ('initial_average_retail_price', Decimal('13126.681480539114')), ('proposed_sellthru_percent', Decimal('48.4051260202708763')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('32.5964716566508207')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.59647165665082), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 12440020625.822582), ('budget_cost', 5529925817.577142), ('deficit', Decimal('12440020626.2963')), ('Original_BudgetAmount', Decimal('12440020626.2963')), ('budget_percent', Decimal('96.5582')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 2327808.0), ('ACT_FCT', Decimal('1476862769.4800')), ('Original_BudgetCostofGoods', Decimal('5529925817.5760')), ('PO', Decimal('39948116802.1513')), ('COSTPRICE', 4713166435.117021), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('1476862769.4800')), ('stock_on_hand_qty', Decimal('3200128')), ('net_sales_ly', Decimal('8092769115.8600')), ('net_sales_lly', Decimal('1007099531.1300')), ('gross_sales_ly', Decimal('8399543056.2430')), ('total_sku_count', Decimal('516858')), ('ly_customer_disc', Decimal('306773940.3830')), ('SupplyCost', Decimal('5253429526.6988')), ('SALESQTY', 2254951.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('88.2616')), ('budget_qty_act_fct_percent', Decimal('211890648.1772')), ('budget_vs_py_qty_percent', Decimal('130898276.5850')), ('budget_vs_ppy_qty_percent', Decimal('220282352.8072')), ('QTY_Buy_By_SKU', Decimal('2327808.0000')), ('total_sku_count_ty', Decimal('117562057929')), ('total_sku_count_lly', Decimal('37721')), ('total_sku_count_ly', Decimal('257731')), ('quantity_mix_percent', Decimal('101.6192')), ('quantity_act_forecast', Decimal('2572272.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('1617801.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('142823500.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.1049')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('5529925817.5760')), ('budget_vs_py_cost_percent', Decimal('314408048109.7000')), ('budget_vs_ppy_cost_percent', Decimal('35712605280.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('1011509261.3200')), ('cost_of_goods_ly', Decimal('3403519253.0170')), ('cost_act_forecast', Decimal('6541435078.8960')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('704074434646.6091')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('471005689.9200')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('1.8567')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('24068.3861')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('24068.3861')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
1319.642963941 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 3315.6932 ┆ 13126.681 ┆ … ┆ 0.0       ┆ 24068.386 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆ 4         ┆ 481       ┆   ┆           ┆ 1         ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 57.9437           │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 3.0677e8   ┆ 8.0928e9   ┆ 1.2440e10  ┆ 57.769929 ┆ 1.2912e10 ┆ 48.405126 ┆ 2.6674e10 ┆ 3.652269  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76971705FC40>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76971705D120>, <Expr ['col("SalesActualsByForecast").…'] at 0x76971705FDF0>, <Expr ['col("initial_average_retail_pr…'] at 0x76971705FE80>, <Expr ['col("proposed_sellthru_percent…'] at 0x76971705FD90>, <Expr ['col("retail_value_including_ma…'] at 0x76971705F850>, <Expr ['col("budget_gross_margin_perce…'] at 0x76971705FAF0>, <Expr ['col("Logistic%").mean()'] at 0x76971705FD60>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76971705D150>, <Expr ['col("MarkdownValue").mean()'] at 0x76971705F760>, <Expr ['col("markdown_percent").mean()'] at 0x76971705D180>, <Expr ['col("DisplayItemValue").mean()'] at 0x76971705F940>, <Expr ['col("budget_amount").sum()'] at 0x76971705F820>, <Expr ['col("budget_cost").sum()'] at 0x76971705DD20>, <Expr ['col("deficit").sum()'] at 0x76971705D0F0>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76971705F7F0>, <Expr ['col("budget_percent").sum()'] at 0x76971705F910>, <Expr ['col("relative_budget_percent")…'] at 0x76971705CE50>, <Expr ['col("History_Net_Sales").sum()'] at 0x76971705CEB0>, <Expr ['col("budget_qty").sum()'] at 0x76971705CDF0>, <Expr ['col("ACT_FCT").sum()'] at 0x76971705FEB0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76971705CF10>, <Expr ['col("PO").sum()'] at 0x76971705CEE0>, <Expr ['col("COSTPRICE").sum()'] at 0x76971705CF70>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76971705D000>, <Expr ['col("sales_actual").sum()'] at 0x76971705CD00>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76971705CB20>, <Expr ['col("net_sales_ly").sum()'] at 0x76971705CC70>, <Expr ['col("net_sales_lly").sum()'] at 0x76971705CB50>, <Expr ['col("gross_sales_ly").sum()'] at 0x76971705CD30>, <Expr ['col("total_sku_count").sum()'] at 0x76971705CBE0>, <Expr ['col("ly_customer_disc").sum()'] at 0x76971705C8B0>, <Expr ['col("SupplyCost").sum()'] at 0x76971705C760>, <Expr ['col("SALESQTY").sum()'] at 0x76971705CCD0>, <Expr ['col("DisplayItemQty").sum()'] at 0x76971705CAC0>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76971705C730>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76971705C7C0>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76971705CFD0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76971705C910>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76971705D090>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76971705C5B0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76971705C550>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76971705C6A0>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76971705CA30>, <Expr ['col("quantity_mix_percent").su…'] at 0x76971705C400>, <Expr ['col("quantity_act_forecast").s…'] at 0x76971705C5E0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76971705C340>, <Expr ['col("sold_qty_ly").sum()'] at 0x76971705C670>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76971705C250>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76971705CA00>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76971705C3A0>, <Expr ['col("budget_cost_percent").sum…'] at 0x76971705C100>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76971705C130>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76971705C040>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76971705C1F0>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76971705C1C0>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76971705C4C0>, <Expr ['col("cost_mix_percent").sum()'] at 0x76971705F6A0>, <Expr ['col("cost_actuals").sum()'] at 0x76971705FCD0>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76971705C0D0>, <Expr ['col("cost_act_forecast").sum()'] at 0x76971705C370>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76971705D210>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76971705D240>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76971705D300>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76971705FEE0>, <Expr ['col("budget_margin_percent").s…'] at 0x76971705F6D0>, <Expr ['col("budget_margin_mix_percent…'] at 0x76971705D2A0>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76971705D480>, <Expr ['col("margin_actuals").sum()'] at 0x76971705FF70>, <Expr ['col("margin_act_forecast").sum…'] at 0x76971705D5A0>, <Expr ['col("units_per_sku_total").sum…'] at 0x76971705D2D0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76971705FF40>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76971705C9A0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76971705D630>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76971705D330>, <Expr ['col("initial_average_retail_pr…'] at 0x76971705D660>, <Expr ['col("initial_average_retail_pr…'] at 0x76971705D6C0>, <Expr ['col("budget_per_sku").sum()'] at 0x76971705D1B0>, <Expr ['col("budget_qty_ty").sum()'] at 0x76971705D840>, <Expr ['col("Check_box").max()'] at 0x76971705D600>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,3315.6932402801,13126.6814805391,48.4051260203,12911586549.8213729858,55.5472938196,5.0,55.5472938196,30677394038.3000030518,3.6522693952,0.0,12440020625.8225822449,5529925817.5771417618,12440020626.2963008881,12440020626.2963008881,100.0,100.0,0.0,2327808.0,1476862769.4800000191,5529925817.5760002136,39948116802.1512985229,4713166435.117020607,0.0,1476862769.4800000191,3200128.0,8092769115.8599996567,1007099531.1299999952,8399543056.2430000305,516858.0,306773940.3830000162,5253429526.698800087,2254951.0,0.0,0.0,88.2616,211890648.1771999896,130898276.5849999934,220282352.8072000146,2327808.0,117562057929.0,37721.0,257731.0,101.6192,2572272.0,0.0,1617801.0,142823500.0,0.0,0.0,0.1049,0.0,0.0,5529925817.5760002136,314408048109.700012207,35712605280.0,0.0,1011509261.3200000525,3403519253.0170001984,6541435078.8959999084,0.0,0.0,0.0,0.0,704074434646.6091308594,0.0,0.0,471005689.9200000167,0.0,1.8567,0.0,24068.3861,0.0,0.0,0.0,0.0,24068.3861,0.0,0.0,153.7177256354,1235.2324910592,18.2491647585,5730.2488621082,100.0,3915226.9809389994,57.7699291286,42007060952.9546737671,57.9437000575,4689249862.8429994583,0.0,0.0,6910094808.2454404831,119255325.4518387914,42007060952.9546737671,17666615551.3873939514,42007060952.9546737671,12911586549.8213710785,12440020625.8225822449,26674006683.5366134644,11264451926.693365097,4741741.9646437131]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":3315.6932402801,"initial_average_retail_price":13126.6814805391,"proposed_sellthru_percent":48.4051260203,"retail_value_including_markdown":12911586549.8213729858,"budget_gross_margin_percent":55.5472938196,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":55.5472938196,"MarkdownValue":30677394038.3000030518,"markdown_percent":3.6522693952,"DisplayItemValue":0.0,"budget_amount":12440020625.8225822449,"budget_cost":5529925817.5771417618,"deficit":12440020626.2963008881,"Original_BudgetAmount":12440020626.2963008881,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":2327808.0,"ACT_FCT":1476862769.4800000191,"Original_BudgetCostofGoods":5529925817.5760002136,"PO":39948116802.1512985229,"COSTPRICE":4713166435.117020607,"Historical_Gross_Margin":0.0,"sales_actual":1476862769.0,"stock_on_hand_qty":3200128.0,"net_sales_ly":8092769115.8599996567,"net_sales_lly":1007099531.1299999952,"gross_sales_ly":8399543056.2430000305,"total_sku_count":516858.0,"ly_customer_disc":306773940.3830000162,"SupplyCost":5253429526.698800087,"SALESQTY":2254951.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":88.2616,"budget_qty_act_fct_percent":211890648.1771999896,"budget_vs_py_qty_percent":130898276.5849999934,"budget_vs_ppy_qty_percent":220282352.8072000146,"QTY_Buy_By_SKU":2327808.0,"total_sku_count_ty":117562057929.0,"total_sku_count_lly":37721.0,"total_sku_count_ly":257731.0,"quantity_mix_percent":101.6192,"quantity_act_forecast":2572272.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":1617801.0,"quantity_act_forecast_vs_ly_percent":142823500.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.1049,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":5529925817.5760002136,"budget_vs_py_cost_percent":314408048109.700012207,"budget_vs_ppy_cost_percent":35712605280.0,"cost_mix_percent":0.0,"cost_actuals":1011509261.3200000525,"cost_of_goods_ly":3403519253.0170001984,"cost_act_forecast":6541435078.8959999084,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":704074434646.6091308594,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":471005689.9200000167,"margin_act_forecast":0.0,"units_per_sku_total":1.8567,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":24068.3861,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":24068.3861,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":57.9437000575,"FirstMargin_percent":57.7699291286,"budget_vpy":153.7177256354,"budget_vppy":1235.2324910592,"StockatRetailPrice":42007060952.9546737671,"TYForecast":42007060952.9546737671,"LYvsACT_FCT_percent":100.0,"supply_retail_value":12440020625.8225822449} } data_json
WebSocket connection closed unexpectedly
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': True, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
1320.799176524 start_to_execute main the stored procedure
conn established
sp executed
1320.834797849 end of main the stored procedure
conn established
sku wise calc executed
1320.863291212 end of sku wise stored proc
we called the sku wise stored procedure_init
We are getting data from ra_and_stock
1320.863437322 started to fetch data
conn established
<function getData.<locals>.<lambda> at 0x76a877d18550> dfafghaf
1365.487451865 end of fetch data
(122928, 168) output data shape
111111111111111111111111111111111111111111111
processing...
we are calling main groupby process
conn established
sku wise calc executed
1366.266649504 end of sku wise stored proc
conn established
[OrderedDict([('id', 254796), ('store', None), ('region', None), ('area', None), ('Channel', 'B.TECH X'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 254797), ('store', None), ('region', None), ('area', None), ('Channel', 'CALL CENTER'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 254798), ('store', None), ('region', None), ('area', None), ('Channel', 'MINI'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 254799), ('store', None), ('region', None), ('area', None), ('Channel', 'WAREHOUSE'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)]), OrderedDict([('id', 254800), ('store', None), ('region', None), ('area', None), ('Channel', 'DEEL'), ('budget_year', None), ('budget_quarter', None), ('budget_month', None), ('budget_weekday', None), ('budget_day', None), ('budget_dates', None), ('historical_year', None), ('history_Quarter', None), ('history_month', None), ('history_week', None), ('history_Day', None), ('history_datess', None), ('family', None), ('sub_Family', None), ('Supplier', None), ('Category', None), ('Dom_Comm', None), ('Sub_Category', None), ('Extended_sub_category', None), ('Sub_Category_supplier', None), ('Article_Score', None)])] 2163 getData dictsize
1366.393660523 end of fetch data
shape: (2_163, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 254796 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 254797 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 254798 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 254799 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 254800 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 256954 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ HOBS-ARISTON  ┆ 0            │
│ 256955 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WD-KOLDAIR    ┆ 0            │
│ 256956 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ COMPLEMENTARY ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ -INTEL        ┆              │
│ 256957 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ MOBILE-APPLE  ┆ 0            │
│ 256958 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-T ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ORNADO        ┆              │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the filter dataframe
shape: (2_163, 26)
┌────────┬───────┬────────┬──────┬───┬──────────────┬───────────────┬───────────────┬──────────────┐
│ id     ┆ store ┆ region ┆ area ┆ … ┆ Sub_Category ┆ Extended_sub_ ┆ Sub_Category_ ┆ Article_Scor │
│ ---    ┆ ---   ┆ ---    ┆ ---  ┆   ┆ ---          ┆ category      ┆ supplier      ┆ e            │
│ i64    ┆ str   ┆ str    ┆ i32  ┆   ┆ str          ┆ ---           ┆ ---           ┆ ---          │
│        ┆       ┆        ┆      ┆   ┆              ┆ str           ┆ str           ┆ i32          │
╞════════╪═══════╪════════╪══════╪═══╪══════════════╪═══════════════╪═══════════════╪══════════════╡
│ 254796 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 254797 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 254798 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 254799 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ 254800 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ 0             ┆ 0            │
│ …      ┆ …     ┆ …      ┆ …    ┆ … ┆ …            ┆ …             ┆ …             ┆ …            │
│ 256954 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ HOBS-ARISTON  ┆ 0            │
│ 256955 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ WD-KOLDAIR    ┆ 0            │
│ 256956 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ COMPLEMENTARY ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ -INTEL        ┆              │
│ 256957 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ MOBILE-APPLE  ┆ 0            │
│ 256958 ┆ 0     ┆ 0      ┆ 0    ┆ … ┆ 0            ┆ 0             ┆ AC-COLD-3HP-T ┆ 0            │
│        ┆       ┆        ┆      ┆   ┆              ┆               ┆ ORNADO        ┆              │
└────────┴───────┴────────┴──────┴───┴──────────────┴───────────────┴───────────────┴──────────────┘ the_fiter_data
id Int64
store String
region String
area Int32
Channel String
budget_year Int32
budget_quarter String
budget_month String
budget_weekday Int64
budget_day String
budget_dates Int32
historical_year Int64
history_Quarter String
history_month String
history_week String
history_Day String
history_datess Int32
family String
sub_Family String
Supplier String
Category String
Dom_Comm String
Sub_Category String
Extended_sub_category String
Sub_Category_supplier String
Article_Score Int32
last_v store store
last_v region region
last_v Channel Channel
last_v Quarter budget_quarter
last_v month budget_month
last_v week budget_weekday
last_v Day budget_day
last_v history_Quarter history_Quarter
last_v history_month history_month
last_v history_Day history_Day
last_v family family
last_v sub_family sub_Family
last_v supplier Supplier
last_v category Category
last_v dom_comm Dom_Comm
last_v sub_category Sub_Category
last_v extended_sub_category Extended_sub_category
last_v sub_category_supplier Sub_Category_supplier
{'store': ['Ras Ghareb Branch', 'Beni Suef Branch', 'BTECHX San_Stefano Mall', 'Nagaa Hamadi Branch', 'New Dumietta Branch', 'Alamein Masa Mall', 'Aswan WH', 'Berket Elsabaa Branch', 'El Fayoum Branch', 'Shebin El Koum Branch', 'BTECH Mini Air Force House', 'Mall Of October Branch', 'BTECHX Truck Alex', 'BTECHX Ismailia Square', '10th Tech Club WH', 'BTECHX El Sherouk', 'New Damanhour', 'Banha Branch', 'BTECHX Obour2', 'Oraby Branch', 'Fakous Branch', 'Shoubra Branch', 'BTECHX City Stars Mall', 'Ain Shams Branch - Ibrahim Abdel Razek St.', 'BTECHX El Mosher Axis', 'Qalyub', 'BTECHX Gehan2 Dewaka', 'Makadi Bay', 'Noon Seller Store1', 'Alex_ Tusun', 'New Roxy', 'Masara', 'Mall Of Arabia Branch', 'El Helmya', 'Dar El Salam Branch', 'BTECHX Midor', 'BTECHX Mansoura', 'BTECHXCFC', 'El Zaher', 'Sky Mall El Sherouk Branch', 'Shubra El Kheima Branch', 'QENA-Warehouse', 'Dumietta Branch', 'BTECHX Manial', 'BTECHX Airport', 'El Tahrir', 'Asafra Branch', 'BTECHX Safwa Zaid ', 'GateWay Mall El Rehab', 'BTECHX El Menia', 'Banha warehouse', 'Qena Branch', 'BTECHX Open Air Mall', 'El Sadat Branch', 'Loran Branch', 'Delta Tanta Mega Store', 'BTECHX Sporting Club', '1Imbaba', 'BTECHX Mahala', 'El Nozha Branch', 'Mega Fisal', 'BTECHX Roxcy', 'BTECHX Moharam Bek', 'Deel Asyut WH', 'Quesna Branch', 'Marina Branch', 'El Betash Branch', 'Mega Alex Sidi Gaber', 'Sale With Cost W.H', 'BTECHX Saad El Din El Shazly', 'Dakernis Branch', 'HQ Call Center', 'BTECHX 2Mansoura', '10th Show Room WH', 'Asyut WH', 'BTECHX ElShams Club', 'BTECHX Assuit', 'Aswan Mega  Branch', 'Elagamy2', 'Zahra El Asher Branch', 'Agami Branch', '26Th July Branch', 'Maadi Branch-El Laselky St.', 'Hadek El Kobba Branch', 'BTECHX GardeniaTagamo', '9025Show Room Alex', 'Mansoura Branch', 'B.TECH X AUC', 'Tanta WH', 'BTECHX Hegaz', 'Marassi-North-Coast Branch', 'Hassan El Maamon', 'Marina Kaian Branch', 'BTECHX Maadi Grand Mall', 'BTECHX Shebin El koum', 'BTECHX Shinzo Abe', 'Malawi Branch', 'BTECHX ElRehab North', 'B.TECHX El Mandara', 'Misr elgdida', 'El Seyouf Branch', 'BTECHX Gihan3 Abasia', 'Zayton Branch', 'Mall Of Egypt Branch', 'Almaza Branch', 'Winget Branch', 'Damanhour Branch', 'BTECH Mini MPC', '10th of Ramadan WH', 'Suez Branch', 'Alex WH', 'New sohag', 'BTECHX Sidi Bishr', 'EL Matria', 'BTECHX Zagazig', 'Ismaila Branch-Railway station', 'El Kanater Branch', 'BTECHX Sohag', 'Tanta Branch', 'B2B Gov', 'Roxy Branch', 'BTECHX The Yard Mall', 'El Tagamou 1 Branch', 'Ain Shams Branch - Mostafa Hafez St.', 'El Tagamou 2 Branch', 'BTECHX Kasr El Einy', 'Jumia Seller Store', 'Assiut Branch - Ibn Sina Tower', 'BTECHX CityCenter Alex', 'El-Gouna Branch', 'BTECHX Ramses Station', 'Miela Arkan Mall', 'BTECHX Kafr ElSheikh', 'El Sayeda Zainab', 'Haram Branch', 'Luxor Branch', 'Show Room - Corp. Sale-38', 'El-Elsoudan Street Branch', 'BTECHX ElRehab Mall1', 'Salah Salim Branch', 'Makram Ebaid Branch', 'Uni Mall El Obour', 'BTECHXMataria', 'BTECHX Dokki', 'Ismalia Branch-City Council Square', 'B.TECH STAFF', 'Abbas El-Akkad Branch', 'Smouha Branch', 'El Menia Mega Branch', 'Corporate Sales', 'CFC Mall', 'BTECHX Triumph Tagamo', 'Zagazig Branch', 'Gesr El Suez Branch', 'El Galaa', 'BTECH mini Egyptian Shooting ', 'Mahalla Branch', 'BTECHX CityCenterMaadi', 'Cairo Retail Warehouses', 'BTECH2Fayoum', 'BTECHX 45', 'Assuit Mega Branch', '3Tanta Mall', 'Miela Arkan WH', 'Amwaj ranch', 'Port Said', 'ElBahr ElAzam', 'Flag Mall Branch', 'Faisal Branch', 'El Mokattam Branch', 'Desouk Branch', 'Mega Helwan', 'Town Center El Salam', 'October-WH', '0', 'BTECHX Sheraton', 'BTECHX ASU', 'Sohag Branch', 'Eldahar Mega Branch', 'EL Amiria Branch'], 'region': ['0', 'CAIRO', 'UPPER EGYPT', 'ALEXANDRIA', 'HURGHADA', 'DELTA'], 'season': [], 'area': [], 'Channel': ['WAREHOUSE', 'CALL CENTER', 'DEEL', 'Retail', '0', 'ARKAN', 'NON', 'ONLINE', 'B.TECH X', 'MINI', 'B2B'], 'budget_year': [0.0], 'Quarter': ['0', '3'], 'month': ['July     ', '0'], 'week': [0, 1, 2, 3, 4, 5, 6, 7], 'date': ['19925', '19918', '19923', '19932', '19913', '19933', '19930', '19907', '19929', '19919', '19924', '19914', '19915', '19909', '19910', '19906', '19921', '19905', '19908', '19911', '19916', '19917', '19934', '19926', '19928', '0', '19922', '19927', '19912', '19920', '19931', '19935'], 'Day': ['Saturday ', 'Thursday ', 'Tuesday  ', 'Friday   ', 'Sunday   ', 'Wednesday', 'Monday   ', '0'], 'historical_year': [], 'history_Quarter': ['3', '0'], 'history_month': ['July     ', '0'], 'history_week': ['0', '28', '29', '30', '31'], 'history_Day': ['Thursday ', 'Friday   ', 'Wednesday', 'Tuesday  ', 'Monday   ', 'Sunday   ', 'Saturday ', '0'], 'history_dates': [0, 19190, 19192, 19193, 19194, 19197, 19198, 19200, 19204, 19553, 19554, 19555, 19556, 19557, 19558, 19559, 19560, 19561, 19562, 19563, 19564, 19565, 19566, 19567, 19568, 19569], 'article_score': ['sale', 'abc', 'ae', 'speed', 'terminal', 'margin', 'sell', 'markdown', 'core', 'quartile', 'sortimeter'], 'history_year': [0.0, 2022.0, 2023.0], 'family': ['LAPTOP', 'BMOBILE ACCESSORIES', 'COMPLEMENTARY', 'AC', 'MDA', '0', 'TABLET', 'SDA', 'MOBILE', 'NON', 'TV'], 'sub_family': ['AC COM', 'TV DOM', 'SDA COM', 'TV COM', 'NON', 'BMOBILE', 'SDA DOM', '0', 'MDA COM', 'AC DOM', 'MDA DOM'], 'supplier': ['OPPO', 'CANON', 'SOLAC', 'ORIGINAL', 'HISENSE', 'LAVA', 'MICROSOFT', 'EZVIZ', 'PASSAP', 'BISSELL', 'F&D', 'BOSCH', 'TANK', 'WHITE POINT', 'ZAHRAN', 'SONAI', 'SHTEBEL', 'INDESIT', 'TEFAL', 'KLASS', 'BeKO', 'SONY', 'ARION', 'ARISTON', 'MSI', 'ARIETE', 'TOSHIBA', 'FRANKE', 'FAGOR', 'DALY', 'HOOVER', 'ICOOK', 'MIELE', 'LAVVENTO', 'ETI', 'SHARP', 'NOUR TECH', 'TORNADO', 'SPEED', 'HOME', 'IDEAL', 'MIENTA', 'MODEM', 'LDNIO', 'HONOR', 'KEENDEX', 'APPLE', 'DOB', 'FORA', 'NON', 'XAIOMI', 'FLYON', 'SASHO', 'TRUMAN', 'HITACHI', 'RUSH BRUSH', 'CAIXUN', 'SCHNEIDER', 'SENCOR', 'FUTURE', 'ROVO', 'ROYAL', 'MUSIC HERO', 'ELBA', 'ZADA', 'AMERICOOL', 'ICONZ', 'STEEL', 'ALASKA', 'KOLDAIR', 'NI', 'CHOETECH', 'LENOVO', 'MEDIA TECH', 'NIKON', 'OLYMPIC', 'BMOBILE ACCESSORIES', 'BABYLISS', 'DAIKIN', 'ELECTROSTAR', 'CONTEX', 'TIGER', 'PHILIPS', 'XIAOMI', 'SKYWORTH ZAPPER', 'FIRST', 'ASUS', 'KIRIAZI', 'INTEL', 'ATLANTIC', 'BIALETTI', 'BRANDT', 'ZANUSSI', 'SMART', 'NOKIA', 'FLAT', 'MODEX', 'BLACK AND DECAR', 'HAVIT', 'KHATER', 'ELIOS', 'REMINGTON', 'ILOOK', 'BENQ', 'ORAIMO', 'EPSON', 'HP', '0', 'NIKAI', 'TOUCH', 'GRAND', 'KENWOOD', 'REALME', 'LOGITECH', 'GLEMGAS', 'SANDISK', 'DELONGHI', 'ULTRA', 'MIDEA', 'OKKA', 'HAIER', 'S.LINK', 'WHITE WHALE', 'SARY', 'TCL', 'HOUSECOM', 'SIMFER', 'CARRIERE', 'PANASONIC', 'TOSHIBA Midea', 'GORENJE', 'SAMSUNG', 'VEITO', 'VIVO', 'LA GERMANYA', 'DELL', 'SEASONS', 'EG', 'UNIVERSAL', 'SYINIX', 'UNION AIRE', 'MUTECH', 'HAMA', 'BLACK AND WHITE', 'CANDY', 'HAPILLINE', 'HUAWEI', 'PREMIER', 'ALEXA', 'INFINIX', 'FALCON', 'G.TEC', 'PREMIUM', 'BRAUN', 'DAHUA', 'GOLDI', 'BERGEN', 'OZO', 'BEKO', 'LG', 'AMAZONE', 'LONGLIFE', 'NARDI', 'GENERAL ELECTRIC', 'MOULINEX', 'HOPE', 'DAEWOO', 'HOME TECH', 'PLUTO', 'CRAFT', 'NESPRESSO', 'ITEL', 'INFINX', 'FRESH'], 'category': ['Chopper Tornado', 'Audio oraimo', 'Cooker Fresh', 'Blender sencor', 'Washing M Toshiba', 'Deep F Sharp', 'Washing M Haier', 'AC Acc Union Aire', 'Air Fryer Tornado', 'Chopper Sonai', 'Audio Iconz', 'Fridge Haier', 'TV Acc ICONZ', 'Juicer Media Tech', 'Gaming ASS ASS', 'Fan Mienta', 'Hobs Fagor', 'Cooker Union Aire?', 'Fridge Union Aire', 'Audio sony', 'Blender sary', 'Deep F Fresh', 'Gift Zanussi', 'H.Mixer Fresh', 'Scale Solac', 'TV Haier', 'Kettle Tornado', 'IFix', 'Hood Beko', 'Mic. SMART', 'F.Proc Black&decker', 'Oven Franke', 'H.Mixer Modex', 'Oven Hoover', 'Warmer Black&decker', 'Cooker Premium', 'Cooker White Whale', 'Fridge PASSAP', 'Hood Franke', 'Iron Mienta', 'Fridge Miele', 'H.Mixer Tornado', 'Deep F Electrostar', 'Mic. Ariston', 'D Washer Fresh', 'Oven Fresh', 'kettle Mienta', 'Gas Heater Panasonic', 'Laptop DELL', 'Grill Media Tech', 'Grill Touch', 'Comp Monitor Dell', 'Deep F Beko', 'Blender Smart', 'AC Accessory Haier', 'Washing M Bosch', 'Toaster tornado', 'VC Ultra', 'Fan Black&white', 'Chopper Black&decker', 'Frayer Philips I2', 'AC ULTRA', 'Hobs Zanussi', 'E.Hot Plate Fresh', 'Grill Black&decker', 'Warmer Tornado', 'Fan Kenwood', 'Mic. Kenwood', 'Blender Black&decker', 'Deep F Union Aire?', 'Laptop Lenovo', 'AC Crafft', 'E.Hot Plate SMART', 'Air Cooler Home', 'Chopper Ultra', 'F.Proc Mienta', 'Mobile NOKIA', 'Com Projector Merlin', 'Iron Touch', 'Hobs Elba', 'TV Acc Toshiba', 'M.Mincer Touch', 'Iron Panasonic', 'Blender Black&white', 'Deep F Toshiba', 'Fan Fresh', 'Hair Dryer Philips', 'Oven Indesit', 'Comp Monitor Xiaomi', 'HHA DAEWOO', 'D Washer Indesit', 'Kitchen M Touch', 'Mobile LAVA', 'Shaving_Tri Hapillin', 'Juicer Tornado', 'Air Styler Babyliss', 'Deep F Tornado', 'TV Acc Fora', 'Iron Philips I2', 'Cooking Appliances A', 'Kettle Ariete', 'Oven Mienta', 'Straightners Braun', 'Fun Line Zahran', 'Blender Braun', 'Kettle SMART', 'Curl Irons Babyliss', 'Charger SBS', 'Deep F PASSAP', 'Air Purifier SHARP', 'TV Sony', 'Cooker Zanussi', 'Coffee M Beko', 'H.Blend Bosch', 'Juicer Modex', 'Chopper G.tec', 'Deep F Ariston', 'B.Electronic ass', 'Fan black&decker', 'Gas Heater Nikai', 'Kitchen M Fresh', 'Audio Toshiba', 'Straightners Babylis', 'Gas Heater Ariston', 'Warmer Fresh', 'Toaster Home', 'Chopper SMART', 'AC Haier', 'Blender Mienta', 'Juicer Moulinex', 'TV LG', 'Iron Modex', 'Kitchen M Modex', 'Tripod SBS', 'Sport Machine Khater', 'Mixer Kenwood', 'B.ElectronicServices', 'TV Acc hama', '0', 'AC Premium', 'Blender Modex', 'Oven Elba', 'TV Acc HP', 'Laptop MSI', 'Fridge Samsung', 'Complem Camera CANON', 'Juicer Braun', 'AC TORNADO', 'Frayer Modex', 'B2B AC', 'TV Acc ilook', 'Ele Heater Shtebel', 'M.Mincer SMART', 'Protection SBS', 'Audio Philips', 'WD Bergen', 'Coffee M Media Tech', 'VC Mienta', 'Wall Hood Toshiba', 'Ele Heater Fresh', 'Complem Printer HP', 'Ele Heater VEITO', 'Coffee M Tefal', 'Washing M Tornado', 'Fun Line Home', 'Kettle Zahran', 'Grill Tornado', 'H.Mixer Midea', 'Power Bank SBS', 'F.Proc Modex', 'Gas Heater Union Air', 'Tablet TCL', 'Fun Line Tornado', 'AC Midea', 'Gas Heater Bosch', 'TV Ultra', 'Epilator Babyliss', 'TV Union Aire', 'Mic. Fresh', 'Comp Monitor Samsung', 'Thermal Bottle Tiger', 'IFixBtech', 'Ele Heater Union Air', 'Frayer Tefal', 'H.Mixer Sonai', 'TV Acc STEEL', 'VC Solac', 'kettle Media', 'Frayer Mienta', 'Oven Miele', 'Tablet Lenovo', 'Hobs GLEMGAS', 'Lam Black&decker', 'Cappuccino Maker Ari', 'Coffee Grinder Ariet', 'F.Proc Home', 'Hood Bosch', 'Coffee M Solac', 'H.Mixer Black&white', 'H.Blend Tornado', 'Cooker Beko', 'Mincer Black&decker', 'Kettle Ultra', 'AC Accessory Fresh', 'Receiver truman', 'Toaster Black&decker', 'Audio LG', 'Ice Box Tank', 'Air Purifier LG', 'Ele Heater Atlantic', 'F.Proc Sonai', 'Kettle Black&decker', 'TV Contex', 'Compl DESK PC Intel', 'H.Mixer Rovo', 'Gift Fresh', 'Fan Nikai', 'M.Mincer Modex', 'Oven Ultra', 'VC Black&decker', 'F.Proc ULTRA', 'Kettle Touch', 'F.Proc Bosch', 'Mincer Bosch', 'Washing M Samsung', 'Complem Gaming Sony', 'Audio Samsung', 'Ele Heater Olympic', 'Coffee M Kenwood', 'Washing M Indesit', 'Boxi', 'AC Accessory Premium', 'Fun Line Ariete', 'Fridge Fresh', 'Ele Heater Universal', 'Fan Sasho', 'Coffee M Modex', 'Fridge Beko', 'Juicer Mienta', 'Juicer Kenwood', 'Cooker La germanya', 'Mobile INFINX', 'F.Proc SMART', 'H.Blend Black&decker', 'M.Mincer Kenwood', 'TABLET REALME', 'Kitchen M Mienta', 'Comp Monitor BenQ', 'Iron Tornado', 'Gas Heater Kiriazi', 'kettle Black&white', 'Blender Tornado', 'R.cooker Modex', 'F.Proc Panasonic', 'TV Sharp', 'Gas Heater Fresh', 'Kitchen M Bosch', 'AC Daikin', 'WD Grand', 'Air Cooler Fresh', 'Coffee M Philips I2', 'AC Hisense', 'VC Miele', 'Frayer Delonghi', 'Mic. Zanussi', 'Coffee M SMART', 'Kettle Panasonic', 'H.Blend Moulinex', 'Oven Bosch', 'Mincer Home', 'Lam Philips', 'Oven Nardi', 'Oven Touch', 'TV Acc Tiger', 'Mixer Black&decker', 'Hair Dryer Remington', 'TV Acc FLAT', 'Blender Touch', 'D Washer LG', 'Deep F White Whale', 'Washing M Sharp', 'Blender Moulinex', 'VC Hoover', 'Dryer LG', 'Grill Fresh', 'Oven beko', 'Mic. Black&decker', 'TV Syinix', 'Fridge LG', 'Mobile OPPO', 'Hood Touch', 'Mixer Ultra', 'Mobile APPLE', 'H.Blend Touch', 'Kettle Kenwood', 'Shaving_Tri Tornado', 'Fridge Bosch', 'VC Fresh', 'Fan Smart', 'Fridge Alaska', 'Fun Line Sonai', 'M.Mincer Moulinex', 'Hood Gorenje', 'Gas Heater White Poi', 'Sport Machine Future', 'WD Tank', 'Hobs Klass', 'Oven Sharp', 'Tablet APPLE', 'M Grinder Sonai', 'Tools Bosch', 'H.Blend Black&white', 'Enquiry Fees', 'R.cooker HOME', 'TV SARY', 'Masher Kenwood', 'Iron Black&Decker', 'Iron Tefal', 'Thermal Mug Tank', 'AC Beko', 'Frayer Black&decker', 'Coffee M Braun', 'Oven Gorenje', 'Laptop APPLE', 'F.Proc Sasho', 'VC Samsung', 'Fridge ULTRA', 'Washing M Fagor', 'Shaving_Tri Braun', 'Fan universal', 'Compl Printer CANON', 'Mobile Hope', 'Ele Heater Zanussi', 'F.Proc Moulinex', 'Washing M Kiriazi', 'WD PASSAP', 'Coffee M Sonai', 'Cables SBS', 'H.Blender Braun', 'E.Hot Pla Home', 'Hood Ariston', 'Iron Smart', 'Compl Camera GoPRO', 'Hobs Ariston', 'VC Bissell', 'Ele Heater Kiriazi', 'Iron Kenwood', 'Warmer Touch', 'TV Acc Falcon', 'Washing M Ariston', 'Fridge White Point', 'Washing M LG', 'M.Mincer Bosch', 'Kettle Media Tech', 'Gift Samsung', 'Straightners Remingt', 'Kettle Braun', 'Tablet Huawei', 'Chopper Media Tech', 'VC Kenwood', 'AC Fresh', 'Kitchen M Home', 'Curl Irons Rush brus', 'Cooker White Point', 'Fridge Electrostar', 'Iron Media Tech', 'E.Hot Plate Mienta', 'Blender Ariete', 'Selfie Stick SBS', 'TV Acc Etrain', 'Coffee M Miele', 'IT ASS ASS', 'Airpods kit SBS', 'R.cooker Tefal', 'Straightners Tornado', 'D Washer Beko', 'Iron Braun', 'Air Styler Rush brus', 'Mic. LG', 'Mobile VIVO', 'Hobs Nardi', 'Receiver ETI', 'H.Blend Kenwood', 'Hood Indesit', 'VC LG', 'TV Acc Itel', 'Mic. Home', 'M.Mincer Sonai', 'Oven Ariston', 'TV Nikai', 'Gas Heater Olympic', 'Receiver', 'Washing M EG', 'Thermoses Tiger', 'M.Mincer Black&White', 'Oven Tornado', 'Mobile HONOR', 'Kitchen M Black&whit', 'M.Mincer Panasonic', 'Bundle- b-in Indesit', 'Coffee M Bialetti', 'Frayer Media Tech', 'Espresso Machine Ari', 'Cooker Kiriazi', 'TV Acc MUTECH', 'VC Panasonic', 'AC Accessory Zanussi', 'Straightners Rush br', 'Grill Modex', 'Oven Zanussi', 'WARMER Ultra', 'Hair Dryer Solac', 'Oven Simfer', 'Ele Heater TORNADO', 'WD White Point', 'Kitchen M SMART', 'H.Blend sary', 'Juicer Bosch', 'Mobile REALME', 'Coffee M Tornado', 'Receiver Daly', 'Juicer Home', 'Gas Heater Zanussi', 'Washing M White Poin', 'Iron Black&white', 'tv acc schneider', 'Gas Heater Tornado', 'Deep F LG', 'Kitchen M Ariete', 'Mobile Huawei', 'tv acc truman', 'F.Proc Tornado', 'R.cooker Media Tech', 'Iron Ultra', 'Fan Sonai', 'TV ASS ASS', 'Ice Tank Tank', 'Straightners Mienta', 'Hobs SMART', 'Fridge Ideal', 'Cooker Royal', 'Hobs Hoover', 'Chopper Bosch', 'AC LG', 'Gas Heater Atlantic', 'Hobs Gorenje', 'TV Tornado', 'Grill Home', 'D Washer Ariston', 'Toaster Ariete', 'Mincer White Whale', 'Holders SBS', 'F.Proc Braun', 'Security Ass Camera ', 'WD speed', 'Hood ASS Indesit', 'Bottel Tank', 'Kettle Home', 'TV Acc ETI', 'Oven Home', 'Fun Line Mienta', 'WD Ultra', 'AC Sharp', 'Warmer Media Tech', 'Fan Panasonic', 'Chopper Fresh', 'VC Tornado', 'M.Mincer Tornado', 'Wall Hood Fresh', 'Mic. Tornado', 'Grill Tefal', 'VC Bosch', 'Hobs Franke', 'H.Mixer Bosch', 'Fan Tefal', 'H.Mixer Panasonic', 'Kitchen ware Modex', 'Kitchen M Moulinex', 'Gas Heater LongLife', 'Headset SBS', 'VC Modex', 'Iron Solac', 'Straightners Solac', 'Tools Hitachi', 'Oven ICook', 'Air Cooler Tornado', 'TV Toshiba', 'Coffee M White Whale', 'AC Accessory Crafft', 'M.Mincer Braun', 'Kettle Fresh', 'Fan Ultra', 'TV Acc Energizer', 'Mic. Hoover', 'Coffee M Home', 'Grill Bosch', 'Gas Heater Arion', 'Ele heater flyon', 'WD White Whale', 'Hair Dryer Tornado', 'H.Blend Media Tech', 'WD Fresh', 'Ele Heater Ariston', 'VC Philips I2', 'H.Mixer Kenwood', 'Kitchen M Kenwood', 'Audio Dob', 'Mixer Black&white', 'Security Ass Camera', 'Blender Bosch', 'Blender Home', 'TV Caixun', 'Wall Hood Tornado', 'TV FRESH', 'Blender Sonai', 'mosq.kill Home', 'Audio Media Tech', 'TV Premium', 'Hood ASS Ariston', 'Hood Elba', 'Deep F Miele', 'Cooker Bosch', 'Blender Kenwood', 'Chopper Rovo', 'Blender Media Tech', 'Blender Ultra', 'Fridge Kiriazi', 'TV Samsung', 'AC Carriere', 'Mixer Union Aire', 'Masher Black&white', 'Iron Home', 'Gas Heater White Wha', 'Comp Printer Epson', 'Transferfeesonline01', 'Gas Heater Toshiba', 'tv acc keendex', 'Kettle SENCOR', 'H.Mixer Touch', 'VC Tefal', 'Laptop Microsoft', 'tv acc elios', 'Audio F&D', 'AC Accessory Carrier', 'D Washer White Point', 'Kettle Modex', 'AC Union Aire?', 'Washing M Miele', 'Mic. Samsung', 'TV Acc NI', 'Frayer Miele', 'Kettle Housecom', 'AC Americool', 'H.Blender Zada', 'Hood ICook', 'Mobile Samsung', 'Fridge White Whale', 'Kettle Sonai', 'Hair Dryer Rush brus', 'Deep F Indesit', 'Coffee M Black&decke', 'Shaving_Tri Babyliss', 'WD Tornado', 'Hobs Bosch', 'Fan Tornado', 'Air Fryer Kenwood', 'Hood Premier', 'Coffee M Delonghi', 'Deep F White Point', 'Fun Line Media Tech', 'Masher Mienta', 'Hobs Miele', 'Tablet Samsung', 'VC AccessoriesMiele', 'Hobs ICook', 'Hood Sonai', 'Fridge Ariston', 'Hobs Beko', 'Shaving_TriRemington', 'Filter Tank', 'CombiSet Miele', 'Grill Kenwood', 'Audio', 'Hood Fagor', 'Juicer Black&decker', 'Mixer Goldi', 'Air Cooler Sonai', 'Hobs Indesit', 'Fridge Tornado', 'Fan Union Aire?', 'Complent Alexa IOT', 'Coffee M okka', 'R.cooker Black&decke', 'Thermal Mug Tefal', 'H.Mixer SMART', 'AC Accessory Sharp', 'H.Mixer Braun', 'Mixer Media Tech', 'AC General Electric', 'Audio First', 'Dryer Home', 'AC Accessory LG', 'Washing M Beko', 'H.Mixer Mienta', 'TV Accessory', 'TV Pluto', 'H.Mixer PhilipsI2', 'Blender Panasonic', 'Hobs Fresh', 'Fan Touch', 'Toaster Kenwood', 'Deep F Kiriazi', 'Filter ASS philips', 'F.Proc Ariete', 'Chopper Moulinex', 'Tablet Nokia', 'AC Accessory Daikin', 'Complem Camera Nikon', 'Washing M Hoover', 'Frayer Fresh', 'Hood Tornado', 'Chopper Mienta', 'Hair Dryer Babyliss', 'Laptop ASUS', 'E.Hot Touch', 'Receiver SkyWorth Za', 'Mic. Sharp', 'Mixer Touch', 'D Washer Miele', 'Frayer Home', 'Shaving_Tri Philips', 'AC Zanussi', 'Gas Heater premium', 'Coffee M Bosch', 'D Washer Bosch', 'H.Blend Mienta', 'Washing M Premium', 'VC Smart', 'Hobs Brandt', 'VC Black&white', 'Wall Hood Universal', 'Gas Heater Universal', 'Chopper Touch', 'Laptop Huawei', 'Filter ASS Tank', 'F.Proc Union Aire', 'Speaker SBS', 'Washing M Union Aire', 'Ele Heater Toshiba', 'Washing M Zanussi', 'Coffee M Nespresso', 'Fridge Sharp', 'Mic. Daewoo', 'Blender Fresh', 'Fridge Zanussi', 'Laptop HP', 'Washing M CANDY', 'Washing M Fresh', 'Straightners Philips', 'Mixer Modex', 'Fridge Toshiba', 'Mobile XIAOMI', 'Coffee M Mienta', 'Bl-In Barbecue Elba', 'F.Proc Kenwood', 'F.Proc Black&white', 'Deep F Alaska'], 'dom_comm': ['NON', 'COMM', 'DOM', '0', 'B.MOBILE'], 'sub_category': ['LAPTOP', 'AC-HOT/COLD-1.5HP', 'AC-HOT/COLD-1.5HP-INDOOR UNIT', 'SPORT MACHINE', 'VC ACCESSORIES', 'ELE HEATER', 'HAIR DRYER', 'E.HOT PLATE', 'TV-ACCESSORY', 'FILTER 3 STAGES', 'FILTER 5 STAGES', 'COMPLEMENTARY', 'FRIDGE', 'SCALE', 'HOOD ASS', 'F.PROC', 'GIFT', 'TV-43-SMRT', 'TV-60-SMRT', 'COOKING APPLIANCES', 'THERMAL VESSEL', 'D WASHER', 'COOKER', 'Mobile_Acc', 'AC-HOT/COLD-3HP-OUTDOOR UNIT', 'COFFEE M', 'TABLET', 'HOBS', 'DEEP FREEZER', 'KITCHEN M', 'FILTER 7 STAGES', 'WD', 'MINCER', 'TV-86-SMRT', 'RECEIVER', 'TV-55-SMRT', 'TV-70-SMRT', 'It_Acc', 'AC-HOT/COLD-3HP', 'IRON', 'Wearable_Acc', 'AC-HOT/COLD-7HP-OUTDOOR UNIT', 'ALEXA ECHO DOT', 'STRAIGHTNERS', 'TV-32', 'COMBISET', 'TV-65-SMRT-HI', 'TV-65-SMRT', 'AC-COLD-2.25HP-OUTDOOR UNIT', 'GAS HEATER', 'AC-COLD-2.25HP', 'AC-HOT/COLD-3HP-INDOOR UNIT', 'AC-COLD-1.5HP', 'TANK', 'R.COOKER', 'AC ACCESSORY', 'MOBILE', 'VC', 'WARMER', 'AC-HOT/COLD-2.25HP-OUTDOOR UNIT', 'AIR FRYER', 'BUNDLE- B-IN', 'AC-COLD-2.25HP-INDOOR UNIT', 'AIR STYLER', 'TV-75-SMRT', 'ESPRESSO MACH', 'TV-75-SMRT-HI', 'DRYER', 'OVEN', 'AC-HOT/COLD-2.25HP', '0', 'AC-HOT/COLD-4HP-INDOOR UNIT', 'SHAVING_TRI', 'FILTER ASS', 'AC-HOT/COLD-1.5HP-OUTDOOR UNIT', 'FAN', 'TV-50-SMRT-HI', 'WASHER DRYER', 'MASHER', 'AUDIO', 'TV-43', 'NON', 'WALL HOOD', 'FRAYER', 'AC-COLD-1.5HP-INDOOR UNIT', 'AC-COLD-3HP-INDOOR UNIT', 'TV-50', 'TV-FRAME', 'HOOD', 'JUICER', 'CURL IRONS', 'TV-55-SMRT-HI', 'AC-HOT/COLD-4HP-OUTDOOR UNIT', 'TV-85-SMRT-HI', 'MICROWAVE', 'TOASTER', 'FILTER 6 STAGES', 'TV-50-SMRT', 'CHOPPER', 'BLENDER', 'AC-HOT/COLD-7HP-INDOOR UNIT', 'MIXER', 'AC-COLD-1.5HP-OUTDOOR UNIT', 'GRILL', 'FUN LINE', 'CAPPUCCINO MAKER', 'M.MINCER', 'TV-40-SMRT', 'MOSQ.KILL', 'AIR PURIFIER', 'COFFEE GRINDER', 'AC-HOT/COLD-5HP-OUTDOOR UNIT', 'BMOBILE ACCESSORIES', 'TV-32-SMRT', 'H.BLENDER', 'AC-COLD-3HP-OUTDOOR UNIT', 'AC-COLD-3HP', 'WASHING M', 'LAM', 'AC-HOT/COLD-2.25HP-INDOOR UNIT', 'H.MIXER', 'TOOLS', 'KETTLE', 'AIR COOLER', 'AC-HOT/COLD-5HP-INDOOR UNIT'], 'extended_sub_category': ['WALL HOOD', 'Power', 'TV-55-SMRT', 'VC', 'Service', 'AC-COLD-3HP', 'TABLET', 'BUNDLE- B-IN', 'Mobile Cables', 'AC-COLD-1.5HP', 'FILTER 7 STAGES', 'DEEP FREEZER', 'STRAIGHTNERS', 'MIXER', 'FUN LINE', 'Protection', 'SHAVING_TRI', 'TANK', 'Computer peripherals', 'TV-60-SMRT', 'Wearables', 'H.BLENDER', 'MINCER', 'TOASTER', 'AIR STYLER', 'TV COMPLEMENTARY', 'ESPRESSO MACH', 'TV-55-SMRT-HI', 'GRILL', 'FRIDGE', 'TV-43', 'COFFEE M', 'FAN', 'IRON', 'FRAYER', 'E.HOT PLATE', 'AC-HOT/COLD-3HP', 'NON', 'CHOPPER', 'AC-COLD-2.25HP', 'KETTLE', 'HOOD', 'MOSQ.KILL', 'FILTER 6 STAGES', 'WD', 'TV-40-SMRT', 'THERMAL VESSEL', 'TV-50-SMRT-HI', 'WARMER', 'COMPLEMENTARY', 'Gift', 'AC-HOT/COLD-5HP', 'HOBS', 'F.PROC', 'TV-70-SMRT', 'AC-HOT/COLD-4HP', 'COFFEE GRINDER', 'D WASHER', 'TV-85-SMRT', 'AC COMPLEMENTARY', 'H.MIXER', 'IT Supplies', 'TV-65-SMRT-HI', 'Gaming', 'Cross Bag', 'Network-Adapter', 'TV-50', 'Mobile photography', 'SCALE', 'Network', 'MASHER', 'HAIR DRYER', 'WASHER DRYER', 'SPORT MACHINE', 'OVEN', 'GAS HEATER', 'Smart tag', 'AIR PURIFIER', 'TV-75-SMRT-HI', 'MOBILE COMPLEMENTARY', 'WASHING M', 'FILTER 3 STAGES', 'Smart Scale', 'SDA COMPLEMENTARY', 'LAPTOP', 'Mobile cables', 'KITCHEN M', 'BMOBILE ACCESSORIES', '0', 'FILTER 5 STAGES', 'ALEXA ECHO DOT', 'AIR COOLER', 'M.MINCER', 'Mobile Audio', 'AIR FRYER', 'ELE HEATER', 'Mobile Case', 'R.COOKER', 'AC-HOT/COLD-7HP', 'AC-HOT/COLD-2.25HP', 'IOT', 'Security', 'COOKER', 'COMBISET', 'CURL IRONS', 'TV-85-SMRT-HI', 'CAPPUCCINO MAKER', 'JUICER', 'TV Cables', 'DRYER', 'TV-32', 'TV-50-SMRT', 'Network-Modem', 'TV-65-SMRT', 'MICROWAVE', 'TV-32-SMRT', 'COOKING APPLIANCES', 'TV-43-SMRT', 'Network-Switch', 'Mobile Holder', 'AC-HOT/COLD-1.5HP', 'TV-75-SMRT', 'MDA COMPLEMENTARY', 'Storage', 'BLENDER', 'MOBILE'], 'sub_category_supplier': ['WD-ULTRA', 'R.COOKER-MEDIA TECH', 'AC ACCESSORY-UNION AIRE', 'H.BLENDER-BLACK AND DECAR', 'BLENDER-BRAUN', 'FAN-ULTRA', 'FAN-BLACK AND WHITE', 'OVEN-HOME TECH', 'H.BLENDER-SARY', 'DEEP FREEZER-ELECTROSTAR', 'TV-32-SMRT-LG', 'SPORT MACHINE-FUTURE', 'WASHING M-UNION AIRE', 'FRIDGE-TORNADO', 'TV-ACCESSORY-FORA', 'D WASHER-FRESH', 'AIR PURIFIER-SHARP', 'TV-55-SMRT-TOSHIBA', 'AC ACCESSORY-FRESH', 'AC-HOT/COLD-5HP-CARRIERE', 'TOASTER-BLACK AND DECAR', 'TV-65-SMRT-TOSHIBA', 'AC-HOT/COLD-3HP-BEKO', 'HOOD-SONAI', 'BMOBILE ACCESSORIES-STEEL', 'MOBILE-NOKIA', 'KITCHEN M-SMART', 'DEEP FREEZER-BEKO', 'FILTER ASS-SEASONS', 'VC-HOOVER', 'DEEP FREEZER-MIELE', 'CHOPPER-BLACK AND DECAR', 'AC-COLD-2.25HP-ULTRA', 'BLENDER-SARY', 'TOASTER-ARIETE', 'AIR COOLER-SONAI', 'SHAVING_TRI-BABYLISS', 'GAS HEATER-ARISTON', 'HOBS-KLASS', 'MINCER-BOSCH', 'DEEP FREEZER-WHITE POINT', 'FRIDGE-WHITE POINT', 'H.BLENDER-TORNADO', 'OVEN-MIELE', 'MOBILE-OPPO', 'F.PROC-BOSCH', 'OVEN-BEKO', 'HOBS-ICOOK', 'TV-50-SMRT-LG', 'WASHING M-LG', 'FRIDGE-BEKO', 'HOBS-BRANDT', 'WD-PASSAP', 'F.PROC-BRAUN', 'AC-HOT/COLD-4HP-CARRIERE', 'MICROWAVE-SMART', 'TV-32-PREMIUM', 'IRON-PHILIPS', 'AC-HOT/COLD-2.25HP-HISENSE', 'KETTLE-SENCOR', 'MICROWAVE-SHARP', 'GIFT-LG', 'H.MIXER-PHILIPS', 'MICROWAVE-HOME TECH', 'TV-32-LG', 'BMOBILE ACCESSORIES-MUTECH', 'AC-COLD-2.25HP-CRAFT', 'KITCHEN M-MIENTA', 'COOKER-LA GERMANYA', 'TV-50-SMRT-PREMIUM', 'TV-60-SMRT-SAMSUNG', 'COFFEE M-BIALETTI', 'AC-COLD-1.5HP-MIDEA', 'HOOD-TOUCH', 'CHOPPER-SMART', 'IRON-SOLAC', 'AC-HOT/COLD-2.25HP-BEKO', 'DEEP FREEZER-TORNADO', 'ELE HEATER-OLYMPIC', 'GRILL-BOSCH', 'GAS HEATER-FRESH', 'TV-ACCESSORY-HP', 'WD-TORNADO', 'STRAIGHTNERS-PHILIPS', 'LAPTOP-LENOVO', 'AC-COLD-3HP-PREMIUM', 'COMPLEMENTARY-INTEL', 'COMBISET-MIELE', 'H.MIXER-MEDIA TECH', 'H.MIXER-PANASONIC', 'SHAVING_TRI-TORNADO', 'RECEIVER-SKYWORTH ZAPPER', 'TV-55-SMRT-CAIXUN', 'TV-43-SMRT-SAMSUNG', 'AC-HOT/COLD-3HP-FRESH', 'KITCHEN M-BOSCH', 'GRILL-BLACK AND DECAR', 'BLENDER-FRESH', 'LAM-BLACK AND DECAR', 'CURL IRONS-RUSH BRUSH', 'TV-65-SMRT-HI-SAMSUNG', 'AC-COLD-2.25HP-LG', 'OVEN-SIMFER', 'KITCHEN M-MODEX', 'COFFEE M-NESPRESSO', 'COOKER-WHITE POINT', 'GIFT-FRESH', 'WD-WHITE WHALE', 'HOBS-BOSCH', 'DRYER-HOME TECH', 'BMOBILE ACCESSORIES-LOGITECH', 'WASHER DRYER-LG', 'H.BLENDER-MEDIA TECH', '0', 'FILTER 6 STAGES-SEASONS', 'FILTER ASS-PHILIPS', 'HAIR DRYER-TORNADO', 'IRON-BLACK AND WHITE', 'AC-HOT/COLD-3HP-TORNADO', 'HAIR DRYER-BABYLISS', 'TV-75-SMRT-HI-LG', 'HOBS-FRESH', 'WASHING M-PREMIUM', 'HOOD-INDESIT', 'AUDIO-TOSHIBA', 'TV-ACCESSORY-ORIGINAL', 'TV-ACCESSORY-SCHNEIDER', 'GAS HEATER-BOSCH', 'ELE HEATER-UNION AIRE', 'VC-BLACK AND DECAR', 'VC-TORNADO', 'E.HOT PLATE-FRESH', 'IRON-BRAUN', 'FUN LINE-HOME TECH', 'VC-SMART', 'TV-50-SMRT-UNION AIRE', 'TV-43-TORNADO', 'TV-32-SMRT-SAMSUNG', 'MOBILE-INFINX', 'GAS HEATER-LONGLIFE', 'COOKER-ZANUSSI', 'AC-HOT/COLD-3HP-LG', 'WASHING M-ZANUSSI', 'AUDIO-SAMSUNG', 'FRIDGE-MIELE', 'SCALE-SOLAC', 'BLENDER-MEDIA TECH', 'TABLET-LENOVO', 'AC-HOT/COLD-2.25HP-LG', 'TABLET-REALME', 'TV-ACCESSORY-SYINIX', 'F.PROC-BLACK AND WHITE', 'CHOPPER-G.TEC', 'FAN-TOUCH', 'STRAIGHTNERS-MIENTA', 'GAS HEATER-UNION AIRE', 'LAPTOP-APPLE', 'TV-86-SMRT-LG', 'TV-FRAME-SAMSUNG', 'KETTLE-HOUSECOM', 'COFFEE M-OKKA', 'AC-COLD-3HP-ULTRA', 'COFFEE M-MIENTA', 'TV-55-SMRT-SHARP', 'GIFT-WHITE POINT', 'OVEN-NARDI', 'TV-55-SMRT-TORNADO', 'GIFT-ZANUSSI', 'GAS HEATER-PANASONIC', 'H.MIXER-FRESH', 'FRAYER-BLACK AND DECAR', 'HOOD-FRESH', 'COOKER-BOSCH', 'SHAVING_TRI-PHILIPS', 'MICROWAVE-KENWOOD', 'E.HOT PLATE-MIENTA', 'OVEN-HOOVER', 'TV-32-SMRT-SONY', 'FUN LINE-MEDIA TECH', 'KETTLE-HOME TECH', 'FUN LINE-MIENTA', 'GAS HEATER-WHITE WHALE', 'VC-FRESH', 'WASHING M-SAMSUNG', 'GAS HEATER-ZANUSSI', 'FAN-SMART', 'FRIDGE-ZANUSSI', 'VC-SOLAC', 'AC ACCESSORY-CARRIERE', 'COFFEE M-BLACK AND DECAR', 'DEEP FREEZER-UNION AIRE', 'H.MIXER-SMART', 'HOBS-ARISTON', 'M.MINCER-SMART', 'H.MIXER-TOUCH', 'AUDIO-SONY', 'WASHING M-EG', 'OVEN-ELBA', 'HOOD-FAGOR', 'AC-HOT/COLD-7HP-CARRIERE', 'TV-43-SMRT-SONY', 'AC-COLD-1.5HP-CARRIERE', 'JUICER-BRAUN', 'WARMER-MEDIA TECH', 'AC-COLD-3HP-FRESH', 'FAN-SASHO', 'MASHER-BLACK AND WHITE', 'FAN-BLACK AND DECAR', 'FRIDGE-FRESH', 'AC-COLD-1.5HP-LG', 'AC-HOT/COLD-3HP-PREMIUM', 'TV-ACCESSORY-ETI', 'CHOPPER-SONAI', 'AC-COLD-1.5HP-AMERICOOL', 'TV-43-NIKAI', 'F.PROC-SASHO', 'COOKING APPLIANCES-ARIETE', 'TV-70-SMRT-SAMSUNG', 'WALL HOOD-FRESH', 'BLENDER-HOME TECH', 'AC-HOT/COLD-3HP-MIDEA', 'HOBS-MIELE', 'MOBILE-HUAWEI', 'F.PROC-MIENTA', 'IRON-MEDIA TECH', 'WARMER-FRESH', 'AC-HOT/COLD-1.5HP-CARRIERE', 'ELE HEATER-FLYON', 'FRAYER-DELONGHI', 'M.MINCER-SONAI', 'JUICER-BLACK AND DECAR', 'M.MINCER-BRAUN', 'SHAVING_TRI-BRAUN', 'HAIR DRYER-REMINGTON', 'GRILL-TORNADO', 'AC ACCESSORY-DAIKIN', 'TV-43-CAIXUN', 'VC-BOSCH', 'HOOD-BEKO', 'FRAYER-MIENTA', 'KETTLE-MODEX', 'AC-COLD-2.25HP-PREMIUM', 'COFFEE M-KENWOOD', 'COMPLEMENTARY-HP', 'BLENDER-SONAI', 'RECEIVER-MUTECH', 'AIR FRYER-TORNADO', 'ELE HEATER-KIRIAZI', 'MOBILE-HOPE', 'DEEP FREEZER-LG', 'COFFEE M-TEFAL', 'OVEN-FRESH', 'DEEP FREEZER-FRESH', 'BLENDER-BLACK AND DECAR', 'TV-85-SMRT-HI-SAMSUNG', 'H.BLENDER-BOSCH', 'HOBS-FRANKE', 'MIXER-BLACK AND DECAR', 'TV-70-SMRT-LG', 'HOOD-ICOOK', 'AC-COLD-2.25HP-MIDEA', 'TV-32-SMRT-TORNADO', 'ELE HEATER-FRESH', 'AC-COLD-1.5HP-SHARP', 'CHOPPER-MOULINEX', 'F.PROC-MOULINEX', 'TV-43-SMRT-PREMIUM', 'COFFEE M-HOME TECH', 'FAN-MIENTA', 'FRIDGE-LG', 'TANK-SEASONS', 'BMOBILE ACCESSORIES-LDNIO', 'BLENDER-KENWOOD', 'OVEN-SHARP', 'IRON-HOME TECH', 'OVEN-ZANUSSI', 'TV-43-HAIER', 'AIR FRYER-SOLAC', 'WD-BERGEN', 'FAN-TEFAL', 'TV-55-SMRT-HI-SAMSUNG', 'JUICER-TORNADO', 'TV-75-SMRT-HI-SAMSUNG', 'THERMAL VESSEL-TANK', 'COFFEE M-MEDIA TECH', 'TV-43-LG', 'VC-MIENTA', 'F.PROC-PANASONIC', 'FRAYER-MODEX', 'AUDIO-PHILIPS', 'WALL HOOD-UNIVERSAL', 'D WASHER-INDESIT', 'D WASHER-LG', 'ELE HEATER-ATLANTIC', 'TV-43-SMRT-PLUTO', 'AC-HOT/COLD-2.25HP-PREMIUM', 'M.MINCER-MODEX', 'COMPLEMENTARY-NIKON', 'MICROWAVE-TORNADO', 'THERMAL VESSEL-TIGER', 'KETTLE-ARIETE', 'HOBS-INDESIT', 'WD-WHITE POINT', 'TV-32-TORNADO', 'R.COOKER-MODEX', 'AC ACCESSORY-PREMIUM', 'FAN-NIKAI', 'MICROWAVE-LG', 'MIXER-GOLDI', 'CHOPPER-TORNADO', 'D WASHER-BeKO', 'BLENDER-MIENTA', 'WARMER-BLACK AND DECAR', 'TV-50-ULTRA', 'AC-COLD-3HP-MIDEA', 'DEEP FREEZER-KIRIAZI', 'MICROWAVE-ZANUSSI', 'VC-LG', 'GRILL-FRESH', 'TV-ACCESSORY-FALCON', 'AC-HOT/COLD-1.5HP-HAIER', 'MIXER-MEDIA TECH', 'WASHING M-Toshiba', 'COFFEE M-SONAI', 'FILTER 5 STAGES-SEASONS', 'BLENDER-BOSCH', 'VC-BISSELL', 'WARMER-TORNADO', 'VC-PANASONIC', 'TV-ACCESSORY-ITEL', 'AUDIO-ORAIMO', 'IRON-MODEX', 'OVEN-INDESIT', 'F.PROC-ULTRA', 'JUICER-KENWOOD', 'TV-55-SMRT-HI-LG', 'TV-ACCESSORY-FLAT', 'BMOBILE ACCESSORIES', 'TV-32-ULTRA', 'TV-75-SMRT-SAMSUNG', 'COOKER-ROYAL', 'AC-HOT/COLD-1.5HP-BEKO', 'MIXER-MODEX', 'GIFT-SAMSUNG', 'VC-BLACK AND WHITE', 'AIR FRYER-KENWOOD', 'FUN LINE-ZAHRAN', 'WASHING M-ARISTON', 'VC-KENWOOD', 'TV-43-SMRT-LG', 'BLENDER-SMART', 'D WASHER-BOSCH', 'COFFEE M-SOLAC', 'BLENDER-ULTRA', 'AC-COLD-2.25HP-UNION AIRE', 'KETTLE-BLACK AND DECAR', 'WASHING M-FAGOR', 'KETTLE-KENWOOD', 'AC-COLD-2.25HP-TORNADO', 'H.MIXER-BRAUN', 'COMPLEMENTARY-EPSON', 'AC-COLD-3HP-LG', 'KETTLE-BRAUN', 'AUDIO-MEDIA TECH', 'MICROWAVE-FRESH', 'TV-32-SAMSUNG', 'BMOBILE ACCESSORIES-SONY', 'COFFEE M-BRAUN', 'HAIR DRYER-SOLAC', 'IRON-MIENTA', 'FRIDGE-SHARP', 'M.MINCER-MOULINEX', 'STRAIGHTNERS-RUSH BRUSH', 'H.BLENDER-KENWOOD', 'TOOLS-BOSCH', 'TV-ACCESSORY-LG', 'COFFEE M-SMART', 'MOBILE-VIVO', 'KETTLE-MIENTA', 'MOBILE-APPLE', 'BLENDER-SENCOR', 'TV-32-SMRT-FRESH', 'AC-COLD-1.5HP-FRESH', 'HOOD ASS-ARISTON', 'VC-MIELE', 'TV-32-UNION AIRE', 'WD-FRESH', 'LAM-PHILIPS', 'R.COOKER-HOME TECH', 'GAS HEATER-ATLANTIC', 'AC-COLD-1.5HP-HAIER', 'TV-32-SMRT-HAIER', 'COFFEE M-MIELE', 'COFFEE M-TORNADO', 'WD-SPEED', 'TV-ACCESSORY-KEENDEX', 'ALEXA ECHO DOT-ALEXA', 'COMPLEMENTARY-CANON', 'CURL IRONS-BABYLISS', 'GAS HEATER-WHITE POINT', 'FRIDGE-TOSHIBA', 'COMPLEMENTARY-BENQ', 'COOKER-WHITE WHALE', 'LAPTOP-DELL', 'AUDIO-FIRST', 'AC-HOT/COLD-1.5HP-FRESH', 'RECIEVER-TIGER', 'LAPTOP-HP', 'E.HOT PLATE-HOME TECH', 'H.MIXER-MIENTA', 'H.MIXER-TORNADO', 'HOOD-BOSCH', 'H.MIXER-MODEX', 'WASHING M-KIRIAZI', 'WASHING M-BOSCH', 'AC-COLD-1.5HP-TORNADO', 'OVEN-ICOOK', 'COMPLEMENTARY-SONY', 'VC-PHILIPS', 'AC ACCESSORY-CRAFT', 'AC-COLD-1.5HP-PREMIUM', 'TV-65-SMRT-TORNADO', 'TV-43-SMRT-TORNADO', 'MOBILE-XIAOMI', 'COFFEE M-BEKO', 'E.HOT PLATE-TOUCH', 'HOOD-BeKO', 'BMOBILE ACCESSORIES-EZVIZ', 'COFFEE M-DELONGHI', 'HOBS-HOOVER', 'FRIDGE-BOSCH', 'AC-HOT/COLD-2.25HP-CARRIERE', 'M.MINCER-BLACK AND WHITE', 'JUICER-MODEX', 'IRON-KENWOOD', 'HOOD ASS-INDESIT', 'MICROWAVE-ARISTON', 'MOSQ.KILL-HOME TECH', 'AUDIO-DOB', 'TV-ACCESSORY-NOUR TECH', 'FRIDGE-PASSAP', 'F.PROC-MODEX', 'AC-HOT/COLD-1.5HP-SHARP', 'KITCHEN M-FRESH', 'KITCHEN M-HOME TECH', 'TV-32-SMRT-SHARP', 'WASHING M-FRESH', 'WARMER-TOUCH', 'TV-32-SONY', 'H.MIXER-BOSCH', 'COOKER-FRESH', 'RECEIVER-ETI', 'BMOBILE ACCESSORIES-MUSIC HERO', 'MASHER-KENWOOD', 'D WASHER-WHITE POINT', 'TABLET-APPLE', 'HOOD-TORNADO', 'FRAYER-TEFAL', 'HOBS-ZANUSSI', 'FRIDGE-UNION AIRE', 'VC-SAMSUNG', 'D WASHER-ARISTON', 'MOBILE-REALME', 'TV-50-SMRT-TOSHIBA', 'MINCER-BLACK AND DECAR', 'TV-75-SMRT-UNION AIRE', 'FAN-UNION AIRE', 'HAIR DRYER-RUSH BRUSH', 'COMPLEMENTARY-SAMSUNG', 'TV-55-SMRT-LG', 'GRILL-HOME TECH', 'ELE HEATER-ARISTON', 'AC-HOT/COLD-1.5HP-PREMIUM', 'F.PROC-SMART', 'COFFEE M-BOSCH', 'OVEN-TOUCH', 'M.MINCER-KENWOOD', 'AC ACCESSORY-SHARP', 'BLENDER-TOUCH', 'MINCER-HOME TECH', 'FRAYER-PHILIPS', 'AC-HOT/COLD-2.25HP-UNION AIRE', 'TABLET-TCL', 'TV-32-SMRT-NIKAI', 'SHAVING_TRI-HAPILLINE', 'HOBS-GORENJE', 'AC-HOT/COLD-4HP-LG', 'LAPTOP-ASUS', 'DEEP FREEZER-INDESIT', 'CHOPPER-MEDIA TECH', 'FRIDGE-IDEAL', 'FRIDGE-ARISTON', 'GAS HEATER-KIRIAZI', 'H.MIXER-KENWOOD', 'GAS HEATER-PREMIUM', 'AC-HOT/COLD-2.25HP-GENERAL ELECTRIC', 'KETTLE-MEDIA TECH', 'BLENDER-PANASONIC', 'OVEN-ARISTON', 'AC-HOT/COLD-5HP-LG', 'TV-32-TOSHIBA', 'FRAYER-MEDIA TECH', 'TV-ACCESSORY-TRUMAN', 'IRON-PANASONIC', 'TOASTER-KENWOOD', 'AC-HOT/COLD-1.5HP-CRAFT', 'AIR STYLER-BABYLISS', 'AC-HOT/COLD-1.5HP-LG', 'WASHING M-WHITE POINT', 'IRON-BLACK AND DECAR', 'H.BLENDER-ZADA', 'ELE HEATER-TORNADO', 'KETTLE-BLACK AND WHITE', 'AC ACCESSORY-LG', 'WASHING M-TORNADO', 'JUICER-HOME TECH', 'BMOBILE ACCESSORIES-HP', 'CHOPPER-FRESH', 'HOOD-ELBA', 'BUNDLE- B-IN-INDESIT', 'THERMAL VESSEL-SEASONS', 'H.BLENDER-BRAUN', 'FRAYER-HOME TECH', 'WARMER-ULTRA', 'GAS HEATER-NIKAI', 'MOBILE-HONOR', 'MOBILE-LAVA', 'TV-65-SMRT-SHARP', 'KITCHEN M-ARIETE', 'FILTER 7 STAGES-SEASONS', 'CHOPPER-MIENTA', 'TV-43-ULTRA', 'H.MIXER-BLACK AND WHITE', 'DEEP FREEZER-SHARP', 'FUN LINE-ARIETE', 'THERMAL VESSEL-TEFAL', 'WD-GRAND', 'DEEP FREEZER-ARISTON', 'FRIDGE-ELECTROSTAR', 'AC ACCESSORY-ZANUSSI', 'F.PROC-ARIETE', 'WASHING M-HAIER', 'IRON-TOUCH', 'COOKER-BEKO', 'KETTLE-ULTRA', 'FAN-KENWOOD', 'COFFEE M-PHILIPS', 'ELE HEATER-ZANUSSI', 'KETTLE-SMART', 'M.MINCER-BOSCH', 'TV-43-SMRT-UNION AIRE', 'LAPTOP-HUAWEI', 'MICROWAVE-SAMSUNG', 'OVEN-GORENJE', 'AC-HOT/COLD-2.25HP-SHARP', 'COOKER-PREMIUM', 'AC-COLD-2.25HP-FRESH', 'AC-HOT/COLD-1.5HP-HISENSE', 'HOOD-PREMIER', 'F.PROC-SONAI', 'BMOBILE ACCESSORIES-ORIGINAL', 'AC-COLD-3HP-CARRIERE', 'KETTLE-FRESH', 'DEEP FREEZER-TOSHIBA Midea', 'MASHER-MIENTA', 'F.PROC-KENWOOD', 'STRAIGHTNERS-BRAUN', 'HOOD-FRANKE', 'FAN-TORNADO', 'WASHING M-INDESIT', 'HOBS-GLEMGAS', 'BLENDER-TORNADO', 'F.PROC-BLACK AND DECAR', 'AC-HOT/COLD-1.5HP-ULTRA', 'D WASHER-MIELE', 'MIXER-BLACK AND WHITE', 'TV-ACCESSORY-ICONZ', 'F.PROC-HOME TECH', 'AC-HOT/COLD-3HP-SHARP', 'JUICER-BOSCH', 'AC-HOT/COLD-3HP-UNION AIRE', 'M.MINCER-TOUCH', 'H.MIXER-SONAI', 'SHAVING_TRI-RUSH BRUSH', 'TV-32-CONTEX', 'AC-HOT/COLD-2.25HP-ULTRA', 'HOBS-FAGOR', 'AUDIO-LG', 'MIXER-ULTRA', 'TV-43-SMRT-SHARP', 'AC-HOT/COLD-1.5HP-AMERICOOL', 'STRAIGHTNERS-REMINGTON', 'TOASTER-TORNADO', 'DEEP FREEZER-WHITE WHALE', 'AIR COOLER-HOME TECH', 'CHOPPER-BOSCH', 'FRAYER-FRESH', 'TV-50-SMRT-SAMSUNG', 'SHAVING_TRI-REMINGTON', 'OVEN-MIENTA', 'KETTLE-SONAI', 'JUICER-MIENTA', 'VC ACCESSORIES-MIELE', 'BLENDER-MODEX', 'COMPLEMENTARY-DELL', 'ESPRESSO MACH-ARIETE', 'DEEP FREEZER-PASSAP', 'WASHING M-CANDY', 'WASHING M-HOOVER', 'ELE HEATER-TOSHIBA', 'HOBS-ELBA', 'AC-HOT/COLD-1.5HP-UNION AIRE', 'KETTLE-TORNADO', 'TV-65-SMRT-HI-LG', 'HOBS-BEKO', 'FILTER 3 STAGES-SEASONS', 'AC-COLD-1.5HP-CRAFT', 'TV-50-SMRT-HI-LG', 'H.BLENDER-BLACK AND WHITE', 'TABLET-HUAWEI', 'HOBS-NARDI', 'AUDIO-ICONZ', 'GAS HEATER-UNIVERSAL', 'FUN LINE-SONAI', 'OVEN-FRANKE', 'BMOBILE ACCESSORIES-DAHUA', 'TV-75-SMRT-LG', 'TV-32-SMRT-PREMIUM', 'BMOBILE ACCESSORIES-NI', 'GIFT-DAEWOO', 'R.COOKER-TEFAL', 'AC-COLD-2.25HP-GENERAL ELECTRIC', 'BLENDER-ARIETE', 'OVEN-TORNADO', 'FRAYER-MIELE', 'ELE HEATER-SHTEBEL', 'STRAIGHTNERS-BABYLISS', 'KITCHEN M-MOULINEX', 'VC-TEFAL', 'COMPLEMENTARY-XIAOMI', 'FRIDGE-SAMSUNG', 'OVEN-ULTRA', 'FAN-PANASONIC', 'KETTLE-ZAHRAN', 'TV-65-SMRT-SAMSUNG', 'E.HOT PLATE-SMART', 'RECEIVER-TRUMAN', 'CHOPPER-ROVO', 'TV-32-SMRT-TOSHIBA', 'TV-43-SMRT-TOSHIBA', 'IRON-TORNADO', 'COMPLEMENTARY-HAVIT', 'TOOLS-HITACHI', 'TV-55-SMRT-PREMIUM', 'COFFEE M-WHITE WHALE', 'TV-32-SARY', 'AIR COOLER-FRESH', 'TV-40-SMRT-SAMSUNG', 'WASHING M-MIELE', 'BMOBILE ACCESSORIES-TOSHIBA', 'MOBILE-SAMSUNG', 'LAPTOP-MSI', 'AIR STYLER-RUSH BRUSH', 'AUDIO-F&D', 'AC-COLD-1.5HP-ULTRA', 'MICROWAVE-HOOVER', 'FAN-SONAI', 'COOKER-KIRIAZI', 'TV-ACCESSORY-HAMA', 'STRAIGHTNERS-TORNADO', 'TV-55-SMRT-SAMSUNG', 'TV-ACCESSORY-ELIOS', 'VC-MODEX', 'AC-HOT/COLD-3HP-GENERAL ELECTRIC', 'KITCHEN M-KENWOOD', 'R.COOKER-BLACK AND DECAR', 'CHOPPER-TOUCH', 'AC ACCESSORY-HAIER', 'GAS HEATER-OLYMPIC', 'H.BLENDER-MIENTA', 'HOBS-SMART', 'M.MINCER-PANASONIC', 'GAS HEATER-TORNADO', 'OVEN-BOSCH', 'H.BLENDER-TOUCH', 'DEEP FREEZER-ALASKA', 'F.PROC-TORNADO', 'BMOBILE ACCESSORIES-LAVVENTO', 'GRILL-MEDIA TECH', 'M.MINCER-TORNADO', 'FUN LINE-TORNADO', 'GAS HEATER-ARION', 'TV-ACCESSORY-ILOOK', 'GRILL-MODEX', 'MIXER-UNION AIRE', 'VC-ULTRA', 'JUICER-MEDIA TECH', 'ELE HEATER-UNIVERSAL', 'CHOPPER-ULTRA', 'COOKER-UNION AIRE', 'WALL HOOD-TORNADO', 'AC-HOT/COLD-1.5HP-TORNADO', 'WASHING M-TOSHIBA', 'TV-65-SMRT-LG', 'D WASHER-BEKO', 'TV-60-SMRT-TORNADO', 'MINCER-WHITE WHALE', 'AC-HOT/COLD-3HP-ULTRA', 'IRON-TEFAL', 'MIXER-TOUCH', 'LAPTOP-MICROSOFT', 'GRILL-TOUCH', 'AC-COLD-3HP-TORNADO', 'TV-43-SMRT-HAIER', 'IRON-SMART', 'AC-COLD-2.25HP-SHARP', 'AC-HOT/COLD-1.5HP-MIDEA', 'KITCHEN M-TOUCH', 'AC-HOT/COLD-1.5HP-ZANUSSI', 'IRON-ULTRA', 'AC-COLD-1.5HP-UNION AIRE', 'AC-HOT/COLD-4HP-SHARP', 'KETTLE-TOUCH', 'HAIR DRYER-PHILIPS', 'GRILL-TEFAL', 'COFFEE GRINDER-ARIETE', 'ELE HEATER-VEITO', 'COFFEE M-MODEX', 'TABLET-SAMSUNG', 'H.MIXER-ROVO', 'AC-HOT/COLD-3HP-CARRIERE', 'WALL HOOD-TOSHIBA', 'KITCHEN M-BLACK AND WHITE', 'KETTLE-PANASONIC', 'GIFT-INFINX', 'AC-HOT/COLD-2.25HP-TORNADO', 'AIR PURIFIER-LG', 'AC-COLD-3HP-SHARP', 'TV-50-SMRT-SHARP', 'MICROWAVE-BLACK AND DECAR', 'H.BLENDER-MOULINEX', 'WASHING M-BEKO', 'FRIDGE-ULTRA', 'FRIDGE-WHITE WHALE', 'WD-KOLDAIR', 'HOOD-GORENJE', 'FRIDGE-HAIER', 'TV-85-SMRT-HI-LG', 'JUICER-MOULINEX', 'DEEP FREEZER-TOSHIBA', 'FAN-FRESH', 'BLENDER-BLACK AND WHITE', 'GRILL-KENWOOD', 'F.PROC-UNION AIRE', 'WASHING M-SHARP', 'MICROWAVE-DAEWOO', 'TV-32-HAIER', 'AC-COLD-2.25HP-CARRIERE', 'FRIDGE-KIRIAZI', 'BLENDER-MOULINEX', 'TV-32-FRESH', 'NON', 'SPORT MACHINE-KHATER', 'HOOD-ARISTON', 'TOASTER-HOME TECH', 'FAN-UNIVERSAL', 'CAPPUCCINO MAKER-ARIETE', 'RECEIVER-DALY', 'AIR COOLER-TORNADO']} the_received_subfilter
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
1366.595739311 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', Decimal('11758.7683247112756766')), ('proposed_sellthru_percent', Decimal('9.1492581023037876')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('27.4787111154496941')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 27.478711115449695), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 1564401541.2620547), ('budget_cost', 954765123.1099868), ('deficit', Decimal('1564401541.2233')), ('Original_BudgetAmount', Decimal('1564401541.2233')), ('budget_percent', Decimal('99.8578')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 619895.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('954765123.1100')), ('PO', Decimal('1272173792.5233')), ('COSTPRICE', 176226570.29000092), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('441256')), ('net_sales_ly', Decimal('542598837.4600')), ('net_sales_lly', Decimal('347973.4000')), ('gross_sales_ly', Decimal('555062511.7900')), ('total_sku_count', Decimal('114950')), ('ly_customer_disc', Decimal('12463674.3300')), ('SupplyCost', Decimal('907026866.9555')), ('SALESQTY', 104890.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('103.1495')), ('budget_qty_act_fct_percent', Decimal('61989500.0000')), ('budget_vs_py_qty_percent', Decimal('54058575.2879')), ('budget_vs_ppy_qty_percent', Decimal('61985268.1811')), ('QTY_Buy_By_SKU', Decimal('619895.0000')), ('total_sku_count_ty', Decimal('7555708056')), ('total_sku_count_lly', Decimal('41')), ('total_sku_count_ly', Decimal('11137')), ('quantity_mix_percent', Decimal('100.1460')), ('quantity_act_forecast', Decimal('619895.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('104617.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('10038300.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.3551')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('954765123.1100')), ('budget_vs_py_cost_percent', Decimal('17234755999.0000')), ('budget_vs_ppy_cost_percent', Decimal('48111602.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('176017860.7600')), ('cost_act_forecast', Decimal('954765123.1100')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('67254598559.1910')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('4.2410')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('13609.4332')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('13609.4332')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
1366.805669609 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 0.0       ┆ 11758.768 ┆ … ┆ 0.0       ┆ 13609.433 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆           ┆ 325       ┆   ┆           ┆ 2         ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 67.560222         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1.2464e7   ┆ 5.4260e8   ┆ 1.5644e9   ┆ 42.02084  ┆ 1.6003e9  ┆ 9.149258  ┆ 1.7491e10 ┆ 2.245454  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A6972ABD60>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A6972AA500>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A6972ABEB0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972ABCA0>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A6972ABDC0>, <Expr ['col("retail_value_including_ma…'] at 0x76A6972AB820>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A6972AB940>, <Expr ['col("Logistic%").mean()'] at 0x76A6972ABAF0>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A6972AA4D0>, <Expr ['col("MarkdownValue").mean()'] at 0x76A6972AB730>, <Expr ['col("markdown_percent").mean()'] at 0x76A6972AA4A0>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A6972ABFD0>, <Expr ['col("budget_amount").sum()'] at 0x76A6972AB7F0>, <Expr ['col("budget_cost").sum()'] at 0x76A6972A9900>, <Expr ['col("deficit").sum()'] at 0x76A6972AA530>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A6972AB7C0>, <Expr ['col("budget_percent").sum()'] at 0x76A6972ABD30>, <Expr ['col("relative_budget_percent")…'] at 0x76A6972AA7D0>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A6972AA770>, <Expr ['col("budget_qty").sum()'] at 0x76A6972AA830>, <Expr ['col("ACT_FCT").sum()'] at 0x76A6972AB910>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A6972AA710>, <Expr ['col("PO").sum()'] at 0x76A6972AA740>, <Expr ['col("COSTPRICE").sum()'] at 0x76A6972AA6E0>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A6972AA620>, <Expr ['col("sales_actual").sum()'] at 0x76A6972AA920>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A6972AAB00>, <Expr ['col("net_sales_ly").sum()'] at 0x76A6972AA9B0>, <Expr ['col("net_sales_lly").sum()'] at 0x76A6972AAAD0>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A6972AA8F0>, <Expr ['col("total_sku_count").sum()'] at 0x76A6972AAA40>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A6972AAD70>, <Expr ['col("SupplyCost").sum()'] at 0x76A6972AAE60>, <Expr ['col("SALESQTY").sum()'] at 0x76A6972AA950>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A6972AAB60>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A6972AAEF0>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A6972AAE90>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A6972AA650>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A6972AAD10>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A6972AA590>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A6972AB0A0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A6972AB130>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A6972AAF50>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A6972AABF0>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A6972AB100>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A6972AB040>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972AB2E0>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A6972AAFB0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972AB3D0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A6972AAC20>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972AB280>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A6972ABEE0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A6972AB4C0>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A6972AB5E0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A6972AB430>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A6972AB460>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A6972AB1C0>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A6972AB670>, <Expr ['col("cost_actuals").sum()'] at 0x76A6972ABF40>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A6972AB550>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A6972AB2B0>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A6972AA410>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A6972AA3E0>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A6972AA320>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A6972AB520>, <Expr ['col("budget_margin_percent").s…'] at 0x76A6972AB6A0>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A6972AA380>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A6972AA1D0>, <Expr ['col("margin_actuals").sum()'] at 0x76A6972ABDF0>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A6972AA0B0>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A6972AA350>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A6972ABB20>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A6972AAC80>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A6972AA020>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A6972AA2F0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972A9FC0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972A9F60>, <Expr ['col("budget_per_sku").sum()'] at 0x76A6972AA470>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A6972A9DE0>, <Expr ['col("Check_box").max()'] at 0x76A6972AA050>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,0.0,11758.7683247113,9.1492581023,1600336360.8479478359,38.9693056464,5.0,38.9693056464,1246367433.0000002384,2.2454541723,0.0,1564401541.2620546818,954765123.1099867821,1564401541.2232999802,1564401541.2232999802,100.0,100.0,0.0,619895.0,0.0,954765123.1100000143,1272173792.5232999325,176226570.2900009155,0.0,0.0,441256.0,542598837.4600000381,347973.4,555062511.7899999619,114950.0,12463674.3300000001,907026866.9555000067,104890.0,0.0,0.0,103.1495,61989500.0,54058575.2879000008,61985268.1811000034,619895.0,7555708056.0,41.0,11137.0,100.146,619895.0,0.0,104617.0,10038300.0,0.0,0.0,0.3551,0.0,0.0,954765123.1100000143,17234755999.0,48111602.0,0.0,0.0,176017860.7599999905,954765123.1100000143,0.0,0.0,0.0,0.0,67254598559.1910018921,0.0,0.0,0.0,0.0,4.241,0.0,13609.4332,0.0,0.0,0.0,0.0,13609.4332,0.0,0.0,288.3164196564,449575.0368453608,0.0,0.0,100.0,0.0,42.0208403641,5188627075.88879776,67.5602215471,366580976.7000000477,0.0,0.0,609636418.1520678997,9023600.0443988796,5188627075.88879776,1683179128.1651751995,5188627075.88879776,1600336360.8479475975,1564401541.2620549202,17491433108.0569534302,10141385924.3347568512,6584440.7963792915]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":11758.7683247113,"proposed_sellthru_percent":9.1492581023,"retail_value_including_markdown":1600336360.8479478359,"budget_gross_margin_percent":38.9693056464,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":38.9693056464,"MarkdownValue":1246367433.0000002384,"markdown_percent":2.2454541723,"DisplayItemValue":0.0,"budget_amount":1564401541.2620546818,"budget_cost":954765123.1099867821,"deficit":1564401541.2232999802,"Original_BudgetAmount":1564401541.2232999802,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":619895.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":954765123.1100000143,"PO":1272173792.5232999325,"COSTPRICE":176226570.2900009155,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":441256.0,"net_sales_ly":542598837.4600000381,"net_sales_lly":347973.4,"gross_sales_ly":555062511.7899999619,"total_sku_count":114950.0,"ly_customer_disc":12463674.3300000001,"SupplyCost":907026866.9555000067,"SALESQTY":104890.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":103.1495,"budget_qty_act_fct_percent":61989500.0,"budget_vs_py_qty_percent":54058575.2879000008,"budget_vs_ppy_qty_percent":61985268.1811000034,"QTY_Buy_By_SKU":619895.0,"total_sku_count_ty":7555708056.0,"total_sku_count_lly":41.0,"total_sku_count_ly":11137.0,"quantity_mix_percent":100.146,"quantity_act_forecast":619895.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":104617.0,"quantity_act_forecast_vs_ly_percent":10038300.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.3551,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":954765123.1100000143,"budget_vs_py_cost_percent":17234755999.0,"budget_vs_ppy_cost_percent":48111602.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":176017860.7599999905,"cost_act_forecast":954765123.1100000143,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":67254598559.1910018921,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":4.241,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":13609.4332,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":13609.4332,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":67.5602215471,"FirstMargin_percent":42.0208403641,"budget_vpy":288.3164196564,"budget_vppy":449575.0368453608,"StockatRetailPrice":5188627075.88879776,"TYForecast":5188627075.88879776,"LYvsACT_FCT_percent":100.0,"supply_retail_value":1564401541.2620549202} } data_json
INFO:     106.51.119.229:0 - "OPTIONS /otb/export/to_excel HTTP/1.1" 200 OK
INFO:     106.51.119.229:0 - "POST /otb/export/to_excel HTTP/1.1" 200 OK
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 11758.7683247113, 'proposed_sellthru_percent': 9.1492581023, 'retail_value_including_markdown': 1600336360.8479478, 'budget_gross_margin_percent': 38.9693056464, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 38.9693056464, 'MarkdownValue': 1246367433.0000002, 'markdown_percent': 2.2454541723, 'DisplayItemValue': 0, 'budget_amount': 1564401541.2620547, 'budget_cost': 954765123.1099868, 'deficit': 1564401541.2233, 'Original_BudgetAmount': 1564401541.2233, 'budget_percent': 100, 'relative_budget_percent': 100, 'History_Net_Sales': 0, 'budget_qty': 619895, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 954765123.11, 'PO': 1272173792.5233, 'COSTPRICE': 176226570.29000092, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 441256, 'net_sales_ly': 542598837.46, 'net_sales_lly': 347973.4, 'gross_sales_ly': 555062511.79, 'total_sku_count': 114950, 'ly_customer_disc': 12463674.33, 'SupplyCost': 907026866.9555, 'SALESQTY': 104890, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 103.1495, 'budget_qty_act_fct_percent': 61989500, 'budget_vs_py_qty_percent': 54058575.2879, 'budget_vs_ppy_qty_percent': 61985268.1811, 'QTY_Buy_By_SKU': 619895, 'total_sku_count_ty': 7555708056, 'total_sku_count_lly': 41, 'total_sku_count_ly': 11137, 'quantity_mix_percent': 100.146, 'quantity_act_forecast': 619895, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 104617, 'quantity_act_forecast_vs_ly_percent': 10038300, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.3551, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 954765123.11, 'budget_vs_py_cost_percent': 17234755999, 'budget_vs_ppy_cost_percent': 48111602, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 176017860.76, 'cost_act_forecast': 954765123.11, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 67254598559.191, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 4.241, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 13609.4332, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 13609.4332, 'budget_qty_ty': 0, 'Check_box': 0, 'budget_vpy': 288.3164196564, 'budget_vppy': 449575.0368453608, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 100, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 42.0208403641, 'PurchasedRetailValueGrossSale': 5188627075.888798, 'ly_margin_percent': 67.5602215471, 'ly_margin': 366580976.70000005, 'margin_act_forecast_vs_ly_margin_percent': 0, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 609636418.1520679, 'budget_vs_py_margin_percent': 9023600.04439888, 'StockatRetailPrice': 5188627075.888798, 'StockatCostPrice': 1683179128.1651752, 'TYForecast': 5188627075.888798, 'GrossSales': 1600336360.8479476, 'supply_retail_value': 1564401541.262055, 'PurchaseRetailValueatGrossSale': 17491433108.056953, 'OTBorPurchaseCost': 10141385924.334757, 'OTBquantity': 6584440.796379291}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
[] [] the expand heirarchy
sku wise calc executed
1368.500224482 end of sku wise stored proc
we are finding corr ex2
['Channel'] FILTERDATA5
drilldown procedure start
conn established
['Channel'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] []   get_sp_otb_expand_heirarchy
sku wise calc executed
1368.522370378 end of sku wise stored proc
conn established
[OrderedDict([('Channel', 'ARKAN'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('72.2500000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 72.25), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 1201763.972404484), ('budget_cost', 381655.07), ('deficit', Decimal('1201763.9727')), ('Original_BudgetAmount', Decimal('1201763.9727')), ('budget_percent', Decimal('0.0766')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 67.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('381655.0700')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('893')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('32')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('362572.3165')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0115')), ('budget_qty_act_fct_percent', Decimal('6700.0000')), ('budget_vs_py_qty_percent', Decimal('6700.0000')), ('budget_vs_ppy_qty_percent', Decimal('6700.0000')), ('QTY_Buy_By_SKU', Decimal('67.0000')), ('total_sku_count_ty', Decimal('1123392')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('67.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('381655.0700')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('381655.0700')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('82010890.2408')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0003')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('10.4550')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('10.4550')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'B.TECH X'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('24.9815082346142733')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 24.981508234614274), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 26528780.33084482), ('budget_cost', 23526535.730000027), ('deficit', Decimal('26528780.3251')), ('Original_BudgetAmount', Decimal('26528780.3251')), ('budget_percent', Decimal('1.6652')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 11637.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('23526535.7300')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('3653')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('6434')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('22350208.9435')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('2.1048')), ('budget_qty_act_fct_percent', Decimal('1163700.0000')), ('budget_vs_py_qty_percent', Decimal('1163700.0000')), ('budget_vs_ppy_qty_percent', Decimal('1163700.0000')), ('QTY_Buy_By_SKU', Decimal('11637.0000')), ('total_sku_count_ty', Decimal('396728625')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('11637.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0020')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('23526535.7300')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('23526535.7300')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('595047784.0850')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0401')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('230.7869')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('230.7869')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'B2B'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('19670.680497398844')), ('proposed_sellthru_percent', Decimal('68.0487804878048780')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('32.9512195121951220')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.951219512195124), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 18064021.32617273), ('budget_cost', 4268327.429999999), ('deficit', Decimal('18064021.3256')), ('Original_BudgetAmount', Decimal('18064021.3256')), ('budget_percent', Decimal('1.1533')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 3641.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('4268327.4300')), ('PO', Decimal('386351.5313')), ('COSTPRICE', 3231866.279999999), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('8')), ('net_sales_ly', Decimal('20895108.0000')), ('net_sales_lly', Decimal('347973.4000')), ('gross_sales_ly', Decimal('21008918.3300')), ('total_sku_count', Decimal('308')), ('ly_customer_disc', Decimal('113810.3300')), ('SupplyCost', Decimal('4054911.0585')), ('SALESQTY', 3727.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.5911')), ('budget_qty_act_fct_percent', Decimal('364100.0000')), ('budget_vs_py_qty_percent', Decimal('111688.4479')), ('budget_vs_ppy_qty_percent', Decimal('359868.1811')), ('QTY_Buy_By_SKU', Decimal('3641.0000')), ('total_sku_count_ty', Decimal('39178228')), ('total_sku_count_lly', Decimal('40')), ('total_sku_count_ly', Decimal('253')), ('quantity_mix_percent', Decimal('3.3054')), ('quantity_act_forecast', Decimal('3641.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('3454.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('276800.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0011')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('4268327.4300')), ('budget_vs_py_cost_percent', Decimal('300931377.0000')), ('budget_vs_ppy_cost_percent', Decimal('48111602.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('3023156.7500')), ('cost_act_forecast', Decimal('4268327.4300')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('1557532411.6168')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0302')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('157.1474')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('157.1474')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'CALL CENTER'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('1464.9523809523809524')), ('proposed_sellthru_percent', Decimal('24.1379310344827586')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('17.6436781609195402')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 17.64367816091954), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 436326.3970658023), ('budget_cost', 527213.74), ('deficit', Decimal('436326.3967')), ('Original_BudgetAmount', Decimal('436326.3967')), ('budget_percent', Decimal('0.0277')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 71.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('527213.7400')), ('PO', Decimal('40765.8843')), ('COSTPRICE', 167194.67), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('7')), ('net_sales_ly', Decimal('30230.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('30764.0000')), ('total_sku_count', Decimal('63')), ('ly_customer_disc', Decimal('534.0000')), ('SupplyCost', Decimal('500853.0530')), ('SALESQTY', 4.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0134')), ('budget_qty_act_fct_percent', Decimal('7100.0000')), ('budget_vs_py_qty_percent', Decimal('7100.0000')), ('budget_vs_ppy_qty_percent', Decimal('7100.0000')), ('QTY_Buy_By_SKU', Decimal('71.0000')), ('total_sku_count_ty', Decimal('5670836')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('15')), ('quantity_mix_percent', Decimal('0.0040')), ('quantity_act_forecast', Decimal('71.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('4.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('400.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('527213.7400')), ('budget_vs_py_cost_percent', Decimal('16719467.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('167194.6700')), ('cost_act_forecast', Decimal('527213.7400')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('11832122.7064')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('3.7957')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('3.7957')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'DEEL'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('16413.999576605903')), ('proposed_sellthru_percent', Decimal('96.7226890756302521')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('63.7693277310924370')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 63.76932773109244), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 392503333.3846699), ('budget_cost', 85289696.13700016), ('deficit', Decimal('392503333.3815')), ('Original_BudgetAmount', Decimal('392503333.3815')), ('budget_percent', Decimal('25.0969')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 72856.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('85289696.1370')), ('PO', Decimal('981840304.4883')), ('COSTPRICE', 87358417.8800002), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('57717')), ('net_sales_ly', Decimal('405277851.0400')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('411783475.0400')), ('total_sku_count', Decimal('4750')), ('ly_customer_disc', Decimal('6505624.0000')), ('SupplyCost', Decimal('81025211.3302')), ('SALESQTY', 74957.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('11.7492')), ('budget_qty_act_fct_percent', Decimal('7285600.0000')), ('budget_vs_py_qty_percent', Decimal('1261810.3330')), ('budget_vs_ppy_qty_percent', Decimal('7285600.0000')), ('QTY_Buy_By_SKU', Decimal('72856.0000')), ('total_sku_count_ty', Decimal('458060480')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('4608')), ('quantity_mix_percent', Decimal('71.6868')), ('quantity_act_forecast', Decimal('72856.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('74957.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('7208200.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0435')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('85289696.1370')), ('budget_vs_py_cost_percent', Decimal('8439102573.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('87358417.8800')), ('cost_act_forecast', Decimal('85289696.1370')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('30723242882.7641')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.6047')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('3414.5564')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('3414.5564')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))])] 11 getData dictsize
1368.822932662 end of fetch data
shape: (11, 81)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ Channel   ┆ final_pri ┆ act_forec ┆ SalesActu ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ---       ┆ ce        ┆ ast_vs_bu ┆ alsByFore ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ str       ┆ ---       ┆ dget_perc ┆ cast      ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│           ┆ f64       ┆ ent       ┆ ---       ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆           ┆ ---       ┆ f64       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆           ┆ f64       ┆           ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ ARKAN     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 10.455    ┆ 0.0       ┆ 0.0      │
│ B.TECH X  ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 230.7869  ┆ 0.0       ┆ 0.0      │
│ B2B       ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 157.1474  ┆ 0.0       ┆ 0.0      │
│ CALL      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 3.7957    ┆ 0.0       ┆ 0.0      │
│ CENTER    ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆          │
│ DEEL      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 3414.5564 ┆ 0.0       ┆ 0.0      │
│ MINI      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 24.6193   ┆ 0.0       ┆ 0.0      │
│ NON       ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 4.9223    ┆ 0.0       ┆ 0.0      │
│ ONLINE    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 1016.6893 ┆ 0.0       ┆ 0.0      │
│ Retail    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 2935.455  ┆ 0.0       ┆ 0.0      │
│ WAREHOUSE ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 5408.9087 ┆ 0.0       ┆ 0.0      │
│ 0         ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 402.0972  ┆ 0.0       ┆ 0.0      │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ -182.414365       │
└───────────────────┘ ly_mgn
shape: (11, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 1.2018e6   ┆ 69.82999  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2.6529e7   ┆ 15.751087 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 113810.33  ┆ 2.0895108e ┆ 1.8064e7   ┆ 77.552556 ┆ 1.8162e7  ┆ 68.04878  ┆ 2.6690e7  ┆ 0.541724  │
│            ┆ 7          ┆            ┆           ┆           ┆           ┆           ┆           │
│ 534.0      ┆ 30230.0    ┆ 436326.397 ┆ -14.78862 ┆ 444033.91 ┆ 24.137931 ┆ 1.8396e6  ┆ 1.735795  │
│            ┆            ┆ 066        ┆ 1         ┆ 5955      ┆           ┆           ┆           │
│ 6.505624e6 ┆ 4.0528e8   ┆ 3.9250e8   ┆ 79.356809 ┆ 3.9880e8  ┆ 96.722689 ┆ 4.1232e8  ┆ 1.579865  │
│ 120819.0   ┆ 2.199974e6 ┆ 2.8301e6   ┆ 24.038323 ┆ 2.9855e6  ┆ 78.729282 ┆ 3.7922e6  ┆ 5.205936  │
│ 38695.0    ┆ 505514.0   ┆ 565820.374 ┆ 65.937801 ┆ 609131.57 ┆ 82.222222 ┆ 740835.70 ┆ 7.11032   │
│            ┆            ┆ 699        ┆           ┆ 7551      ┆           ┆ 2427      ┆           │
│ 5.684192e6 ┆ 1.1369e8   ┆ 1.1687e8   ┆ 30.822653 ┆ 1.2271e8  ┆ 95.20332  ┆ 1.2889e8  ┆ 4.761653  │
│ 0.0        ┆ 0.0        ┆ 3.3743e8   ┆ 18.805384 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 6.2175e8   ┆ 30.340196 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 4.6221e7   ┆ 81.700132 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['Channel', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x7697328E9690>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x7697328EBA90>, <Expr ['col("SalesActualsByForecast").…'] at 0x7697328EBB50>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328E94B0>, <Expr ['col("proposed_sellthru_percent…'] at 0x7697328EB4F0>, <Expr ['col("retail_value_including_ma…'] at 0x7697328E8EE0>, <Expr ['col("budget_gross_margin_perce…'] at 0x7697328E9780>, <Expr ['col("Logistic%").mean()'] at 0x7697328EBEB0>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x7697328EBA60>, <Expr ['col("MarkdownValue").mean()'] at 0x7697328E8220>, <Expr ['col("markdown_percent").mean()'] at 0x7697328EA2F0>, <Expr ['col("DisplayItemValue").mean()'] at 0x7697328EB820>, <Expr ['col("budget_amount").sum()'] at 0x7697328EBDF0>, <Expr ['col("budget_cost").sum()'] at 0x7697328EBCA0>, <Expr ['col("deficit").sum()'] at 0x7697328EB940>, <Expr ['col("Original_BudgetAmount").s…'] at 0x7697328EB730>, <Expr ['col("budget_percent").sum()'] at 0x7697328E8340>, <Expr ['col("relative_budget_percent")…'] at 0x7697328EBFD0>, <Expr ['col("History_Net_Sales").sum()'] at 0x7697328EB8E0>, <Expr ['col("budget_qty").sum()'] at 0x7697328E80D0>, <Expr ['col("ACT_FCT").sum()'] at 0x7697328E8070>, <Expr ['col("Original_BudgetCostofGood…'] at 0x7697328EB880>, <Expr ['col("PO").sum()'] at 0x7697328E81C0>, <Expr ['col("COSTPRICE").sum()'] at 0x7697328EA890>, <Expr ['col("Historical_Gross_Margin")…'] at 0x7697328E8160>, <Expr ['col("sales_actual").sum()'] at 0x7697328EAC80>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x7697328EBF10>, <Expr ['col("net_sales_ly").sum()'] at 0x7697328EAA10>, <Expr ['col("net_sales_lly").sum()'] at 0x7697328EA950>, <Expr ['col("gross_sales_ly").sum()'] at 0x7697328EAD70>, <Expr ['col("total_sku_count").sum()'] at 0x7697328E8F40>, <Expr ['col("ly_customer_disc").sum()'] at 0x7697328EA9B0>, <Expr ['col("SupplyCost").sum()'] at 0x7697328EAB60>, <Expr ['col("SALESQTY").sum()'] at 0x7697328E9540>, <Expr ['col("DisplayItemQty").sum()'] at 0x7697328EAE30>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x7697328EAEC0>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x7697328E82B0>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x7697328E8100>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x7697328E8250>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x7697328EACB0>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x7697328E89A0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x7697328E8310>, <Expr ['col("total_sku_count_lly").sum…'] at 0x7697328E9A50>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x7697328E99F0>, <Expr ['col("quantity_mix_percent").su…'] at 0x7697328E98D0>, <Expr ['col("quantity_act_forecast").s…'] at 0x7697328E9AB0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328E8700>, <Expr ['col("sold_qty_ly").sum()'] at 0x7697328E9A20>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328EAE00>, <Expr ['col("quantity_act_or_forecast_…'] at 0x7697328E8C40>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328E9C30>, <Expr ['col("budget_cost_percent").sum…'] at 0x7697328E8910>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x7697328EAFE0>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x7697328E8280>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x7697328E8A60>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x7697328E9D50>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x7697328E9CF0>, <Expr ['col("cost_mix_percent").sum()'] at 0x7697328E9C60>, <Expr ['col("cost_actuals").sum()'] at 0x7697328E8730>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x7697328E8B20>, <Expr ['col("cost_act_forecast").sum()'] at 0x7697328EAB30>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x7697328E9EA0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x7697328E9D20>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x7697328E9E70>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x7697328E9BD0>, <Expr ['col("budget_margin_percent").s…'] at 0x7697328EA050>, <Expr ['col("budget_margin_mix_percent…'] at 0x7697328E9F00>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x7697328E8A30>, <Expr ['col("margin_actuals").sum()'] at 0x7697328E9CC0>, <Expr ['col("margin_act_forecast").sum…'] at 0x7697328EBAF0>, <Expr ['col("units_per_sku_total").sum…'] at 0x7697328E8CA0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x7697328E8940>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x7697328E9FF0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x7697328EA140>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x7697328E9FC0>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328EACE0>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328E8D30>, <Expr ['col("budget_per_sku").sum()'] at 0x7697328EA020>, <Expr ['col("budget_qty_ty").sum()'] at 0x7697328E9D80>, <Expr ['col("Check_box").max()'] at 0x7697328E8D90>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Channel","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9],"data":[["ARKAN",0.0,0.0,0.0,0.0,0.0,null,68.2420942245,5.0,68.2420942245,null,null,0.0,1201763.9724044839,381655.07,1201763.9727,1201763.9727,0.0768194061,0.0768194061,0.0,67.0,0.0,381655.07,0.0,0.0,0.0,0.0,893.0,0.0,0.0,0.0,32.0,0.0,362572.3165,0.0,0.0,0.0,0.0115,6700.0,6700.0,6700.0,67.0,1123392.0,0.0,0.0,0.0,67.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,381655.07,0.0,0.0,0.0,0.0,0.0,381655.07,0.0,0.0,0.0,0.0,82010890.2407999933,0.0,0.0,0.0,0.0,0.0003,0.0,10.455,0.0,0.0,0.0,0.0,10.455,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,69.8299895133,0.0,0.0,0.0,null,0.0,820108.9024044839,0.0,0.0,0.0,0.0,0.0,1201763.9724044839,null,null,null],["B.TECH X",0.0,0.0,0.0,0.0,0.0,null,11.31693415,5.0,11.31693415,null,null,0.0,26528780.3308448195,23526535.7300000265,26528780.3251000009,26528780.3251000009,1.6957782022,1.6957782022,0.0,11637.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,3653.0,0.0,0.0,0.0,6434.0,0.0,22350208.943500001,0.0,0.0,0.0,2.1048,1163700.0,1163700.0,1163700.0,11637.0,396728625.0,0.0,0.0,0.0,11637.0,0.0,0.0,0.0,0.0,0.0,0.002,0.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,595047784.0850000381,0.0,0.0,0.0,0.0,0.0401,0.0,230.7869,0.0,0.0,0.0,0.0,230.7869,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,15.7510874425,0.0,0.0,0.0,null,0.0,3002244.600844793,0.0,0.0,0.0,0.0,0.0,26528780.3308448195,null,null,null],["B2B",0.0,0.0,0.0,19670.6804973988,68.0487804878,18162411.4483132213,76.3711116538,5.0,76.3711116538,11381033.0,0.5417238918,0.0,18064021.3261727318,4268327.4299999988,18064021.3255999982,18064021.3255999982,1.1546921203,1.1546921203,0.0,3641.0,0.0,4268327.4299999997,386351.5313,3231866.2799999989,0.0,0.0,8.0,20895108.0,347973.4,21008918.3299999982,308.0,113810.33,4054911.0584999998,3727.0,0.0,0.0,0.5911,364100.0,111688.4479,359868.1811,3641.0,39178228.0,40.0,253.0,3.3054,3641.0,0.0,3454.0,276800.0,0.0,0.0,0.0011,0.0,0.0,4268327.4299999997,300931377.0,48111602.0,0.0,0.0,3023156.75,4268327.4299999997,0.0,0.0,0.0,0.0,1557532411.6168000698,0.0,0.0,0.0,0.0,0.0302,0.0,157.1474,0.0,0.0,0.0,0.0,157.1474,0.0,0.0,86.4509593641,5191.2075251076,0.0,0.0,100.0,0.0,77.5525560711,157365.4439791907,85.5317486275,17871951.25,0.0,0.0,13795693.8961727321,161293.2521262724,157365.4439791907,22768.0280083949,157365.4439791907,18162411.4483132213,18064021.3261727281,26690282.0566610061,5991286.0991384303,5110.7308529428],["CALL CENTER",0.0,0.0,0.0,1464.9523809524,24.1379310345,444033.9159554199,-20.8301270667,5.0,-20.8301270667,53400.0,1.7357950852,0.0,436326.3970658023,527213.74,436326.3967,436326.3967,0.0278909465,0.0278909465,0.0,71.0,0.0,527213.74,40765.8843,167194.67,0.0,0.0,7.0,30230.0,0.0,30764.0,63.0,534.0,500853.053,4.0,0.0,0.0,0.0134,7100.0,7100.0,7100.0,71.0,5670836.0,0.0,15.0,0.004,71.0,0.0,4.0,400.0,0.0,0.0,0.0,0.0,0.0,527213.74,16719467.0,0.0,0.0,0.0,167194.67,527213.74,0.0,0.0,0.0,0.0,11832122.7063999996,0.0,0.0,0.0,0.0,0.0,0.0,3.7957,0.0,0.0,0.0,0.0,3.7957,0.0,0.0,1443.3555973067,0.0,0.0,0.0,0.0,0.0,-14.7886207133,10254.6666666667,-453.0753225273,-136964.67,0.0,0.0,-90887.3429341977,200.6009562102,10254.6666666667,56716.0307407652,10254.6666666667,444033.9159554199,436326.3970658023,1839569.0803867395,2111615.9744448187,284.3718264732],["DEEL",0.0,0.0,0.0,16413.9995766059,96.7226890756,398803897.5511910915,78.2703256552,5.0,78.2703256552,650562400.0,1.5798652433,0.0,392503333.3846698999,85289696.1370001584,392503333.3815000057,392503333.3815000057,25.0896795376,25.0896795376,0.0,72856.0,0.0,85289696.1369999945,981840304.4882999659,87358417.8800002038,0.0,0.0,57717.0,405277851.0400000215,0.0,411783475.0400000215,4750.0,6505624.0,81025211.3302000016,74957.0,0.0,0.0,11.7492,7285600.0,1261810.3330000001,7285600.0,72856.0,458060480.0,0.0,4608.0,71.6868,72856.0,0.0,74957.0,7208200.0,0.0,0.0,0.0435,0.0,0.0,85289696.1369999945,8439102573.0,0.0,0.0,0.0,87358417.8799999952,85289696.1369999945,0.0,0.0,0.0,0.0,30723242882.7640991211,0.0,0.0,0.0,0.0,0.6047,0.0,3414.5564,0.0,0.0,0.0,0.0,3414.5564,0.0,0.0,96.8479605726,0.0,0.0,0.0,0.0,0.0,79.3568093724,947366813.5629628897,78.4448082579,317919433.1600000262,0.0,0.0,307213637.2476697564,3916302.9914958626,947366813.5629628897,204206733.1646729112,947366813.5629628897,398803897.5511909723,392503333.3846699595,412316801.1172174811,85115343.2441636771,72707.0646076158],["MINI",0.0,0.0,0.0,3035.2819354949,78.729281768,2985539.0552947633,20.0403404442,5.0,20.0403404442,12081899.9999999981,5.2059360744,0.0,2830113.8005987788,2262949.3599999985,2830113.8010999998,2830113.8010999998,0.1809071217,0.1809071217,0.0,1218.0,0.0,2262949.3599999999,326005.7196,2001507.1700000004,0.0,0.0,207.0,2199974.0,0.0,2320793.0,695.0,120819.0,2149801.892,1002.0,0.0,0.0,0.2105,121800.0,85899.9998,121800.0,1218.0,64715402.0,0.0,581.0,0.9695,1218.0,0.0,1002.0,97200.0,0.0,0.0,0.0,0.0,0.0,2262949.3599999999,198527517.0,0.0,0.0,0.0,2001507.1699999999,2262949.3599999999,0.0,0.0,0.0,0.0,71360884.058799997,0.0,0.0,0.0,0.0,0.0031,0.0,24.6193,0.0,0.0,0.0,0.0,24.6193,0.0,0.0,128.6430567179,0.0,0.0,0.0,0.0,0.0,24.038323422,628303.3606474403,9.0213261611,198466.8300000001,0.0,0.0,567164.4405987803,62869.2977583136,628303.3606474403,571622.0652021103,628303.3606474403,2985539.0552947633,2830113.8005987788,3792158.3790059802,2880587.083185798,1550.4346360275],["NON",0.0,0.0,0.0,5428.9903918919,82.2222222222,609131.5775514458,64.1450539656,5.0,64.1450539656,3869500.0,7.1103197485,0.0,565820.3746985839,202874.59,565820.3747,565820.3747,0.0361684874,0.0361684874,0.0,112.0,0.0,202874.59,8714.588,146848.65,0.0,0.0,3.0,505514.0,0.0,544209.0,45.0,38695.0,192730.8605,104.0,0.0,0.0,0.0186,11200.0,4860.0,11200.0,112.0,4366090.0,0.0,37.0,0.1001,112.0,0.0,104.0,10400.0,0.0,0.0,0.0,0.0,0.0,202874.59,14684864.0,0.0,0.0,0.0,146848.65,202874.59,0.0,0.0,0.0,0.0,36294578.4698999971,0.0,0.0,0.0,0.0,0.0001,0.0,4.9223,0.0,0.0,0.0,0.0,4.9223,0.0,0.0,111.9297140531,0.0,0.0,0.0,0.0,0.0,65.9378012673,16286.9711756757,70.9506264911,358665.35,0.0,0.0,362945.7846985838,5115.469766068,16286.9711756757,4731.263090116,16286.9711756757,609131.5775514459,565820.3746985837,740835.702427434,252344.9292437059,139.3108524596],["ONLINE",0.0,0.0,0.0,8516.5590508964,95.2033195021,122711565.726052016,27.1817404781,5.0,27.1817404781,568419200.0000001192,4.7616526371,0.0,116868467.2206595242,85101583.759999752,116868467.2134999931,116868467.2134999931,7.4704904168,7.4704904168,0.0,25436.0,0.0,85101583.7600000054,289571650.3118000031,83320735.6399997771,0.0,0.0,19778.0,113690160.4200000018,0.0,119374352.4200000018,5897.0,5684192.0,80846504.5719999969,25096.0,0.0,0.0,4.2018,2543600.0,931116.5072,2543600.0,25436.0,588164202.0,0.0,5642.0,24.0802,25436.0,0.0,25096.0,2445300.0,0.0,0.0,0.0568,0.0,0.0,85101583.7600000054,8264790201.0,0.0,0.0,0.0,83320735.6400000006,85101583.7600000054,0.0,0.0,0.0,0.0,3260037604.0521998405,0.0,0.0,0.0,0.0,0.1601,0.0,1016.6893,0.0,0.0,0.0,0.0,1016.6893,0.0,0.0,102.7955865212,0.0,0.0,0.0,0.0,0.0,30.8226534542,168440504.908629626,26.7124478212,30369424.7800000012,0.0,0.0,31766883.4606597722,1189216.4908781173,168440504.908629626,123445922.9251921624,168440504.908629626,122711565.726052016,116868467.2206595242,128894209.1177586168,89165593.7188596576,26650.6913458754],["Retail",0.0,0.0,0.0,0.0,0.0,null,14.5319827416,5.0,14.5319827416,null,null,0.0,337427030.3686295748,288392192.5499979854,337427030.3485999703,337427030.3485999703,21.5690806656,21.5690806656,0.0,394649.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,73550.0,0.0,0.0,0.0,63110.0,0.0,273972582.9225000143,0.0,0.0,0.0,65.7041,39464900.0,39464900.0,39464900.0,394649.0,3965551539.0,0.0,1.0,0.0,394649.0,0.0,0.0,0.0,0.0,0.0,0.0193,0.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,8408750625.8790998459,0.0,0.0,0.0,0.0,2.7984,0.0,2935.455,0.0,0.0,0.0,0.0,2935.455,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,18.8053836045,0.0,0.0,0.0,null,0.0,49034837.8186315894,0.0,0.0,0.0,0.0,0.0,337427030.3686296344,null,null,null],["WAREHOUSE",0.0,0.0,0.0,0.0,0.0,null,26.6738901388,5.0,26.6738901388,null,null,0.0,621754634.7719311714,455908486.5599999428,621754634.7683999538,621754634.7683999538,39.7439288043,39.7439288043,0.0,102879.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,285440.0,0.0,0.0,0.0,32518.0,0.0,433113062.2319999933,0.0,0.0,0.0,17.3396,10287900.0,10287900.0,10287900.0,102879.0,1967204902.0,1.0,0.0,0.0,102879.0,0.0,0.0,0.0,0.0,0.0,0.2318,0.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,18754576488.1813011169,0.0,0.0,0.0,0.0,0.5502,0.0,5408.9087,0.0,0.0,0.0,0.0,5408.9087,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,30.3401956319,0.0,0.0,0.0,null,0.0,165846148.2119312286,0.0,0.0,0.0,0.0,0.0,621754634.7719312906,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":11,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":4957.3148939309,"proposed_sellthru_percent":40.4603840082,"retail_value_including_markdown":1600336360.8479442596,"budget_gross_margin_percent":40.6073024609,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":40.6073024609,"MarkdownValue":1246367433.0000002384,"markdown_percent":2.2454541723,"DisplayItemValue":0.0,"budget_amount":1564401541.2620511055,"budget_cost":954765123.1099978685,"deficit":1564401541.2232997417,"Original_BudgetAmount":1564401541.2232997417,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":619895.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":954765123.1100000143,"PO":1272173792.5232999325,"COSTPRICE":176226570.2899999917,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":441256.0,"net_sales_ly":542598837.4600000381,"net_sales_lly":347973.4,"gross_sales_ly":555062511.7899999619,"total_sku_count":114950.0,"ly_customer_disc":12463674.3300000001,"SupplyCost":907026866.9555000067,"SALESQTY":104890.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":103.1495,"budget_qty_act_fct_percent":61989500.0,"budget_vs_py_qty_percent":54058575.2879000008,"budget_vs_ppy_qty_percent":61985268.181099996,"QTY_Buy_By_SKU":619895.0,"total_sku_count_ty":7555708056.0,"total_sku_count_lly":41.0,"total_sku_count_ly":11137.0,"quantity_mix_percent":100.146,"quantity_act_forecast":619895.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":104617.0,"quantity_act_forecast_vs_ly_percent":10038300.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.3551,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":954765123.1100000143,"budget_vs_py_cost_percent":17234755999.0,"budget_vs_ppy_cost_percent":48111602.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":176017860.7599999905,"cost_act_forecast":954765123.1100000143,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":67254598559.1909942627,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":4.241,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":13609.4332,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":13609.4332,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":67.5602215471,"FirstMargin_percent":42.0208403641,"budget_vpy":288.3164196564,"budget_vppy":449575.0368453598,"StockatRetailPrice":2187444940.8363904953,"TYForecast":2187444940.8363904953,"LYvsACT_FCT_percent":100.0,"supply_retail_value":1564401541.2620513439} } data_json
INFO:     106.51.119.229:0 - "POST /otb/export/to_excel HTTP/1.1" 200 OK
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 11758.7683247113, 'proposed_sellthru_percent': 9.1492581023, 'retail_value_including_markdown': 1600336360.8479478, 'budget_gross_margin_percent': 38.9693056464, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 38.9693056464, 'MarkdownValue': 1246367433.0000002, 'markdown_percent': 2.2454541723, 'DisplayItemValue': 0, 'budget_amount': 1564401541.2620547, 'budget_cost': 954765123.1099868, 'deficit': 1564401541.2233, 'Original_BudgetAmount': 1564401541.2233, 'budget_percent': 100, 'relative_budget_percent': 100, 'History_Net_Sales': 0, 'budget_qty': 619895, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 954765123.11, 'PO': 1272173792.5233, 'COSTPRICE': 176226570.29000092, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 441256, 'net_sales_ly': 542598837.46, 'net_sales_lly': 347973.4, 'gross_sales_ly': 555062511.79, 'total_sku_count': 114950, 'ly_customer_disc': 12463674.33, 'SupplyCost': 907026866.9555, 'SALESQTY': 104890, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 103.1495, 'budget_qty_act_fct_percent': 61989500, 'budget_vs_py_qty_percent': 54058575.2879, 'budget_vs_ppy_qty_percent': 61985268.1811, 'QTY_Buy_By_SKU': 619895, 'total_sku_count_ty': 7555708056, 'total_sku_count_lly': 41, 'total_sku_count_ly': 11137, 'quantity_mix_percent': 100.146, 'quantity_act_forecast': 619895, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 104617, 'quantity_act_forecast_vs_ly_percent': 10038300, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.3551, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 954765123.11, 'budget_vs_py_cost_percent': 17234755999, 'budget_vs_ppy_cost_percent': 48111602, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 176017860.76, 'cost_act_forecast': 954765123.11, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 67254598559.191, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 4.241, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 13609.4332, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 13609.4332, 'budget_qty_ty': 0, 'Check_box': 0, 'budget_vpy': 288.3164196564, 'budget_vppy': 449575.0368453608, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 100, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 42.0208403641, 'PurchasedRetailValueGrossSale': 5188627075.888798, 'ly_margin_percent': 67.5602215471, 'ly_margin': 366580976.70000005, 'margin_act_forecast_vs_ly_margin_percent': 0, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 609636418.1520679, 'budget_vs_py_margin_percent': 9023600.04439888, 'StockatRetailPrice': 5188627075.888798, 'StockatCostPrice': 1683179128.1651752, 'TYForecast': 5188627075.888798, 'GrossSales': 1600336360.8479476, 'supply_retail_value': 1564401541.262055, 'PurchaseRetailValueatGrossSale': 17491433108.056953, 'OTBorPurchaseCost': 10141385924.334757, 'OTBquantity': 6584440.796379291}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
[] [] the expand heirarchy
sku wise calc executed
1372.933147148 end of sku wise stored proc
we are finding corr ex2
['Channel'] FILTERDATA5
drilldown procedure start
conn established
['Channel'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] []   get_sp_otb_expand_heirarchy
sku wise calc executed
1372.955557257 end of sku wise stored proc
conn established
[OrderedDict([('Channel', 'ARKAN'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('72.2500000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 72.25), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 1201763.972404484), ('budget_cost', 381655.07), ('deficit', Decimal('1201763.9727')), ('Original_BudgetAmount', Decimal('1201763.9727')), ('budget_percent', Decimal('0.0766')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 67.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('381655.0700')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('893')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('32')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('362572.3165')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0115')), ('budget_qty_act_fct_percent', Decimal('6700.0000')), ('budget_vs_py_qty_percent', Decimal('6700.0000')), ('budget_vs_ppy_qty_percent', Decimal('6700.0000')), ('QTY_Buy_By_SKU', Decimal('67.0000')), ('total_sku_count_ty', Decimal('1123392')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('67.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('381655.0700')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('381655.0700')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('82010890.2408')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0003')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('10.4550')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('10.4550')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'B.TECH X'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('24.9815082346142733')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 24.981508234614274), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 26528780.330844812), ('budget_cost', 23526535.730000027), ('deficit', Decimal('26528780.3251')), ('Original_BudgetAmount', Decimal('26528780.3251')), ('budget_percent', Decimal('1.6652')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 11637.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('23526535.7300')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('3653')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('6434')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('22350208.9435')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('2.1048')), ('budget_qty_act_fct_percent', Decimal('1163700.0000')), ('budget_vs_py_qty_percent', Decimal('1163700.0000')), ('budget_vs_ppy_qty_percent', Decimal('1163700.0000')), ('QTY_Buy_By_SKU', Decimal('11637.0000')), ('total_sku_count_ty', Decimal('396728625')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('11637.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0020')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('23526535.7300')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('23526535.7300')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('595047784.0850')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0401')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('230.7869')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('230.7869')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'B2B'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('19670.680497398844')), ('proposed_sellthru_percent', Decimal('68.0487804878048780')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('32.9512195121951220')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.951219512195124), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 18064021.326172743), ('budget_cost', 4268327.429999999), ('deficit', Decimal('18064021.3256')), ('Original_BudgetAmount', Decimal('18064021.3256')), ('budget_percent', Decimal('1.1533')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 3641.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('4268327.4300')), ('PO', Decimal('386351.5313')), ('COSTPRICE', 3231866.2800000003), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('8')), ('net_sales_ly', Decimal('20895108.0000')), ('net_sales_lly', Decimal('347973.4000')), ('gross_sales_ly', Decimal('21008918.3300')), ('total_sku_count', Decimal('308')), ('ly_customer_disc', Decimal('113810.3300')), ('SupplyCost', Decimal('4054911.0585')), ('SALESQTY', 3727.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.5911')), ('budget_qty_act_fct_percent', Decimal('364100.0000')), ('budget_vs_py_qty_percent', Decimal('111688.4479')), ('budget_vs_ppy_qty_percent', Decimal('359868.1811')), ('QTY_Buy_By_SKU', Decimal('3641.0000')), ('total_sku_count_ty', Decimal('39178228')), ('total_sku_count_lly', Decimal('40')), ('total_sku_count_ly', Decimal('253')), ('quantity_mix_percent', Decimal('3.3054')), ('quantity_act_forecast', Decimal('3641.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('3454.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('276800.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0011')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('4268327.4300')), ('budget_vs_py_cost_percent', Decimal('300931377.0000')), ('budget_vs_ppy_cost_percent', Decimal('48111602.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('3023156.7500')), ('cost_act_forecast', Decimal('4268327.4300')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('1557532411.6168')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0302')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('157.1474')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('157.1474')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'CALL CENTER'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('1464.9523809523809524')), ('proposed_sellthru_percent', Decimal('24.1379310344827586')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('17.6436781609195402')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 17.64367816091954), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 436326.3970658023), ('budget_cost', 527213.74), ('deficit', Decimal('436326.3967')), ('Original_BudgetAmount', Decimal('436326.3967')), ('budget_percent', Decimal('0.0277')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 71.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('527213.7400')), ('PO', Decimal('40765.8843')), ('COSTPRICE', 167194.66999999998), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('7')), ('net_sales_ly', Decimal('30230.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('30764.0000')), ('total_sku_count', Decimal('63')), ('ly_customer_disc', Decimal('534.0000')), ('SupplyCost', Decimal('500853.0530')), ('SALESQTY', 4.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0134')), ('budget_qty_act_fct_percent', Decimal('7100.0000')), ('budget_vs_py_qty_percent', Decimal('7100.0000')), ('budget_vs_ppy_qty_percent', Decimal('7100.0000')), ('QTY_Buy_By_SKU', Decimal('71.0000')), ('total_sku_count_ty', Decimal('5670836')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('15')), ('quantity_mix_percent', Decimal('0.0040')), ('quantity_act_forecast', Decimal('71.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('4.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('400.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('527213.7400')), ('budget_vs_py_cost_percent', Decimal('16719467.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('167194.6700')), ('cost_act_forecast', Decimal('527213.7400')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('11832122.7064')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('3.7957')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('3.7957')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'DEEL'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('16413.999576605903')), ('proposed_sellthru_percent', Decimal('96.7226890756302521')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('63.7693277310924370')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 63.76932773109244), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 392503333.3846704), ('budget_cost', 85289696.13700005), ('deficit', Decimal('392503333.3815')), ('Original_BudgetAmount', Decimal('392503333.3815')), ('budget_percent', Decimal('25.0969')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 72856.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('85289696.1370')), ('PO', Decimal('981840304.4883')), ('COSTPRICE', 87358417.88000016), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('57717')), ('net_sales_ly', Decimal('405277851.0400')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('411783475.0400')), ('total_sku_count', Decimal('4750')), ('ly_customer_disc', Decimal('6505624.0000')), ('SupplyCost', Decimal('81025211.3302')), ('SALESQTY', 74957.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('11.7492')), ('budget_qty_act_fct_percent', Decimal('7285600.0000')), ('budget_vs_py_qty_percent', Decimal('1261810.3330')), ('budget_vs_ppy_qty_percent', Decimal('7285600.0000')), ('QTY_Buy_By_SKU', Decimal('72856.0000')), ('total_sku_count_ty', Decimal('458060480')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('4608')), ('quantity_mix_percent', Decimal('71.6868')), ('quantity_act_forecast', Decimal('72856.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('74957.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('7208200.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0435')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('85289696.1370')), ('budget_vs_py_cost_percent', Decimal('8439102573.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('87358417.8800')), ('cost_act_forecast', Decimal('85289696.1370')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('30723242882.7641')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.6047')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('3414.5564')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('3414.5564')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))])] 11 getData dictsize
1373.158192494 end of fetch data
shape: (11, 81)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ Channel   ┆ final_pri ┆ act_forec ┆ SalesActu ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ---       ┆ ce        ┆ ast_vs_bu ┆ alsByFore ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ str       ┆ ---       ┆ dget_perc ┆ cast      ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│           ┆ f64       ┆ ent       ┆ ---       ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆           ┆ ---       ┆ f64       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆           ┆ f64       ┆           ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ ARKAN     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 10.455    ┆ 0.0       ┆ 0.0      │
│ B.TECH X  ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 230.7869  ┆ 0.0       ┆ 0.0      │
│ B2B       ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 157.1474  ┆ 0.0       ┆ 0.0      │
│ CALL      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 3.7957    ┆ 0.0       ┆ 0.0      │
│ CENTER    ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆          │
│ DEEL      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 3414.5564 ┆ 0.0       ┆ 0.0      │
│ MINI      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 24.6193   ┆ 0.0       ┆ 0.0      │
│ NON       ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 4.9223    ┆ 0.0       ┆ 0.0      │
│ ONLINE    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 1016.6893 ┆ 0.0       ┆ 0.0      │
│ Retail    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 2935.455  ┆ 0.0       ┆ 0.0      │
│ WAREHOUSE ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 5408.9087 ┆ 0.0       ┆ 0.0      │
│ 0         ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 402.0972  ┆ 0.0       ┆ 0.0      │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ -182.414365       │
└───────────────────┘ ly_mgn
shape: (11, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 1.2018e6   ┆ 69.82999  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2.6529e7   ┆ 15.751087 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 113810.33  ┆ 2.0895108e ┆ 1.8064e7   ┆ 77.552556 ┆ 1.8162e7  ┆ 68.04878  ┆ 2.6690e7  ┆ 0.541724  │
│            ┆ 7          ┆            ┆           ┆           ┆           ┆           ┆           │
│ 534.0      ┆ 30230.0    ┆ 436326.397 ┆ -14.78862 ┆ 444033.91 ┆ 24.137931 ┆ 1.8396e6  ┆ 1.735795  │
│            ┆            ┆ 066        ┆ 1         ┆ 5955      ┆           ┆           ┆           │
│ 6.505624e6 ┆ 4.0528e8   ┆ 3.9250e8   ┆ 79.356809 ┆ 3.9880e8  ┆ 96.722689 ┆ 4.1232e8  ┆ 1.579865  │
│ 120819.0   ┆ 2.199974e6 ┆ 2.8301e6   ┆ 24.038323 ┆ 2.9855e6  ┆ 78.729282 ┆ 3.7922e6  ┆ 5.205936  │
│ 38695.0    ┆ 505514.0   ┆ 565820.374 ┆ 65.937801 ┆ 609131.57 ┆ 82.222222 ┆ 740835.70 ┆ 7.11032   │
│            ┆            ┆ 699        ┆           ┆ 7551      ┆           ┆ 2427      ┆           │
│ 5.684192e6 ┆ 1.1369e8   ┆ 1.1687e8   ┆ 30.822653 ┆ 1.2271e8  ┆ 95.20332  ┆ 1.2889e8  ┆ 4.761653  │
│ 0.0        ┆ 0.0        ┆ 3.3743e8   ┆ 18.805384 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 6.2175e8   ┆ 30.340196 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 4.6221e7   ┆ 81.700132 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['Channel', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A6972A8820>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A6972A89D0>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A6972A8970>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972A9750>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A6972A85E0>, <Expr ['col("retail_value_including_ma…'] at 0x76A6972A9870>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A6972ABA90>, <Expr ['col("Logistic%").mean()'] at 0x76A6972A9DB0>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A6972A86D0>, <Expr ['col("MarkdownValue").mean()'] at 0x76A6972A9B10>, <Expr ['col("markdown_percent").mean()'] at 0x76A6972AAE90>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A6972A8F70>, <Expr ['col("budget_amount").sum()'] at 0x76A6972A9600>, <Expr ['col("budget_cost").sum()'] at 0x76A6972A94E0>, <Expr ['col("deficit").sum()'] at 0x76A6972A9AB0>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A6972A95A0>, <Expr ['col("budget_percent").sum()'] at 0x76A6972A9A20>, <Expr ['col("relative_budget_percent")…'] at 0x76A6972A8760>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A6972A8B50>, <Expr ['col("budget_qty").sum()'] at 0x76A6972A8D90>, <Expr ['col("ACT_FCT").sum()'] at 0x76A6972A9A50>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A6972A9660>, <Expr ['col("PO").sum()'] at 0x76A6972A8CD0>, <Expr ['col("COSTPRICE").sum()'] at 0x76A6972A8A90>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A6972A8C10>, <Expr ['col("sales_actual").sum()'] at 0x76A6972A8BB0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A6972A9B40>, <Expr ['col("net_sales_ly").sum()'] at 0x76A6972A8C40>, <Expr ['col("net_sales_lly").sum()'] at 0x76A6972ABA60>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A6972A96F0>, <Expr ['col("total_sku_count").sum()'] at 0x76A6972A8A60>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A6972A9990>, <Expr ['col("SupplyCost").sum()'] at 0x76A6972AB4F0>, <Expr ['col("SALESQTY").sum()'] at 0x76A6972A9840>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A6972AA470>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A6972A9D20>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A6972A94B0>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A6972A8CA0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A6972A9FC0>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A6972AB970>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A6972AA020>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A6972A86A0>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A6972AA080>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A6972AA290>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A6972ABB20>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A6972AA140>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972AA230>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A6972AA350>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972A9F60>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A6972ABDF0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972AAF20>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A6972AB520>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A6972AA2F0>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A6972A8AF0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A6972ABF70>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A6972AB550>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A6972AB340>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A6972AA3E0>, <Expr ['col("cost_actuals").sum()'] at 0x76A6972AB5E0>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A6972ABF40>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A6972AA050>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A6972AB4C0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A6972AB580>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A6972AB430>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A6972AA380>, <Expr ['col("budget_margin_percent").s…'] at 0x76A6972AB160>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A6972AB490>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A6972AAA70>, <Expr ['col("margin_actuals").sum()'] at 0x76A6972AB5B0>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A6972AABC0>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A6972AB1F0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A6972AA170>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A6972AB3D0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A6972AB130>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A6972AAFB0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972A9F30>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972AADD0>, <Expr ['col("budget_per_sku").sum()'] at 0x76A6972AB2E0>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A6972AB670>, <Expr ['col("Check_box").max()'] at 0x76A6972AAD70>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Channel","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9,10],"data":[["ARKAN",0.0,0.0,0.0,0.0,0.0,null,68.2420942245,5.0,68.2420942245,null,null,0.0,1201763.9724044839,381655.07,1201763.9727,1201763.9727,0.0768194061,0.0768194061,0.0,67.0,0.0,381655.07,0.0,0.0,0.0,0.0,893.0,0.0,0.0,0.0,32.0,0.0,362572.3165,0.0,0.0,0.0,0.0115,6700.0,6700.0,6700.0,67.0,1123392.0,0.0,0.0,0.0,67.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,381655.07,0.0,0.0,0.0,0.0,0.0,381655.07,0.0,0.0,0.0,0.0,82010890.2407999933,0.0,0.0,0.0,0.0,0.0003,0.0,10.455,0.0,0.0,0.0,0.0,10.455,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,69.8299895133,0.0,0.0,0.0,null,0.0,820108.9024044839,0.0,0.0,0.0,0.0,0.0,1201763.9724044839,null,null,null],["B.TECH X",0.0,0.0,0.0,0.0,0.0,null,11.31693415,5.0,11.31693415,null,null,0.0,26528780.3308448121,23526535.7300000265,26528780.3251000009,26528780.3251000009,1.6957782022,1.6957782022,0.0,11637.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,3653.0,0.0,0.0,0.0,6434.0,0.0,22350208.943500001,0.0,0.0,0.0,2.1048,1163700.0,1163700.0,1163700.0,11637.0,396728625.0,0.0,0.0,0.0,11637.0,0.0,0.0,0.0,0.0,0.0,0.002,0.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,595047784.0850000381,0.0,0.0,0.0,0.0,0.0401,0.0,230.7869,0.0,0.0,0.0,0.0,230.7869,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,15.7510874425,0.0,0.0,0.0,null,0.0,3002244.6008447856,0.0,0.0,0.0,0.0,0.0,26528780.3308448121,null,null,null],["B2B",0.0,0.0,0.0,19670.6804973988,68.0487804878,18162411.44831324,76.3711116538,5.0,76.3711116538,11381033.0,0.5417238918,0.0,18064021.326172743,4268327.4299999988,18064021.3255999982,18064021.3255999982,1.1546921203,1.1546921203,0.0,3641.0,0.0,4268327.4299999997,386351.5313,3231866.2800000003,0.0,0.0,8.0,20895108.0,347973.4,21008918.3299999982,308.0,113810.33,4054911.0584999998,3727.0,0.0,0.0,0.5911,364100.0,111688.4479,359868.1811,3641.0,39178228.0,40.0,253.0,3.3054,3641.0,0.0,3454.0,276800.0,0.0,0.0,0.0011,0.0,0.0,4268327.4299999997,300931377.0,48111602.0,0.0,0.0,3023156.75,4268327.4299999997,0.0,0.0,0.0,0.0,1557532411.6168000698,0.0,0.0,0.0,0.0,0.0302,0.0,157.1474,0.0,0.0,0.0,0.0,157.1474,0.0,0.0,86.4509593641,5191.2075251076,0.0,0.0,100.0,0.0,77.5525560711,157365.4439791907,85.5317486275,17871951.25,0.0,0.0,13795693.8961727433,161293.2521262726,157365.4439791907,22768.0280083949,157365.4439791907,18162411.4483132362,18064021.3261727467,26690282.0566610321,5991286.0991384303,5110.7308529428],["CALL CENTER",0.0,0.0,0.0,1464.9523809524,24.1379310345,444033.9159554199,-20.8301270667,5.0,-20.8301270667,53400.0,1.7357950852,0.0,436326.3970658023,527213.74,436326.3967,436326.3967,0.0278909465,0.0278909465,0.0,71.0,0.0,527213.74,40765.8843,167194.67,0.0,0.0,7.0,30230.0,0.0,30764.0,63.0,534.0,500853.053,4.0,0.0,0.0,0.0134,7100.0,7100.0,7100.0,71.0,5670836.0,0.0,15.0,0.004,71.0,0.0,4.0,400.0,0.0,0.0,0.0,0.0,0.0,527213.74,16719467.0,0.0,0.0,0.0,167194.67,527213.74,0.0,0.0,0.0,0.0,11832122.7063999996,0.0,0.0,0.0,0.0,0.0,0.0,3.7957,0.0,0.0,0.0,0.0,3.7957,0.0,0.0,1443.3555973067,0.0,0.0,0.0,0.0,0.0,-14.7886207133,10254.6666666667,-453.0753225273,-136964.67,0.0,0.0,-90887.3429341977,200.6009562102,10254.6666666667,56716.0307407652,10254.6666666667,444033.9159554199,436326.3970658023,1839569.0803867395,2111615.9744448187,284.3718264732],["DEEL",0.0,0.0,0.0,16413.9995766059,96.7226890756,398803897.5511915088,78.2703256552,5.0,78.2703256552,650562400.0,1.5798652433,0.0,392503333.3846703768,85289696.1370000541,392503333.3815000057,392503333.3815000057,25.0896795376,25.0896795376,0.0,72856.0,0.0,85289696.1369999945,981840304.4882999659,87358417.8800001591,0.0,0.0,57717.0,405277851.0400000215,0.0,411783475.0400000215,4750.0,6505624.0,81025211.3302000016,74957.0,0.0,0.0,11.7492,7285600.0,1261810.3330000001,7285600.0,72856.0,458060480.0,0.0,4608.0,71.6868,72856.0,0.0,74957.0,7208200.0,0.0,0.0,0.0435,0.0,0.0,85289696.1369999945,8439102573.0,0.0,0.0,0.0,87358417.8799999952,85289696.1369999945,0.0,0.0,0.0,0.0,30723242882.7640991211,0.0,0.0,0.0,0.0,0.6047,0.0,3414.5564,0.0,0.0,0.0,0.0,3414.5564,0.0,0.0,96.8479605726,0.0,0.0,0.0,0.0,0.0,79.3568093724,947366813.5629628897,78.4448082579,317919433.1600000262,0.0,0.0,307213637.2476702929,3916302.9914958691,947366813.5629628897,204206733.1646729112,947366813.5629628897,398803897.5511915088,392503333.3846703768,412316801.117217958,85115343.2441636771,72707.0646076159],["MINI",0.0,0.0,0.0,3035.2819354949,78.729281768,2985539.0552947633,20.0403404442,5.0,20.0403404442,12081899.9999999981,5.2059360744,0.0,2830113.8005987788,2262949.3599999975,2830113.8010999998,2830113.8010999998,0.1809071217,0.1809071217,0.0,1218.0,0.0,2262949.3599999999,326005.7196,2001507.1700000004,0.0,0.0,207.0,2199974.0,0.0,2320793.0,695.0,120819.0,2149801.892,1002.0,0.0,0.0,0.2105,121800.0,85899.9998,121800.0,1218.0,64715402.0,0.0,581.0,0.9695,1218.0,0.0,1002.0,97200.0,0.0,0.0,0.0,0.0,0.0,2262949.3599999999,198527517.0,0.0,0.0,0.0,2001507.1699999999,2262949.3599999999,0.0,0.0,0.0,0.0,71360884.058799997,0.0,0.0,0.0,0.0,0.0031,0.0,24.6193,0.0,0.0,0.0,0.0,24.6193,0.0,0.0,128.6430567179,0.0,0.0,0.0,0.0,0.0,24.038323422,628303.3606474403,9.0213261611,198466.8300000001,0.0,0.0,567164.4405987812,62869.2977583137,628303.3606474403,571622.0652021103,628303.3606474403,2985539.0552947633,2830113.8005987788,3792158.3790059802,2880587.083185798,1550.4346360275],["NON",0.0,0.0,0.0,5428.9903918919,82.2222222222,609131.5775514458,64.1450539656,5.0,64.1450539656,3869500.0,7.1103197485,0.0,565820.3746985839,202874.59,565820.3747,565820.3747,0.0361684874,0.0361684874,0.0,112.0,0.0,202874.59,8714.588,146848.65,0.0,0.0,3.0,505514.0,0.0,544209.0,45.0,38695.0,192730.8605,104.0,0.0,0.0,0.0186,11200.0,4860.0,11200.0,112.0,4366090.0,0.0,37.0,0.1001,112.0,0.0,104.0,10400.0,0.0,0.0,0.0,0.0,0.0,202874.59,14684864.0,0.0,0.0,0.0,146848.65,202874.59,0.0,0.0,0.0,0.0,36294578.4698999971,0.0,0.0,0.0,0.0,0.0001,0.0,4.9223,0.0,0.0,0.0,0.0,4.9223,0.0,0.0,111.9297140531,0.0,0.0,0.0,0.0,0.0,65.9378012673,16286.9711756757,70.9506264911,358665.35,0.0,0.0,362945.7846985838,5115.469766068,16286.9711756757,4731.263090116,16286.9711756757,609131.5775514459,565820.3746985837,740835.702427434,252344.9292437059,139.3108524596],["ONLINE",0.0,0.0,0.0,8516.5590508964,95.2033195021,122711565.7260519266,27.1817404781,5.0,27.1817404781,568419200.0000001192,4.7616526371,0.0,116868467.2206594348,85101583.7599998116,116868467.2134999931,116868467.2134999931,7.4704904168,7.4704904168,0.0,25436.0,0.0,85101583.7600000054,289571650.3118000031,83320735.6399999112,0.0,0.0,19778.0,113690160.4200000018,0.0,119374352.4200000018,5897.0,5684192.0,80846504.5719999969,25096.0,0.0,0.0,4.2018,2543600.0,931116.5072,2543600.0,25436.0,588164202.0,0.0,5642.0,24.0802,25436.0,0.0,25096.0,2445300.0,0.0,0.0,0.0568,0.0,0.0,85101583.7600000054,8264790201.0,0.0,0.0,0.0,83320735.6400000006,85101583.7600000054,0.0,0.0,0.0,0.0,3260037604.0521998405,0.0,0.0,0.0,0.0,0.1601,0.0,1016.6893,0.0,0.0,0.0,0.0,1016.6893,0.0,0.0,102.7955865212,0.0,0.0,0.0,0.0,0.0,30.8226534542,168440504.908629626,26.7124478212,30369424.7800000012,0.0,0.0,31766883.4606596231,1189216.4908781119,168440504.908629626,123445922.9251921624,168440504.908629626,122711565.7260519266,116868467.2206594348,128894209.1177585125,89165593.7188596576,26650.6913458754],["Retail",0.0,0.0,0.0,0.0,0.0,null,14.5319827416,5.0,14.5319827416,null,null,0.0,337427030.3686293364,288392192.5499998331,337427030.3485999703,337427030.3485999703,21.5690806656,21.5690806656,0.0,394649.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,73550.0,0.0,0.0,0.0,63110.0,0.0,273972582.9225000143,0.0,0.0,0.0,65.7041,39464900.0,39464900.0,39464900.0,394649.0,3965551539.0,0.0,1.0,0.0,394649.0,0.0,0.0,0.0,0.0,0.0,0.0193,0.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,8408750625.8790998459,0.0,0.0,0.0,0.0,2.7984,0.0,2935.455,0.0,0.0,0.0,0.0,2935.455,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,18.8053836045,0.0,0.0,0.0,null,0.0,49034837.8186295033,0.0,0.0,0.0,0.0,0.0,337427030.3686293364,null,null,null],["WAREHOUSE",0.0,0.0,0.0,0.0,0.0,null,26.6738901388,5.0,26.6738901388,null,null,0.0,621754634.7719317675,455908486.5599997044,621754634.7683999538,621754634.7683999538,39.7439288043,39.7439288043,0.0,102879.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,285440.0,0.0,0.0,0.0,32518.0,0.0,433113062.2319999933,0.0,0.0,0.0,17.3396,10287900.0,10287900.0,10287900.0,102879.0,1967204902.0,1.0,0.0,0.0,102879.0,0.0,0.0,0.0,0.0,0.0,0.2318,0.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,18754576488.1813011169,0.0,0.0,0.0,0.0,0.5502,0.0,5408.9087,0.0,0.0,0.0,0.0,5408.9087,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,30.3401956319,0.0,0.0,0.0,null,0.0,165846148.2119320631,0.0,0.0,0.0,0.0,0.0,621754634.7719318867,null,null,null],["0",0.0,0.0,0.0,0.0,0.0,null,80.7369806851,5.0,80.7369806851,null,null,0.0,46221249.314375788,8903608.1830000021,46221249.3153999969,46221249.3153999969,2.9545642915,2.9545642915,0.0,7329.0,0.0,8903608.1830000002,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1098.0,0.0,8458427.7748000007,0.0,0.0,0.0,1.2049,732900.0,732900.0,732900.0,7329.0,64944360.0,0.0,0.0,0.0,7329.0,0.0,0.0,0.0,0.0,0.0,0.0006,0.0,0.0,8903608.1830000002,0.0,0.0,0.0,0.0,0.0,8903608.1830000002,0.0,0.0,0.0,0.0,3753912287.1366000175,0.0,0.0,0.0,0.0,0.0538,0.0,402.0972,0.0,0.0,0.0,0.0,402.0972,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,81.7001316488,0.0,0.0,0.0,null,0.0,37317641.1313757896,0.0,0.0,0.0,0.0,0.0,46221249.3143757805,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":11,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":4957.3148939309,"proposed_sellthru_percent":40.4603840082,"retail_value_including_markdown":1600336360.8479452133,"budget_gross_margin_percent":40.6073024609,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":40.6073024609,"MarkdownValue":1246367433.0000002384,"markdown_percent":2.2454541723,"DisplayItemValue":0.0,"budget_amount":1564401541.2620520592,"budget_cost":954765123.1099994183,"deficit":1564401541.2232997417,"Original_BudgetAmount":1564401541.2232997417,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":619895.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":954765123.1100000143,"PO":1272173792.5232999325,"COSTPRICE":176226570.2900000811,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":441256.0,"net_sales_ly":542598837.4600000381,"net_sales_lly":347973.4,"gross_sales_ly":555062511.7899999619,"total_sku_count":114950.0,"ly_customer_disc":12463674.3300000001,"SupplyCost":907026866.9555000067,"SALESQTY":104890.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":103.1495,"budget_qty_act_fct_percent":61989500.0,"budget_vs_py_qty_percent":54058575.2879000008,"budget_vs_ppy_qty_percent":61985268.181099996,"QTY_Buy_By_SKU":619895.0,"total_sku_count_ty":7555708056.0,"total_sku_count_lly":41.0,"total_sku_count_ly":11137.0,"quantity_mix_percent":100.146,"quantity_act_forecast":619895.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":104617.0,"quantity_act_forecast_vs_ly_percent":10038300.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.3551,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":954765123.1100000143,"budget_vs_py_cost_percent":17234755999.0,"budget_vs_ppy_cost_percent":48111602.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":176017860.7599999905,"cost_act_forecast":954765123.1100000143,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":67254598559.1909942627,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":4.241,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":13609.4332,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":13609.4332,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":67.5602215471,"FirstMargin_percent":42.0208403641,"budget_vpy":288.3164196564,"budget_vppy":449575.0368453601,"StockatRetailPrice":2187444940.8363904953,"TYForecast":2187444940.8363904953,"LYvsACT_FCT_percent":100.0,"supply_retail_value":1564401541.2620522976} } data_json
INFO:     106.51.119.229:0 - "OPTIONS /otb/export/to_excel HTTP/1.1" 200 OK
INFO:     106.51.119.229:0 - "POST /otb/export/to_excel HTTP/1.1" 200 OK
INFO:     68.183.116.84:38092 - "GET / HTTP/1.0" 200 OK
INFO:     172.105.157.87:55868 - "GET / HTTP/1.0" 200 OK
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'Channel': 'Retail', 'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 0, 'proposed_sellthru_percent': 0, 'retail_value_including_markdown': None, 'budget_gross_margin_percent': 14.5319827416, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 14.5319827416, 'MarkdownValue': None, 'markdown_percent': None, 'DisplayItemValue': 0, 'budget_amount': 337427030.36862934, 'budget_cost': 288392192.54999983, 'deficit': 337427030.3486, 'Original_BudgetAmount': 337427030.3486, 'budget_percent': 21.5690806656, 'relative_budget_percent': 21.5690806656, 'History_Net_Sales': 0, 'budget_qty': 394649, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 288392192.55, 'PO': 0, 'COSTPRICE': 0, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 73550, 'net_sales_ly': 0, 'net_sales_lly': 0, 'gross_sales_ly': 0, 'total_sku_count': 63110, 'ly_customer_disc': 0, 'SupplyCost': 273972582.9225, 'SALESQTY': 0, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 65.7041, 'budget_qty_act_fct_percent': 39464900, 'budget_vs_py_qty_percent': 39464900, 'budget_vs_ppy_qty_percent': 39464900, 'QTY_Buy_By_SKU': 394649, 'total_sku_count_ty': 3965551539, 'total_sku_count_lly': 0, 'total_sku_count_ly': 1, 'quantity_mix_percent': 0, 'quantity_act_forecast': 394649, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 0, 'quantity_act_forecast_vs_ly_percent': 0, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.0193, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 288392192.55, 'budget_vs_py_cost_percent': 0, 'budget_vs_ppy_cost_percent': 0, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 0, 'cost_act_forecast': 288392192.55, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 8408750625.8791, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 2.7984, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 2935.455, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 2935.455, 'budget_qty_ty': 0, 'Check_box': 0, 'budget_vpy': 0, 'budget_vppy': 0, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 18.8053836045, 'PurchasedRetailValueGrossSale': 0, 'ly_margin_percent': 0, 'ly_margin': 0, 'margin_act_forecast_vs_ly_margin_percent': None, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 49034837.8186295, 'budget_vs_py_margin_percent': 0, 'StockatRetailPrice': 0, 'StockatCostPrice': 0, 'TYForecast': 0, 'GrossSales': 0, 'supply_retail_value': 337427030.36862934, 'PurchaseRetailValueatGrossSale': None, 'OTBorPurchaseCost': None, 'OTBquantity': None}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
['Channel'] ['Retail'] the expand heirarchy
sku wise calc executed
1378.268020219 end of sku wise stored proc
we are finding corr ex4
grp err
drilldown procedure start
conn established
['Family'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] ['Channel']   get_sp_otb_expand_heirarchy
sku wise calc executed
1378.290788458 end of sku wise stored proc
conn established
[OrderedDict([('Family', 'AC'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('21.7411632691228726')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 21.741163269122872), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 37054277.34329216), ('budget_cost', 33667021.12000007), ('deficit', Decimal('37054277.3407')), ('Original_BudgetAmount', Decimal('37054277.3407')), ('budget_percent', Decimal('2.3486')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 5220.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('33667021.1200')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('2030')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('4641')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('31983670.0640')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.9920')), ('budget_qty_act_fct_percent', Decimal('522000.0000')), ('budget_vs_py_qty_percent', Decimal('522000.0000')), ('budget_vs_ppy_qty_percent', Decimal('522000.0000')), ('QTY_Buy_By_SKU', Decimal('5220.0000')), ('total_sku_count_ty', Decimal('337780042')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('5220.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0004')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('33667021.1200')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('33667021.1200')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('1011739639.3269')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0004')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('322.3547')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('322.3547')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Family', 'BMOBILE ACCESSORIES'), ('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-24')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('33.4051036682615630')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 33.40510366826156), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', None), ('budget_amount', 10771755.468878694), ('budget_cost', 8644668.169999983), ('deficit', Decimal('10771755.4553')), ('Original_BudgetAmount', Decimal('10771755.4553')), ('budget_percent', Decimal('0.5958')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 13061.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('8644668.1700')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('36937')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('10687')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('8212434.7615')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('2.4469')), ('budget_qty_act_fct_percent', Decimal('1306100.0000')), ('budget_vs_py_qty_percent', Decimal('1306100.0000')), ('budget_vs_ppy_qty_percent', Decimal('1306100.0000')), ('QTY_Buy_By_SKU', Decimal('13061.0000')), ('total_sku_count_ty', Decimal('627615654')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('13061.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0003')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('8644668.1700')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('8644668.1700')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('295172037.8932')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0042')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('93.7087')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('93.7087')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Family', 'COMPLEMENTARY'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('18.4469696969696970')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 18.446969696969695), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 3113806.9899061364), ('budget_cost', 2997814.0600000015), ('deficit', Decimal('3113806.9884')), ('Original_BudgetAmount', Decimal('3113806.9884')), ('budget_percent', Decimal('0.2023')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 249.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('2997814.0600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('39')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('246')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('2847923.3570')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0494')), ('budget_qty_act_fct_percent', Decimal('24900.0000')), ('budget_vs_py_qty_percent', Decimal('24900.0000')), ('budget_vs_ppy_qty_percent', Decimal('24900.0000')), ('QTY_Buy_By_SKU', Decimal('249.0000')), ('total_sku_count_ty', Decimal('15987788')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('249.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0010')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('2997814.0600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('2997814.0600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('53713988.9895')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('27.0879')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('27.0879')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Family', 'LAPTOP'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('16.1028938906752412')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 16.10289389067524), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 7084184.647733003), ('budget_cost', 6784951.130000001), ('deficit', Decimal('7084184.6459')), ('Original_BudgetAmount', Decimal('7084184.6459')), ('budget_percent', Decimal('0.4540')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 302.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('6784951.1300')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('22')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('295')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('6445703.5735')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0598')), ('budget_qty_act_fct_percent', Decimal('30200.0000')), ('budget_vs_py_qty_percent', Decimal('30200.0000')), ('budget_vs_ppy_qty_percent', Decimal('30200.0000')), ('QTY_Buy_By_SKU', Decimal('302.0000')), ('total_sku_count_ty', Decimal('19007441')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('302.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0013')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('6784951.1300')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('6784951.1300')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('105432049.7751')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('61.6306')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('61.6306')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Family', 'MDA'), ('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-24')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('23.6531222854936782')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 23.653122285493676), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', None), ('budget_amount', 119827180.21606804), ('budget_cost', 100294690.63999991), ('deficit', Decimal('119827180.2071')), ('Original_BudgetAmount', Decimal('119827180.2071')), ('budget_percent', Decimal('7.6422')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 10063.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('100294690.6400')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('5120')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('9665')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('95279956.1080')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('1.9689')), ('budget_qty_act_fct_percent', Decimal('1006300.0000')), ('budget_vs_py_qty_percent', Decimal('1006300.0000')), ('budget_vs_ppy_qty_percent', Decimal('1006300.0000')), ('QTY_Buy_By_SKU', Decimal('10063.0000')), ('total_sku_count_ty', Decimal('546526510')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('10063.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0079')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('100294690.6400')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('100294690.6400')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('3240827454.6042')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0003')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('1042.4375')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('1042.4375')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))])] 10 getData dictsize
1378.491637497 end of fetch data
shape: (10, 82)
┌────────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬─────────┬───────────┐
│ Family     ┆ final_pri ┆ act_forec ┆ SalesActu ┆ … ┆ budget_pe ┆ budget_qt ┆ Channel ┆ Check_box │
│ ---        ┆ ce        ┆ ast_vs_bu ┆ alsByFore ┆   ┆ r_sku     ┆ y_ty      ┆ ---     ┆ ---       │
│ str        ┆ ---       ┆ dget_perc ┆ cast      ┆   ┆ ---       ┆ ---       ┆ str     ┆ f64       │
│            ┆ f64       ┆ ent       ┆ ---       ┆   ┆ f64       ┆ f64       ┆         ┆           │
│            ┆           ┆ ---       ┆ f64       ┆   ┆           ┆           ┆         ┆           │
│            ┆           ┆ f64       ┆           ┆   ┆           ┆           ┆         ┆           │
╞════════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═════════╪═══════════╡
│ AC         ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 322.3547  ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ BMOBILE    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 93.7087   ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ ACCESSORIE ┆           ┆           ┆           ┆   ┆           ┆           ┆         ┆           │
│ S          ┆           ┆           ┆           ┆   ┆           ┆           ┆         ┆           │
│ COMPLEMENT ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 27.0879   ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ ARY        ┆           ┆           ┆           ┆   ┆           ┆           ┆         ┆           │
│ LAPTOP     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 61.6306   ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ MDA        ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 1042.4375 ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ MOBILE     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 371.4101  ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ NON        ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0231    ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ SDA        ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 533.5224  ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ TABLET     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 23.064    ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ TV         ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 460.216   ┆ 0.0       ┆ Retail  ┆ 0.0       │
└────────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴─────────┴───────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 0.0               │
└───────────────────┘ ly_mgn
shape: (10, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 3.7054e7   ┆ 13.68427  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 1.0772e7   ┆ 23.759551 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 3.1138e6   ┆ 8.53886   ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 7.0842e6   ┆ 9.012767  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 1.1983e8   ┆ 20.485523 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 4.2694e7   ┆ 9.558922  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2653.96052 ┆ 27.8      ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 6          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 6.1326e7   ┆ 25.089448 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2.6511e6   ┆ 21.344977 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 5.2902e7   ┆ 19.543464 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['Family', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Channel', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x7697328EB280>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x7697328EB4C0>, <Expr ['col("SalesActualsByForecast").…'] at 0x7697328E8E50>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328E95D0>, <Expr ['col("proposed_sellthru_percent…'] at 0x7697328E8DC0>, <Expr ['col("retail_value_including_ma…'] at 0x7697328EBF70>, <Expr ['col("budget_gross_margin_perce…'] at 0x7697328E8F70>, <Expr ['col("Logistic%").mean()'] at 0x7697328EB550>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x7697328EB580>, <Expr ['col("MarkdownValue").mean()'] at 0x7697328EA6E0>, <Expr ['col("markdown_percent").mean()'] at 0x7697328EADD0>, <Expr ['col("DisplayItemValue").mean()'] at 0x7697328EB430>, <Expr ['col("budget_amount").sum()'] at 0x7697328E9060>, <Expr ['col("budget_cost").sum()'] at 0x7697328E9750>, <Expr ['col("deficit").sum()'] at 0x7697328EAD10>, <Expr ['col("Original_BudgetAmount").s…'] at 0x7697328E97E0>, <Expr ['col("budget_percent").sum()'] at 0x7697328E8610>, <Expr ['col("relative_budget_percent")…'] at 0x7697328EB1C0>, <Expr ['col("History_Net_Sales").sum()'] at 0x7697328EBD30>, <Expr ['col("budget_qty").sum()'] at 0x7697328E86A0>, <Expr ['col("ACT_FCT").sum()'] at 0x7697328E8490>, <Expr ['col("Original_BudgetCostofGood…'] at 0x7697328E9360>, <Expr ['col("PO").sum()'] at 0x7697328EAC50>, <Expr ['col("COSTPRICE").sum()'] at 0x7697328EA5F0>, <Expr ['col("Historical_Gross_Margin")…'] at 0x7697328E8670>, <Expr ['col("sales_actual").sum()'] at 0x7697328E87C0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x7697328E90F0>, <Expr ['col("net_sales_ly").sum()'] at 0x7697328E8520>, <Expr ['col("net_sales_lly").sum()'] at 0x7697328EA650>, <Expr ['col("gross_sales_ly").sum()'] at 0x7697328E9630>, <Expr ['col("total_sku_count").sum()'] at 0x7697328E9030>, <Expr ['col("ly_customer_disc").sum()'] at 0x7697328EA6B0>, <Expr ['col("SupplyCost").sum()'] at 0x7697328E9510>, <Expr ['col("SALESQTY").sum()'] at 0x7697328E98A0>, <Expr ['col("DisplayItemQty").sum()'] at 0x7697328EA380>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x7697328E9930>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x7697328E9180>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x7697328E8640>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x7697328EA200>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x7697328EA620>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x7697328EA290>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x7697328E8A90>, <Expr ['col("total_sku_count_lly").sum…'] at 0x7697328E8CD0>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x7697328EACE0>, <Expr ['col("quantity_mix_percent").su…'] at 0x7697328E9FC0>, <Expr ['col("quantity_act_forecast").s…'] at 0x7697328E9FF0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328E9F90>, <Expr ['col("sold_qty_ly").sum()'] at 0x7697328EA140>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328E8D90>, <Expr ['col("quantity_act_or_forecast_…'] at 0x7697328E8C70>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x7697328E8460>, <Expr ['col("budget_cost_percent").sum…'] at 0x7697328EA0B0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x7697328E8E20>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x7697328EA590>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x7697328E9EA0>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x7697328E8B50>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x7697328E9E70>, <Expr ['col("cost_mix_percent").sum()'] at 0x7697328E9ED0>, <Expr ['col("cost_actuals").sum()'] at 0x7697328E9CF0>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x7697328E9F30>, <Expr ['col("cost_act_forecast").sum()'] at 0x7697328E9990>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x7697328EADA0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x7697328E8BB0>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x7697328E9E10>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x7697328EA0E0>, <Expr ['col("budget_margin_percent").s…'] at 0x7697328E8910>, <Expr ['col("budget_margin_mix_percent…'] at 0x7697328E8280>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x7697328E9B40>, <Expr ['col("margin_actuals").sum()'] at 0x7697328E9D20>, <Expr ['col("margin_act_forecast").sum…'] at 0x7697328EAFE0>, <Expr ['col("units_per_sku_total").sum…'] at 0x7697328E9B70>, <Expr ['col("units_per_sku_lly").sum()'] at 0x7697328EA230>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x7697328E9BA0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x7697328E98D0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x7697328E99C0>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328EA3B0>, <Expr ['col("initial_average_retail_pr…'] at 0x7697328EACB0>, <Expr ['col("budget_per_sku").sum()'] at 0x7697328E8C40>, <Expr ['col("budget_qty_ty").sum()'] at 0x7697328EAC20>, <Expr ['col("Check_box").max()'] at 0x7697328EAEC0>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Family","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Channel","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9],"data":[["AC",0.0,0.0,0.0,0,0.0,null,9.1413366179,5.0,9.1413366179,null,null,0,37054277.3432921618,33667021.1200000718,37054277.3407000005,37054277.3407000005,10.981419391,10.981419391,0.0,5220.0,0.0,33667021.1199999973,0,0,0.0,0.0,2030.0,0.0,0.0,0.0,4641.0,0.0,31983670.0639999993,0,0.0,0.0,0.992,522000.0,522000.0,522000.0,5220.0,337780042.0,0.0,0.0,0.0,5220.0,0.0,0.0,0.0,0.0,0.0,0.0004,0.0,0.0,33667021.1199999973,0.0,0.0,0.0,0.0,0.0,33667021.1199999973,0.0,0.0,0.0,0.0,1011739639.3269000053,0.0,0.0,0.0,0.0,0.0004,0.0,322.3547,0.0,0.0,0.0,0.0,322.3547,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,13.684269787,0.0,0.0,0.0,null,0.0,3387256.22329209,0.0,0.0,0.0,0.0,0.0,37054277.3432921618,null,null,null],["BMOBILE ACCESSORIES",0.0,0.0,0.0,0,0.0,null,19.7468955271,5.0,19.7468955271,null,null,0,10771755.4688786939,8644668.1699999832,10771755.4552999996,10771755.4552999996,3.1923214501,3.1923214501,0.0,13061.0,0.0,8644668.1699999999,0,0,0.0,0.0,36937.0,0.0,0.0,0.0,10687.0,0.0,8212434.7615,0,0.0,0.0,2.4469,1306100.0,1306100.0,1306100.0,13061.0,627615654.0,0.0,0.0,0.0,13061.0,0.0,0.0,0.0,0.0,0.0,0.0003,0.0,0.0,8644668.1699999999,0.0,0.0,0.0,0.0,0.0,8644668.1699999999,0.0,0.0,0.0,0.0,295172037.8931999803,0.0,0.0,0.0,0.0,0.0042,0.0,93.7087,0.0,0.0,0.0,0.0,93.7087,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,23.7595507508,0.0,0.0,0.0,null,0.0,2127087.2988787107,0.0,0.0,0.0,0.0,0.0,10771755.4688786939,null,null,null],["COMPLEMENTARY",0.0,0.0,0.0,0,0.0,null,3.7251162414,5.0,3.7251162414,null,null,0,3113806.9899061364,2997814.0600000015,3113806.9884000001,3113806.9884000001,0.9228089956,0.9228089956,0.0,249.0,0.0,2997814.0600000001,0,0,0.0,0.0,39.0,0.0,0.0,0.0,246.0,0.0,2847923.3569999998,0,0.0,0.0,0.0494,24900.0,24900.0,24900.0,249.0,15987788.0,0.0,0.0,0.0,249.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,2997814.0600000001,0.0,0.0,0.0,0.0,0.0,2997814.0600000001,0.0,0.0,0.0,0.0,53713988.9895000011,0.0,0.0,0.0,0.0,0.0,0.0,27.0879,0.0,0.0,0.0,0.0,27.0879,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,8.5388604293,0.0,0.0,0.0,null,0.0,115992.929906135,0.0,0.0,0.0,0.0,0.0,3113806.9899061364,null,null,null],["LAPTOP",0.0,0.0,0.0,0,0.0,null,4.2239655319,5.0,4.2239655319,null,null,0,7084184.6477330029,6784951.1300000008,7084184.6458999999,7084184.6458999999,2.0994715924,2.0994715924,0.0,302.0,0.0,6784951.1299999999,0,0,0.0,0.0,22.0,0.0,0.0,0.0,295.0,0.0,6445703.5734999999,0,0.0,0.0,0.0598,30200.0,30200.0,30200.0,302.0,19007441.0,0.0,0.0,0.0,302.0,0.0,0.0,0.0,0.0,0.0,0.0013,0.0,0.0,6784951.1299999999,0.0,0.0,0.0,0.0,0.0,6784951.1299999999,0.0,0.0,0.0,0.0,105432049.7750999928,0.0,0.0,0.0,0.0,0.0,0.0,61.6306,0.0,0.0,0.0,0.0,61.6306,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.0127672553,0.0,0.0,0.0,null,0.0,299233.5177330021,0.0,0.0,0.0,0.0,0.0,7084184.6477330029,null,null,null],["MDA",0.0,0.0,0.0,0,0.0,null,16.3005501263,5.0,16.3005501263,null,null,0,119827180.2160680443,100294690.6399999112,119827180.207100004,119827180.207100004,35.5120276183,35.5120276183,0.0,10063.0,0.0,100294690.6400000006,0,0,0.0,0.0,5120.0,0.0,0.0,0.0,9665.0,0.0,95279956.1079999954,0,0.0,0.0,1.9689,1006300.0,1006300.0,1006300.0,10063.0,546526510.0,0.0,0.0,0.0,10063.0,0.0,0.0,0.0,0.0,0.0,0.0079,0.0,0.0,100294690.6400000006,0.0,0.0,0.0,0.0,0.0,100294690.6400000006,0.0,0.0,0.0,0.0,3240827454.6041998863,0.0,0.0,0.0,0.0,0.0003,0.0,1042.4375,0.0,0.0,0.0,0.0,1042.4375,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,20.48552262,0.0,0.0,0.0,null,0.0,19532489.5760681331,0.0,0.0,0.0,0.0,0.0,119827180.2160680443,null,null,null],["MOBILE",0.0,0.0,0.0,0,0.0,null,4.7988656956,5.0,4.7988656956,null,null,0,42694295.7528806925,40645453.8400000483,42694295.7594000027,42694295.7594000027,12.6528973409,12.6528973409,0.0,3978.0,0.0,40645453.8400000036,0,0,0.0,0.0,396.0,0.0,0.0,0.0,3728.0,0.0,38613181.1480000019,0,0.0,0.0,0.7714,397800.0,397800.0,397800.0,3978.0,248824895.0,0.0,0.0,0.0,3978.0,0.0,0.0,0.0,0.0,0.0,0.006,0.0,0.0,40645453.8400000036,0.0,0.0,0.0,0.0,0.0,40645453.8400000036,0.0,0.0,0.0,0.0,712091196.2920000553,0.0,0.0,0.0,0.0,0.0001,0.0,371.4101,0.0,0.0,0.0,0.0,371.4101,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.5589224109,0.0,0.0,0.0,null,0.0,2048841.9128806442,0.0,0.0,0.0,0.0,0.0,42694295.7528806925,null,null,null],["NON",0.0,0.0,0.0,0,0.0,null,24.0,5.0,24.0,null,null,0,2653.9605263158,2017.01,2653.9605,2653.9605,0.0007865287,0.0007865287,0.0,321345.0,0.0,2017.01,0,0,0.0,0.0,0.0,0.0,0.0,0.0,13.0,0.0,1916.1595,0,0.0,0.0,51.8599,32134500.0,32134500.0,32134500.0,321345.0,82072909.0,0.0,0.0,0.0,321345.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2017.01,0.0,0.0,0.0,0.0,0.0,2017.01,0.0,0.0,0.0,0.0,63695.0526,0.0,0.0,0.0,0.0,2.7855,0.0,0.0231,0.0,0.0,0.0,0.0,0.0231,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,27.8,0.0,0.0,0.0,null,0.0,636.9505263158,0.0,0.0,0.0,0.0,0.0,2653.9605263158,null,null,null],["SDA",0.0,0.0,0.0,0,0.0,null,21.1467875816,5.0,21.1467875816,null,null,0,61326124.1069174185,48357618.9099998325,61326124.1039000005,61326124.1039000005,18.1746329095,18.1746329095,0.0,30094.0,0.0,48357618.9099999964,0,0,0.0,0.0,14848.0,0.0,0.0,0.0,25471.0,0.0,45939737.9645000026,0,0.0,0.0,5.6447,3009400.0,3009400.0,3009400.0,30094.0,1559713701.0,0.0,1.0,0.0,30094.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,48357618.9099999964,0.0,0.0,0.0,0.0,0.0,48357618.9099999964,0.0,0.0,0.0,0.0,1782373475.7172999382,0.0,0.0,0.0,0.0,0.0065,0.0,533.5224,0.0,0.0,0.0,0.0,533.5224,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.0894482025,0.0,0.0,0.0,null,0.0,12968505.196917586,0.0,0.0,0.0,0.0,0.0,61326124.1069174185,null,null,null],["TABLET",0.0,0.0,0.0,0,0.0,null,17.2052388791,5.0,17.2052388791,null,null,0,2651101.0362039264,2194972.7699999996,2651101.0303000002,2651101.0303000002,0.7856812874,0.7856812874,0.0,332.0,0.0,2194972.77,0,0,0.0,0.0,109.0,0.0,0.0,0.0,318.0,0.0,2085224.1314999999,0,0.0,0.0,0.0652,33200.0,33200.0,33200.0,332.0,20867871.0,0.0,0.0,0.0,332.0,0.0,0.0,0.0,0.0,0.0,0.0002,0.0,0.0,2194972.77,0.0,0.0,0.0,0.0,0.0,2194972.77,0.0,0.0,0.0,0.0,57254692.6172000021,0.0,0.0,0.0,0.0,0.0,0.0,23.064,0.0,0.0,0.0,0.0,23.064,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.3449769351,0.0,0.0,0.0,null,0.0,456128.2662039269,0.0,0.0,0.0,0.0,0.0,2651101.0362039264,null,null,null],["TV",0.0,0.0,0.0,0,0.0,null,15.308909678,5.0,15.308909678,null,null,0,52901650.8462176621,44802984.8999999166,52901650.8571000025,52901650.8571000025,15.6779528861,15.6779528861,0.0,10005.0,0.0,44802984.8999999985,0,0,0.0,0.0,14049.0,0.0,0.0,0.0,8046.0,0.0,42562835.6550000012,0,0.0,0.0,1.8459,1000500.0,1000500.0,1000500.0,10005.0,507154728.0,0.0,0.0,0.0,10005.0,0.0,0.0,0.0,0.0,0.0,0.0022,0.0,0.0,44802984.8999999985,0.0,0.0,0.0,0.0,0.0,44802984.8999999985,0.0,0.0,0.0,0.0,1150082395.6110999584,0.0,0.0,0.0,0.0,0.0014,0.0,460.216,0.0,0.0,0.0,0.0,460.216,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.5434641941,0.0,0.0,0.0,null,0.0,8098665.9462177455,0.0,0.0,0.0,0.0,0.0,52901650.8462176621,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":10,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":0.0,"proposed_sellthru_percent":0.0,"retail_value_including_markdown":null,"budget_gross_margin_percent":13.5597665879,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":13.5597665879,"MarkdownValue":null,"markdown_percent":null,"DisplayItemValue":0.0,"budget_amount":337427030.3686240911,"budget_cost":288392192.5499998331,"deficit":337427030.3486000299,"Original_BudgetAmount":337427030.3486000299,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":394649.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":288392192.5500000119,"PO":0.0,"COSTPRICE":0.0,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":73550.0,"net_sales_ly":0.0,"net_sales_lly":0.0,"gross_sales_ly":0.0,"total_sku_count":63110.0,"ly_customer_disc":0.0,"SupplyCost":273972582.9225000143,"SALESQTY":0.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":65.7041,"budget_qty_act_fct_percent":39464900.0,"budget_vs_py_qty_percent":39464900.0,"budget_vs_ppy_qty_percent":39464900.0,"QTY_Buy_By_SKU":394649.0,"total_sku_count_ty":3965551539.0,"total_sku_count_lly":0.0,"total_sku_count_ly":1.0,"quantity_mix_percent":0.0,"quantity_act_forecast":394649.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":0.0,"quantity_act_forecast_vs_ly_percent":0.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.0193,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":288392192.5500000119,"budget_vs_py_cost_percent":0.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":0.0,"cost_act_forecast":288392192.5500000119,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":8408750625.8790988922,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":2.7984,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":2935.455,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":2935.455,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":null,"FirstMargin_percent":18.8053836045,"budget_vpy":0.0,"budget_vppy":0.0,"StockatRetailPrice":0.0,"TYForecast":0.0,"LYvsACT_FCT_percent":0.0,"supply_retail_value":337427030.3686240911} } data_json
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'Family': 'MDA', 'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 0, 'proposed_sellthru_percent': 0, 'retail_value_including_markdown': None, 'budget_gross_margin_percent': 16.3005501263, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 16.3005501263, 'MarkdownValue': None, 'markdown_percent': None, 'DisplayItemValue': 0, 'budget_amount': 119827180.21606804, 'budget_cost': 100294690.63999991, 'deficit': 119827180.2071, 'Original_BudgetAmount': 119827180.2071, 'budget_percent': 35.5120276183, 'relative_budget_percent': 35.5120276183, 'History_Net_Sales': 0, 'budget_qty': 10063, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 100294690.64, 'PO': 0, 'COSTPRICE': 0, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 5120, 'net_sales_ly': 0, 'net_sales_lly': 0, 'gross_sales_ly': 0, 'total_sku_count': 9665, 'ly_customer_disc': 0, 'SupplyCost': 95279956.108, 'SALESQTY': 0, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 1.9689, 'budget_qty_act_fct_percent': 1006300, 'budget_vs_py_qty_percent': 1006300, 'budget_vs_ppy_qty_percent': 1006300, 'QTY_Buy_By_SKU': 10063, 'total_sku_count_ty': 546526510, 'total_sku_count_lly': 0, 'total_sku_count_ly': 0, 'quantity_mix_percent': 0, 'quantity_act_forecast': 10063, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 0, 'quantity_act_forecast_vs_ly_percent': 0, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.0079, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 100294690.64, 'budget_vs_py_cost_percent': 0, 'budget_vs_ppy_cost_percent': 0, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 0, 'cost_act_forecast': 100294690.64, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 3240827454.6042, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 0.0003, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 1042.4375, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 1042.4375, 'budget_qty_ty': 0, 'Channel': 'Retail', 'Check_box': 0, 'budget_vpy': 0, 'budget_vppy': 0, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 20.48552262, 'PurchasedRetailValueGrossSale': 0, 'ly_margin_percent': 0, 'ly_margin': 0, 'margin_act_forecast_vs_ly_margin_percent': None, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 19532489.576068133, 'budget_vs_py_margin_percent': 0, 'StockatRetailPrice': 0, 'StockatCostPrice': 0, 'TYForecast': 0, 'GrossSales': 0, 'supply_retail_value': 119827180.21606804, 'PurchaseRetailValueatGrossSale': None, 'OTBorPurchaseCost': None, 'OTBquantity': None}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
['Family', 'Channel'] ['MDA', 'Retail'] the expand heirarchy
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/otb_procedure.py", line 327, in filter_data_for_expanding
    await conn.execute(query,
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1945, in _do_execute
    result = await executor(stmt, None)
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "WHERE"

we are finding corr ex4
grp err
drilldown procedure start
conn established
['SubFamily'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] ['Channel', 'Family']   get_sp_otb_expand_heirarchy
sku wise calc executed
1379.552834914 end of sku wise stored proc
conn established
[OrderedDict([('SubFamily', 'AC COM'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('27.1219512195121951')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 27.121951219512194), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 356235.7789952549), ('budget_cost', 221014.66000000003), ('deficit', Decimal('356235.7794')), ('Original_BudgetAmount', Decimal('356235.7794')), ('budget_percent', Decimal('0.0217')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 112.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('221014.6600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('32')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('110')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('209963.9270')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0218')), ('budget_qty_act_fct_percent', Decimal('11200.0000')), ('budget_vs_py_qty_percent', Decimal('11200.0000')), ('budget_vs_ppy_qty_percent', Decimal('11200.0000')), ('QTY_Buy_By_SKU', Decimal('112.0000')), ('total_sku_count_ty', Decimal('8185226')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('112.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('221014.6600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('221014.6600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('15606557.9015')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('3.0983')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('3.0983')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('SubFamily', 'AC DOM'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('21.6144716692189893')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 21.61447166921899), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 36698041.564296976), ('budget_cost', 33446006.46000007), ('deficit', Decimal('36698041.5613')), ('Original_BudgetAmount', Decimal('36698041.5613')), ('budget_percent', Decimal('2.3269')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 5108.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('33446006.4600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('1998')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('4531')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('31773706.1370')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.9702')), ('budget_qty_act_fct_percent', Decimal('510800.0000')), ('budget_vs_py_qty_percent', Decimal('510800.0000')), ('budget_vs_ppy_qty_percent', Decimal('510800.0000')), ('QTY_Buy_By_SKU', Decimal('5108.0000')), ('total_sku_count_ty', Decimal('329594816')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('5108.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0004')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('33446006.4600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('33446006.4600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('996133081.4254')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0004')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('319.2564')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('319.2564')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('SubFamily', 'BMOBILE'), ('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-24')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('28.4391812503864943')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 28.439181250386493), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', None), ('budget_amount', 66315143.89560227), ('budget_cost', 61267859.97000012), ('deficit', Decimal('66315143.8793')), ('Original_BudgetAmount', Decimal('66315143.8793')), ('budget_percent', Decimal('4.1662')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 17922.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('61267859.9700')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('37503')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('15274')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('58204466.9715')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('3.3927')), ('budget_qty_act_fct_percent', Decimal('1792200.0000')), ('budget_vs_py_qty_percent', Decimal('1792200.0000')), ('budget_vs_ppy_qty_percent', Decimal('1792200.0000')), ('QTY_Buy_By_SKU', Decimal('17922.0000')), ('total_sku_count_ty', Decimal('932303649')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('17922.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0088')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('61267859.9700')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('61267859.9700')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('1223663965.5670')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0043')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('576.9013')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('576.9013')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'TABLET'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('SubFamily', 'MDA COM'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('41.3710691823899371')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 41.37106918238994), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 1518115.2000463104), ('budget_cost', 674051.2800000003), ('deficit', Decimal('1518115.2009')), ('Original_BudgetAmount', Decimal('1518115.2009')), ('budget_percent', Decimal('0.0944')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 152.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('674051.2800')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('17')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('151')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('640348.7160')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0301')), ('budget_qty_act_fct_percent', Decimal('15200.0000')), ('budget_vs_py_qty_percent', Decimal('15200.0000')), ('budget_vs_ppy_qty_percent', Decimal('15200.0000')), ('QTY_Buy_By_SKU', Decimal('152.0000')), ('total_sku_count_ty', Decimal('10045318')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('152.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('674051.2800')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('674051.2800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('89499610.0047')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('13.2083')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('13.2083')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'MDA'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('SubFamily', 'MDA DOM'), ('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-24')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('23.3769849049206038')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 23.376984904920604), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', None), ('budget_amount', 118309065.01602188), ('budget_cost', 99620639.36000006), ('deficit', Decimal('118309065.0062')), ('Original_BudgetAmount', Decimal('118309065.0062')), ('budget_percent', Decimal('7.5478')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 9911.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('99620639.3600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('5103')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('9514')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('94639607.3920')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('1.9388')), ('budget_qty_act_fct_percent', Decimal('991100.0000')), ('budget_vs_py_qty_percent', Decimal('991100.0000')), ('budget_vs_ppy_qty_percent', Decimal('991100.0000')), ('QTY_Buy_By_SKU', Decimal('9911.0000')), ('total_sku_count_ty', Decimal('536481192')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('9911.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0079')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('99620639.3600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('99620639.3600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('3151327844.5995')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0003')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('1029.2292')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('1029.2292')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'MDA'), ('Check_box', Decimal('0.0000'))])] 10 getData dictsize
1379.754524498 end of fetch data
shape: (10, 83)
┌───────────┬────────────┬────────────┬────────────┬───┬────────────┬─────────┬────────┬───────────┐
│ SubFamily ┆ final_pric ┆ act_foreca ┆ SalesActua ┆ … ┆ budget_qty ┆ Channel ┆ Family ┆ Check_box │
│ ---       ┆ e          ┆ st_vs_budg ┆ lsByForeca ┆   ┆ _ty        ┆ ---     ┆ ---    ┆ ---       │
│ str       ┆ ---        ┆ et_percent ┆ st         ┆   ┆ ---        ┆ str     ┆ str    ┆ f64       │
│           ┆ f64        ┆ ---        ┆ ---        ┆   ┆ f64        ┆         ┆        ┆           │
│           ┆            ┆ f64        ┆ f64        ┆   ┆            ┆         ┆        ┆           │
╞═══════════╪════════════╪════════════╪════════════╪═══╪════════════╪═════════╪════════╪═══════════╡
│ AC COM    ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ AC     ┆ 0.0       │
│ AC DOM    ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ AC     ┆ 0.0       │
│ BMOBILE   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ TABLET ┆ 0.0       │
│ MDA COM   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ MDA    ┆ 0.0       │
│ MDA DOM   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ MDA    ┆ 0.0       │
│ NON       ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ NON    ┆ 0.0       │
│ SDA COM   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ SDA    ┆ 0.0       │
│ SDA DOM   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ SDA    ┆ 0.0       │
│ TV COM    ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ TV     ┆ 0.0       │
│ TV DOM    ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ TV     ┆ 0.0       │
└───────────┴────────────┴────────────┴────────────┴───┴────────────┴─────────┴────────┴───────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 0.0               │
└───────────────────┘ ly_mgn
shape: (10, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 356235.778 ┆ 41.060405 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 995        ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 3.6698e7   ┆ 13.418524 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 6.6315e7   ┆ 12.230505 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 1.5181e6   ┆ 57.819491 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 1.1831e8   ┆ 20.006462 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2653.96052 ┆ 27.8      ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 6          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 804347.665 ┆ 54.703504 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 379        ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 6.0522e7   ┆ 24.695871 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 956415.283 ┆ 38.772726 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 018        ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 5.1945e7   ┆ 19.189415 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['SubFamily', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Channel', 'Family', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A6972A9C30>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A6972AAA10>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A6972AB100>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972AA8F0>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A6972AB9A0>, <Expr ['col("retail_value_including_ma…'] at 0x76A6972A9420>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A6972ABF10>, <Expr ['col("Logistic%").mean()'] at 0x76A6972AAC50>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A6972A8E80>, <Expr ['col("MarkdownValue").mean()'] at 0x76A6972A85B0>, <Expr ['col("markdown_percent").mean()'] at 0x76A6972AB370>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A6972ABA30>, <Expr ['col("budget_amount").sum()'] at 0x76A6972AB730>, <Expr ['col("budget_cost").sum()'] at 0x76A6972A8910>, <Expr ['col("deficit").sum()'] at 0x76A6972ABB50>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A6972A9240>, <Expr ['col("budget_percent").sum()'] at 0x76A6972A8070>, <Expr ['col("relative_budget_percent")…'] at 0x76A6972A9390>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A6972A8370>, <Expr ['col("budget_qty").sum()'] at 0x76A6972AA9B0>, <Expr ['col("ACT_FCT").sum()'] at 0x76A6972A91B0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A6972A9090>, <Expr ['col("PO").sum()'] at 0x76A6972AAE60>, <Expr ['col("COSTPRICE").sum()'] at 0x76A6972A82E0>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A6972AA2C0>, <Expr ['col("sales_actual").sum()'] at 0x76A6972A8520>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A6972AAEC0>, <Expr ['col("net_sales_ly").sum()'] at 0x76A6972AB8B0>, <Expr ['col("net_sales_lly").sum()'] at 0x76A6972A8640>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A6972A8490>, <Expr ['col("total_sku_count").sum()'] at 0x76A6972A9630>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A6972AB0A0>, <Expr ['col("SupplyCost").sum()'] at 0x76A6972A9900>, <Expr ['col("SALESQTY").sum()'] at 0x76A6972A8580>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A6972ABAF0>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A6972A9210>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A6972AB6D0>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A6972A9BA0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A6972ABD30>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A6972A8460>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A6972AA6E0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A6972AAE30>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A6972A8610>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A6972A9D80>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A6972A9CC0>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A6972A8340>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972A9E40>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A6972A9510>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972AB8E0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A6972AA920>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A6972A80A0>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A6972AAEF0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A6972ABE50>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A6972AAAD0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A6972A8160>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A6972AACE0>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A6972A9330>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A6972A8250>, <Expr ['col("cost_actuals").sum()'] at 0x76A6972AAD70>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A6972AA680>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A6972AB7F0>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A6972AAB90>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A6972AA740>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A6972AADA0>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A6972AA620>, <Expr ['col("budget_margin_percent").s…'] at 0x76A6972AA650>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A6972AADD0>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A6972AB0D0>, <Expr ['col("margin_actuals").sum()'] at 0x76A6972A9360>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A6972AAD10>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A6972AABF0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A6972A8190>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A6972AAFB0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A6972AB040>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A6972AB130>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972AA7A0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A6972AAF80>, <Expr ['col("budget_per_sku").sum()'] at 0x76A6972AA590>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A6972A9D50>, <Expr ['col("Check_box").max()'] at 0x76A6972AB400>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["SubFamily","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Channel","Family","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9],"data":[["AC COM",0.0,0.0,0.0,0,0.0,null,37.9583205754,5.0,37.9583205754,null,null,0,356235.7789952549,221014.66,356235.7794,356235.7794,0.1055741677,0.1055741677,0.0,112.0,0.0,221014.66,0,0,0.0,0.0,32.0,0.0,0.0,0.0,110.0,0.0,209963.927,0,0.0,0.0,0.0218,11200.0,11200.0,11200.0,112.0,8185226.0,0.0,0.0,0.0,112.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,221014.66,0.0,0.0,0.0,0.0,0.0,221014.66,0.0,0.0,0.0,0.0,15606557.9014999997,0.0,0.0,0.0,0.0,0.0,0.0,3.0983,0.0,0.0,0.0,0.0,3.0983,0.0,"Retail","AC",0.0,0.0,0.0,0.0,0.0,0.0,0.0,41.0604045466,0.0,0.0,0.0,null,0.0,135221.1189952549,0.0,0.0,0.0,0.0,0.0,356235.7789952549,null,null,null],["AC DOM",0.0,0.0,0.0,0,0.0,null,8.8616039594,5.0,8.8616039594,null,null,0,36698041.5642969757,33446006.4600000717,36698041.561300002,36698041.561300002,10.8758452232,10.8758452232,0.0,5108.0,0.0,33446006.4600000009,0,0,0.0,0.0,1998.0,0.0,0.0,0.0,4531.0,0.0,31773706.1369999982,0,0.0,0.0,0.9702,510800.0,510800.0,510800.0,5108.0,329594816.0,0.0,0.0,0.0,5108.0,0.0,0.0,0.0,0.0,0.0,0.0004,0.0,0.0,33446006.4600000009,0.0,0.0,0.0,0.0,0.0,33446006.4600000009,0.0,0.0,0.0,0.0,996133081.4254000187,0.0,0.0,0.0,0.0,0.0004,0.0,319.2564,0.0,0.0,0.0,0.0,319.2564,0.0,"Retail","AC",0.0,0.0,0.0,0.0,0.0,0.0,0.0,13.4185237615,0.0,0.0,0.0,null,0.0,3252035.1042969041,0.0,0.0,0.0,0.0,0.0,36698041.5642969757,null,null,null],["BMOBILE",0.0,0.0,0.0,0,0.0,null,7.6110577903,5.0,7.6110577903,null,null,0,66315143.895602271,61267859.970000118,66315143.8792999983,66315143.8792999983,19.6531806664,19.6531806664,0.0,17922.0,0.0,61267859.9699999988,0,0,0.0,0.0,37503.0,0.0,0.0,0.0,15274.0,0.0,58204466.9715000018,0,0.0,0.0,3.3927,1792200.0,1792200.0,1792200.0,17922.0,932303649.0,0.0,0.0,0.0,17922.0,0.0,0.0,0.0,0.0,0.0,0.0088,0.0,0.0,61267859.9699999988,0.0,0.0,0.0,0.0,0.0,61267859.9699999988,0.0,0.0,0.0,0.0,1223663965.5669999123,0.0,0.0,0.0,0.0,0.0043,0.0,576.9013,0.0,0.0,0.0,0.0,576.9013,0.0,"Retail","TABLET",0.0,0.0,0.0,0.0,0.0,0.0,0.0,12.2305049008,0.0,0.0,0.0,null,0.0,5047283.9256021529,0.0,0.0,0.0,0.0,0.0,66315143.895602271,null,null,null],["MDA COM",0.0,0.0,0.0,0,0.0,null,55.5994643898,5.0,55.5994643898,null,null,0,1518115.2000463104,674051.2800000003,1518115.2009000001,1518115.2009000001,0.4499091843,0.4499091843,0.0,152.0,0.0,674051.28,0,0,0.0,0.0,17.0,0.0,0.0,0.0,151.0,0.0,640348.716,0,0.0,0.0,0.0301,15200.0,15200.0,15200.0,152.0,10045318.0,0.0,0.0,0.0,152.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,674051.28,0.0,0.0,0.0,0.0,0.0,674051.28,0.0,0.0,0.0,0.0,89499610.0047000051,0.0,0.0,0.0,0.0,0.0,0.0,13.2083,0.0,0.0,0.0,0.0,13.2083,0.0,"Retail","MDA",0.0,0.0,0.0,0.0,0.0,0.0,0.0,57.8194911703,0.0,0.0,0.0,null,0.0,844063.9200463102,0.0,0.0,0.0,0.0,0.0,1518115.2000463104,null,null,null],["MDA DOM",0.0,0.0,0.0,0,0.0,null,15.7962753349,5.0,15.7962753349,null,null,0,118309065.0160218775,99620639.360000059,118309065.0062000006,118309065.0062000006,35.062118434,35.062118434,0.0,9911.0,0.0,99620639.3599999994,0,0,0.0,0.0,5103.0,0.0,0.0,0.0,9514.0,0.0,94639607.3920000046,0,0.0,0.0,1.9388,991100.0,991100.0,991100.0,9911.0,536481192.0,0.0,0.0,0.0,9911.0,0.0,0.0,0.0,0.0,0.0,0.0079,0.0,0.0,99620639.3599999994,0.0,0.0,0.0,0.0,0.0,99620639.3599999994,0.0,0.0,0.0,0.0,3151327844.5995001793,0.0,0.0,0.0,0.0,0.0003,0.0,1029.2292,0.0,0.0,0.0,0.0,1029.2292,0.0,"Retail","MDA",0.0,0.0,0.0,0.0,0.0,0.0,0.0,20.0064615681,0.0,0.0,0.0,null,0.0,18688425.6560218185,0.0,0.0,0.0,0.0,0.0,118309065.0160218775,null,null,null],["NON",0.0,0.0,0.0,0,0.0,null,24.0,5.0,24.0,null,null,0,2653.9605263158,2017.01,2653.9605,2653.9605,0.0007865287,0.0007865287,0.0,321345.0,0.0,2017.01,0,0,0.0,0.0,0.0,0.0,0.0,0.0,13.0,0.0,1916.1595,0,0.0,0.0,51.8599,32134500.0,32134500.0,32134500.0,321345.0,82072909.0,0.0,0.0,0.0,321345.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2017.01,0.0,0.0,0.0,0.0,0.0,2017.01,0.0,0.0,0.0,0.0,63695.0526,0.0,0.0,0.0,0.0,2.7855,0.0,0.0231,0.0,0.0,0.0,0.0,0.0231,0.0,"Retail","NON",0.0,0.0,0.0,0.0,0.0,0.0,0.0,27.8,0.0,0.0,0.0,null,0.0,636.9505263158,0.0,0.0,0.0,0.0,0.0,2653.9605263158,null,null,null],["SDA COM",0.0,0.0,0.0,0,0.0,null,52.3194774464,5.0,52.3194774464,null,null,0,804347.6653789092,383517.1700000005,804347.6663,804347.6663,0.2383767728,0.2383767728,0.0,281.0,0.0,383517.17,0,0,0.0,0.0,82.0,0.0,0.0,0.0,268.0,0.0,364341.3115,0,0.0,0.0,0.0548,28100.0,28100.0,28100.0,281.0,15274915.0,0.0,0.0,0.0,281.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,383517.17,0.0,0.0,0.0,0.0,0.0,383517.17,0.0,0.0,0.0,0.0,47066224.5411999971,0.0,0.0,0.0,0.0,0.0,0.0,6.9993,0.0,0.0,0.0,0.0,6.9993,0.0,"Retail","SDA",0.0,0.0,0.0,0.0,0.0,0.0,0.0,54.7035035741,0.0,0.0,0.0,null,0.0,420830.4953789087,0.0,0.0,0.0,0.0,0.0,804347.6653789092,null,null,null],["SDA DOM",0.0,0.0,0.0,0,0.0,null,20.7324957053,5.0,20.7324957053,null,null,0,60521776.4415385425,47974101.7399997935,60521776.4376000017,60521776.4376000017,17.9362561367,17.9362561367,0.0,29813.0,0.0,47974101.7400000021,0,0,0.0,0.0,14766.0,0.0,0.0,0.0,25203.0,0.0,45575396.6529999971,0,0.0,0.0,5.5899,2981300.0,2981300.0,2981300.0,29813.0,1544438786.0,0.0,1.0,0.0,29813.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,47974101.7400000021,0.0,0.0,0.0,0.0,0.0,47974101.7400000021,0.0,0.0,0.0,0.0,1735307251.1761000156,0.0,0.0,0.0,0.0,0.0065,0.0,526.5231,0.0,0.0,0.0,0.0,526.5231,0.0,"Retail","SDA",0.0,0.0,0.0,0.0,0.0,0.0,0.0,24.6958709201,0.0,0.0,0.0,null,0.0,12547674.701538749,0.0,0.0,0.0,0.0,0.0,60521776.4415385425,null,null,null],["TV COM",0.0,0.0,0.0,0,0.0,null,35.5502383803,5.0,35.5502383803,null,null,0,956415.2830184372,616407.37,956415.2817000001,956415.2817000001,0.2834435884,0.2834435884,0.0,169.0,0.0,616407.37,0,0,0.0,0.0,78.0,0.0,0.0,0.0,158.0,0.0,585587.0015,0,0.0,0.0,0.0326,16900.0,16900.0,16900.0,169.0,11989837.0,0.0,0.0,0.0,169.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,616407.37,0.0,0.0,0.0,0.0,0.0,616407.37,0.0,0.0,0.0,0.0,38259113.3003000021,0.0,0.0,0.0,0.0,0.0,0.0,8.3191,0.0,0.0,0.0,0.0,8.3191,0.0,"Retail","TV",0.0,0.0,0.0,0.0,0.0,0.0,0.0,38.7727264613,0.0,0.0,0.0,null,0.0,340007.9130184372,0.0,0.0,0.0,0.0,0.0,956415.2830184373,null,null,null],["TV DOM",0.0,0.0,0.0,0,0.0,null,14.9362264875,5.0,14.9362264875,null,null,0,51945235.5631992072,44186577.5299999118,51945235.5754000023,51945235.5754000023,15.3945092977,15.3945092977,0.0,9836.0,0.0,44186577.5300000012,0,0,0.0,0.0,13971.0,0.0,0.0,0.0,7888.0,0.0,41977248.6534999982,0,0.0,0.0,1.8133,983600.0,983600.0,983600.0,9836.0,495164891.0,0.0,0.0,0.0,9836.0,0.0,0.0,0.0,0.0,0.0,0.0022,0.0,0.0,44186577.5300000012,0.0,0.0,0.0,0.0,0.0,44186577.5300000012,0.0,0.0,0.0,0.0,1111823282.3108000755,0.0,0.0,0.0,0.0,0.0014,0.0,451.8969,0.0,0.0,0.0,0.0,451.8969,0.0,"Retail","TV",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.1894151632,0.0,0.0,0.0,null,0.0,7758658.0331992954,0.0,0.0,0.0,0.0,0.0,51945235.5631991997,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":10,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":0.0,"proposed_sellthru_percent":0.0,"retail_value_including_markdown":null,"budget_gross_margin_percent":27.3365160069,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":27.3365160069,"MarkdownValue":null,"markdown_percent":null,"DisplayItemValue":0.0,"budget_amount":337427030.3686240911,"budget_cost":288392192.5499999523,"deficit":337427030.3486000299,"Original_BudgetAmount":337427030.3486000299,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":394649.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":288392192.5500000119,"PO":0.0,"COSTPRICE":0.0,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":73550.0,"net_sales_ly":0.0,"net_sales_lly":0.0,"gross_sales_ly":0.0,"total_sku_count":63110.0,"ly_customer_disc":0.0,"SupplyCost":273972582.9225000739,"SALESQTY":0.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":65.7041,"budget_qty_act_fct_percent":39464900.0,"budget_vs_py_qty_percent":39464900.0,"budget_vs_ppy_qty_percent":39464900.0,"QTY_Buy_By_SKU":394649.0,"total_sku_count_ty":3965551539.0,"total_sku_count_lly":0.0,"total_sku_count_ly":1.0,"quantity_mix_percent":0.0,"quantity_act_forecast":394649.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":0.0,"quantity_act_forecast_vs_ly_percent":0.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.0193,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":288392192.5500000119,"budget_vs_py_cost_percent":0.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":0.0,"cost_act_forecast":288392192.5500000119,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":8408750625.8790988922,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":2.7984,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":2935.455,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":2935.455,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":null,"FirstMargin_percent":18.8053836045,"budget_vpy":0.0,"budget_vppy":0.0,"StockatRetailPrice":0.0,"TYForecast":0.0,"LYvsACT_FCT_percent":0.0,"supply_retail_value":337427030.3686240911} } data_json
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'SubFamily': 'MDA DOM', 'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 0, 'proposed_sellthru_percent': 0, 'retail_value_including_markdown': None, 'budget_gross_margin_percent': 15.7962753349, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 15.7962753349, 'MarkdownValue': None, 'markdown_percent': None, 'DisplayItemValue': 0, 'budget_amount': 118309065.01602188, 'budget_cost': 99620639.36000006, 'deficit': 118309065.0062, 'Original_BudgetAmount': 118309065.0062, 'budget_percent': 35.062118434, 'relative_budget_percent': 35.062118434, 'History_Net_Sales': 0, 'budget_qty': 9911, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 99620639.36, 'PO': 0, 'COSTPRICE': 0, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 5103, 'net_sales_ly': 0, 'net_sales_lly': 0, 'gross_sales_ly': 0, 'total_sku_count': 9514, 'ly_customer_disc': 0, 'SupplyCost': 94639607.392, 'SALESQTY': 0, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 1.9388, 'budget_qty_act_fct_percent': 991100, 'budget_vs_py_qty_percent': 991100, 'budget_vs_ppy_qty_percent': 991100, 'QTY_Buy_By_SKU': 9911, 'total_sku_count_ty': 536481192, 'total_sku_count_lly': 0, 'total_sku_count_ly': 0, 'quantity_mix_percent': 0, 'quantity_act_forecast': 9911, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 0, 'quantity_act_forecast_vs_ly_percent': 0, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.0079, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 99620639.36, 'budget_vs_py_cost_percent': 0, 'budget_vs_ppy_cost_percent': 0, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 0, 'cost_act_forecast': 99620639.36, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 3151327844.5995, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 0.0003, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 1029.2292, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 1029.2292, 'budget_qty_ty': 0, 'Channel': 'Retail', 'Family': 'MDA', 'Check_box': 0, 'budget_vpy': 0, 'budget_vppy': 0, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 20.0064615681, 'PurchasedRetailValueGrossSale': 0, 'ly_margin_percent': 0, 'ly_margin': 0, 'margin_act_forecast_vs_ly_margin_percent': None, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 18688425.65602182, 'budget_vs_py_margin_percent': 0, 'StockatRetailPrice': 0, 'StockatCostPrice': 0, 'TYForecast': 0, 'GrossSales': 0, 'supply_retail_value': 118309065.01602188, 'PurchaseRetailValueatGrossSale': None, 'OTBorPurchaseCost': None, 'OTBquantity': None}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
['SubFamily', 'Channel', 'Family'] ['MDA DOM', 'Retail', 'MDA'] the expand heirarchy
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/otb_procedure.py", line 327, in filter_data_for_expanding
    await conn.execute(query,
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1945, in _do_execute
    result = await executor(stmt, None)
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "WHERE"

we are finding corr ex4
grp err
drilldown procedure start
conn established
['Supplier'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] ['Channel', 'Family', 'SubFamily']   get_sp_otb_expand_heirarchy
sku wise calc executed
1380.802570009 end of sku wise stored proc
conn established
[OrderedDict([('Supplier', 'ALASKA'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('24.0980392156862745')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 24.098039215686274), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 507945.8034699883), ('budget_cost', 420296.2), ('deficit', Decimal('507945.8039')), ('Original_BudgetAmount', Decimal('507945.8039')), ('budget_percent', Decimal('0.0318')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 48.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('420296.2000')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('4')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('47')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('399281.3900')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0095')), ('budget_qty_act_fct_percent', Decimal('4800.0000')), ('budget_vs_py_qty_percent', Decimal('4800.0000')), ('budget_vs_ppy_qty_percent', Decimal('4800.0000')), ('QTY_Buy_By_SKU', Decimal('48.0000')), ('total_sku_count_ty', Decimal('2086955')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('48.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('420296.2000')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('420296.2000')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('13808226.3470')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('4.4190')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('4.4190')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'MDA'), ('SubFamily', 'MDA DOM'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Supplier', 'ALEXA'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('15.0000000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 15.0), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 6449.92725752508), ('budget_cost', 5438.01), ('deficit', Decimal('6449.9273')), ('Original_BudgetAmount', Decimal('6449.9273')), ('budget_percent', Decimal('0.0004')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 2.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('5438.0100')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('2')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('2')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('5166.1095')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0004')), ('budget_qty_act_fct_percent', Decimal('200.0000')), ('budget_vs_py_qty_percent', Decimal('200.0000')), ('budget_vs_ppy_qty_percent', Decimal('200.0000')), ('QTY_Buy_By_SKU', Decimal('2.0000')), ('total_sku_count_ty', Decimal('129915')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('2.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('5438.0100')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('5438.0100')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('101191.7257')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.0561')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.0561')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'COMPLEMENTARY'), ('SubFamily', 'BMOBILE'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Supplier', 'AMAZONE'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('21.6470588235294118')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 21.647058823529413), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 34879.83693089434), ('budget_cost', 27301.780000000006), ('deficit', Decimal('34879.8373')), ('Original_BudgetAmount', Decimal('34879.8373')), ('budget_percent', Decimal('0.0017')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 17.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('27301.7800')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('26')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('17')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('25936.6910')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0034')), ('budget_qty_act_fct_percent', Decimal('1700.0000')), ('budget_vs_py_qty_percent', Decimal('1700.0000')), ('budget_vs_ppy_qty_percent', Decimal('1700.0000')), ('QTY_Buy_By_SKU', Decimal('17.0000')), ('total_sku_count_ty', Decimal('566169')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('17.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('27301.7800')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('27301.7800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('757805.6934')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.3035')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.3035')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'BMOBILE ACCESSORIES'), ('SubFamily', 'BMOBILE'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Supplier', 'AMERICOOL'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('48.2500000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 48.25), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 20488.29641511777), ('budget_cost', 10666.98), ('deficit', Decimal('20488.2965')), ('Original_BudgetAmount', Decimal('20488.2965')), ('budget_percent', Decimal('0.0014')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 4.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('10666.9800')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('2')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('4')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('10133.6310')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0008')), ('budget_qty_act_fct_percent', Decimal('400.0000')), ('budget_vs_py_qty_percent', Decimal('400.0000')), ('budget_vs_ppy_qty_percent', Decimal('400.0000')), ('QTY_Buy_By_SKU', Decimal('4.0000')), ('total_sku_count_ty', Decimal('200303')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('4.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('10666.9800')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('10666.9800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('982131.6415')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.1783')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.1783')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('SubFamily', 'AC DOM'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Supplier', 'APPLE'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('10.9529983792544571')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 10.952998379254456), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 18058824.36350777), ('budget_cost', 18154356.85000001), ('deficit', Decimal('18058824.3641')), ('Original_BudgetAmount', Decimal('18058824.3641')), ('budget_percent', Decimal('1.1469')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 580.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('18154356.8500')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('156')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('570')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('17246639.0075')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.1149')), ('budget_qty_act_fct_percent', Decimal('58000.0000')), ('budget_vs_py_qty_percent', Decimal('58000.0000')), ('budget_vs_ppy_qty_percent', Decimal('58000.0000')), ('QTY_Buy_By_SKU', Decimal('580.0000')), ('total_sku_count_ty', Decimal('47090225')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('580.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0055')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('18154356.8500')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('18154356.8500')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('235495375.3514')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('157.1016')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('157.1016')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'TABLET'), ('SubFamily', 'BMOBILE'), ('Check_box', Decimal('0.0000'))])] 150 getData dictsize
1381.020764198 end of fetch data
shape: (150, 84)
┌────────────┬───────────┬───────────┬───────────┬───┬─────────┬───────────┬───────────┬───────────┐
│ Supplier   ┆ final_pri ┆ act_forec ┆ SalesActu ┆ … ┆ Channel ┆ Family    ┆ SubFamily ┆ Check_box │
│ ---        ┆ ce        ┆ ast_vs_bu ┆ alsByFore ┆   ┆ ---     ┆ ---       ┆ ---       ┆ ---       │
│ str        ┆ ---       ┆ dget_perc ┆ cast      ┆   ┆ str     ┆ str       ┆ str       ┆ f64       │
│            ┆ f64       ┆ ent       ┆ ---       ┆   ┆         ┆           ┆           ┆           │
│            ┆           ┆ ---       ┆ f64       ┆   ┆         ┆           ┆           ┆           │
│            ┆           ┆ f64       ┆           ┆   ┆         ┆           ┆           ┆           │
╞════════════╪═══════════╪═══════════╪═══════════╪═══╪═════════╪═══════════╪═══════════╪═══════════╡
│ ALASKA     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ MDA       ┆ MDA DOM   ┆ 0.0       │
│ ALEXA      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ COMPLEMEN ┆ BMOBILE   ┆ 0.0       │
│            ┆           ┆           ┆           ┆   ┆         ┆ TARY      ┆           ┆           │
│ AMAZONE    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ BMOBILE   ┆ BMOBILE   ┆ 0.0       │
│            ┆           ┆           ┆           ┆   ┆         ┆ ACCESSORI ┆           ┆           │
│            ┆           ┆           ┆           ┆   ┆         ┆ ES        ┆           ┆           │
│ AMERICOOL  ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ AC        ┆ AC DOM    ┆ 0.0       │
│ APPLE      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ TABLET    ┆ BMOBILE   ┆ 0.0       │
│ …          ┆ …         ┆ …         ┆ …         ┆ … ┆ …       ┆ …         ┆ …         ┆ …         │
│ WHITE      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ SDA       ┆ SDA DOM   ┆ 0.0       │
│ WHALE      ┆           ┆           ┆           ┆   ┆         ┆           ┆           ┆           │
│ XAIOMI     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ BMOBILE   ┆ BMOBILE   ┆ 0.0       │
│            ┆           ┆           ┆           ┆   ┆         ┆ ACCESSORI ┆           ┆           │
│            ┆           ┆           ┆           ┆   ┆         ┆ ES        ┆           ┆           │
│ XIAOMI     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ MOBILE    ┆ BMOBILE   ┆ 0.0       │
│ ZAHRAN     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ SDA       ┆ SDA DOM   ┆ 0.0       │
│ ZANUSSI    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ SDA       ┆ SDA DOM   ┆ 0.0       │
└────────────┴───────────┴───────────┴───────────┴───┴─────────┴───────────┴───────────┴───────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 0.0               │
└───────────────────┘ ly_mgn
shape: (150, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 507945.803 ┆ 21.392915 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 47         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 6449.92725 ┆ 19.904376 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 8          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 34879.8369 ┆ 25.639873 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 31         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 20488.2964 ┆ 50.539416 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 15         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 1.8059e7   ┆ 4.497443  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ …          ┆ …          ┆ …          ┆ …         ┆ …         ┆ …         ┆ …         ┆ …         │
│ 0.0        ┆ 0.0        ┆ 6.1395e6   ┆ 19.060102 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 0.0        ┆ 0.0       ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2.0664e6   ┆ 13.769169 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 68833.6172 ┆ 23.424128 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 4          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 7.7596e6   ┆ 22.394989 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['Supplier', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Channel', 'Family', 'SubFamily', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A25668BE20>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A25668BD60>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A25668BDF0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A25668BF70>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A25668BCD0>, <Expr ['col("retail_value_including_ma…'] at 0x76A25668BAF0>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A256688790>, <Expr ['col("Logistic%").mean()'] at 0x76A25668BCA0>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A25668B970>, <Expr ['col("MarkdownValue").mean()'] at 0x76A25668BFA0>, <Expr ['col("markdown_percent").mean()'] at 0x76A256689F30>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A25668BA00>, <Expr ['col("budget_amount").sum()'] at 0x76A25668B8B0>, <Expr ['col("budget_cost").sum()'] at 0x76A25668B910>, <Expr ['col("deficit").sum()'] at 0x76A25668BE80>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A25668BAC0>, <Expr ['col("budget_percent").sum()'] at 0x76A25668B6D0>, <Expr ['col("relative_budget_percent")…'] at 0x76A25668BBB0>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A25668B610>, <Expr ['col("budget_qty").sum()'] at 0x76A25668B6A0>, <Expr ['col("ACT_FCT").sum()'] at 0x76A25668B700>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A25668BA30>, <Expr ['col("PO").sum()'] at 0x76A25668B4C0>, <Expr ['col("COSTPRICE").sum()'] at 0x76A25668B550>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A25668B5E0>, <Expr ['col("sales_actual").sum()'] at 0x76A25668B370>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A25668BA60>, <Expr ['col("net_sales_ly").sum()'] at 0x76A25668B2E0>, <Expr ['col("net_sales_lly").sum()'] at 0x76A25668B310>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A25668B280>, <Expr ['col("total_sku_count").sum()'] at 0x76A25668B790>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A25668B250>, <Expr ['col("SupplyCost").sum()'] at 0x76A25668B160>, <Expr ['col("SALESQTY").sum()'] at 0x76A25668BFD0>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A25668B040>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A25668B070>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A25668B820>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A25668B4F0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A25668AE90>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A25668B340>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A25668ADD0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A25668B9A0>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A25668AD10>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A25668AD70>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A25668AE00>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A25668AD40>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A25668AAA0>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A25668ADA0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A25668AFB0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A25668ABF0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A25668AA10>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A25668AAD0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A25668AF20>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A25668B640>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A25668A890>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A25668A8C0>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A25668A9E0>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A25668A980>, <Expr ['col("cost_actuals").sum()'] at 0x76A25668A740>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A25668A920>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A25668B100>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A25668A5F0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A25668A830>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A25668A680>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A25668AB90>, <Expr ['col("budget_margin_percent").s…'] at 0x76A25668A470>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A25668A620>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A25668A410>, <Expr ['col("margin_actuals").sum()'] at 0x76A25668A950>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A25668A530>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A25668A290>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A25668AC80>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A25668A4D0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A25668A2C0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A25668A560>, <Expr ['col("initial_average_retail_pr…'] at 0x76A25668AEF0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A25668A050>, <Expr ['col("budget_per_sku").sum()'] at 0x76A25668A4A0>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A25668A7D0>, <Expr ['col("Check_box").max()'] at 0x76A256689F00>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Supplier","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Channel","Family","SubFamily","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"data":[["ALASKA",0.0,0.0,0.0,0,0.0,null,17.2556998938,5.0,17.2556998938,null,null,0,507945.8034699883,420296.2,507945.8039,507945.8039,0.1505350069,0.1505350069,0.0,48.0,0.0,420296.2,0,0,0.0,0.0,4.0,0.0,0.0,0.0,47.0,0.0,399281.39,0,0.0,0.0,0.0095,4800.0,4800.0,4800.0,48.0,2086955.0,0.0,0.0,0.0,48.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,420296.2,0.0,0.0,0.0,0.0,0.0,420296.2,0.0,0.0,0.0,0.0,13808226.3469999991,0.0,0.0,0.0,0.0,0.0,0.0,4.419,0.0,0.0,0.0,0.0,4.419,0.0,"Retail","MDA","MDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.3929148991,0.0,0.0,0.0,null,0.0,87649.6034699883,0.0,0.0,0.0,0.0,0.0,507945.8034699883,null,null,null],["ALEXA",0.0,0.0,0.0,0,0.0,null,15.6888165885,5.0,15.6888165885,null,null,0,6449.9272575251,5438.01,6449.9273,6449.9273,0.0019115028,0.0019115028,0.0,2.0,0.0,5438.01,0,0,0.0,0.0,2.0,0.0,0.0,0.0,2.0,0.0,5166.1095,0,0.0,0.0,0.0004,200.0,200.0,200.0,2.0,129915.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5438.01,0.0,0.0,0.0,0.0,0.0,5438.01,0.0,0.0,0.0,0.0,101191.7257,0.0,0.0,0.0,0.0,0.0,0.0,0.0561,0.0,0.0,0.0,0.0,0.0561,0.0,"Retail","COMPLEMENTARY","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.9043757591,0.0,0.0,0.0,null,0.0,1011.9172575251,0.0,0.0,0.0,0.0,0.0,6449.9272575251,null,null,null],["AMAZONE",0.0,0.0,0.0,0,0.0,null,21.7261822236,5.0,21.7261822236,null,null,0,34879.8369308943,27301.78,34879.8373,34879.8373,0.0103370014,0.0103370014,0.0,17.0,0.0,27301.78,0,0,0.0,0.0,26.0,0.0,0.0,0.0,17.0,0.0,25936.691,0,0.0,0.0,0.0034,1700.0,1700.0,1700.0,17.0,566169.0,0.0,0.0,0.0,17.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,27301.78,0.0,0.0,0.0,0.0,0.0,27301.78,0.0,0.0,0.0,0.0,757805.6934,0.0,0.0,0.0,0.0,0.0,0.0,0.3035,0.0,0.0,0.0,0.0,0.3035,0.0,"Retail","BMOBILE ACCESSORIES","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.6398731124,0.0,0.0,0.0,null,0.0,7578.0569308943,0.0,0.0,0.0,0.0,0.0,34879.8369308943,null,null,null],["AMERICOOL",0.0,0.0,0.0,0,0.0,null,47.9362276693,5.0,47.9362276693,null,null,0,20488.2964151178,10666.98,20488.2965,20488.2965,0.0060719191,0.0060719191,0.0,4.0,0.0,10666.98,0,0,0.0,0.0,2.0,0.0,0.0,0.0,4.0,0.0,10133.631,0,0.0,0.0,0.0008,400.0,400.0,400.0,4.0,200303.0,0.0,0.0,0.0,4.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10666.98,0.0,0.0,0.0,0.0,0.0,10666.98,0.0,0.0,0.0,0.0,982131.6415,0.0,0.0,0.0,0.0,0.0,0.0,0.1783,0.0,0.0,0.0,0.0,0.1783,0.0,"Retail","AC","AC DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,50.5394162859,0.0,0.0,0.0,null,0.0,9821.3164151178,0.0,0.0,0.0,0.0,0.0,20488.2964151178,null,null,null],["APPLE",0.0,0.0,0.0,0,0.0,null,-0.5290072298,5.0,-0.5290072298,null,null,0,18058824.36350777,18154356.8500000089,18058824.3641000018,18058824.3641000018,5.3519198933,5.3519198933,0.0,580.0,0.0,18154356.8500000015,0,0,0.0,0.0,156.0,0.0,0.0,0.0,570.0,0.0,17246639.0075000003,0,0.0,0.0,0.1149,58000.0,58000.0,58000.0,580.0,47090225.0,0.0,0.0,0.0,580.0,0.0,0.0,0.0,0.0,0.0,0.0055,0.0,0.0,18154356.8500000015,0.0,0.0,0.0,0.0,0.0,18154356.8500000015,0.0,0.0,0.0,0.0,235495375.3513999879,0.0,0.0,0.0,0.0,0.0,0.0,157.1016,0.0,0.0,0.0,0.0,157.1016,0.0,"Retail","TABLET","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.4974431317,0.0,0.0,0.0,null,0.0,-95532.4864922389,0.0,0.0,0.0,0.0,0.0,18058824.36350777,null,null,null],["ARIETE",0.0,0.0,0.0,0,0.0,null,40.1818523587,5.0,40.1818523587,null,null,0,98175.4740252717,58726.75,98175.4744,98175.4744,0.0290953199,0.0290953199,0.0,36.0,0.0,58726.75,0,0,0.0,0.0,2.0,0.0,0.0,0.0,34.0,0.0,55790.4125,0,0.0,0.0,0.0069,3600.0,3600.0,3600.0,36.0,1798627.0,0.0,0.0,0.0,36.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,58726.75,0.0,0.0,0.0,0.0,0.0,58726.75,0.0,0.0,0.0,0.0,4374680.4028000003,0.0,0.0,0.0,0.0,0.0,0.0,0.8545,0.0,0.0,0.0,0.0,0.8545,0.0,"Retail","SDA","SDA COM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,43.1727597407,0.0,0.0,0.0,null,0.0,39448.7240252717,0.0,0.0,0.0,0.0,0.0,98175.4740252717,null,null,null],["ARION",0.0,0.0,0.0,0,0.0,null,21.0,5.0,21.0,null,null,0,1633.6708860759,1290.6,1633.6709,1633.6709,0.0004841553,0.0004841553,0.0,1.0,0.0,1290.6,0,0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1226.07,0,0.0,0.0,0.0002,100.0,100.0,100.0,1.0,108789.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1290.6,0.0,0.0,0.0,0.0,0.0,1290.6,0.0,0.0,0.0,0.0,34307.0886,0.0,0.0,0.0,0.0,0.0,0.0,0.0142,0.0,0.0,0.0,0.0,0.0142,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,24.95,0.0,0.0,0.0,null,0.0,343.070886076,0.0,0.0,0.0,0.0,0.0,1633.6708860759,null,null,null],["ARISTON",0.0,0.0,0.0,0,0.0,null,57.6660888451,5.0,57.6660888451,null,null,0,788778.2415815257,333920.6800000001,788778.242,788778.242,0.2337626125,0.2337626125,0.0,61.0,0.0,333920.68,0,0,0.0,0.0,62.0,0.0,0.0,0.0,60.0,0.0,317224.646,0,0.0,0.0,0.0121,6100.0,6100.0,6100.0,61.0,3500659.0,0.0,0.0,0.0,61.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,333920.68,0.0,0.0,0.0,0.0,0.0,333920.68,0.0,0.0,0.0,0.0,47726377.1582999974,0.0,0.0,0.0,0.0,0.0,0.0,6.8626,0.0,0.0,0.0,0.0,6.8626,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,59.7827844029,0.0,0.0,0.0,null,0.0,454857.5615815255,0.0,0.0,0.0,0.0,0.0,788778.2415815258,null,null,null],["ASUS",0.0,0.0,0.0,0,0.0,null,15.4657143949,5.0,15.4657143949,null,null,0,1209954.4021445045,1022826.3099999998,1209954.4003000001,1209954.4003000001,0.3585825359,0.3585825359,0.0,88.0,0.0,1022826.3100000001,0,0,0.0,0.0,6.0,0.0,0.0,0.0,81.0,0.0,971684.9945,0,0.0,0.0,0.0172,8800.0,8800.0,8800.0,88.0,6097336.0,0.0,0.0,0.0,88.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1022826.3100000001,0.0,0.0,0.0,0.0,0.0,1022826.3100000001,0.0,0.0,0.0,0.0,28833489.2157000005,0.0,0.0,0.0,0.0,0.0,0.0,10.527,0.0,0.0,0.0,0.0,10.527,0.0,"Retail","LAPTOP","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.6924286752,0.0,0.0,0.0,null,0.0,187128.0921445047,0.0,0.0,0.0,0.0,0.0,1209954.4021445045,null,null,null],["ATLANTIC",0.0,0.0,0.0,0,0.0,null,0.1316865091,5.0,0.1316865091,null,null,0,35356.539792997,35309.98,35356.54,35356.54,0.0104782773,0.0104782773,0.0,11.0,0.0,35309.98,0,0,0.0,0.0,13.0,0.0,0.0,0.0,11.0,0.0,33544.481,0,0.0,0.0,0.0022,1100.0,1100.0,1100.0,11.0,615822.0,0.0,0.0,0.0,11.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,35309.98,0.0,0.0,0.0,0.0,0.0,35309.98,0.0,0.0,0.0,0.0,1010759.9793,0.0,0.0,0.0,0.0,0.0,0.0,0.3077,0.0,0.0,0.0,0.0,0.3077,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.1251021837,0.0,0.0,0.0,null,0.0,46.559792997,0.0,0.0,0.0,0.0,0.0,35356.539792997,null,null,null],["BABYLISS",0.0,0.0,0.0,0,0.0,null,51.6366120133,5.0,51.6366120133,null,null,0,166026.20978927,80295.9,166026.2098,166026.2098,0.0492035892,0.0492035892,0.0,74.0,0.0,80295.9,0,0,0.0,0.0,64.0,0.0,0.0,0.0,72.0,0.0,76281.105,0,0.0,0.0,0.0145,7400.0,7400.0,7400.0,74.0,4626973.0,0.0,0.0,0.0,74.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,80295.9,0.0,0.0,0.0,0.0,0.0,80295.9,0.0,0.0,0.0,0.0,9197140.9788000006,0.0,0.0,0.0,0.0,0.0,0.0,1.4444,0.0,0.0,0.0,0.0,1.4444,0.0,"Retail","SDA","SDA COM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,54.0547814126,0.0,0.0,0.0,null,0.0,85730.30978927,0.0,0.0,0.0,0.0,0.0,166026.20978927,null,null,null],["BEKO",0.0,0.0,0.0,0,0.0,null,8.6903127816,5.0,8.6903127816,null,null,0,7008700.0897193998,6399622.1300000008,7008700.0884999996,7008700.0884999996,2.0771009608,2.0771009608,0.0,449.0,0.0,6399622.1299999999,0,0,0.0,0.0,56.0,0.0,0.0,0.0,427.0,0.0,6079641.0235000001,0,0.0,0.0,0.0877,44900.0,44900.0,44900.0,449.0,23455045.0,0.0,0.0,0.0,449.0,0.0,0.0,0.0,0.0,0.0,0.0008,0.0,0.0,6399622.1299999999,0.0,0.0,0.0,0.0,0.0,6399622.1299999999,0.0,0.0,0.0,0.0,188142113.9684000015,0.0,0.0,0.0,0.0,0.0,0.0,60.9705,0.0,0.0,0.0,0.0,60.9705,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,13.2557971425,0.0,0.0,0.0,null,0.0,609077.959719399,0.0,0.0,0.0,0.0,0.0,7008700.0897193998,null,null,null],["BENQ",0.0,0.0,0.0,0,0.0,null,22.8628987474,5.0,22.8628987474,null,null,0,21868.4909415584,16868.72,21868.491,21868.491,0.0064809541,0.0064809541,0.0,5.0,0.0,16868.72,0,0,0.0,0.0,1.0,0.0,0.0,0.0,5.0,0.0,16025.284,0,0.0,0.0,0.001,500.0,500.0,500.0,5.0,302654.0,0.0,0.0,0.0,5.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,16868.72,0.0,0.0,0.0,0.0,0.0,16868.72,0.0,0.0,0.0,0.0,499977.0943,0.0,0.0,0.0,0.0,0.0,0.0,0.1902,0.0,0.0,0.0,0.0,0.1902,0.0,"Retail","COMPLEMENTARY","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,26.7197538101,0.0,0.0,0.0,null,0.0,4999.7709415584,0.0,0.0,0.0,0.0,0.0,21868.4909415584,null,null,null],["BERGEN",0.0,0.0,0.0,0,0.0,null,16.801525229,5.0,16.801525229,null,null,0,345796.6396521375,287697.53,345796.6408,345796.6408,0.1024804205,0.1024804205,0.0,66.0,0.0,287697.53,0,0,0.0,0.0,27.0,0.0,0.0,0.0,65.0,0.0,273312.6535,0,0.0,0.0,0.0131,6600.0,6600.0,6600.0,66.0,3186726.0,0.0,0.0,0.0,66.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,287697.53,0.0,0.0,0.0,0.0,0.0,287697.53,0.0,0.0,0.0,0.0,8463026.9651999995,0.0,0.0,0.0,0.0,0.0,0.0,3.0079,0.0,0.0,0.0,0.0,3.0079,0.0,"Retail","MDA","MDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,20.9614489675,0.0,0.0,0.0,null,0.0,58099.1096521376,0.0,0.0,0.0,0.0,0.0,345796.6396521375,null,null,null],["BISSELL",0.0,0.0,0.0,0,0.0,null,26.8357705114,5.0,26.8357705114,null,null,0,17701.5600253387,12951.21,17701.5601,17701.5601,0.0052460409,0.0052460409,0.0,4.0,0.0,12951.21,0,0,0.0,0.0,0.0,0.0,0.0,0.0,4.0,0.0,12303.6495,0,0.0,0.0,0.0008,400.0,400.0,400.0,4.0,227823.0,0.0,0.0,0.0,4.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,12951.21,0.0,0.0,0.0,0.0,0.0,12951.21,0.0,0.0,0.0,0.0,475035.0026,0.0,0.0,0.0,0.0,0.0,0.0,0.154,0.0,0.0,0.0,0.0,0.154,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,30.4939819858,0.0,0.0,0.0,null,0.0,4750.3500253387,0.0,0.0,0.0,0.0,0.0,17701.5600253387,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":150,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":0.0,"proposed_sellthru_percent":0.0,"retail_value_including_markdown":null,"budget_gross_margin_percent":null,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":null,"MarkdownValue":null,"markdown_percent":null,"DisplayItemValue":0.0,"budget_amount":337427030.3686251044,"budget_cost":288392192.5499997735,"deficit":337427030.3486000299,"Original_BudgetAmount":337427030.3486000299,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":394649.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":288392192.5500000715,"PO":0.0,"COSTPRICE":0.0,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":73550.0,"net_sales_ly":0.0,"net_sales_lly":0.0,"gross_sales_ly":0.0,"total_sku_count":63110.0,"ly_customer_disc":0.0,"SupplyCost":273972582.9225000143,"SALESQTY":0.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":65.7041,"budget_qty_act_fct_percent":39464900.0,"budget_vs_py_qty_percent":39464900.0,"budget_vs_ppy_qty_percent":39464900.0,"QTY_Buy_By_SKU":394649.0,"total_sku_count_ty":3965551539.0,"total_sku_count_lly":0.0,"total_sku_count_ly":1.0,"quantity_mix_percent":0.0,"quantity_act_forecast":394649.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":0.0,"quantity_act_forecast_vs_ly_percent":0.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.0193,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":288392192.5500000715,"budget_vs_py_cost_percent":0.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":0.0,"cost_act_forecast":288392192.5500000715,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":8408750625.8791007996,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":2.7984,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":2935.455,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":2935.455,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":null,"FirstMargin_percent":18.8053836045,"budget_vpy":0.0,"budget_vppy":0.0,"StockatRetailPrice":0.0,"TYForecast":0.0,"LYvsACT_FCT_percent":0.0,"supply_retail_value":337427030.3686251044} } data_json
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'Supplier': 'BERGEN', 'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 0, 'proposed_sellthru_percent': 0, 'retail_value_including_markdown': None, 'budget_gross_margin_percent': 16.801525229, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 16.801525229, 'MarkdownValue': None, 'markdown_percent': None, 'DisplayItemValue': 0, 'budget_amount': 345796.6396521375, 'budget_cost': 287697.53, 'deficit': 345796.6408, 'Original_BudgetAmount': 345796.6408, 'budget_percent': 0.1024804205, 'relative_budget_percent': 0.1024804205, 'History_Net_Sales': 0, 'budget_qty': 66, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 287697.53, 'PO': 0, 'COSTPRICE': 0, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 27, 'net_sales_ly': 0, 'net_sales_lly': 0, 'gross_sales_ly': 0, 'total_sku_count': 65, 'ly_customer_disc': 0, 'SupplyCost': 273312.6535, 'SALESQTY': 0, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 0.0131, 'budget_qty_act_fct_percent': 6600, 'budget_vs_py_qty_percent': 6600, 'budget_vs_ppy_qty_percent': 6600, 'QTY_Buy_By_SKU': 66, 'total_sku_count_ty': 3186726, 'total_sku_count_lly': 0, 'total_sku_count_ly': 0, 'quantity_mix_percent': 0, 'quantity_act_forecast': 66, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 0, 'quantity_act_forecast_vs_ly_percent': 0, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 287697.53, 'budget_vs_py_cost_percent': 0, 'budget_vs_ppy_cost_percent': 0, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 0, 'cost_act_forecast': 287697.53, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 8463026.9652, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 0, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 3.0079, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 3.0079, 'budget_qty_ty': 0, 'Channel': 'Retail', 'Family': 'MDA', 'SubFamily': 'MDA DOM', 'Check_box': 0, 'budget_vpy': 0, 'budget_vppy': 0, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 20.9614489675, 'PurchasedRetailValueGrossSale': 0, 'ly_margin_percent': 0, 'ly_margin': 0, 'margin_act_forecast_vs_ly_margin_percent': None, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 58099.1096521376, 'budget_vs_py_margin_percent': 0, 'StockatRetailPrice': 0, 'StockatCostPrice': 0, 'TYForecast': 0, 'GrossSales': 0, 'supply_retail_value': 345796.6396521375, 'PurchaseRetailValueatGrossSale': None, 'OTBorPurchaseCost': None, 'OTBquantity': None}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
['Supplier', 'Channel', 'Family', 'SubFamily'] ['BERGEN', 'Retail', 'MDA', 'MDA DOM'] the expand heirarchy
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/otb_procedure.py", line 327, in filter_data_for_expanding
    await conn.execute(query,
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1945, in _do_execute
    result = await executor(stmt, None)
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "WHERE"

we are finding corr ex4
grp err
drilldown procedure start
conn established
['Category'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] ['Channel', 'Family', 'SubFamily', 'Supplier']   get_sp_otb_expand_heirarchy
sku wise calc executed
1382.16717282 end of sku wise stored proc
conn established
[OrderedDict([('Category', 'AC Acc Union Aire'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('18.6358695652173913')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 18.63586956521739), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 82063.05849516756), ('budget_cost', 82898.61000000002), ('deficit', Decimal('82063.0600')), ('Original_BudgetAmount', Decimal('82063.0600')), ('budget_percent', Decimal('0.0022')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 171.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('82898.6100')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('92')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('151')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('78753.6795')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0327')), ('budget_qty_act_fct_percent', Decimal('17100.0000')), ('budget_vs_py_qty_percent', Decimal('17100.0000')), ('budget_vs_ppy_qty_percent', Decimal('17100.0000')), ('QTY_Buy_By_SKU', Decimal('171.0000')), ('total_sku_count_ty', Decimal('14637017')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('171.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('82898.6100')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('82898.6100')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('2022349.8510')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.7121')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.7121')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('SubFamily', 'AC DOM'), ('Supplier', 'UNION AIRE'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Category', 'AC Accessory Carrier'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('23.4986225895316804')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 23.49862258953168), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 166577.09172242368), ('budget_cost', 141493.98999999993), ('deficit', Decimal('166577.0923')), ('Original_BudgetAmount', Decimal('166577.0923')), ('budget_percent', Decimal('0.0075')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 367.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('141493.9900')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('416')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('315')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('134419.2905')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0688')), ('budget_qty_act_fct_percent', Decimal('36700.0000')), ('budget_vs_py_qty_percent', Decimal('36700.0000')), ('budget_vs_ppy_qty_percent', Decimal('36700.0000')), ('QTY_Buy_By_SKU', Decimal('367.0000')), ('total_sku_count_ty', Decimal('18438566')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('367.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('141493.9900')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('141493.9900')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('5575924.1728')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0001')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('1.4492')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('1.4492')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('SubFamily', 'AC DOM'), ('Supplier', 'CARRIERE'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Category', 'AC Accessory Crafft'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('13.7575757575757576')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 13.757575757575758), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 18714.2926765887), ('budget_cost', 20366.160000000018), ('deficit', Decimal('18714.2936')), ('Original_BudgetAmount', Decimal('18714.2936')), ('budget_percent', Decimal('0.0000')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 63.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('20366.1600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('32')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('57')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('19347.8520')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0120')), ('budget_qty_act_fct_percent', Decimal('6300.0000')), ('budget_vs_py_qty_percent', Decimal('6300.0000')), ('budget_vs_ppy_qty_percent', Decimal('6300.0000')), ('QTY_Buy_By_SKU', Decimal('63.0000')), ('total_sku_count_ty', Decimal('3917259')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('63.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('20366.1600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('20366.1600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('301059.2692')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.1619')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.1619')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('SubFamily', 'AC COM'), ('Supplier', 'CRAFT'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Category', 'AC Accessory Daikin'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('37.1250000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 37.125), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 3402.9850746268653), ('budget_cost', 2295.0), ('deficit', Decimal('3402.9850')), ('Original_BudgetAmount', Decimal('3402.9850')), ('budget_percent', Decimal('0.0000')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 9.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('2295.0000')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', None), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('7')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('2180.2500')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0016')), ('budget_qty_act_fct_percent', Decimal('900.0000')), ('budget_vs_py_qty_percent', Decimal('900.0000')), ('budget_vs_ppy_qty_percent', Decimal('900.0000')), ('QTY_Buy_By_SKU', Decimal('9.0000')), ('total_sku_count_ty', Decimal('531341')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('9.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('2295.0000')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('2295.0000')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('161798.5075')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.0295')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.0295')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('SubFamily', 'AC DOM'), ('Supplier', 'DAIKIN'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Category', 'AC Accessory Fresh'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('12.7219626168224299')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 12.72196261682243), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 191157.12460911108), ('budget_cost', 204981.48000000016), ('deficit', Decimal('191157.1191')), ('Original_BudgetAmount', Decimal('191157.1191')), ('budget_percent', Decimal('0.0050')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 439.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('204981.4800')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('291')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('361')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('194732.4060')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0809')), ('budget_qty_act_fct_percent', Decimal('43900.0000')), ('budget_vs_py_qty_percent', Decimal('43900.0000')), ('budget_vs_ppy_qty_percent', Decimal('43900.0000')), ('QTY_Buy_By_SKU', Decimal('439.0000')), ('total_sku_count_ty', Decimal('29025963')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('439.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('204981.4800')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('204981.4800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('3336884.4584')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0001')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('1.6633')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('1.6633')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('SubFamily', 'AC DOM'), ('Supplier', 'FRESH'), ('Check_box', Decimal('0.0000'))])] 581 getData dictsize
1382.439837388 end of fetch data
shape: (581, 85)
┌────────────┬────────────┬───────────┬───────────┬───┬────────┬───────────┬───────────┬───────────┐
│ Category   ┆ final_pric ┆ act_forec ┆ SalesActu ┆ … ┆ Family ┆ SubFamily ┆ Supplier  ┆ Check_box │
│ ---        ┆ e          ┆ ast_vs_bu ┆ alsByFore ┆   ┆ ---    ┆ ---       ┆ ---       ┆ ---       │
│ str        ┆ ---        ┆ dget_perc ┆ cast      ┆   ┆ str    ┆ str       ┆ str       ┆ f64       │
│            ┆ f64        ┆ ent       ┆ ---       ┆   ┆        ┆           ┆           ┆           │
│            ┆            ┆ ---       ┆ f64       ┆   ┆        ┆           ┆           ┆           │
│            ┆            ┆ f64       ┆           ┆   ┆        ┆           ┆           ┆           │
╞════════════╪════════════╪═══════════╪═══════════╪═══╪════════╪═══════════╪═══════════╪═══════════╡
│ AC Acc     ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ AC     ┆ AC DOM    ┆ UNION     ┆ 0.0       │
│ Union Aire ┆            ┆           ┆           ┆   ┆        ┆           ┆ AIRE      ┆           │
│ AC         ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ AC     ┆ AC DOM    ┆ CARRIERE  ┆ 0.0       │
│ Accessory  ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ Carrier    ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ AC         ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ AC     ┆ AC COM    ┆ CRAFT     ┆ 0.0       │
│ Accessory  ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ Crafft     ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ AC         ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ AC     ┆ AC DOM    ┆ DAIKIN    ┆ 0.0       │
│ Accessory  ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ Daikin     ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ AC         ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ AC     ┆ AC DOM    ┆ FRESH     ┆ 0.0       │
│ Accessory  ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ Fresh      ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ …          ┆ …          ┆ …         ┆ …         ┆ … ┆ …      ┆ …         ┆ …         ┆ …         │
│ mosq.kill  ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ SDA    ┆ SDA DOM   ┆ HOME TECH ┆ 0.0       │
│ Home       ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ tv acc     ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ TV     ┆ TV DOM    ┆ ELIOS     ┆ 0.0       │
│ elios      ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ tv acc     ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ TV     ┆ TV DOM    ┆ KEENDEX   ┆ 0.0       │
│ keendex    ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ tv acc     ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ TV     ┆ TV DOM    ┆ SCHNEIDER ┆ 0.0       │
│ schneider  ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
│ tv acc     ┆ 0.0        ┆ 0.0       ┆ 0.0       ┆ … ┆ TV     ┆ TV DOM    ┆ TRUMAN    ┆ 0.0       │
│ truman     ┆            ┆           ┆           ┆   ┆        ┆           ┆           ┆           │
└────────────┴────────────┴───────────┴───────────┴───┴────────┴───────────┴───────────┴───────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 0.0               │
└───────────────────┘ ly_mgn
shape: (581, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 82063.0584 ┆ 4.032727  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 95         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 166577.091 ┆ 19.305056 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 722        ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 18714.2926 ┆ -3.38543  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 77         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 3402.98507 ┆ 35.93125  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 5          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 191157.124 ┆ -1.870336 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 609        ┆           ┆           ┆           ┆           ┆           │
│ …          ┆ …          ┆ …          ┆ …         ┆ …         ┆ …         ┆ …         ┆ …         │
│ 0.0        ┆ 0.0        ┆ 13198.9523 ┆ 37.722054 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 81         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 5924.53741 ┆ 36.304301 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 9          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 3834.54039 ┆ 31.120337 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 7          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 2403.27731 ┆ 44.263611 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 1          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 29570.0104 ┆ 3.767829  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 87         ┆           ┆           ┆           ┆           ┆           │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
['Category', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Channel', 'Family', 'SubFamily', 'Supplier', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
[<Expr ['col("final_price").mean()'] at 0x76A2535E7E50>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A2535E7D90>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A2535E7E20>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2535E7F70>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A2535E7C70>, <Expr ['col("retail_value_including_ma…'] at 0x76A2535E7AF0>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A2535E4B80>, <Expr ['col("Logistic%").mean()'] at 0x76A2535E7C40>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A2535E7970>, <Expr ['col("MarkdownValue").mean()'] at 0x76A2535E7FA0>, <Expr ['col("markdown_percent").mean()'] at 0x76A2535E5ED0>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A2535E7A00>, <Expr ['col("budget_amount").sum()'] at 0x76A2535E7880>, <Expr ['col("budget_cost").sum()'] at 0x76A2535E7940>, <Expr ['col("deficit").sum()'] at 0x76A2535E7D60>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A2535E7AC0>, <Expr ['col("budget_percent").sum()'] at 0x76A2535E76D0>, <Expr ['col("relative_budget_percent")…'] at 0x76A2535E7B20>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A2535E75E0>, <Expr ['col("budget_qty").sum()'] at 0x76A2535E76A0>, <Expr ['col("ACT_FCT").sum()'] at 0x76A2535E7760>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A2535E7A30>, <Expr ['col("PO").sum()'] at 0x76A2535E74C0>, <Expr ['col("COSTPRICE").sum()'] at 0x76A2535E7520>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A2535E7610>, <Expr ['col("sales_actual").sum()'] at 0x76A2535E73A0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A2535E7A60>, <Expr ['col("net_sales_ly").sum()'] at 0x76A2535E72E0>, <Expr ['col("net_sales_lly").sum()'] at 0x76A2535E7310>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A2535E7280>, <Expr ['col("total_sku_count").sum()'] at 0x76A2535E77C0>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A2535E7250>, <Expr ['col("SupplyCost").sum()'] at 0x76A2535E7160>, <Expr ['col("SALESQTY").sum()'] at 0x76A2535E7FD0>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A2535E6FE0>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A2535E70D0>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A2535E7910>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A2535E7550>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A2535E6EF0>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A2535E7340>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A2535E6DD0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A2535E79A0>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A2535E6D10>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A2535E6D70>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A2535E6E30>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A2535E6D40>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2535E6BF0>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A2535E6DA0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2535E7040>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A2535E6BC0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2535E6A70>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A2535E69E0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A2535E6F20>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A2535E7640>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A2535E6890>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A2535E6950>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A2535E6A40>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A2535E69B0>, <Expr ['col("cost_actuals").sum()'] at 0x76A2535E6740>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A2535E68C0>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A2535E7100>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A2535E6620>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A2535E6830>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A2535E66B0>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A2535E6B30>, <Expr ['col("budget_margin_percent").s…'] at 0x76A2535E6470>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A2535E6650>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A2535E6380>, <Expr ['col("margin_actuals").sum()'] at 0x76A2535E6980>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A2535E64D0>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A2535E6290>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A2535E6CB0>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A2535E6530>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A2535E62C0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A2535E6500>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2535E6EC0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2535E6020>, <Expr ['col("budget_per_sku").sum()'] at 0x76A2535E64A0>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A2535E67D0>, <Expr ['col("Check_box").max()'] at 0x76A2535E5FC0>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Category","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Channel","Family","SubFamily","Supplier","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"data":[["AC Acc Union Aire",0.0,0.0,0.0,0,0.0,null,-1.0181822615,5.0,-1.0181822615,null,null,0,82063.0584951676,82898.61,82063.06,82063.06,0.0243202385,0.0243202385,0.0,171.0,0.0,82898.61,0,0,0.0,0.0,92.0,0.0,0.0,0.0,151.0,0.0,78753.6795,0,0.0,0.0,0.0327,17100.0,17100.0,17100.0,171.0,14637017.0,0.0,0.0,0.0,171.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,82898.61,0.0,0.0,0.0,0.0,0.0,82898.61,0.0,0.0,0.0,0.0,2022349.851,0.0,0.0,0.0,0.0,0.0,0.0,0.7121,0.0,0.0,0.0,0.0,0.7121,0.0,"Retail","AC","AC DOM","UNION AIRE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.0327268516,0.0,0.0,0.0,null,0.0,-835.5515048325,0.0,0.0,0.0,0.0,0.0,82063.0584951676,null,null,null],["AC Accessory Carrier",0.0,0.0,0.0,0,0.0,null,15.0579539258,5.0,15.0579539258,null,null,0,166577.0917224237,141493.9899999999,166577.0923,166577.0923,0.0493668487,0.0493668487,0.0,367.0,0.0,141493.99,0,0,0.0,0.0,416.0,0.0,0.0,0.0,315.0,0.0,134419.2905,0,0.0,0.0,0.0688,36700.0,36700.0,36700.0,367.0,18438566.0,0.0,0.0,0.0,367.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,141493.99,0.0,0.0,0.0,0.0,0.0,141493.99,0.0,0.0,0.0,0.0,5575924.1727999998,0.0,0.0,0.0,0.0,0.0001,0.0,1.4492,0.0,0.0,0.0,0.0,1.4492,0.0,"Retail","AC","AC DOM","CARRIERE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.3050562295,0.0,0.0,0.0,null,0.0,25083.1017224237,0.0,0.0,0.0,0.0,0.0,166577.0917224237,null,null,null],["AC Accessory Crafft",0.0,0.0,0.0,0,0.0,null,-8.8267686733,5.0,-8.8267686733,null,null,0,18714.2926765887,20366.16,18714.2936,18714.2936,0.0055461747,0.0055461747,0.0,63.0,0.0,20366.16,0,0,0.0,0.0,32.0,0.0,0.0,0.0,57.0,0.0,19347.852,0,0.0,0.0,0.012,6300.0,6300.0,6300.0,63.0,3917259.0,0.0,0.0,0.0,63.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,20366.16,0.0,0.0,0.0,0.0,0.0,20366.16,0.0,0.0,0.0,0.0,301059.2692,0.0,0.0,0.0,0.0,0.0,0.0,0.1619,0.0,0.0,0.0,0.0,0.1619,0.0,"Retail","AC","AC COM","CRAFT",0.0,0.0,0.0,0.0,0.0,0.0,0.0,-3.3854302397,0.0,0.0,0.0,null,0.0,-1651.8673234113,0.0,0.0,0.0,0.0,0.0,18714.2926765887,null,null,null],["AC Accessory Daikin",0.0,0.0,0.0,0,0.0,null,32.5592105263,5.0,32.5592105263,null,null,0,3402.9850746269,2295.0,3402.985,3402.985,0.0010085099,0.0010085099,0.0,9.0,0.0,2295.0,0,0,0.0,0.0,0.0,0.0,0.0,0.0,7.0,0.0,2180.25,0,0.0,0.0,0.0016,900.0,900.0,900.0,9.0,531341.0,0.0,0.0,0.0,9.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2295.0,0.0,0.0,0.0,0.0,0.0,2295.0,0.0,0.0,0.0,0.0,161798.5075,0.0,0.0,0.0,0.0,0.0,0.0,0.0295,0.0,0.0,0.0,0.0,0.0295,0.0,"Retail","AC","AC DOM","DAIKIN",0.0,0.0,0.0,0.0,0.0,0.0,0.0,35.93125,0.0,0.0,0.0,null,0.0,1107.9850746269,0.0,0.0,0.0,0.0,0.0,3402.9850746269,null,null,null],["AC Accessory Fresh",0.0,0.0,0.0,0,0.0,null,-7.2319331122,5.0,-7.2319331122,null,null,0,191157.1246091111,204981.4800000002,191157.1191,191157.1191,0.0566513964,0.0566513964,0.0,439.0,0.0,204981.48,0,0,0.0,0.0,291.0,0.0,0.0,0.0,361.0,0.0,194732.406,0,0.0,0.0,0.0809,43900.0,43900.0,43900.0,439.0,29025963.0,0.0,0.0,0.0,439.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,204981.48,0.0,0.0,0.0,0.0,0.0,204981.48,0.0,0.0,0.0,0.0,3336884.4583999999,0.0,0.0,0.0,0.0,0.0001,0.0,1.6633,0.0,0.0,0.0,0.0,1.6633,0.0,"Retail","AC","AC DOM","FRESH",0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.8703364566,0.0,0.0,0.0,null,0.0,-13824.3553908891,0.0,0.0,0.0,0.0,0.0,191157.1246091111,null,null,null],["AC Accessory Haier",0.0,0.0,0.0,0,0.0,null,null,5.0,null,null,null,0,0.0,1536.36,0.0,0.0,0.0,0.0,0.0,4.0,0.0,1536.36,0,0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1459.542,0,0.0,0.0,0.0008,400.0,400.0,400.0,4.0,322137.0,0.0,0.0,0.0,4.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1536.36,0.0,0.0,0.0,0.0,0.0,1536.36,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,"Retail","AC","AC DOM","HAIER",0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,null,0.0,-1536.36,0.0,0.0,0.0,0.0,0.0,1459.542,null,null,null],["AC Accessory LG",0.0,0.0,0.0,0,0.0,null,15.6902081201,5.0,15.6902081201,null,null,0,10807.1076880119,9111.45,10807.1078,10807.1078,0.0032027984,0.0032027984,0.0,18.0,0.0,9111.45,0,0,0.0,0.0,2.0,0.0,0.0,0.0,17.0,0.0,8655.8775,0,0.0,0.0,0.0035,1800.0,1800.0,1800.0,18.0,1349791.0,0.0,0.0,0.0,18.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9111.45,0.0,0.0,0.0,0.0,0.0,9111.45,0.0,0.0,0.0,0.0,248795.7686,0.0,0.0,0.0,0.0,0.0,0.0,0.0946,0.0,0.0,0.0,0.0,0.0946,0.0,"Retail","AC","AC DOM","LG",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.9056977141,0.0,0.0,0.0,null,0.0,1695.6576880119,0.0,0.0,0.0,0.0,0.0,10807.1076880119,null,null,null],["AC Accessory Premium",0.0,0.0,0.0,0,0.0,null,-1.3664269359,5.0,-1.3664269359,null,null,0,4559.8529411765,4622.16,4559.8525,4559.8525,0.0013513597,0.0013513597,0.0,46.0,0.0,4622.16,0,0,0.0,0.0,22.0,0.0,0.0,0.0,13.0,0.0,4391.052,0,0.0,0.0,0.009,4600.0,4600.0,4600.0,46.0,3723257.0,0.0,0.0,0.0,46.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4622.16,0.0,0.0,0.0,0.0,0.0,4622.16,0.0,0.0,0.0,0.0,56885.2937,0.0,0.0,0.0,0.0,0.0,0.0,0.0393,0.0,0.0,0.0,0.0,0.0393,0.0,"Retail","AC","AC DOM","PREMIUM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.7018944109,0.0,0.0,0.0,null,0.0,-62.3070588235,0.0,0.0,0.0,0.0,0.0,4559.8529411765,null,null,null],["AC Accessory Sharp",0.0,0.0,0.0,0,0.0,null,9.4768767239,5.0,9.4768767239,null,null,0,453502.3595548177,410524.4999999995,453502.3516,453502.3516,0.1344001277,0.1344001277,0.0,609.0,0.0,410524.5,0,0,0.0,0.0,617.0,0.0,0.0,0.0,554.0,0.0,389998.275,0,0.0,0.0,0.1167,60900.0,60900.0,60900.0,609.0,42945906.0,0.0,0.0,0.0,609.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,410524.5,0.0,0.0,0.0,0.0,0.0,410524.5,0.0,0.0,0.0,0.0,11842668.9516000003,0.0,0.0,0.0,0.0,0.0,0.0,3.941,0.0,0.0,0.0,0.0,3.941,0.0,"Retail","AC","AC DOM","SHARP",0.0,0.0,0.0,0.0,0.0,0.0,0.0,14.0030328877,0.0,0.0,0.0,null,0.0,42977.8595548181,0.0,0.0,0.0,0.0,0.0,453502.3595548177,null,null,null],["AC Accessory Zanussi",0.0,0.0,0.0,0,0.0,null,25.6872888757,5.0,25.6872888757,null,null,0,29960.6348135342,22264.56,29960.635,29960.635,0.0088791449,0.0088791449,0.0,93.0,0.0,22264.56,0,0,0.0,0.0,18.0,0.0,0.0,0.0,86.0,0.0,21151.332,0,0.0,0.0,0.0178,9300.0,9300.0,9300.0,93.0,6209280.0,0.0,0.0,0.0,93.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,22264.56,0.0,0.0,0.0,0.0,0.0,22264.56,0.0,0.0,0.0,0.0,1143233.4801,0.0,0.0,0.0,0.0,0.0,0.0,0.262,0.0,0.0,0.0,0.0,0.262,0.0,"Retail","AC","AC DOM","ZANUSSI",0.0,0.0,0.0,0.0,0.0,0.0,0.0,29.4029244319,0.0,0.0,0.0,null,0.0,7696.0748135342,0.0,0.0,0.0,0.0,0.0,29960.6348135342,null,null,null],["AC Americool",0.0,0.0,0.0,0,0.0,null,47.1934389347,5.0,47.1934389347,null,null,0,16490.3372314443,8707.98,16490.3373,16490.3373,0.0048870825,0.0048870825,0.0,3.0,0.0,8707.98,0,0,0.0,0.0,1.0,0.0,0.0,0.0,3.0,0.0,8272.581,0,0.0,0.0,0.0006,300.0,300.0,300.0,3.0,159929.0,0.0,0.0,0.0,3.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,8707.98,0.0,0.0,0.0,0.0,0.0,8707.98,0.0,0.0,0.0,0.0,778235.7230999999,0.0,0.0,0.0,0.0,0.0,0.0,0.1435,0.0,0.0,0.0,0.0,0.1435,0.0,"Retail","AC","AC DOM","AMERICOOL",0.0,0.0,0.0,0.0,0.0,0.0,0.0,49.8337669879,0.0,0.0,0.0,null,0.0,7782.3572314443,0.0,0.0,0.0,0.0,0.0,16490.3372314443,null,null,null],["AC Beko",0.0,0.0,0.0,0,0.0,null,18.9100277266,5.0,18.9100277266,null,null,0,1932749.3474982711,1567265.9099999981,1932749.3470999999,1932749.3470999999,0.5727903142,0.5727903142,0.0,183.0,0.0,1567265.9099999999,0,0,0.0,0.0,3.0,0.0,0.0,0.0,160.0,0.0,1488902.6144999999,0,0.0,0.0,0.035,18300.0,18300.0,18300.0,183.0,10561404.0,0.0,0.0,0.0,183.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1567265.9099999999,0.0,0.0,0.0,0.0,0.0,1567265.9099999999,0.0,0.0,0.0,0.0,53064979.7475999966,0.0,0.0,0.0,0.0,0.0,0.0,16.8126,0.0,0.0,0.0,0.0,16.8126,0.0,"Retail","AC","AC DOM","BEKO",0.0,0.0,0.0,0.0,0.0,0.0,0.0,22.9645263403,0.0,0.0,0.0,null,0.0,365483.4374982731,0.0,0.0,0.0,0.0,0.0,1932749.3474982711,null,null,null],["AC Carriere",0.0,0.0,0.0,0,0.0,null,12.6717505137,5.0,12.6717505137,null,null,0,5890540.1634199573,5144105.6100000059,5890540.1640999997,5890540.1640999997,1.7457226699,1.7457226699,0.0,434.0,0.0,5144105.6100000003,0,0,0.0,0.0,41.0,0.0,0.0,0.0,377.0,0.0,4886900.3295,0,0.0,0.0,0.0813,43400.0,43400.0,43400.0,434.0,28642051.0,0.0,0.0,0.0,434.0,0.0,0.0,0.0,0.0,0.0,0.0001,0.0,0.0,5144105.6100000003,0.0,0.0,0.0,0.0,0.0,5144105.6100000003,0.0,0.0,0.0,0.0,188961358.342599988,0.0,0.0,0.0,0.0,0.0,0.0,51.2448,0.0,0.0,0.0,0.0,51.2448,0.0,"Retail","AC","AC DOM","CARRIERE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,17.038162988,0.0,0.0,0.0,null,0.0,746434.5534199513,0.0,0.0,0.0,0.0,0.0,5890540.1634199573,null,null,null],["AC Crafft",0.0,0.0,0.0,0,0.0,null,38.8374042801,5.0,38.8374042801,null,null,0,21058.6222647832,12880.0,21058.6222,21058.6222,0.0062409411,0.0062409411,0.0,5.0,0.0,12880.0,0,0,0.0,0.0,0.0,0.0,0.0,0.0,5.0,0.0,12236.0,0,0.0,0.0,0.001,500.0,500.0,500.0,5.0,127523.0,0.0,0.0,0.0,5.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,12880.0,0.0,0.0,0.0,0.0,0.0,12880.0,0.0,0.0,0.0,0.0,817862.2266000001,0.0,0.0,0.0,0.0,0.0,0.0,0.1832,0.0,0.0,0.0,0.0,0.1832,0.0,"Retail","AC","AC COM","CRAFT",0.0,0.0,0.0,0.0,0.0,0.0,0.0,41.8955340661,0.0,0.0,0.0,null,0.0,8178.6222647832,0.0,0.0,0.0,0.0,0.0,21058.6222647832,null,null,null],["AC Daikin",0.0,0.0,0.0,0,0.0,null,-3.5454545455,5.0,-3.5454545455,null,null,0,4186.5671641791,4335.0,4186.567,4186.567,0.0012407326,0.0012407326,0.0,11.0,0.0,4335.0,0,0,0.0,0.0,6.0,0.0,0.0,0.0,12.0,0.0,4118.25,0,0.0,0.0,0.0022,1100.0,1100.0,1100.0,11.0,832914.0,0.0,0.0,0.0,11.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4335.0,0.0,0.0,0.0,0.0,0.0,4335.0,0.0,0.0,0.0,0.0,138156.7165,0.0,0.0,0.0,0.0,0.0,0.0,0.0363,0.0,0.0,0.0,0.0,0.0363,0.0,"Retail","AC","AC DOM","DAIKIN",0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.6318181818,0.0,0.0,0.0,null,0.0,-148.4328358209,0.0,0.0,0.0,0.0,0.0,4186.5671641791,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":581,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":0.0,"proposed_sellthru_percent":0.0,"retail_value_including_markdown":null,"budget_gross_margin_percent":null,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":null,"MarkdownValue":null,"markdown_percent":null,"DisplayItemValue":0.0,"budget_amount":337427030.3686244488,"budget_cost":288392192.5500001311,"deficit":337427030.3485999703,"Original_BudgetAmount":337427030.3485999703,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":394649.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":288392192.5500000119,"PO":0.0,"COSTPRICE":0.0,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":73550.0,"net_sales_ly":0.0,"net_sales_lly":0.0,"gross_sales_ly":0.0,"total_sku_count":63110.0,"ly_customer_disc":0.0,"SupplyCost":273972582.9225000143,"SALESQTY":0.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":65.7041,"budget_qty_act_fct_percent":39464900.0,"budget_vs_py_qty_percent":39464900.0,"budget_vs_ppy_qty_percent":39464900.0,"QTY_Buy_By_SKU":394649.0,"total_sku_count_ty":3965551539.0,"total_sku_count_lly":0.0,"total_sku_count_ly":1.0,"quantity_mix_percent":0.0,"quantity_act_forecast":394649.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":0.0,"quantity_act_forecast_vs_ly_percent":0.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.0193,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":288392192.5500000119,"budget_vs_py_cost_percent":0.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":0.0,"cost_act_forecast":288392192.5500000119,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":8408750625.8791007996,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":2.7984,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":2935.455,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":2935.455,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":null,"FirstMargin_percent":18.8053836045,"budget_vpy":0.0,"budget_vppy":0.0,"StockatRetailPrice":0.0,"TYForecast":0.0,"LYvsACT_FCT_percent":0.0,"supply_retail_value":337427030.3686244488} } data_json
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'SubFamily': 'MDA DOM', 'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 0, 'proposed_sellthru_percent': 0, 'retail_value_including_markdown': None, 'budget_gross_margin_percent': 15.7962753349, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 15.7962753349, 'MarkdownValue': None, 'markdown_percent': None, 'DisplayItemValue': 0, 'budget_amount': 118309065.01602188, 'budget_cost': 99620639.36000006, 'deficit': 118309065.0062, 'Original_BudgetAmount': 118309065.0062, 'budget_percent': 35.062118434, 'relative_budget_percent': 35.062118434, 'History_Net_Sales': 0, 'budget_qty': 9911, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 99620639.36, 'PO': 0, 'COSTPRICE': 0, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 5103, 'net_sales_ly': 0, 'net_sales_lly': 0, 'gross_sales_ly': 0, 'total_sku_count': 9514, 'ly_customer_disc': 0, 'SupplyCost': 94639607.392, 'SALESQTY': 0, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 1.9388, 'budget_qty_act_fct_percent': 991100, 'budget_vs_py_qty_percent': 991100, 'budget_vs_ppy_qty_percent': 991100, 'QTY_Buy_By_SKU': 9911, 'total_sku_count_ty': 536481192, 'total_sku_count_lly': 0, 'total_sku_count_ly': 0, 'quantity_mix_percent': 0, 'quantity_act_forecast': 9911, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 0, 'quantity_act_forecast_vs_ly_percent': 0, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.0079, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 99620639.36, 'budget_vs_py_cost_percent': 0, 'budget_vs_ppy_cost_percent': 0, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 0, 'cost_act_forecast': 99620639.36, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 3151327844.5995, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 0.0003, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 1029.2292, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 1029.2292, 'budget_qty_ty': 0, 'Channel': 'Retail', 'Family': 'MDA', 'Check_box': 0, 'budget_vpy': 0, 'budget_vppy': 0, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 20.0064615681, 'PurchasedRetailValueGrossSale': 0, 'ly_margin_percent': 0, 'ly_margin': 0, 'margin_act_forecast_vs_ly_margin_percent': None, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 18688425.65602182, 'budget_vs_py_margin_percent': 0, 'StockatRetailPrice': 0, 'StockatCostPrice': 0, 'TYForecast': 0, 'GrossSales': 0, 'supply_retail_value': 118309065.01602188, 'PurchaseRetailValueatGrossSale': None, 'OTBorPurchaseCost': None, 'OTBquantity': None}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
['SubFamily', 'Channel', 'Family'] ['MDA DOM', 'Retail', 'MDA'] the expand heirarchy
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/otb_procedure.py", line 327, in filter_data_for_expanding
    await conn.execute(query,
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1945, in _do_execute
    result = await executor(stmt, None)
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "WHERE"

we are finding corr ex4
grp err
drilldown procedure start
conn established
['Supplier'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] ['Channel', 'Family', 'SubFamily']   get_sp_otb_expand_heirarchy
sku wise calc executed
1383.420459859 end of sku wise stored proc
conn established
[OrderedDict([('Supplier', 'ALASKA'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('24.0980392156862745')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 24.098039215686274), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 507945.8034699883), ('budget_cost', 420296.2), ('deficit', Decimal('507945.8039')), ('Original_BudgetAmount', Decimal('507945.8039')), ('budget_percent', Decimal('0.0318')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 48.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('420296.2000')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('4')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('47')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('399281.3900')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0095')), ('budget_qty_act_fct_percent', Decimal('4800.0000')), ('budget_vs_py_qty_percent', Decimal('4800.0000')), ('budget_vs_ppy_qty_percent', Decimal('4800.0000')), ('QTY_Buy_By_SKU', Decimal('48.0000')), ('total_sku_count_ty', Decimal('2086955')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('48.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('420296.2000')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('420296.2000')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('13808226.3470')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('4.4190')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('4.4190')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'MDA'), ('SubFamily', 'MDA DOM'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Supplier', 'ALEXA'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('15.0000000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 15.0), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 6449.92725752508), ('budget_cost', 5438.01), ('deficit', Decimal('6449.9273')), ('Original_BudgetAmount', Decimal('6449.9273')), ('budget_percent', Decimal('0.0004')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 2.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('5438.0100')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('2')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('2')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('5166.1095')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0004')), ('budget_qty_act_fct_percent', Decimal('200.0000')), ('budget_vs_py_qty_percent', Decimal('200.0000')), ('budget_vs_ppy_qty_percent', Decimal('200.0000')), ('QTY_Buy_By_SKU', Decimal('2.0000')), ('total_sku_count_ty', Decimal('129915')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('2.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('5438.0100')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('5438.0100')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('101191.7257')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.0561')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.0561')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'COMPLEMENTARY'), ('SubFamily', 'BMOBILE'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Supplier', 'AMAZONE'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('21.6470588235294118')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 21.647058823529413), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 34879.83693089434), ('budget_cost', 27301.780000000006), ('deficit', Decimal('34879.8373')), ('Original_BudgetAmount', Decimal('34879.8373')), ('budget_percent', Decimal('0.0017')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 17.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('27301.7800')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('26')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('17')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('25936.6910')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0034')), ('budget_qty_act_fct_percent', Decimal('1700.0000')), ('budget_vs_py_qty_percent', Decimal('1700.0000')), ('budget_vs_ppy_qty_percent', Decimal('1700.0000')), ('QTY_Buy_By_SKU', Decimal('17.0000')), ('total_sku_count_ty', Decimal('566169')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('17.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('27301.7800')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('27301.7800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('757805.6934')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.3035')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.3035')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'BMOBILE ACCESSORIES'), ('SubFamily', 'BMOBILE'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Supplier', 'AMERICOOL'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('48.2500000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 48.25), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 20488.29641511777), ('budget_cost', 10666.98), ('deficit', Decimal('20488.2965')), ('Original_BudgetAmount', Decimal('20488.2965')), ('budget_percent', Decimal('0.0014')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 4.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('10666.9800')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('2')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('4')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('10133.6310')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0008')), ('budget_qty_act_fct_percent', Decimal('400.0000')), ('budget_vs_py_qty_percent', Decimal('400.0000')), ('budget_vs_ppy_qty_percent', Decimal('400.0000')), ('QTY_Buy_By_SKU', Decimal('4.0000')), ('total_sku_count_ty', Decimal('200303')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('4.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('10666.9800')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('10666.9800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('982131.6415')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('0.1783')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('0.1783')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('SubFamily', 'AC DOM'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Supplier', 'APPLE'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('10.9529983792544571')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 10.952998379254456), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 18058824.36350777), ('budget_cost', 18154356.85000001), ('deficit', Decimal('18058824.3641')), ('Original_BudgetAmount', Decimal('18058824.3641')), ('budget_percent', Decimal('1.1469')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 580.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('18154356.8500')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('156')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('570')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('17246639.0075')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.1149')), ('budget_qty_act_fct_percent', Decimal('58000.0000')), ('budget_vs_py_qty_percent', Decimal('58000.0000')), ('budget_vs_ppy_qty_percent', Decimal('58000.0000')), ('QTY_Buy_By_SKU', Decimal('580.0000')), ('total_sku_count_ty', Decimal('47090225')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('580.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0055')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('18154356.8500')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('18154356.8500')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('235495375.3514')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('157.1016')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('157.1016')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'TABLET'), ('SubFamily', 'BMOBILE'), ('Check_box', Decimal('0.0000'))])] 150 getData dictsize
1383.643684851 end of fetch data
shape: (150, 84)
┌────────────┬───────────┬───────────┬───────────┬───┬─────────┬───────────┬───────────┬───────────┐
│ Supplier   ┆ final_pri ┆ act_forec ┆ SalesActu ┆ … ┆ Channel ┆ Family    ┆ SubFamily ┆ Check_box │
│ ---        ┆ ce        ┆ ast_vs_bu ┆ alsByFore ┆   ┆ ---     ┆ ---       ┆ ---       ┆ ---       │
│ str        ┆ ---       ┆ dget_perc ┆ cast      ┆   ┆ str     ┆ str       ┆ str       ┆ f64       │
│            ┆ f64       ┆ ent       ┆ ---       ┆   ┆         ┆           ┆           ┆           │
│            ┆           ┆ ---       ┆ f64       ┆   ┆         ┆           ┆           ┆           │
│            ┆           ┆ f64       ┆           ┆   ┆         ┆           ┆           ┆           │
╞════════════╪═══════════╪═══════════╪═══════════╪═══╪═════════╪═══════════╪═══════════╪═══════════╡
│ ALASKA     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ MDA       ┆ MDA DOM   ┆ 0.0       │
│ ALEXA      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ COMPLEMEN ┆ BMOBILE   ┆ 0.0       │
│            ┆           ┆           ┆           ┆   ┆         ┆ TARY      ┆           ┆           │
│ AMAZONE    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ BMOBILE   ┆ BMOBILE   ┆ 0.0       │
│            ┆           ┆           ┆           ┆   ┆         ┆ ACCESSORI ┆           ┆           │
│            ┆           ┆           ┆           ┆   ┆         ┆ ES        ┆           ┆           │
│ AMERICOOL  ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ AC        ┆ AC DOM    ┆ 0.0       │
│ APPLE      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ TABLET    ┆ BMOBILE   ┆ 0.0       │
│ …          ┆ …         ┆ …         ┆ …         ┆ … ┆ …       ┆ …         ┆ …         ┆ …         │
│ WHITE      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ SDA       ┆ SDA DOM   ┆ 0.0       │
│ WHALE      ┆           ┆           ┆           ┆   ┆         ┆           ┆           ┆           │
│ XAIOMI     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ BMOBILE   ┆ BMOBILE   ┆ 0.0       │
│            ┆           ┆           ┆           ┆   ┆         ┆ ACCESSORI ┆           ┆           │
│            ┆           ┆           ┆           ┆   ┆         ┆ ES        ┆           ┆           │
│ XIAOMI     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ MOBILE    ┆ BMOBILE   ┆ 0.0       │
│ ZAHRAN     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ SDA       ┆ SDA DOM   ┆ 0.0       │
│ ZANUSSI    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ Retail  ┆ SDA       ┆ SDA DOM   ┆ 0.0       │
└────────────┴───────────┴───────────┴───────────┴───┴─────────┴───────────┴───────────┴───────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 0.0               │
└───────────────────┘ ly_mgn
shape: (150, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 507945.803 ┆ 21.392915 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 47         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 6449.92725 ┆ 19.904376 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 8          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 34879.8369 ┆ 25.639873 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 31         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 20488.2964 ┆ 50.539416 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 15         ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 1.8059e7   ┆ 4.497443  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ …          ┆ …          ┆ …          ┆ …         ┆ …         ┆ …         ┆ …         ┆ …         │
│ 0.0        ┆ 0.0        ┆ 6.1395e6   ┆ 19.060102 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 0.0        ┆ 0.0       ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2.0664e6   ┆ 13.769169 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 68833.6172 ┆ 23.424128 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 4          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 7.7596e6   ┆ 22.394989 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['Supplier', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Channel', 'Family', 'SubFamily', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A2552AFE20>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A2552AFD60>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A2552AFDF0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2552AFF70>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A2552AFCD0>, <Expr ['col("retail_value_including_ma…'] at 0x76A2552AFAF0>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A2552AE260>, <Expr ['col("Logistic%").mean()'] at 0x76A2552AFCA0>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A2552AF970>, <Expr ['col("MarkdownValue").mean()'] at 0x76A2552AFFA0>, <Expr ['col("markdown_percent").mean()'] at 0x76A2552ACAF0>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A2552AFA00>, <Expr ['col("budget_amount").sum()'] at 0x76A2552AF8B0>, <Expr ['col("budget_cost").sum()'] at 0x76A2552AF910>, <Expr ['col("deficit").sum()'] at 0x76A2552AFE80>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A2552AFAC0>, <Expr ['col("budget_percent").sum()'] at 0x76A2552AF6D0>, <Expr ['col("relative_budget_percent")…'] at 0x76A2552AFBB0>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A2552AF610>, <Expr ['col("budget_qty").sum()'] at 0x76A2552AF6A0>, <Expr ['col("ACT_FCT").sum()'] at 0x76A2552AF700>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A2552AFA30>, <Expr ['col("PO").sum()'] at 0x76A2552AF4C0>, <Expr ['col("COSTPRICE").sum()'] at 0x76A2552AF550>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A2552AF5E0>, <Expr ['col("sales_actual").sum()'] at 0x76A2552AF370>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A2552AFA60>, <Expr ['col("net_sales_ly").sum()'] at 0x76A2552AF2E0>, <Expr ['col("net_sales_lly").sum()'] at 0x76A2552AF310>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A2552AF280>, <Expr ['col("total_sku_count").sum()'] at 0x76A2552AF790>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A2552AF250>, <Expr ['col("SupplyCost").sum()'] at 0x76A2552AF160>, <Expr ['col("SALESQTY").sum()'] at 0x76A2552AFFD0>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A2552AF040>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A2552AF070>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A2552AF820>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A2552AF4F0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A2552AEE90>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A2552AF340>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A2552AEDD0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A2552AF9A0>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A2552AED10>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A2552AED70>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A2552AEE00>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A2552AED40>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2552AEAA0>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A2552AEDA0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2552AEFB0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A2552AEBF0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2552AEA10>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A2552AEAD0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A2552AEF20>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A2552AF640>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A2552AC190>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A2552AC160>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A2552AC040>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A2552AC0A0>, <Expr ['col("cost_actuals").sum()'] at 0x76A2552AC310>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A2552AC100>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A2552AF100>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A2552AC430>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A2552AC250>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A2552AC340>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A2552AEB90>, <Expr ['col("budget_margin_percent").s…'] at 0x76A2552AC5B0>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A2552AC2E0>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A2552AC610>, <Expr ['col("margin_actuals").sum()'] at 0x76A2552AC0D0>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A2552AC4F0>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A2552AC790>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A2552AEC80>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A2552AC520>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A2552AC760>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A2552AC4C0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2552AEEF0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2552AC9D0>, <Expr ['col("budget_per_sku").sum()'] at 0x76A2552AC580>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A2552AC220>, <Expr ['col("Check_box").max()'] at 0x76A2552ACB20>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Supplier","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Channel","Family","SubFamily","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"data":[["ALASKA",0.0,0.0,0.0,0,0.0,null,17.2556998938,5.0,17.2556998938,null,null,0,507945.8034699883,420296.2,507945.8039,507945.8039,0.1505350069,0.1505350069,0.0,48.0,0.0,420296.2,0,0,0.0,0.0,4.0,0.0,0.0,0.0,47.0,0.0,399281.39,0,0.0,0.0,0.0095,4800.0,4800.0,4800.0,48.0,2086955.0,0.0,0.0,0.0,48.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,420296.2,0.0,0.0,0.0,0.0,0.0,420296.2,0.0,0.0,0.0,0.0,13808226.3469999991,0.0,0.0,0.0,0.0,0.0,0.0,4.419,0.0,0.0,0.0,0.0,4.419,0.0,"Retail","MDA","MDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.3929148991,0.0,0.0,0.0,null,0.0,87649.6034699883,0.0,0.0,0.0,0.0,0.0,507945.8034699883,null,null,null],["ALEXA",0.0,0.0,0.0,0,0.0,null,15.6888165885,5.0,15.6888165885,null,null,0,6449.9272575251,5438.01,6449.9273,6449.9273,0.0019115028,0.0019115028,0.0,2.0,0.0,5438.01,0,0,0.0,0.0,2.0,0.0,0.0,0.0,2.0,0.0,5166.1095,0,0.0,0.0,0.0004,200.0,200.0,200.0,2.0,129915.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5438.01,0.0,0.0,0.0,0.0,0.0,5438.01,0.0,0.0,0.0,0.0,101191.7257,0.0,0.0,0.0,0.0,0.0,0.0,0.0561,0.0,0.0,0.0,0.0,0.0561,0.0,"Retail","COMPLEMENTARY","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.9043757591,0.0,0.0,0.0,null,0.0,1011.9172575251,0.0,0.0,0.0,0.0,0.0,6449.9272575251,null,null,null],["AMAZONE",0.0,0.0,0.0,0,0.0,null,21.7261822236,5.0,21.7261822236,null,null,0,34879.8369308943,27301.78,34879.8373,34879.8373,0.0103370014,0.0103370014,0.0,17.0,0.0,27301.78,0,0,0.0,0.0,26.0,0.0,0.0,0.0,17.0,0.0,25936.691,0,0.0,0.0,0.0034,1700.0,1700.0,1700.0,17.0,566169.0,0.0,0.0,0.0,17.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,27301.78,0.0,0.0,0.0,0.0,0.0,27301.78,0.0,0.0,0.0,0.0,757805.6934,0.0,0.0,0.0,0.0,0.0,0.0,0.3035,0.0,0.0,0.0,0.0,0.3035,0.0,"Retail","BMOBILE ACCESSORIES","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.6398731124,0.0,0.0,0.0,null,0.0,7578.0569308943,0.0,0.0,0.0,0.0,0.0,34879.8369308943,null,null,null],["AMERICOOL",0.0,0.0,0.0,0,0.0,null,47.9362276693,5.0,47.9362276693,null,null,0,20488.2964151178,10666.98,20488.2965,20488.2965,0.0060719191,0.0060719191,0.0,4.0,0.0,10666.98,0,0,0.0,0.0,2.0,0.0,0.0,0.0,4.0,0.0,10133.631,0,0.0,0.0,0.0008,400.0,400.0,400.0,4.0,200303.0,0.0,0.0,0.0,4.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10666.98,0.0,0.0,0.0,0.0,0.0,10666.98,0.0,0.0,0.0,0.0,982131.6415,0.0,0.0,0.0,0.0,0.0,0.0,0.1783,0.0,0.0,0.0,0.0,0.1783,0.0,"Retail","AC","AC DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,50.5394162859,0.0,0.0,0.0,null,0.0,9821.3164151178,0.0,0.0,0.0,0.0,0.0,20488.2964151178,null,null,null],["APPLE",0.0,0.0,0.0,0,0.0,null,-0.5290072298,5.0,-0.5290072298,null,null,0,18058824.36350777,18154356.8500000089,18058824.3641000018,18058824.3641000018,5.3519198933,5.3519198933,0.0,580.0,0.0,18154356.8500000015,0,0,0.0,0.0,156.0,0.0,0.0,0.0,570.0,0.0,17246639.0075000003,0,0.0,0.0,0.1149,58000.0,58000.0,58000.0,580.0,47090225.0,0.0,0.0,0.0,580.0,0.0,0.0,0.0,0.0,0.0,0.0055,0.0,0.0,18154356.8500000015,0.0,0.0,0.0,0.0,0.0,18154356.8500000015,0.0,0.0,0.0,0.0,235495375.3513999879,0.0,0.0,0.0,0.0,0.0,0.0,157.1016,0.0,0.0,0.0,0.0,157.1016,0.0,"Retail","TABLET","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.4974431317,0.0,0.0,0.0,null,0.0,-95532.4864922389,0.0,0.0,0.0,0.0,0.0,18058824.36350777,null,null,null],["ARIETE",0.0,0.0,0.0,0,0.0,null,40.1818523587,5.0,40.1818523587,null,null,0,98175.4740252717,58726.75,98175.4744,98175.4744,0.0290953199,0.0290953199,0.0,36.0,0.0,58726.75,0,0,0.0,0.0,2.0,0.0,0.0,0.0,34.0,0.0,55790.4125,0,0.0,0.0,0.0069,3600.0,3600.0,3600.0,36.0,1798627.0,0.0,0.0,0.0,36.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,58726.75,0.0,0.0,0.0,0.0,0.0,58726.75,0.0,0.0,0.0,0.0,4374680.4028000003,0.0,0.0,0.0,0.0,0.0,0.0,0.8545,0.0,0.0,0.0,0.0,0.8545,0.0,"Retail","SDA","SDA COM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,43.1727597407,0.0,0.0,0.0,null,0.0,39448.7240252717,0.0,0.0,0.0,0.0,0.0,98175.4740252717,null,null,null],["ARION",0.0,0.0,0.0,0,0.0,null,21.0,5.0,21.0,null,null,0,1633.6708860759,1290.6,1633.6709,1633.6709,0.0004841553,0.0004841553,0.0,1.0,0.0,1290.6,0,0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1226.07,0,0.0,0.0,0.0002,100.0,100.0,100.0,1.0,108789.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1290.6,0.0,0.0,0.0,0.0,0.0,1290.6,0.0,0.0,0.0,0.0,34307.0886,0.0,0.0,0.0,0.0,0.0,0.0,0.0142,0.0,0.0,0.0,0.0,0.0142,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,24.95,0.0,0.0,0.0,null,0.0,343.070886076,0.0,0.0,0.0,0.0,0.0,1633.6708860759,null,null,null],["ARISTON",0.0,0.0,0.0,0,0.0,null,57.6660888451,5.0,57.6660888451,null,null,0,788778.2415815252,333920.6799999999,788778.242,788778.242,0.2337626125,0.2337626125,0.0,61.0,0.0,333920.68,0,0,0.0,0.0,62.0,0.0,0.0,0.0,60.0,0.0,317224.646,0,0.0,0.0,0.0121,6100.0,6100.0,6100.0,61.0,3500659.0,0.0,0.0,0.0,61.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,333920.68,0.0,0.0,0.0,0.0,0.0,333920.68,0.0,0.0,0.0,0.0,47726377.1582999974,0.0,0.0,0.0,0.0,0.0,0.0,6.8626,0.0,0.0,0.0,0.0,6.8626,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,59.7827844029,0.0,0.0,0.0,null,0.0,454857.5615815253,0.0,0.0,0.0,0.0,0.0,788778.2415815251,null,null,null],["ASUS",0.0,0.0,0.0,0,0.0,null,15.4657143949,5.0,15.4657143949,null,null,0,1209954.4021445047,1022826.3099999998,1209954.4003000001,1209954.4003000001,0.3585825359,0.3585825359,0.0,88.0,0.0,1022826.3100000001,0,0,0.0,0.0,6.0,0.0,0.0,0.0,81.0,0.0,971684.9945,0,0.0,0.0,0.0172,8800.0,8800.0,8800.0,88.0,6097336.0,0.0,0.0,0.0,88.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1022826.3100000001,0.0,0.0,0.0,0.0,0.0,1022826.3100000001,0.0,0.0,0.0,0.0,28833489.2157000005,0.0,0.0,0.0,0.0,0.0,0.0,10.527,0.0,0.0,0.0,0.0,10.527,0.0,"Retail","LAPTOP","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.6924286752,0.0,0.0,0.0,null,0.0,187128.0921445049,0.0,0.0,0.0,0.0,0.0,1209954.4021445047,null,null,null],["ATLANTIC",0.0,0.0,0.0,0,0.0,null,0.1316865091,5.0,0.1316865091,null,null,0,35356.539792997,35309.98,35356.54,35356.54,0.0104782773,0.0104782773,0.0,11.0,0.0,35309.98,0,0,0.0,0.0,13.0,0.0,0.0,0.0,11.0,0.0,33544.481,0,0.0,0.0,0.0022,1100.0,1100.0,1100.0,11.0,615822.0,0.0,0.0,0.0,11.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,35309.98,0.0,0.0,0.0,0.0,0.0,35309.98,0.0,0.0,0.0,0.0,1010759.9793,0.0,0.0,0.0,0.0,0.0,0.0,0.3077,0.0,0.0,0.0,0.0,0.3077,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,5.1251021837,0.0,0.0,0.0,null,0.0,46.559792997,0.0,0.0,0.0,0.0,0.0,35356.539792997,null,null,null],["BABYLISS",0.0,0.0,0.0,0,0.0,null,51.6366120133,5.0,51.6366120133,null,null,0,166026.20978927,80295.9,166026.2098,166026.2098,0.0492035892,0.0492035892,0.0,74.0,0.0,80295.9,0,0,0.0,0.0,64.0,0.0,0.0,0.0,72.0,0.0,76281.105,0,0.0,0.0,0.0145,7400.0,7400.0,7400.0,74.0,4626973.0,0.0,0.0,0.0,74.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,80295.9,0.0,0.0,0.0,0.0,0.0,80295.9,0.0,0.0,0.0,0.0,9197140.9788000006,0.0,0.0,0.0,0.0,0.0,0.0,1.4444,0.0,0.0,0.0,0.0,1.4444,0.0,"Retail","SDA","SDA COM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,54.0547814126,0.0,0.0,0.0,null,0.0,85730.30978927,0.0,0.0,0.0,0.0,0.0,166026.20978927,null,null,null],["BEKO",0.0,0.0,0.0,0,0.0,null,8.6903127816,5.0,8.6903127816,null,null,0,7008700.0897193952,6399622.1299999999,7008700.0884999996,7008700.0884999996,2.0771009608,2.0771009608,0.0,449.0,0.0,6399622.1299999999,0,0,0.0,0.0,56.0,0.0,0.0,0.0,427.0,0.0,6079641.0235000001,0,0.0,0.0,0.0877,44900.0,44900.0,44900.0,449.0,23455045.0,0.0,0.0,0.0,449.0,0.0,0.0,0.0,0.0,0.0,0.0008,0.0,0.0,6399622.1299999999,0.0,0.0,0.0,0.0,0.0,6399622.1299999999,0.0,0.0,0.0,0.0,188142113.9684000015,0.0,0.0,0.0,0.0,0.0,0.0,60.9705,0.0,0.0,0.0,0.0,60.9705,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,13.2557971425,0.0,0.0,0.0,null,0.0,609077.9597193953,0.0,0.0,0.0,0.0,0.0,7008700.0897193952,null,null,null],["BENQ",0.0,0.0,0.0,0,0.0,null,22.8628987474,5.0,22.8628987474,null,null,0,21868.4909415584,16868.72,21868.491,21868.491,0.0064809541,0.0064809541,0.0,5.0,0.0,16868.72,0,0,0.0,0.0,1.0,0.0,0.0,0.0,5.0,0.0,16025.284,0,0.0,0.0,0.001,500.0,500.0,500.0,5.0,302654.0,0.0,0.0,0.0,5.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,16868.72,0.0,0.0,0.0,0.0,0.0,16868.72,0.0,0.0,0.0,0.0,499977.0943,0.0,0.0,0.0,0.0,0.0,0.0,0.1902,0.0,0.0,0.0,0.0,0.1902,0.0,"Retail","COMPLEMENTARY","BMOBILE",0.0,0.0,0.0,0.0,0.0,0.0,0.0,26.7197538101,0.0,0.0,0.0,null,0.0,4999.7709415584,0.0,0.0,0.0,0.0,0.0,21868.4909415584,null,null,null],["BERGEN",0.0,0.0,0.0,0,0.0,null,16.801525229,5.0,16.801525229,null,null,0,345796.6396521376,287697.5299999999,345796.6408,345796.6408,0.1024804205,0.1024804205,0.0,66.0,0.0,287697.53,0,0,0.0,0.0,27.0,0.0,0.0,0.0,65.0,0.0,273312.6535,0,0.0,0.0,0.0131,6600.0,6600.0,6600.0,66.0,3186726.0,0.0,0.0,0.0,66.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,287697.53,0.0,0.0,0.0,0.0,0.0,287697.53,0.0,0.0,0.0,0.0,8463026.9651999995,0.0,0.0,0.0,0.0,0.0,0.0,3.0079,0.0,0.0,0.0,0.0,3.0079,0.0,"Retail","MDA","MDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,20.9614489675,0.0,0.0,0.0,null,0.0,58099.1096521377,0.0,0.0,0.0,0.0,0.0,345796.6396521376,null,null,null],["BISSELL",0.0,0.0,0.0,0,0.0,null,26.8357705114,5.0,26.8357705114,null,null,0,17701.5600253387,12951.21,17701.5601,17701.5601,0.0052460409,0.0052460409,0.0,4.0,0.0,12951.21,0,0,0.0,0.0,0.0,0.0,0.0,0.0,4.0,0.0,12303.6495,0,0.0,0.0,0.0008,400.0,400.0,400.0,4.0,227823.0,0.0,0.0,0.0,4.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,12951.21,0.0,0.0,0.0,0.0,0.0,12951.21,0.0,0.0,0.0,0.0,475035.0026,0.0,0.0,0.0,0.0,0.0,0.0,0.154,0.0,0.0,0.0,0.0,0.154,0.0,"Retail","SDA","SDA DOM",0.0,0.0,0.0,0.0,0.0,0.0,0.0,30.4939819858,0.0,0.0,0.0,null,0.0,4750.3500253387,0.0,0.0,0.0,0.0,0.0,17701.5600253387,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":150,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":0.0,"proposed_sellthru_percent":0.0,"retail_value_including_markdown":null,"budget_gross_margin_percent":null,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":null,"MarkdownValue":null,"markdown_percent":null,"DisplayItemValue":0.0,"budget_amount":337427030.3686251044,"budget_cost":288392192.5499998331,"deficit":337427030.3486000299,"Original_BudgetAmount":337427030.3486000299,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":394649.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":288392192.5500000715,"PO":0.0,"COSTPRICE":0.0,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":73550.0,"net_sales_ly":0.0,"net_sales_lly":0.0,"gross_sales_ly":0.0,"total_sku_count":63110.0,"ly_customer_disc":0.0,"SupplyCost":273972582.9225000143,"SALESQTY":0.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":65.7041,"budget_qty_act_fct_percent":39464900.0,"budget_vs_py_qty_percent":39464900.0,"budget_vs_ppy_qty_percent":39464900.0,"QTY_Buy_By_SKU":394649.0,"total_sku_count_ty":3965551539.0,"total_sku_count_lly":0.0,"total_sku_count_ly":1.0,"quantity_mix_percent":0.0,"quantity_act_forecast":394649.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":0.0,"quantity_act_forecast_vs_ly_percent":0.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.0193,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":288392192.5500000715,"budget_vs_py_cost_percent":0.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":0.0,"cost_act_forecast":288392192.5500000715,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":8408750625.8791007996,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":2.7984,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":2935.455,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":2935.455,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":null,"FirstMargin_percent":18.8053836045,"budget_vpy":0.0,"budget_vppy":0.0,"StockatRetailPrice":0.0,"TYForecast":0.0,"LYvsACT_FCT_percent":0.0,"supply_retail_value":337427030.3686251044} } data_json
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'Family': 'MDA', 'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 0, 'proposed_sellthru_percent': 0, 'retail_value_including_markdown': None, 'budget_gross_margin_percent': 16.3005501263, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 16.3005501263, 'MarkdownValue': None, 'markdown_percent': None, 'DisplayItemValue': 0, 'budget_amount': 119827180.21606804, 'budget_cost': 100294690.63999991, 'deficit': 119827180.2071, 'Original_BudgetAmount': 119827180.2071, 'budget_percent': 35.5120276183, 'relative_budget_percent': 35.5120276183, 'History_Net_Sales': 0, 'budget_qty': 10063, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 100294690.64, 'PO': 0, 'COSTPRICE': 0, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 5120, 'net_sales_ly': 0, 'net_sales_lly': 0, 'gross_sales_ly': 0, 'total_sku_count': 9665, 'ly_customer_disc': 0, 'SupplyCost': 95279956.108, 'SALESQTY': 0, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 1.9689, 'budget_qty_act_fct_percent': 1006300, 'budget_vs_py_qty_percent': 1006300, 'budget_vs_ppy_qty_percent': 1006300, 'QTY_Buy_By_SKU': 10063, 'total_sku_count_ty': 546526510, 'total_sku_count_lly': 0, 'total_sku_count_ly': 0, 'quantity_mix_percent': 0, 'quantity_act_forecast': 10063, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 0, 'quantity_act_forecast_vs_ly_percent': 0, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.0079, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 100294690.64, 'budget_vs_py_cost_percent': 0, 'budget_vs_ppy_cost_percent': 0, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 0, 'cost_act_forecast': 100294690.64, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 3240827454.6042, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 0.0003, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 1042.4375, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 1042.4375, 'budget_qty_ty': 0, 'Channel': 'Retail', 'Check_box': 0, 'budget_vpy': 0, 'budget_vppy': 0, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 20.48552262, 'PurchasedRetailValueGrossSale': 0, 'ly_margin_percent': 0, 'ly_margin': 0, 'margin_act_forecast_vs_ly_margin_percent': None, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 19532489.576068133, 'budget_vs_py_margin_percent': 0, 'StockatRetailPrice': 0, 'StockatCostPrice': 0, 'TYForecast': 0, 'GrossSales': 0, 'supply_retail_value': 119827180.21606804, 'PurchaseRetailValueatGrossSale': None, 'OTBorPurchaseCost': None, 'OTBquantity': None}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
['Family', 'Channel'] ['MDA', 'Retail'] the expand heirarchy
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/otb_procedure.py", line 327, in filter_data_for_expanding
    await conn.execute(query,
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/asyncpg/connection.py", line 1945, in _do_execute
    result = await executor(stmt, None)
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "WHERE"

we are finding corr ex4
grp err
drilldown procedure start
conn established
['SubFamily'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] ['Channel', 'Family']   get_sp_otb_expand_heirarchy
sku wise calc executed
1384.625672355 end of sku wise stored proc
conn established
[OrderedDict([('SubFamily', 'AC COM'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('27.1219512195121951')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 27.121951219512194), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 356235.7789952549), ('budget_cost', 221014.66000000003), ('deficit', Decimal('356235.7794')), ('Original_BudgetAmount', Decimal('356235.7794')), ('budget_percent', Decimal('0.0217')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 112.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('221014.6600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('32')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('110')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('209963.9270')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0218')), ('budget_qty_act_fct_percent', Decimal('11200.0000')), ('budget_vs_py_qty_percent', Decimal('11200.0000')), ('budget_vs_ppy_qty_percent', Decimal('11200.0000')), ('QTY_Buy_By_SKU', Decimal('112.0000')), ('total_sku_count_ty', Decimal('8185226')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('112.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('221014.6600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('221014.6600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('15606557.9015')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('3.0983')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('3.0983')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('SubFamily', 'AC DOM'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('21.6144716692189893')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 21.61447166921899), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 36698041.564296976), ('budget_cost', 33446006.460000135), ('deficit', Decimal('36698041.5613')), ('Original_BudgetAmount', Decimal('36698041.5613')), ('budget_percent', Decimal('2.3269')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 5108.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('33446006.4600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('1998')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('4531')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('31773706.1370')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.9702')), ('budget_qty_act_fct_percent', Decimal('510800.0000')), ('budget_vs_py_qty_percent', Decimal('510800.0000')), ('budget_vs_ppy_qty_percent', Decimal('510800.0000')), ('QTY_Buy_By_SKU', Decimal('5108.0000')), ('total_sku_count_ty', Decimal('329594816')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('5108.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0004')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('33446006.4600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('33446006.4600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('996133081.4254')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0004')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('319.2564')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('319.2564')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'AC'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('SubFamily', 'BMOBILE'), ('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-24')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('28.4391812503864943')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 28.439181250386493), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', None), ('budget_amount', 66315143.8956022), ('budget_cost', 61267859.97000012), ('deficit', Decimal('66315143.8793')), ('Original_BudgetAmount', Decimal('66315143.8793')), ('budget_percent', Decimal('4.1662')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 17922.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('61267859.9700')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('37503')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('15274')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('58204466.9715')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('3.3927')), ('budget_qty_act_fct_percent', Decimal('1792200.0000')), ('budget_vs_py_qty_percent', Decimal('1792200.0000')), ('budget_vs_ppy_qty_percent', Decimal('1792200.0000')), ('QTY_Buy_By_SKU', Decimal('17922.0000')), ('total_sku_count_ty', Decimal('932303649')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('17922.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0088')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('61267859.9700')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('61267859.9700')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('1223663965.5670')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0043')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('576.9013')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('576.9013')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'TABLET'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('SubFamily', 'MDA COM'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('41.3710691823899371')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 41.37106918238994), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 1518115.2000463107), ('budget_cost', 674051.2799999993), ('deficit', Decimal('1518115.2009')), ('Original_BudgetAmount', Decimal('1518115.2009')), ('budget_percent', Decimal('0.0944')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 152.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('674051.2800')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('17')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('151')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('640348.7160')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0301')), ('budget_qty_act_fct_percent', Decimal('15200.0000')), ('budget_vs_py_qty_percent', Decimal('15200.0000')), ('budget_vs_ppy_qty_percent', Decimal('15200.0000')), ('QTY_Buy_By_SKU', Decimal('152.0000')), ('total_sku_count_ty', Decimal('10045318')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('152.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('674051.2800')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('674051.2800')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('89499610.0047')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('13.2083')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('13.2083')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'MDA'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('SubFamily', 'MDA DOM'), ('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-24')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('23.3769849049206038')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 23.376984904920604), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', None), ('budget_amount', 118309065.01602176), ('budget_cost', 99620639.35999987), ('deficit', Decimal('118309065.0062')), ('Original_BudgetAmount', Decimal('118309065.0062')), ('budget_percent', Decimal('7.5478')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 9911.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('99620639.3600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('5103')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('9514')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('94639607.3920')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('1.9388')), ('budget_qty_act_fct_percent', Decimal('991100.0000')), ('budget_vs_py_qty_percent', Decimal('991100.0000')), ('budget_vs_ppy_qty_percent', Decimal('991100.0000')), ('QTY_Buy_By_SKU', Decimal('9911.0000')), ('total_sku_count_ty', Decimal('536481192')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('9911.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0079')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('99620639.3600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('99620639.3600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('3151327844.5995')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0003')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('1029.2292')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('1029.2292')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Family', 'MDA'), ('Check_box', Decimal('0.0000'))])] 10 getData dictsize
1384.826187757 end of fetch data
shape: (10, 83)
┌───────────┬────────────┬────────────┬────────────┬───┬────────────┬─────────┬────────┬───────────┐
│ SubFamily ┆ final_pric ┆ act_foreca ┆ SalesActua ┆ … ┆ budget_qty ┆ Channel ┆ Family ┆ Check_box │
│ ---       ┆ e          ┆ st_vs_budg ┆ lsByForeca ┆   ┆ _ty        ┆ ---     ┆ ---    ┆ ---       │
│ str       ┆ ---        ┆ et_percent ┆ st         ┆   ┆ ---        ┆ str     ┆ str    ┆ f64       │
│           ┆ f64        ┆ ---        ┆ ---        ┆   ┆ f64        ┆         ┆        ┆           │
│           ┆            ┆ f64        ┆ f64        ┆   ┆            ┆         ┆        ┆           │
╞═══════════╪════════════╪════════════╪════════════╪═══╪════════════╪═════════╪════════╪═══════════╡
│ AC COM    ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ AC     ┆ 0.0       │
│ AC DOM    ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ AC     ┆ 0.0       │
│ BMOBILE   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ TABLET ┆ 0.0       │
│ MDA COM   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ MDA    ┆ 0.0       │
│ MDA DOM   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ MDA    ┆ 0.0       │
│ NON       ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ NON    ┆ 0.0       │
│ SDA COM   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ SDA    ┆ 0.0       │
│ SDA DOM   ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ SDA    ┆ 0.0       │
│ TV COM    ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ TV     ┆ 0.0       │
│ TV DOM    ┆ 0.0        ┆ 0.0        ┆ 0.0        ┆ … ┆ 0.0        ┆ Retail  ┆ TV     ┆ 0.0       │
└───────────┴────────────┴────────────┴────────────┴───┴────────────┴─────────┴────────┴───────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 0.0               │
└───────────────────┘ ly_mgn
shape: (10, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 356235.778 ┆ 41.060405 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 995        ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 3.6698e7   ┆ 13.418524 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 6.6315e7   ┆ 12.230505 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 1.5181e6   ┆ 57.819491 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 1.1831e8   ┆ 20.006462 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2653.96052 ┆ 27.8      ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 6          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 804347.665 ┆ 54.703504 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 379        ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 6.0522e7   ┆ 24.695871 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 956415.283 ┆ 38.772726 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 018        ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 5.1945e7   ┆ 19.189415 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['SubFamily', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Channel', 'Family', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A231169300>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A231169330>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A23116A680>, <Expr ['col("initial_average_retail_pr…'] at 0x76A23116A7D0>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A23116A350>, <Expr ['col("retail_value_including_ma…'] at 0x76A231169D80>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A23116AB30>, <Expr ['col("Logistic%").mean()'] at 0x76A23116A710>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A23116BEE0>, <Expr ['col("MarkdownValue").mean()'] at 0x76A23116A770>, <Expr ['col("markdown_percent").mean()'] at 0x76A231169360>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A23116AAA0>, <Expr ['col("budget_amount").sum()'] at 0x76A23116BD90>, <Expr ['col("budget_cost").sum()'] at 0x76A231169240>, <Expr ['col("deficit").sum()'] at 0x76A23116BD30>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A23116A6B0>, <Expr ['col("budget_percent").sum()'] at 0x76A23116A6E0>, <Expr ['col("relative_budget_percent")…'] at 0x76A23116A500>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A23116A470>, <Expr ['col("budget_qty").sum()'] at 0x76A23116A440>, <Expr ['col("ACT_FCT").sum()'] at 0x76A231168040>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A231168130>, <Expr ['col("PO").sum()'] at 0x76A231168100>, <Expr ['col("COSTPRICE").sum()'] at 0x76A231168160>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A2311681C0>, <Expr ['col("sales_actual").sum()'] at 0x76A2311681F0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A2311682B0>, <Expr ['col("net_sales_ly").sum()'] at 0x76A231168280>, <Expr ['col("net_sales_lly").sum()'] at 0x76A231168310>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A231169150>, <Expr ['col("total_sku_count").sum()'] at 0x76A2311684C0>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A231168490>, <Expr ['col("SupplyCost").sum()'] at 0x76A231168400>, <Expr ['col("SALESQTY").sum()'] at 0x76A2311685B0>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A2311682E0>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A231168670>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A231168430>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A2311686D0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A231168790>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A231168730>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A231168700>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A231168850>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A231168880>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A231168910>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A231168940>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A2311689A0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A231168A00>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A231168AC0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A231168190>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A231168B50>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A231168C10>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A231168BE0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A2311687C0>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A231168D30>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A231168D00>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A231168DF0>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A231168E50>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A231168E20>, <Expr ['col("cost_actuals").sum()'] at 0x76A231168EB0>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A231169090>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A23116A290>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A231168220>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A23116BB20>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A2311685E0>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A23116B6D0>, <Expr ['col("budget_margin_percent").s…'] at 0x76A23116B730>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A23116B7F0>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A23116B850>, <Expr ['col("margin_actuals").sum()'] at 0x76A23116B820>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A23116B910>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A23116B880>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A23116B940>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A23116BA00>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A23116BA90>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A23116B9A0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A23116BD60>, <Expr ['col("initial_average_retail_pr…'] at 0x76A23116BAC0>, <Expr ['col("budget_per_sku").sum()'] at 0x76A23116AB60>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A23116AD10>, <Expr ['col("Check_box").max()'] at 0x76A23116ACB0>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["SubFamily","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Channel","Family","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9],"data":[["AC COM",0.0,0.0,0.0,0,0.0,null,37.9583205754,5.0,37.9583205754,null,null,0,356235.7789952549,221014.66,356235.7794,356235.7794,0.1055741677,0.1055741677,0.0,112.0,0.0,221014.66,0,0,0.0,0.0,32.0,0.0,0.0,0.0,110.0,0.0,209963.927,0,0.0,0.0,0.0218,11200.0,11200.0,11200.0,112.0,8185226.0,0.0,0.0,0.0,112.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,221014.66,0.0,0.0,0.0,0.0,0.0,221014.66,0.0,0.0,0.0,0.0,15606557.9014999997,0.0,0.0,0.0,0.0,0.0,0.0,3.0983,0.0,0.0,0.0,0.0,3.0983,0.0,"Retail","AC",0.0,0.0,0.0,0.0,0.0,0.0,0.0,41.0604045466,0.0,0.0,0.0,null,0.0,135221.1189952549,0.0,0.0,0.0,0.0,0.0,356235.7789952549,null,null,null],["AC DOM",0.0,0.0,0.0,0,0.0,null,8.8616039594,5.0,8.8616039594,null,null,0,36698041.5642969757,33446006.460000135,36698041.561300002,36698041.561300002,10.8758452232,10.8758452232,0.0,5108.0,0.0,33446006.4600000009,0,0,0.0,0.0,1998.0,0.0,0.0,0.0,4531.0,0.0,31773706.1369999982,0,0.0,0.0,0.9702,510800.0,510800.0,510800.0,5108.0,329594816.0,0.0,0.0,0.0,5108.0,0.0,0.0,0.0,0.0,0.0,0.0004,0.0,0.0,33446006.4600000009,0.0,0.0,0.0,0.0,0.0,33446006.4600000009,0.0,0.0,0.0,0.0,996133081.4254000187,0.0,0.0,0.0,0.0,0.0004,0.0,319.2564,0.0,0.0,0.0,0.0,319.2564,0.0,"Retail","AC",0.0,0.0,0.0,0.0,0.0,0.0,0.0,13.4185237615,0.0,0.0,0.0,null,0.0,3252035.1042968407,0.0,0.0,0.0,0.0,0.0,36698041.5642969757,null,null,null],["BMOBILE",0.0,0.0,0.0,0,0.0,null,7.6110577903,5.0,7.6110577903,null,null,0,66315143.8956021965,61267859.970000118,66315143.8792999983,66315143.8792999983,19.6531806664,19.6531806664,0.0,17922.0,0.0,61267859.9699999988,0,0,0.0,0.0,37503.0,0.0,0.0,0.0,15274.0,0.0,58204466.9715000018,0,0.0,0.0,3.3927,1792200.0,1792200.0,1792200.0,17922.0,932303649.0,0.0,0.0,0.0,17922.0,0.0,0.0,0.0,0.0,0.0,0.0088,0.0,0.0,61267859.9699999988,0.0,0.0,0.0,0.0,0.0,61267859.9699999988,0.0,0.0,0.0,0.0,1223663965.5669999123,0.0,0.0,0.0,0.0,0.0043,0.0,576.9013,0.0,0.0,0.0,0.0,576.9013,0.0,"Retail","TABLET",0.0,0.0,0.0,0.0,0.0,0.0,0.0,12.2305049008,0.0,0.0,0.0,null,0.0,5047283.9256020784,0.0,0.0,0.0,0.0,0.0,66315143.8956022039,null,null,null],["MDA COM",0.0,0.0,0.0,0,0.0,null,55.5994643898,5.0,55.5994643898,null,null,0,1518115.2000463107,674051.2799999993,1518115.2009000001,1518115.2009000001,0.4499091843,0.4499091843,0.0,152.0,0.0,674051.28,0,0,0.0,0.0,17.0,0.0,0.0,0.0,151.0,0.0,640348.716,0,0.0,0.0,0.0301,15200.0,15200.0,15200.0,152.0,10045318.0,0.0,0.0,0.0,152.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,674051.28,0.0,0.0,0.0,0.0,0.0,674051.28,0.0,0.0,0.0,0.0,89499610.0047000051,0.0,0.0,0.0,0.0,0.0,0.0,13.2083,0.0,0.0,0.0,0.0,13.2083,0.0,"Retail","MDA",0.0,0.0,0.0,0.0,0.0,0.0,0.0,57.8194911703,0.0,0.0,0.0,null,0.0,844063.9200463113,0.0,0.0,0.0,0.0,0.0,1518115.2000463109,null,null,null],["MDA DOM",0.0,0.0,0.0,0,0.0,null,15.7962753349,5.0,15.7962753349,null,null,0,118309065.0160217583,99620639.3599998653,118309065.0062000006,118309065.0062000006,35.062118434,35.062118434,0.0,9911.0,0.0,99620639.3599999994,0,0,0.0,0.0,5103.0,0.0,0.0,0.0,9514.0,0.0,94639607.3920000046,0,0.0,0.0,1.9388,991100.0,991100.0,991100.0,9911.0,536481192.0,0.0,0.0,0.0,9911.0,0.0,0.0,0.0,0.0,0.0,0.0079,0.0,0.0,99620639.3599999994,0.0,0.0,0.0,0.0,0.0,99620639.3599999994,0.0,0.0,0.0,0.0,3151327844.5995001793,0.0,0.0,0.0,0.0,0.0003,0.0,1029.2292,0.0,0.0,0.0,0.0,1029.2292,0.0,"Retail","MDA",0.0,0.0,0.0,0.0,0.0,0.0,0.0,20.0064615681,0.0,0.0,0.0,null,0.0,18688425.656021893,0.0,0.0,0.0,0.0,0.0,118309065.0160217583,null,null,null],["NON",0.0,0.0,0.0,0,0.0,null,24.0,5.0,24.0,null,null,0,2653.9605263158,2017.01,2653.9605,2653.9605,0.0007865287,0.0007865287,0.0,321345.0,0.0,2017.01,0,0,0.0,0.0,0.0,0.0,0.0,0.0,13.0,0.0,1916.1595,0,0.0,0.0,51.8599,32134500.0,32134500.0,32134500.0,321345.0,82072909.0,0.0,0.0,0.0,321345.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2017.01,0.0,0.0,0.0,0.0,0.0,2017.01,0.0,0.0,0.0,0.0,63695.0526,0.0,0.0,0.0,0.0,2.7855,0.0,0.0231,0.0,0.0,0.0,0.0,0.0231,0.0,"Retail","NON",0.0,0.0,0.0,0.0,0.0,0.0,0.0,27.8,0.0,0.0,0.0,null,0.0,636.9505263158,0.0,0.0,0.0,0.0,0.0,2653.9605263158,null,null,null],["SDA COM",0.0,0.0,0.0,0,0.0,null,52.3194774464,5.0,52.3194774464,null,null,0,804347.6653789092,383517.1700000004,804347.6663,804347.6663,0.2383767728,0.2383767728,0.0,281.0,0.0,383517.17,0,0,0.0,0.0,82.0,0.0,0.0,0.0,268.0,0.0,364341.3115,0,0.0,0.0,0.0548,28100.0,28100.0,28100.0,281.0,15274915.0,0.0,0.0,0.0,281.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,383517.17,0.0,0.0,0.0,0.0,0.0,383517.17,0.0,0.0,0.0,0.0,47066224.5411999971,0.0,0.0,0.0,0.0,0.0,0.0,6.9993,0.0,0.0,0.0,0.0,6.9993,0.0,"Retail","SDA",0.0,0.0,0.0,0.0,0.0,0.0,0.0,54.7035035741,0.0,0.0,0.0,null,0.0,420830.4953789088,0.0,0.0,0.0,0.0,0.0,804347.6653789092,null,null,null],["SDA DOM",0.0,0.0,0.0,0,0.0,null,20.7324957053,5.0,20.7324957053,null,null,0,60521776.4415386766,47974101.7399998009,60521776.4376000017,60521776.4376000017,17.9362561367,17.9362561367,0.0,29813.0,0.0,47974101.7400000021,0,0,0.0,0.0,14766.0,0.0,0.0,0.0,25203.0,0.0,45575396.6529999971,0,0.0,0.0,5.5899,2981300.0,2981300.0,2981300.0,29813.0,1544438786.0,0.0,1.0,0.0,29813.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,47974101.7400000021,0.0,0.0,0.0,0.0,0.0,47974101.7400000021,0.0,0.0,0.0,0.0,1735307251.1761000156,0.0,0.0,0.0,0.0,0.0065,0.0,526.5231,0.0,0.0,0.0,0.0,526.5231,0.0,"Retail","SDA",0.0,0.0,0.0,0.0,0.0,0.0,0.0,24.6958709201,0.0,0.0,0.0,null,0.0,12547674.7015388757,0.0,0.0,0.0,0.0,0.0,60521776.4415386766,null,null,null],["TV COM",0.0,0.0,0.0,0,0.0,null,35.5502383803,5.0,35.5502383803,null,null,0,956415.2830184372,616407.37,956415.2817000001,956415.2817000001,0.2834435884,0.2834435884,0.0,169.0,0.0,616407.37,0,0,0.0,0.0,78.0,0.0,0.0,0.0,158.0,0.0,585587.0015,0,0.0,0.0,0.0326,16900.0,16900.0,16900.0,169.0,11989837.0,0.0,0.0,0.0,169.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,616407.37,0.0,0.0,0.0,0.0,0.0,616407.37,0.0,0.0,0.0,0.0,38259113.3003000021,0.0,0.0,0.0,0.0,0.0,0.0,8.3191,0.0,0.0,0.0,0.0,8.3191,0.0,"Retail","TV",0.0,0.0,0.0,0.0,0.0,0.0,0.0,38.7727264613,0.0,0.0,0.0,null,0.0,340007.9130184372,0.0,0.0,0.0,0.0,0.0,956415.2830184373,null,null,null],["TV DOM",0.0,0.0,0.0,0,0.0,null,14.9362264875,5.0,14.9362264875,null,null,0,51945235.5631992444,44186577.5299999192,51945235.5754000023,51945235.5754000023,15.3945092977,15.3945092977,0.0,9836.0,0.0,44186577.5300000012,0,0,0.0,0.0,13971.0,0.0,0.0,0.0,7888.0,0.0,41977248.6534999982,0,0.0,0.0,1.8133,983600.0,983600.0,983600.0,9836.0,495164891.0,0.0,0.0,0.0,9836.0,0.0,0.0,0.0,0.0,0.0,0.0022,0.0,0.0,44186577.5300000012,0.0,0.0,0.0,0.0,0.0,44186577.5300000012,0.0,0.0,0.0,0.0,1111823282.3108000755,0.0,0.0,0.0,0.0,0.0014,0.0,451.8969,0.0,0.0,0.0,0.0,451.8969,0.0,"Retail","TV",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.1894151632,0.0,0.0,0.0,null,0.0,7758658.0331993252,0.0,0.0,0.0,0.0,0.0,51945235.5631992444,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":10,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":0.0,"proposed_sellthru_percent":0.0,"retail_value_including_markdown":null,"budget_gross_margin_percent":27.3365160069,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":27.3365160069,"MarkdownValue":null,"markdown_percent":null,"DisplayItemValue":0.0,"budget_amount":337427030.3686240315,"budget_cost":288392192.5499998331,"deficit":337427030.3486000299,"Original_BudgetAmount":337427030.3486000299,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":394649.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":288392192.5500000119,"PO":0.0,"COSTPRICE":0.0,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":73550.0,"net_sales_ly":0.0,"net_sales_lly":0.0,"gross_sales_ly":0.0,"total_sku_count":63110.0,"ly_customer_disc":0.0,"SupplyCost":273972582.9225000739,"SALESQTY":0.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":65.7041,"budget_qty_act_fct_percent":39464900.0,"budget_vs_py_qty_percent":39464900.0,"budget_vs_ppy_qty_percent":39464900.0,"QTY_Buy_By_SKU":394649.0,"total_sku_count_ty":3965551539.0,"total_sku_count_lly":0.0,"total_sku_count_ly":1.0,"quantity_mix_percent":0.0,"quantity_act_forecast":394649.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":0.0,"quantity_act_forecast_vs_ly_percent":0.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.0193,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":288392192.5500000119,"budget_vs_py_cost_percent":0.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":0.0,"cost_act_forecast":288392192.5500000119,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":8408750625.8790988922,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":2.7984,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":2935.455,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":2935.455,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":null,"FirstMargin_percent":18.8053836045,"budget_vpy":0.0,"budget_vppy":0.0,"StockatRetailPrice":0.0,"TYForecast":0.0,"LYvsACT_FCT_percent":0.0,"supply_retail_value":337427030.3686240315} } data_json
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'Channel': 'Retail', 'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 0, 'proposed_sellthru_percent': 0, 'retail_value_including_markdown': None, 'budget_gross_margin_percent': 14.5319827416, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 14.5319827416, 'MarkdownValue': None, 'markdown_percent': None, 'DisplayItemValue': 0, 'budget_amount': 337427030.36862934, 'budget_cost': 288392192.54999983, 'deficit': 337427030.3486, 'Original_BudgetAmount': 337427030.3486, 'budget_percent': 21.5690806656, 'relative_budget_percent': 21.5690806656, 'History_Net_Sales': 0, 'budget_qty': 394649, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 288392192.55, 'PO': 0, 'COSTPRICE': 0, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 73550, 'net_sales_ly': 0, 'net_sales_lly': 0, 'gross_sales_ly': 0, 'total_sku_count': 63110, 'ly_customer_disc': 0, 'SupplyCost': 273972582.9225, 'SALESQTY': 0, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 65.7041, 'budget_qty_act_fct_percent': 39464900, 'budget_vs_py_qty_percent': 39464900, 'budget_vs_ppy_qty_percent': 39464900, 'QTY_Buy_By_SKU': 394649, 'total_sku_count_ty': 3965551539, 'total_sku_count_lly': 0, 'total_sku_count_ly': 1, 'quantity_mix_percent': 0, 'quantity_act_forecast': 394649, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 0, 'quantity_act_forecast_vs_ly_percent': 0, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.0193, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 288392192.55, 'budget_vs_py_cost_percent': 0, 'budget_vs_ppy_cost_percent': 0, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 0, 'cost_act_forecast': 288392192.55, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 8408750625.8791, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 2.7984, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 2935.455, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 2935.455, 'budget_qty_ty': 0, 'Check_box': 0, 'budget_vpy': 0, 'budget_vppy': 0, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 18.8053836045, 'PurchasedRetailValueGrossSale': 0, 'ly_margin_percent': 0, 'ly_margin': 0, 'margin_act_forecast_vs_ly_margin_percent': None, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 49034837.8186295, 'budget_vs_py_margin_percent': 0, 'StockatRetailPrice': 0, 'StockatCostPrice': 0, 'TYForecast': 0, 'GrossSales': 0, 'supply_retail_value': 337427030.36862934, 'PurchaseRetailValueatGrossSale': None, 'OTBorPurchaseCost': None, 'OTBquantity': None}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
['Channel'] ['Retail'] the expand heirarchy
sku wise calc executed
1385.808899372 end of sku wise stored proc
we are finding corr ex4
grp err
drilldown procedure start
conn established
['Family'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] ['Channel']   get_sp_otb_expand_heirarchy
sku wise calc executed
1385.83123664 end of sku wise stored proc
conn established
[OrderedDict([('Family', 'AC'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('21.7411632691228726')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 21.741163269122872), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 37054277.34329216), ('budget_cost', 33667021.120000124), ('deficit', Decimal('37054277.3407')), ('Original_BudgetAmount', Decimal('37054277.3407')), ('budget_percent', Decimal('2.3486')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 5220.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('33667021.1200')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('2030')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('4641')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('31983670.0640')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.9920')), ('budget_qty_act_fct_percent', Decimal('522000.0000')), ('budget_vs_py_qty_percent', Decimal('522000.0000')), ('budget_vs_ppy_qty_percent', Decimal('522000.0000')), ('QTY_Buy_By_SKU', Decimal('5220.0000')), ('total_sku_count_ty', Decimal('337780042')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('5220.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0004')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('33667021.1200')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('33667021.1200')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('1011739639.3269')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0004')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('322.3547')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('322.3547')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Family', 'BMOBILE ACCESSORIES'), ('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-24')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('33.4051036682615630')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 33.40510366826156), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', None), ('budget_amount', 10771755.468878698), ('budget_cost', 8644668.16999998), ('deficit', Decimal('10771755.4553')), ('Original_BudgetAmount', Decimal('10771755.4553')), ('budget_percent', Decimal('0.5958')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 13061.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('8644668.1700')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('36937')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('10687')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('8212434.7615')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('2.4469')), ('budget_qty_act_fct_percent', Decimal('1306100.0000')), ('budget_vs_py_qty_percent', Decimal('1306100.0000')), ('budget_vs_ppy_qty_percent', Decimal('1306100.0000')), ('QTY_Buy_By_SKU', Decimal('13061.0000')), ('total_sku_count_ty', Decimal('627615654')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('13061.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0003')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('8644668.1700')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('8644668.1700')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('295172037.8932')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0042')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('93.7087')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('93.7087')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Family', 'COMPLEMENTARY'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('18.4469696969696970')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 18.446969696969695), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 3113806.989906136), ('budget_cost', 2997814.0600000005), ('deficit', Decimal('3113806.9884')), ('Original_BudgetAmount', Decimal('3113806.9884')), ('budget_percent', Decimal('0.2023')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 249.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('2997814.0600')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('39')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('246')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('2847923.3570')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0494')), ('budget_qty_act_fct_percent', Decimal('24900.0000')), ('budget_vs_py_qty_percent', Decimal('24900.0000')), ('budget_vs_ppy_qty_percent', Decimal('24900.0000')), ('QTY_Buy_By_SKU', Decimal('249.0000')), ('total_sku_count_ty', Decimal('15987788')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('249.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0010')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('2997814.0600')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('2997814.0600')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('53713988.9895')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('27.0879')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('27.0879')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Family', 'LAPTOP'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('16.1028938906752412')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 16.10289389067524), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 7084184.647733003), ('budget_cost', 6784951.130000003), ('deficit', Decimal('7084184.6459')), ('Original_BudgetAmount', Decimal('7084184.6459')), ('budget_percent', Decimal('0.4540')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 302.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('6784951.1300')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('22')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('295')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('6445703.5735')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0598')), ('budget_qty_act_fct_percent', Decimal('30200.0000')), ('budget_vs_py_qty_percent', Decimal('30200.0000')), ('budget_vs_ppy_qty_percent', Decimal('30200.0000')), ('QTY_Buy_By_SKU', Decimal('302.0000')), ('total_sku_count_ty', Decimal('19007441')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('302.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0013')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('6784951.1300')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('6784951.1300')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('105432049.7751')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('61.6306')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('61.6306')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Family', 'MDA'), ('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-24')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('23.6531222854936782')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 23.653122285493676), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', None), ('budget_amount', 119827180.21606809), ('budget_cost', 100294690.63999993), ('deficit', Decimal('119827180.2071')), ('Original_BudgetAmount', Decimal('119827180.2071')), ('budget_percent', Decimal('7.6422')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 10063.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('100294690.6400')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('5120')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('9665')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('95279956.1080')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('1.9689')), ('budget_qty_act_fct_percent', Decimal('1006300.0000')), ('budget_vs_py_qty_percent', Decimal('1006300.0000')), ('budget_vs_ppy_qty_percent', Decimal('1006300.0000')), ('QTY_Buy_By_SKU', Decimal('10063.0000')), ('total_sku_count_ty', Decimal('546526510')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('10063.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0079')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('100294690.6400')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('100294690.6400')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('3240827454.6042')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0003')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('1042.4375')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('1042.4375')), ('budget_qty_ty', Decimal('0.0000')), ('Channel', 'Retail'), ('Check_box', Decimal('0.0000'))])] 10 getData dictsize
1386.032573385 end of fetch data
shape: (10, 82)
┌────────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬─────────┬───────────┐
│ Family     ┆ final_pri ┆ act_forec ┆ SalesActu ┆ … ┆ budget_pe ┆ budget_qt ┆ Channel ┆ Check_box │
│ ---        ┆ ce        ┆ ast_vs_bu ┆ alsByFore ┆   ┆ r_sku     ┆ y_ty      ┆ ---     ┆ ---       │
│ str        ┆ ---       ┆ dget_perc ┆ cast      ┆   ┆ ---       ┆ ---       ┆ str     ┆ f64       │
│            ┆ f64       ┆ ent       ┆ ---       ┆   ┆ f64       ┆ f64       ┆         ┆           │
│            ┆           ┆ ---       ┆ f64       ┆   ┆           ┆           ┆         ┆           │
│            ┆           ┆ f64       ┆           ┆   ┆           ┆           ┆         ┆           │
╞════════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═════════╪═══════════╡
│ AC         ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 322.3547  ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ BMOBILE    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 93.7087   ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ ACCESSORIE ┆           ┆           ┆           ┆   ┆           ┆           ┆         ┆           │
│ S          ┆           ┆           ┆           ┆   ┆           ┆           ┆         ┆           │
│ COMPLEMENT ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 27.0879   ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ ARY        ┆           ┆           ┆           ┆   ┆           ┆           ┆         ┆           │
│ LAPTOP     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 61.6306   ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ MDA        ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 1042.4375 ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ MOBILE     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 371.4101  ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ NON        ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0231    ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ SDA        ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 533.5224  ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ TABLET     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 23.064    ┆ 0.0       ┆ Retail  ┆ 0.0       │
│ TV         ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 460.216   ┆ 0.0       ┆ Retail  ┆ 0.0       │
└────────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴─────────┴───────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 0.0               │
└───────────────────┘ ly_mgn
shape: (10, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 3.7054e7   ┆ 13.68427  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 1.0772e7   ┆ 23.759551 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 3.1138e6   ┆ 8.53886   ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 7.0842e6   ┆ 9.012767  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 1.1983e8   ┆ 20.485523 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 4.2694e7   ┆ 9.558922  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2653.96052 ┆ 27.8      ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│            ┆            ┆ 6          ┆           ┆           ┆           ┆           ┆           │
│ 0.0        ┆ 0.0        ┆ 6.1326e7   ┆ 25.089448 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2.6511e6   ┆ 21.344977 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 5.2902e7   ┆ 19.543464 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['Family', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Channel', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A2552AE1A0>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A2552AD060>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A2552AE110>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2552AE170>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A2552AE0B0>, <Expr ['col("retail_value_including_ma…'] at 0x76A2552ADF90>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A2552AE080>, <Expr ['col("Logistic%").mean()'] at 0x76A2552ACD00>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A2552ADED0>, <Expr ['col("MarkdownValue").mean()'] at 0x76A2552ADF00>, <Expr ['col("markdown_percent").mean()'] at 0x76A2552ACC40>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A2552AE860>, <Expr ['col("budget_amount").sum()'] at 0x76A2552AC850>, <Expr ['col("budget_cost").sum()'] at 0x76A2552AC2E0>, <Expr ['col("deficit").sum()'] at 0x76A2552AC130>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A2552ADF30>, <Expr ['col("budget_percent").sum()'] at 0x76A2552AE1D0>, <Expr ['col("relative_budget_percent")…'] at 0x76A2552AC280>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A2552ADD80>, <Expr ['col("budget_qty").sum()'] at 0x76A2552ADD20>, <Expr ['col("ACT_FCT").sum()'] at 0x76A2552ACA30>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A2552ACB50>, <Expr ['col("PO").sum()'] at 0x76A2552AC5E0>, <Expr ['col("COSTPRICE").sum()'] at 0x76A2552ADD50>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A2552ADE70>, <Expr ['col("sales_actual").sum()'] at 0x76A2552AC730>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A2552ADBA0>, <Expr ['col("net_sales_ly").sum()'] at 0x76A2552AC880>, <Expr ['col("net_sales_lly").sum()'] at 0x76A2552ADB10>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A2552ADAB0>, <Expr ['col("total_sku_count").sum()'] at 0x76A2552ADBD0>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A2552AD2A0>, <Expr ['col("SupplyCost").sum()'] at 0x76A2552AC8E0>, <Expr ['col("SALESQTY").sum()'] at 0x76A2552ADC00>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A2552ADB70>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A2552AD0C0>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A2552AD450>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A2552ADEA0>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A2552AD9F0>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A2552ADE10>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A2552AE9E0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A2552AD330>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A2552AD780>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A2552AC9A0>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A2552AE980>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A2552AD1B0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2552ACDF0>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A2552AD2D0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2552ACDC0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A2552ADA80>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2552ACD90>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A2552ACE50>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A2552AE6E0>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A2552AE530>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A2552AE440>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A2552AE890>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A2552AD1E0>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A2552AE5C0>, <Expr ['col("cost_actuals").sum()'] at 0x76A2552AE620>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A2552ACEB0>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A2552AE320>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A2552AFC40>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A2552AE8F0>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A2552AFE50>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A2552AE950>, <Expr ['col("budget_margin_percent").s…'] at 0x76A2552AE7A0>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A2552AD090>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A2552AEEF0>, <Expr ['col("margin_actuals").sum()'] at 0x76A2552ACF70>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A2552AC520>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A2552ACB20>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A2552ACEE0>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A2552AD9C0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A2552AC820>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A2552AC220>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2552AC7C0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A2552AEC80>, <Expr ['col("budget_per_sku").sum()'] at 0x76A2552AE830>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A2552AC5B0>, <Expr ['col("Check_box").max()'] at 0x76A2552AC700>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Family","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Channel","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9],"data":[["AC",0.0,0.0,0.0,0,0.0,null,9.1413366179,5.0,9.1413366179,null,null,0,37054277.3432921618,33667021.120000124,37054277.3407000005,37054277.3407000005,10.981419391,10.981419391,0.0,5220.0,0.0,33667021.1199999973,0,0,0.0,0.0,2030.0,0.0,0.0,0.0,4641.0,0.0,31983670.0639999993,0,0.0,0.0,0.992,522000.0,522000.0,522000.0,5220.0,337780042.0,0.0,0.0,0.0,5220.0,0.0,0.0,0.0,0.0,0.0,0.0004,0.0,0.0,33667021.1199999973,0.0,0.0,0.0,0.0,0.0,33667021.1199999973,0.0,0.0,0.0,0.0,1011739639.3269000053,0.0,0.0,0.0,0.0,0.0004,0.0,322.3547,0.0,0.0,0.0,0.0,322.3547,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,13.684269787,0.0,0.0,0.0,null,0.0,3387256.2232920378,0.0,0.0,0.0,0.0,0.0,37054277.3432921618,null,null,null],["BMOBILE ACCESSORIES",0.0,0.0,0.0,0,0.0,null,19.7468955271,5.0,19.7468955271,null,null,0,10771755.4688786976,8644668.1699999794,10771755.4552999996,10771755.4552999996,3.1923214501,3.1923214501,0.0,13061.0,0.0,8644668.1699999999,0,0,0.0,0.0,36937.0,0.0,0.0,0.0,10687.0,0.0,8212434.7615,0,0.0,0.0,2.4469,1306100.0,1306100.0,1306100.0,13061.0,627615654.0,0.0,0.0,0.0,13061.0,0.0,0.0,0.0,0.0,0.0,0.0003,0.0,0.0,8644668.1699999999,0.0,0.0,0.0,0.0,0.0,8644668.1699999999,0.0,0.0,0.0,0.0,295172037.8931999803,0.0,0.0,0.0,0.0,0.0042,0.0,93.7087,0.0,0.0,0.0,0.0,93.7087,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,23.7595507508,0.0,0.0,0.0,null,0.0,2127087.2988787182,0.0,0.0,0.0,0.0,0.0,10771755.4688786976,null,null,null],["COMPLEMENTARY",0.0,0.0,0.0,0,0.0,null,3.7251162414,5.0,3.7251162414,null,null,0,3113806.9899061359,2997814.0600000005,3113806.9884000001,3113806.9884000001,0.9228089956,0.9228089956,0.0,249.0,0.0,2997814.0600000001,0,0,0.0,0.0,39.0,0.0,0.0,0.0,246.0,0.0,2847923.3569999998,0,0.0,0.0,0.0494,24900.0,24900.0,24900.0,249.0,15987788.0,0.0,0.0,0.0,249.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,2997814.0600000001,0.0,0.0,0.0,0.0,0.0,2997814.0600000001,0.0,0.0,0.0,0.0,53713988.9895000011,0.0,0.0,0.0,0.0,0.0,0.0,27.0879,0.0,0.0,0.0,0.0,27.0879,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,8.5388604293,0.0,0.0,0.0,null,0.0,115992.9299061354,0.0,0.0,0.0,0.0,0.0,3113806.9899061359,null,null,null],["LAPTOP",0.0,0.0,0.0,0,0.0,null,4.2239655319,5.0,4.2239655319,null,null,0,7084184.6477330029,6784951.1300000027,7084184.6458999999,7084184.6458999999,2.0994715924,2.0994715924,0.0,302.0,0.0,6784951.1299999999,0,0,0.0,0.0,22.0,0.0,0.0,0.0,295.0,0.0,6445703.5734999999,0,0.0,0.0,0.0598,30200.0,30200.0,30200.0,302.0,19007441.0,0.0,0.0,0.0,302.0,0.0,0.0,0.0,0.0,0.0,0.0013,0.0,0.0,6784951.1299999999,0.0,0.0,0.0,0.0,0.0,6784951.1299999999,0.0,0.0,0.0,0.0,105432049.7750999928,0.0,0.0,0.0,0.0,0.0,0.0,61.6306,0.0,0.0,0.0,0.0,61.6306,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.0127672553,0.0,0.0,0.0,null,0.0,299233.5177330002,0.0,0.0,0.0,0.0,0.0,7084184.6477330029,null,null,null],["MDA",0.0,0.0,0.0,0,0.0,null,16.3005501263,5.0,16.3005501263,null,null,0,119827180.216068089,100294690.6399999261,119827180.207100004,119827180.207100004,35.5120276183,35.5120276183,0.0,10063.0,0.0,100294690.6400000006,0,0,0.0,0.0,5120.0,0.0,0.0,0.0,9665.0,0.0,95279956.1079999954,0,0.0,0.0,1.9689,1006300.0,1006300.0,1006300.0,10063.0,546526510.0,0.0,0.0,0.0,10063.0,0.0,0.0,0.0,0.0,0.0,0.0079,0.0,0.0,100294690.6400000006,0.0,0.0,0.0,0.0,0.0,100294690.6400000006,0.0,0.0,0.0,0.0,3240827454.6041998863,0.0,0.0,0.0,0.0,0.0003,0.0,1042.4375,0.0,0.0,0.0,0.0,1042.4375,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,20.48552262,0.0,0.0,0.0,null,0.0,19532489.5760681629,0.0,0.0,0.0,0.0,0.0,119827180.216068089,null,null,null],["MOBILE",0.0,0.0,0.0,0,0.0,null,4.7988656956,5.0,4.7988656956,null,null,0,42694295.7528807223,40645453.8400000781,42694295.7594000027,42694295.7594000027,12.6528973409,12.6528973409,0.0,3978.0,0.0,40645453.8400000036,0,0,0.0,0.0,396.0,0.0,0.0,0.0,3728.0,0.0,38613181.1480000019,0,0.0,0.0,0.7714,397800.0,397800.0,397800.0,3978.0,248824895.0,0.0,0.0,0.0,3978.0,0.0,0.0,0.0,0.0,0.0,0.006,0.0,0.0,40645453.8400000036,0.0,0.0,0.0,0.0,0.0,40645453.8400000036,0.0,0.0,0.0,0.0,712091196.2920000553,0.0,0.0,0.0,0.0,0.0001,0.0,371.4101,0.0,0.0,0.0,0.0,371.4101,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.5589224109,0.0,0.0,0.0,null,0.0,2048841.9128806442,0.0,0.0,0.0,0.0,0.0,42694295.7528807223,null,null,null],["NON",0.0,0.0,0.0,0,0.0,null,24.0,5.0,24.0,null,null,0,2653.9605263158,2017.01,2653.9605,2653.9605,0.0007865287,0.0007865287,0.0,321345.0,0.0,2017.01,0,0,0.0,0.0,0.0,0.0,0.0,0.0,13.0,0.0,1916.1595,0,0.0,0.0,51.8599,32134500.0,32134500.0,32134500.0,321345.0,82072909.0,0.0,0.0,0.0,321345.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2017.01,0.0,0.0,0.0,0.0,0.0,2017.01,0.0,0.0,0.0,0.0,63695.0526,0.0,0.0,0.0,0.0,2.7855,0.0,0.0231,0.0,0.0,0.0,0.0,0.0231,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,27.8,0.0,0.0,0.0,null,0.0,636.9505263158,0.0,0.0,0.0,0.0,0.0,2653.9605263158,null,null,null],["SDA",0.0,0.0,0.0,0,0.0,null,21.1467875816,5.0,21.1467875816,null,null,0,61326124.1069174632,48357618.90999984,61326124.1039000005,61326124.1039000005,18.1746329095,18.1746329095,0.0,30094.0,0.0,48357618.9099999964,0,0,0.0,0.0,14848.0,0.0,0.0,0.0,25471.0,0.0,45939737.9645000026,0,0.0,0.0,5.6447,3009400.0,3009400.0,3009400.0,30094.0,1559713701.0,0.0,1.0,0.0,30094.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,48357618.9099999964,0.0,0.0,0.0,0.0,0.0,48357618.9099999964,0.0,0.0,0.0,0.0,1782373475.7172999382,0.0,0.0,0.0,0.0,0.0065,0.0,533.5224,0.0,0.0,0.0,0.0,533.5224,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,25.0894482025,0.0,0.0,0.0,null,0.0,12968505.1969176233,0.0,0.0,0.0,0.0,0.0,61326124.1069174632,null,null,null],["TABLET",0.0,0.0,0.0,0,0.0,null,17.2052388791,5.0,17.2052388791,null,null,0,2651101.0362039246,2194972.77,2651101.0303000002,2651101.0303000002,0.7856812874,0.7856812874,0.0,332.0,0.0,2194972.77,0,0,0.0,0.0,109.0,0.0,0.0,0.0,318.0,0.0,2085224.1314999999,0,0.0,0.0,0.0652,33200.0,33200.0,33200.0,332.0,20867871.0,0.0,0.0,0.0,332.0,0.0,0.0,0.0,0.0,0.0,0.0002,0.0,0.0,2194972.77,0.0,0.0,0.0,0.0,0.0,2194972.77,0.0,0.0,0.0,0.0,57254692.6172000021,0.0,0.0,0.0,0.0,0.0,0.0,23.064,0.0,0.0,0.0,0.0,23.064,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.3449769351,0.0,0.0,0.0,null,0.0,456128.2662039245,0.0,0.0,0.0,0.0,0.0,2651101.0362039246,null,null,null],["TV",0.0,0.0,0.0,0,0.0,null,15.308909678,5.0,15.308909678,null,null,0,52901650.8462175652,44802984.8999999091,52901650.8571000025,52901650.8571000025,15.6779528861,15.6779528861,0.0,10005.0,0.0,44802984.8999999985,0,0,0.0,0.0,14049.0,0.0,0.0,0.0,8046.0,0.0,42562835.6550000012,0,0.0,0.0,1.8459,1000500.0,1000500.0,1000500.0,10005.0,507154728.0,0.0,0.0,0.0,10005.0,0.0,0.0,0.0,0.0,0.0,0.0022,0.0,0.0,44802984.8999999985,0.0,0.0,0.0,0.0,0.0,44802984.8999999985,0.0,0.0,0.0,0.0,1150082395.6110999584,0.0,0.0,0.0,0.0,0.0014,0.0,460.216,0.0,0.0,0.0,0.0,460.216,0.0,"Retail",0.0,0.0,0.0,0.0,0.0,0.0,0.0,19.5434641941,0.0,0.0,0.0,null,0.0,8098665.9462176561,0.0,0.0,0.0,0.0,0.0,52901650.8462175727,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":10,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":0.0,"proposed_sellthru_percent":0.0,"retail_value_including_markdown":null,"budget_gross_margin_percent":13.5597665879,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":13.5597665879,"MarkdownValue":null,"markdown_percent":null,"DisplayItemValue":0.0,"budget_amount":337427030.3686240911,"budget_cost":288392192.5499998331,"deficit":337427030.3486000299,"Original_BudgetAmount":337427030.3486000299,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":394649.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":288392192.5500000119,"PO":0.0,"COSTPRICE":0.0,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":73550.0,"net_sales_ly":0.0,"net_sales_lly":0.0,"gross_sales_ly":0.0,"total_sku_count":63110.0,"ly_customer_disc":0.0,"SupplyCost":273972582.9225000143,"SALESQTY":0.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":65.7041,"budget_qty_act_fct_percent":39464900.0,"budget_vs_py_qty_percent":39464900.0,"budget_vs_ppy_qty_percent":39464900.0,"QTY_Buy_By_SKU":394649.0,"total_sku_count_ty":3965551539.0,"total_sku_count_lly":0.0,"total_sku_count_ly":1.0,"quantity_mix_percent":0.0,"quantity_act_forecast":394649.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":0.0,"quantity_act_forecast_vs_ly_percent":0.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.0193,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":288392192.5500000119,"budget_vs_py_cost_percent":0.0,"budget_vs_ppy_cost_percent":0.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":0.0,"cost_act_forecast":288392192.5500000119,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":8408750625.8790988922,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":2.7984,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":2935.455,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":2935.455,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":null,"FirstMargin_percent":18.8053836045,"budget_vpy":0.0,"budget_vppy":0.0,"StockatRetailPrice":0.0,"TYForecast":0.0,"LYvsACT_FCT_percent":0.0,"supply_retail_value":337427030.3686240911} } data_json
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 15, 'fetch_from_db': False, 'group_by': {'status': False, 'columns': []}, 'expand': {'status': True, 'row': {'final_price': 0, 'act_forecast_vs_budget_percent': 0, 'SalesActualsByForecast': 0, 'initial_average_retail_price': 11758.7683247113, 'proposed_sellthru_percent': 9.1492581023, 'retail_value_including_markdown': 1600336360.8479478, 'budget_gross_margin_percent': 38.9693056464, 'Logistic%': 5, 'adjusted_budget_gross_margin_percent': 38.9693056464, 'MarkdownValue': 1246367433.0000002, 'markdown_percent': 2.2454541723, 'DisplayItemValue': 0, 'budget_amount': 1564401541.2620547, 'budget_cost': 954765123.1099868, 'deficit': 1564401541.2233, 'Original_BudgetAmount': 1564401541.2233, 'budget_percent': 100, 'relative_budget_percent': 100, 'History_Net_Sales': 0, 'budget_qty': 619895, 'ACT_FCT': 0, 'Original_BudgetCostofGoods': 954765123.11, 'PO': 1272173792.5233, 'COSTPRICE': 176226570.29000092, 'Historical_Gross_Margin': 0, 'sales_actual': 0, 'stock_on_hand_qty': 441256, 'net_sales_ly': 542598837.46, 'net_sales_lly': 347973.4, 'gross_sales_ly': 555062511.79, 'total_sku_count': 114950, 'ly_customer_disc': 12463674.33, 'SupplyCost': 907026866.9555, 'SALESQTY': 104890, 'DisplayItemQty': 0, 'COR_EOLStock_value': 0, 'Budget_Qty_Perc': 103.1495, 'budget_qty_act_fct_percent': 61989500, 'budget_vs_py_qty_percent': 54058575.2879, 'budget_vs_ppy_qty_percent': 61985268.1811, 'QTY_Buy_By_SKU': 619895, 'total_sku_count_ty': 7555708056, 'total_sku_count_lly': 41, 'total_sku_count_ly': 11137, 'quantity_mix_percent': 100.146, 'quantity_act_forecast': 619895, 'quantity_act_forecast_vs_budget_percent': 0, 'sold_qty_ly': 104617, 'quantity_act_forecast_vs_ly_percent': 10038300, 'quantity_act_or_forecast_per_sku': 0, 'quantity_act_forecast_vs_ppy_percent': 0, 'budget_cost_percent': 0.3551, 'budget_vs_act_forecast_cost_percent': 0, 'cost_budget_per_sku': 0, 'BudgetCostofGoods': 954765123.11, 'budget_vs_py_cost_percent': 17234755999, 'budget_vs_ppy_cost_percent': 48111602, 'cost_mix_percent': 0, 'cost_actuals': 0, 'cost_of_goods_ly': 176017860.76, 'cost_act_forecast': 954765123.11, 'cost_act_forecast_vs_budget_perc': 0, 'cost_act_forecast_vs_ly_percent': 0, 'cost_act_forecast_vs_ppy_percent': 0, 'cost_act_or_forecast_per_sku': 0, 'budget_margin_percent': 67254598559.191, 'budget_margin_mix_percent': 0, 'budget_vs_act_forecast_margin_percent': 0, 'margin_actuals': 0, 'margin_act_forecast': 0, 'units_per_sku_total': 4.241, 'units_per_sku_lly': 0, 'unit_buy_by_sku_total': 13609.4332, 'unit_buy_by_sku_ly': 0, 'unit_buy_by_sku_lly': 0, 'initial_average_retail_price_ly': 0, 'initial_average_retail_price_lly': 0, 'budget_per_sku': 13609.4332, 'budget_qty_ty': 0, 'Check_box': 0, 'budget_vpy': 288.3164196564, 'budget_vppy': 449575.0368453608, 'LYvsACT_FCT_percent': 0, 'SALES_ACT_FCT_per_sku_ly': 0, 'LLYvsACT_FCT_percent': 100, 'SALES_ACT_FCT_per_sku_lly': 0, 'FirstMargin_percent': 42.0208403641, 'PurchasedRetailValueGrossSale': 5188627075.888798, 'ly_margin_percent': 67.5602215471, 'ly_margin': 366580976.70000005, 'margin_act_forecast_vs_ly_margin_percent': 0, 'margin_act_or_forecast_per_sku': 0, 'budget_gross_margin': 609636418.1520679, 'budget_vs_py_margin_percent': 9023600.04439888, 'StockatRetailPrice': 5188627075.888798, 'StockatCostPrice': 1683179128.1651752, 'TYForecast': 5188627075.888798, 'GrossSales': 1600336360.8479476, 'supply_retail_value': 1564401541.262055, 'PurchaseRetailValueatGrossSale': 17491433108.056953, 'OTBorPurchaseCost': 10141385924.334757, 'OTBquantity': 6584440.796379291}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=15 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are finding corr ex1
filter data for drill down
conn established
[] [] the expand heirarchy
sku wise calc executed
1387.12460919 end of sku wise stored proc
we are finding corr ex2
['Channel'] FILTERDATA5
drilldown procedure start
conn established
['Channel'] ['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue'] ['budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty'] ['new_budget_mix', 'revised_budget_amount'] ['Check_box'] [] []   get_sp_otb_expand_heirarchy
sku wise calc executed
1387.14660314 end of sku wise stored proc
conn established
[OrderedDict([('Channel', 'ARKAN'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('72.2500000000000000')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 72.25), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 1201763.972404484), ('budget_cost', 381655.07), ('deficit', Decimal('1201763.9727')), ('Original_BudgetAmount', Decimal('1201763.9727')), ('budget_percent', Decimal('0.0766')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 67.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('381655.0700')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('893')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('32')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('362572.3165')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0115')), ('budget_qty_act_fct_percent', Decimal('6700.0000')), ('budget_vs_py_qty_percent', Decimal('6700.0000')), ('budget_vs_ppy_qty_percent', Decimal('6700.0000')), ('QTY_Buy_By_SKU', Decimal('67.0000')), ('total_sku_count_ty', Decimal('1123392')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('67.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('381655.0700')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('381655.0700')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('82010890.2408')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0003')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('10.4550')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('10.4550')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'B.TECH X'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', None), ('proposed_sellthru_percent', Decimal('0E-20')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('24.9815082346142733')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 24.981508234614274), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', None), ('budget_amount', 26528780.330844816), ('budget_cost', 23526535.730000034), ('deficit', Decimal('26528780.3251')), ('Original_BudgetAmount', Decimal('26528780.3251')), ('budget_percent', Decimal('1.6652')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 11637.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('23526535.7300')), ('PO', None), ('COSTPRICE', None), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('3653')), ('net_sales_ly', Decimal('0.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('0.0000')), ('total_sku_count', Decimal('6434')), ('ly_customer_disc', Decimal('0.0000')), ('SupplyCost', Decimal('22350208.9435')), ('SALESQTY', None), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('2.1048')), ('budget_qty_act_fct_percent', Decimal('1163700.0000')), ('budget_vs_py_qty_percent', Decimal('1163700.0000')), ('budget_vs_ppy_qty_percent', Decimal('1163700.0000')), ('QTY_Buy_By_SKU', Decimal('11637.0000')), ('total_sku_count_ty', Decimal('396728625')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('0')), ('quantity_mix_percent', Decimal('0.0000')), ('quantity_act_forecast', Decimal('11637.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('0.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('0.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0020')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('23526535.7300')), ('budget_vs_py_cost_percent', Decimal('0.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('0.0000')), ('cost_act_forecast', Decimal('23526535.7300')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('595047784.0850')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0401')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('230.7869')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('230.7869')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'B2B'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('19670.680497398844')), ('proposed_sellthru_percent', Decimal('68.0487804878048780')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('32.9512195121951220')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 32.951219512195124), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 18064021.326172736), ('budget_cost', 4268327.429999998), ('deficit', Decimal('18064021.3256')), ('Original_BudgetAmount', Decimal('18064021.3256')), ('budget_percent', Decimal('1.1533')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 3641.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('4268327.4300')), ('PO', Decimal('386351.5313')), ('COSTPRICE', 3231866.2799999993), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('8')), ('net_sales_ly', Decimal('20895108.0000')), ('net_sales_lly', Decimal('347973.4000')), ('gross_sales_ly', Decimal('21008918.3300')), ('total_sku_count', Decimal('308')), ('ly_customer_disc', Decimal('113810.3300')), ('SupplyCost', Decimal('4054911.0585')), ('SALESQTY', 3727.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.5911')), ('budget_qty_act_fct_percent', Decimal('364100.0000')), ('budget_vs_py_qty_percent', Decimal('111688.4479')), ('budget_vs_ppy_qty_percent', Decimal('359868.1811')), ('QTY_Buy_By_SKU', Decimal('3641.0000')), ('total_sku_count_ty', Decimal('39178228')), ('total_sku_count_lly', Decimal('40')), ('total_sku_count_ly', Decimal('253')), ('quantity_mix_percent', Decimal('3.3054')), ('quantity_act_forecast', Decimal('3641.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('3454.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('276800.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0011')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('4268327.4300')), ('budget_vs_py_cost_percent', Decimal('300931377.0000')), ('budget_vs_ppy_cost_percent', Decimal('48111602.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('3023156.7500')), ('cost_act_forecast', Decimal('4268327.4300')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('1557532411.6168')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0302')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('157.1474')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('157.1474')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'CALL CENTER'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('1464.9523809523809524')), ('proposed_sellthru_percent', Decimal('24.1379310344827586')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('17.6436781609195402')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 17.64367816091954), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 436326.39706580236), ('budget_cost', 527213.74), ('deficit', Decimal('436326.3967')), ('Original_BudgetAmount', Decimal('436326.3967')), ('budget_percent', Decimal('0.0277')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 71.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('527213.7400')), ('PO', Decimal('40765.8843')), ('COSTPRICE', 167194.66999999998), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('7')), ('net_sales_ly', Decimal('30230.0000')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('30764.0000')), ('total_sku_count', Decimal('63')), ('ly_customer_disc', Decimal('534.0000')), ('SupplyCost', Decimal('500853.0530')), ('SALESQTY', 4.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('0.0134')), ('budget_qty_act_fct_percent', Decimal('7100.0000')), ('budget_vs_py_qty_percent', Decimal('7100.0000')), ('budget_vs_ppy_qty_percent', Decimal('7100.0000')), ('QTY_Buy_By_SKU', Decimal('71.0000')), ('total_sku_count_ty', Decimal('5670836')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('15')), ('quantity_mix_percent', Decimal('0.0040')), ('quantity_act_forecast', Decimal('71.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('4.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('400.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0000')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('527213.7400')), ('budget_vs_py_cost_percent', Decimal('16719467.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('167194.6700')), ('cost_act_forecast', Decimal('527213.7400')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('11832122.7064')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.0000')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('3.7957')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('3.7957')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]), OrderedDict([('Channel', 'DEEL'), ('final_price', Decimal('0E-20')), ('act_forecast_vs_budget_percent', Decimal('0E-20')), ('SalesActualsByForecast', Decimal('0E-20')), ('initial_average_retail_price', Decimal('16413.999576605903')), ('proposed_sellthru_percent', Decimal('96.7226890756302521')), ('retail_value_including_markdown', Decimal('0E-20')), ('budget_gross_margin_percent', Decimal('63.7693277310924370')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 63.76932773109244), ('MarkdownValue', Decimal('0E-20')), ('markdown_percent', Decimal('0E-20')), ('DisplayItemValue', Decimal('0E-20')), ('budget_amount', 392503333.38467), ('budget_cost', 85289696.13700007), ('deficit', Decimal('392503333.3815')), ('Original_BudgetAmount', Decimal('392503333.3815')), ('budget_percent', Decimal('25.0969')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 72856.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('85289696.1370')), ('PO', Decimal('981840304.4883')), ('COSTPRICE', 87358417.88000019), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('57717')), ('net_sales_ly', Decimal('405277851.0400')), ('net_sales_lly', Decimal('0.0000')), ('gross_sales_ly', Decimal('411783475.0400')), ('total_sku_count', Decimal('4750')), ('ly_customer_disc', Decimal('6505624.0000')), ('SupplyCost', Decimal('81025211.3302')), ('SALESQTY', 74957.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('11.7492')), ('budget_qty_act_fct_percent', Decimal('7285600.0000')), ('budget_vs_py_qty_percent', Decimal('1261810.3330')), ('budget_vs_ppy_qty_percent', Decimal('7285600.0000')), ('QTY_Buy_By_SKU', Decimal('72856.0000')), ('total_sku_count_ty', Decimal('458060480')), ('total_sku_count_lly', Decimal('0')), ('total_sku_count_ly', Decimal('4608')), ('quantity_mix_percent', Decimal('71.6868')), ('quantity_act_forecast', Decimal('72856.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('74957.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('7208200.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.0435')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('85289696.1370')), ('budget_vs_py_cost_percent', Decimal('8439102573.0000')), ('budget_vs_ppy_cost_percent', Decimal('0.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('87358417.8800')), ('cost_act_forecast', Decimal('85289696.1370')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('30723242882.7641')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('0.6047')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('3414.5564')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('3414.5564')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))])] 11 getData dictsize
1387.345798029 end of fetch data
shape: (11, 81)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ Channel   ┆ final_pri ┆ act_forec ┆ SalesActu ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ---       ┆ ce        ┆ ast_vs_bu ┆ alsByFore ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ str       ┆ ---       ┆ dget_perc ┆ cast      ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│           ┆ f64       ┆ ent       ┆ ---       ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆           ┆ ---       ┆ f64       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆           ┆ f64       ┆           ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ ARKAN     ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 10.455    ┆ 0.0       ┆ 0.0      │
│ B.TECH X  ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 230.7869  ┆ 0.0       ┆ 0.0      │
│ B2B       ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 157.1474  ┆ 0.0       ┆ 0.0      │
│ CALL      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 3.7957    ┆ 0.0       ┆ 0.0      │
│ CENTER    ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆          │
│ DEEL      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 3414.5564 ┆ 0.0       ┆ 0.0      │
│ MINI      ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 24.6193   ┆ 0.0       ┆ 0.0      │
│ NON       ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 4.9223    ┆ 0.0       ┆ 0.0      │
│ ONLINE    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 1016.6893 ┆ 0.0       ┆ 0.0      │
│ Retail    ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 2935.455  ┆ 0.0       ┆ 0.0      │
│ WAREHOUSE ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 5408.9087 ┆ 0.0       ┆ 0.0      │
│ 0         ┆ 0.0       ┆ 0.0       ┆ 0.0       ┆ … ┆ 0.0       ┆ 402.0972  ┆ 0.0       ┆ 0.0      │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the filter dataframe
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ -182.414365       │
└───────────────────┘ ly_mgn
shape: (11, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 0.0        ┆ 0.0        ┆ 1.2018e6   ┆ 69.82999  ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 2.6529e7   ┆ 15.751087 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 113810.33  ┆ 2.0895108e ┆ 1.8064e7   ┆ 77.552556 ┆ 1.8162e7  ┆ 68.04878  ┆ 2.6690e7  ┆ 0.541724  │
│            ┆ 7          ┆            ┆           ┆           ┆           ┆           ┆           │
│ 534.0      ┆ 30230.0    ┆ 436326.397 ┆ -14.78862 ┆ 444033.91 ┆ 24.137931 ┆ 1.8396e6  ┆ 1.735795  │
│            ┆            ┆ 066        ┆ 1         ┆ 5955      ┆           ┆           ┆           │
│ 6.505624e6 ┆ 4.0528e8   ┆ 3.9250e8   ┆ 79.356809 ┆ 3.9880e8  ┆ 96.722689 ┆ 4.1232e8  ┆ 1.579865  │
│ 120819.0   ┆ 2.199974e6 ┆ 2.8301e6   ┆ 24.038323 ┆ 2.9855e6  ┆ 78.729282 ┆ 3.7922e6  ┆ 5.205936  │
│ 38695.0    ┆ 505514.0   ┆ 565820.374 ┆ 65.937801 ┆ 609131.57 ┆ 82.222222 ┆ 740835.70 ┆ 7.11032   │
│            ┆            ┆ 699        ┆           ┆ 7551      ┆           ┆ 2427      ┆           │
│ 5.684192e6 ┆ 1.1369e8   ┆ 1.1687e8   ┆ 30.822653 ┆ 1.2271e8  ┆ 95.20332  ┆ 1.2889e8  ┆ 4.761653  │
│ 0.0        ┆ 0.0        ┆ 3.3743e8   ┆ 18.805384 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 6.2175e8   ┆ 30.340196 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
│ 0.0        ┆ 0.0        ┆ 4.6221e7   ┆ 81.700132 ┆ NaN       ┆ 0.0       ┆ NaN       ┆ NaN       │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['Channel', 'final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A23116B040>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A23116AE90>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A23116A4A0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A23116A500>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A23116B490>, <Expr ['col("retail_value_including_ma…'] at 0x76A23116B370>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A23116B400>, <Expr ['col("Logistic%").mean()'] at 0x76A23116B580>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A23116B700>, <Expr ['col("MarkdownValue").mean()'] at 0x76A23116B430>, <Expr ['col("markdown_percent").mean()'] at 0x76A23116A440>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A231169270>, <Expr ['col("budget_amount").sum()'] at 0x76A23116AE00>, <Expr ['col("budget_cost").sum()'] at 0x76A23116ABC0>, <Expr ['col("deficit").sum()'] at 0x76A23116B070>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A23116AE30>, <Expr ['col("budget_percent").sum()'] at 0x76A23116BA60>, <Expr ['col("relative_budget_percent")…'] at 0x76A23116AFE0>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A23116BA30>, <Expr ['col("budget_qty").sum()'] at 0x76A23116A2C0>, <Expr ['col("ACT_FCT").sum()'] at 0x76A23116AB90>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A23116AFB0>, <Expr ['col("PO").sum()'] at 0x76A23116B8E0>, <Expr ['col("COSTPRICE").sum()'] at 0x76A23116BC70>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A23116AD10>, <Expr ['col("sales_actual").sum()'] at 0x76A23116B9D0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A23116B760>, <Expr ['col("net_sales_ly").sum()'] at 0x76A231168CD0>, <Expr ['col("net_sales_lly").sum()'] at 0x76A23116B820>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A23116BB80>, <Expr ['col("total_sku_count").sum()'] at 0x76A231168FA0>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A23116B7F0>, <Expr ['col("SupplyCost").sum()'] at 0x76A231168070>, <Expr ['col("SALESQTY").sum()'] at 0x76A23116B670>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A231168220>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A231168B20>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A23116ABF0>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A23116BA90>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A231168E50>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A23116B910>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A231168CA0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A23116B6A0>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A2311687C0>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A231168D30>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A2311683A0>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A231168A60>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A231168190>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A231168D00>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A231168E80>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A2311687F0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2311688E0>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A2311689A0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A231168D60>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A23116AB60>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A231168700>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A231168850>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A231168820>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A231168910>, <Expr ['col("cost_actuals").sum()'] at 0x76A231168370>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A231168880>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A23116A290>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A231168460>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A231168730>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A231168640>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A231168AC0>, <Expr ['col("budget_margin_percent").s…'] at 0x76A2311680D0>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A23116A590>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A231168280>, <Expr ['col("margin_actuals").sum()'] at 0x76A231168250>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A231169150>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A23116BEB0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A231168C70>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A2311684F0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A2311681F0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A23116A530>, <Expr ['col("initial_average_retail_pr…'] at 0x76A231168E20>, <Expr ['col("initial_average_retail_pr…'] at 0x76A23116A470>, <Expr ['col("budget_per_sku").sum()'] at 0x76A2311684C0>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A2311683D0>, <Expr ['col("Check_box").max()'] at 0x76A23116A6B0>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["Channel","final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0,1,2,3,4,5,6,7,8,9,10],"data":[["ARKAN",0.0,0.0,0.0,0.0,0.0,null,68.2420942245,5.0,68.2420942245,null,null,0.0,1201763.9724044839,381655.07,1201763.9727,1201763.9727,0.0768194061,0.0768194061,0.0,67.0,0.0,381655.07,0.0,0.0,0.0,0.0,893.0,0.0,0.0,0.0,32.0,0.0,362572.3165,0.0,0.0,0.0,0.0115,6700.0,6700.0,6700.0,67.0,1123392.0,0.0,0.0,0.0,67.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,381655.07,0.0,0.0,0.0,0.0,0.0,381655.07,0.0,0.0,0.0,0.0,82010890.2407999933,0.0,0.0,0.0,0.0,0.0003,0.0,10.455,0.0,0.0,0.0,0.0,10.455,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,69.8299895133,0.0,0.0,0.0,null,0.0,820108.9024044839,0.0,0.0,0.0,0.0,0.0,1201763.9724044839,null,null,null],["B.TECH X",0.0,0.0,0.0,0.0,0.0,null,11.31693415,5.0,11.31693415,null,null,0.0,26528780.3308448158,23526535.730000034,26528780.3251000009,26528780.3251000009,1.6957782022,1.6957782022,0.0,11637.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,3653.0,0.0,0.0,0.0,6434.0,0.0,22350208.943500001,0.0,0.0,0.0,2.1048,1163700.0,1163700.0,1163700.0,11637.0,396728625.0,0.0,0.0,0.0,11637.0,0.0,0.0,0.0,0.0,0.0,0.002,0.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,0.0,23526535.7300000004,0.0,0.0,0.0,0.0,595047784.0850000381,0.0,0.0,0.0,0.0,0.0401,0.0,230.7869,0.0,0.0,0.0,0.0,230.7869,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,15.7510874425,0.0,0.0,0.0,null,0.0,3002244.6008447818,0.0,0.0,0.0,0.0,0.0,26528780.3308448158,null,null,null],["B2B",0.0,0.0,0.0,19670.6804973988,68.0487804878,18162411.4483132325,76.3711116538,5.0,76.3711116538,11381033.0,0.5417238918,0.0,18064021.3261727355,4268327.4299999978,18064021.3255999982,18064021.3255999982,1.1546921203,1.1546921203,0.0,3641.0,0.0,4268327.4299999997,386351.5313,3231866.2799999993,0.0,0.0,8.0,20895108.0,347973.4,21008918.3299999982,308.0,113810.33,4054911.0584999998,3727.0,0.0,0.0,0.5911,364100.0,111688.4479,359868.1811,3641.0,39178228.0,40.0,253.0,3.3054,3641.0,0.0,3454.0,276800.0,0.0,0.0,0.0011,0.0,0.0,4268327.4299999997,300931377.0,48111602.0,0.0,0.0,3023156.75,4268327.4299999997,0.0,0.0,0.0,0.0,1557532411.6168000698,0.0,0.0,0.0,0.0,0.0302,0.0,157.1474,0.0,0.0,0.0,0.0,157.1474,0.0,0.0,86.4509593641,5191.2075251076,0.0,0.0,100.0,0.0,77.5525560711,157365.4439791907,85.5317486275,17871951.25,0.0,0.0,13795693.8961727377,161293.2521262725,157365.4439791907,22768.0280083949,157365.4439791907,18162411.4483132251,18064021.3261727393,26690282.056661021,5991286.0991384313,5110.7308529428],["CALL CENTER",0.0,0.0,0.0,1464.9523809524,24.1379310345,444033.9159554199,-20.8301270667,5.0,-20.8301270667,53400.0,1.7357950852,0.0,436326.3970658024,527213.74,436326.3967,436326.3967,0.0278909465,0.0278909465,0.0,71.0,0.0,527213.74,40765.8843,167194.67,0.0,0.0,7.0,30230.0,0.0,30764.0,63.0,534.0,500853.053,4.0,0.0,0.0,0.0134,7100.0,7100.0,7100.0,71.0,5670836.0,0.0,15.0,0.004,71.0,0.0,4.0,400.0,0.0,0.0,0.0,0.0,0.0,527213.74,16719467.0,0.0,0.0,0.0,167194.67,527213.74,0.0,0.0,0.0,0.0,11832122.7063999996,0.0,0.0,0.0,0.0,0.0,0.0,3.7957,0.0,0.0,0.0,0.0,3.7957,0.0,0.0,1443.3555973067,0.0,0.0,0.0,0.0,0.0,-14.7886207133,10254.6666666667,-453.0753225273,-136964.67,0.0,0.0,-90887.3429341976,200.6009562102,10254.6666666667,56716.0307407652,10254.6666666667,444033.9159554199,436326.3970658024,1839569.0803867397,2111615.9744448182,284.3718264732],["DEEL",0.0,0.0,0.0,16413.9995766059,96.7226890756,398803897.5511910915,78.2703256552,5.0,78.2703256552,650562400.0,1.5798652433,0.0,392503333.3846700191,85289696.137000069,392503333.3815000057,392503333.3815000057,25.0896795376,25.0896795376,0.0,72856.0,0.0,85289696.1369999945,981840304.4882999659,87358417.8800001889,0.0,0.0,57717.0,405277851.0400000215,0.0,411783475.0400000215,4750.0,6505624.0,81025211.3302000016,74957.0,0.0,0.0,11.7492,7285600.0,1261810.3330000001,7285600.0,72856.0,458060480.0,0.0,4608.0,71.6868,72856.0,0.0,74957.0,7208200.0,0.0,0.0,0.0435,0.0,0.0,85289696.1369999945,8439102573.0,0.0,0.0,0.0,87358417.8799999952,85289696.1369999945,0.0,0.0,0.0,0.0,30723242882.7640991211,0.0,0.0,0.0,0.0,0.6047,0.0,3414.5564,0.0,0.0,0.0,0.0,3414.5564,0.0,0.0,96.8479605726,0.0,0.0,0.0,0.0,0.0,79.3568093724,947366813.5629628897,78.4448082579,317919433.1600000262,0.0,0.0,307213637.2476699352,3916302.9914958649,947366813.5629628897,204206733.1646729112,947366813.5629628897,398803897.5511911511,392503333.3846699595,412316801.1172174811,85115343.2441636771,72707.0646076159],["MINI",0.0,0.0,0.0,3035.2819354949,78.729281768,2985539.0552947633,20.0403404442,5.0,20.0403404442,12081899.9999999981,5.2059360744,0.0,2830113.8005987788,2262949.3599999985,2830113.8010999998,2830113.8010999998,0.1809071217,0.1809071217,0.0,1218.0,0.0,2262949.3599999999,326005.7196,2001507.1700000009,0.0,0.0,207.0,2199974.0,0.0,2320793.0,695.0,120819.0,2149801.892,1002.0,0.0,0.0,0.2105,121800.0,85899.9998,121800.0,1218.0,64715402.0,0.0,581.0,0.9695,1218.0,0.0,1002.0,97200.0,0.0,0.0,0.0,0.0,0.0,2262949.3599999999,198527517.0,0.0,0.0,0.0,2001507.1699999999,2262949.3599999999,0.0,0.0,0.0,0.0,71360884.058799997,0.0,0.0,0.0,0.0,0.0031,0.0,24.6193,0.0,0.0,0.0,0.0,24.6193,0.0,0.0,128.6430567179,0.0,0.0,0.0,0.0,0.0,24.038323422,628303.3606474403,9.0213261611,198466.8300000001,0.0,0.0,567164.4405987803,62869.2977583136,628303.3606474403,571622.0652021103,628303.3606474403,2985539.0552947633,2830113.8005987788,3792158.3790059802,2880587.083185798,1550.4346360275],["NON",0.0,0.0,0.0,5428.9903918919,82.2222222222,609131.5775514458,64.1450539656,5.0,64.1450539656,3869500.0,7.1103197485,0.0,565820.3746985839,202874.59,565820.3747,565820.3747,0.0361684874,0.0361684874,0.0,112.0,0.0,202874.59,8714.588,146848.65,0.0,0.0,3.0,505514.0,0.0,544209.0,45.0,38695.0,192730.8605,104.0,0.0,0.0,0.0186,11200.0,4860.0,11200.0,112.0,4366090.0,0.0,37.0,0.1001,112.0,0.0,104.0,10400.0,0.0,0.0,0.0,0.0,0.0,202874.59,14684864.0,0.0,0.0,0.0,146848.65,202874.59,0.0,0.0,0.0,0.0,36294578.4698999971,0.0,0.0,0.0,0.0,0.0001,0.0,4.9223,0.0,0.0,0.0,0.0,4.9223,0.0,0.0,111.9297140531,0.0,0.0,0.0,0.0,0.0,65.9378012673,16286.9711756757,70.9506264911,358665.35,0.0,0.0,362945.7846985838,5115.469766068,16286.9711756757,4731.263090116,16286.9711756757,609131.5775514459,565820.3746985837,740835.702427434,252344.9292437059,139.3108524596],["ONLINE",0.0,0.0,0.0,8516.5590508964,95.2033195021,122711565.7260519266,27.1817404781,5.0,27.1817404781,568419200.0000001192,4.7616526371,0.0,116868467.2206594348,85101583.7599998713,116868467.2134999931,116868467.2134999931,7.4704904168,7.4704904168,0.0,25436.0,0.0,85101583.7600000054,289571650.3118000031,83320735.6399999112,0.0,0.0,19778.0,113690160.4200000018,0.0,119374352.4200000018,5897.0,5684192.0,80846504.5719999969,25096.0,0.0,0.0,4.2018,2543600.0,931116.5072,2543600.0,25436.0,588164202.0,0.0,5642.0,24.0802,25436.0,0.0,25096.0,2445300.0,0.0,0.0,0.0568,0.0,0.0,85101583.7600000054,8264790201.0,0.0,0.0,0.0,83320735.6400000006,85101583.7600000054,0.0,0.0,0.0,0.0,3260037604.0521998405,0.0,0.0,0.0,0.0,0.1601,0.0,1016.6893,0.0,0.0,0.0,0.0,1016.6893,0.0,0.0,102.7955865212,0.0,0.0,0.0,0.0,0.0,30.8226534542,168440504.908629626,26.7124478212,30369424.7800000012,0.0,0.0,31766883.4606595635,1189216.4908781094,168440504.908629626,123445922.9251921624,168440504.908629626,122711565.7260519266,116868467.2206594348,128894209.1177585125,89165593.7188596576,26650.6913458753],["Retail",0.0,0.0,0.0,0.0,0.0,null,14.5319827416,5.0,14.5319827416,null,null,0.0,337427030.3686292768,288392192.5499975681,337427030.3485999703,337427030.3485999703,21.5690806656,21.5690806656,0.0,394649.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,73550.0,0.0,0.0,0.0,63110.0,0.0,273972582.9225000143,0.0,0.0,0.0,65.7041,39464900.0,39464900.0,39464900.0,394649.0,3965551539.0,0.0,1.0,0.0,394649.0,0.0,0.0,0.0,0.0,0.0,0.0193,0.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,0.0,288392192.5500000119,0.0,0.0,0.0,0.0,8408750625.8790998459,0.0,0.0,0.0,0.0,2.7984,0.0,2935.455,0.0,0.0,0.0,0.0,2935.455,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,18.8053836045,0.0,0.0,0.0,null,0.0,49034837.8186317086,0.0,0.0,0.0,0.0,0.0,337427030.3686292768,null,null,null],["WAREHOUSE",0.0,0.0,0.0,0.0,0.0,null,26.6738901388,5.0,26.6738901388,null,null,0.0,621754634.7719318867,455908486.5600001812,621754634.7683999538,621754634.7683999538,39.7439288043,39.7439288043,0.0,102879.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,285440.0,0.0,0.0,0.0,32518.0,0.0,433113062.2319999933,0.0,0.0,0.0,17.3396,10287900.0,10287900.0,10287900.0,102879.0,1967204902.0,1.0,0.0,0.0,102879.0,0.0,0.0,0.0,0.0,0.0,0.2318,0.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,0.0,455908486.5600000024,0.0,0.0,0.0,0.0,18754576488.1813011169,0.0,0.0,0.0,0.0,0.5502,0.0,5408.9087,0.0,0.0,0.0,0.0,5408.9087,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,30.3401956319,0.0,0.0,0.0,null,0.0,165846148.2119317055,0.0,0.0,0.0,0.0,0.0,621754634.7719318867,null,null,null],["0",0.0,0.0,0.0,0.0,0.0,null,80.7369806851,5.0,80.7369806851,null,null,0.0,46221249.3143757954,8903608.1830000058,46221249.3153999969,46221249.3153999969,2.9545642915,2.9545642915,0.0,7329.0,0.0,8903608.1830000002,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1098.0,0.0,8458427.7748000007,0.0,0.0,0.0,1.2049,732900.0,732900.0,732900.0,7329.0,64944360.0,0.0,0.0,0.0,7329.0,0.0,0.0,0.0,0.0,0.0,0.0006,0.0,0.0,8903608.1830000002,0.0,0.0,0.0,0.0,0.0,8903608.1830000002,0.0,0.0,0.0,0.0,3753912287.1366000175,0.0,0.0,0.0,0.0,0.0538,0.0,402.0972,0.0,0.0,0.0,0.0,402.0972,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,81.7001316488,0.0,0.0,0.0,null,0.0,37317641.1313757896,0.0,0.0,0.0,0.0,0.0,46221249.3143757805,null,null,null]], "select_all_kpi":false,"editable_cols":["budget_percent", "budget_qty", "adjusted_budget_gross_margin_percent", "markdown_percent", "Logistic%", "proposed_sellthru_percent", "DisplayItemQty", "COR_EOLStock_value"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":11,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":4957.3148939309,"proposed_sellthru_percent":40.4603840082,"retail_value_including_markdown":1600336360.8479444981,"budget_gross_margin_percent":40.6073024609,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":40.6073024609,"MarkdownValue":1246367433.0000002384,"markdown_percent":2.2454541723,"DisplayItemValue":0.0,"budget_amount":1564401541.2620515823,"budget_cost":954765123.1099976301,"deficit":1564401541.2232997417,"Original_BudgetAmount":1564401541.2232997417,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":619895.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":954765123.1100000143,"PO":1272173792.5232999325,"COSTPRICE":176226570.2900001109,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":441256.0,"net_sales_ly":542598837.4600000381,"net_sales_lly":347973.4,"gross_sales_ly":555062511.7899999619,"total_sku_count":114950.0,"ly_customer_disc":12463674.3300000001,"SupplyCost":907026866.9555000067,"SALESQTY":104890.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":103.1495,"budget_qty_act_fct_percent":61989500.0,"budget_vs_py_qty_percent":54058575.2879000008,"budget_vs_ppy_qty_percent":61985268.181099996,"QTY_Buy_By_SKU":619895.0,"total_sku_count_ty":7555708056.0,"total_sku_count_lly":41.0,"total_sku_count_ly":11137.0,"quantity_mix_percent":100.146,"quantity_act_forecast":619895.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":104617.0,"quantity_act_forecast_vs_ly_percent":10038300.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.3551,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":954765123.1100000143,"budget_vs_py_cost_percent":17234755999.0,"budget_vs_ppy_cost_percent":48111602.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":176017860.7599999905,"cost_act_forecast":954765123.1100000143,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":67254598559.1909942627,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":4.241,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":13609.4332,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":13609.4332,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":67.5602215471,"FirstMargin_percent":42.0208403641,"budget_vpy":288.3164196564,"budget_vppy":449575.0368453598,"StockatRetailPrice":2187444940.8363904953,"TYForecast":2187444940.8363904953,"LYvsACT_FCT_percent":100.0,"supply_retail_value":1564401541.2620515823} } data_json
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': False, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are here main grpby
{'family': [], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
False sun_filter_state_lambda
0_g_len
No main filter No sub_filter_state
No MFS No SFS group is : []
we are calling main groupby process
conn established
[]
main aggregation executed
1388.351234224 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', Decimal('11758.7683247112756766')), ('proposed_sellthru_percent', Decimal('9.1492581023037876')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('27.4787111154496941')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 27.478711115449695), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 1564401541.262046), ('budget_cost', 954765123.1099892), ('deficit', Decimal('1564401541.2233')), ('Original_BudgetAmount', Decimal('1564401541.2233')), ('budget_percent', Decimal('99.8578')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 619895.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('954765123.1100')), ('PO', Decimal('1272173792.5233')), ('COSTPRICE', 176226570.29000056), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('441256')), ('net_sales_ly', Decimal('542598837.4600')), ('net_sales_lly', Decimal('347973.4000')), ('gross_sales_ly', Decimal('555062511.7900')), ('total_sku_count', Decimal('114950')), ('ly_customer_disc', Decimal('12463674.3300')), ('SupplyCost', Decimal('907026866.9555')), ('SALESQTY', 104890.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('103.1495')), ('budget_qty_act_fct_percent', Decimal('61989500.0000')), ('budget_vs_py_qty_percent', Decimal('54058575.2879')), ('budget_vs_ppy_qty_percent', Decimal('61985268.1811')), ('QTY_Buy_By_SKU', Decimal('619895.0000')), ('total_sku_count_ty', Decimal('7555708056')), ('total_sku_count_lly', Decimal('41')), ('total_sku_count_ly', Decimal('11137')), ('quantity_mix_percent', Decimal('100.1460')), ('quantity_act_forecast', Decimal('619895.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('104617.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('10038300.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.3551')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('954765123.1100')), ('budget_vs_py_cost_percent', Decimal('17234755999.0000')), ('budget_vs_ppy_cost_percent', Decimal('48111602.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('176017860.7600')), ('cost_act_forecast', Decimal('954765123.1100')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('67254598559.1910')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('4.2410')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('13609.4332')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('13609.4332')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
1388.549504797 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 0.0       ┆ 11758.768 ┆ … ┆ 0.0       ┆ 13609.433 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆           ┆ 325       ┆   ┆           ┆ 2         ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 1
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 67.560222         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1.2464e7   ┆ 5.4260e8   ┆ 1.5644e9   ┆ 42.02084  ┆ 1.6003e9  ┆ 9.149258  ┆ 1.7491e10 ┆ 2.245454  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
[<Expr ['col("final_price").mean()'] at 0x76A23116B3D0>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A231169DB0>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A231169360>, <Expr ['col("initial_average_retail_pr…'] at 0x76A231168F70>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A231168F40>, <Expr ['col("retail_value_including_ma…'] at 0x76A23116BD90>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A23116A3B0>, <Expr ['col("Logistic%").mean()'] at 0x76A916469990>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A916469F30>, <Expr ['col("MarkdownValue").mean()'] at 0x76A916469ED0>, <Expr ['col("markdown_percent").mean()'] at 0x76A231168520>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A916468880>, <Expr ['col("budget_amount").sum()'] at 0x76A9164687C0>, <Expr ['col("budget_cost").sum()'] at 0x76A916468820>, <Expr ['col("deficit").sum()'] at 0x76A9164687F0>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A916468730>, <Expr ['col("budget_percent").sum()'] at 0x76A9164686A0>, <Expr ['col("relative_budget_percent")…'] at 0x76A916468700>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A916468670>, <Expr ['col("budget_qty").sum()'] at 0x76A916468580>, <Expr ['col("ACT_FCT").sum()'] at 0x76A9164684F0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A916468550>, <Expr ['col("PO").sum()'] at 0x76A916468490>, <Expr ['col("COSTPRICE").sum()'] at 0x76A9164684C0>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A9164683D0>, <Expr ['col("sales_actual").sum()'] at 0x76A916468400>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A916468220>, <Expr ['col("net_sales_ly").sum()'] at 0x76A916468250>, <Expr ['col("net_sales_lly").sum()'] at 0x76A9164681F0>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A9164681C0>, <Expr ['col("total_sku_count").sum()'] at 0x76A916468370>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A9164682B0>, <Expr ['col("SupplyCost").sum()'] at 0x76A916468040>, <Expr ['col("SALESQTY").sum()'] at 0x76A916468070>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A916468160>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A91646B7C0>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A91646B7F0>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A91646B910>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A91646B970>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A91646BD90>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A91646B8B0>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A91646BBB0>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A91646BE20>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A91646BC70>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A91646BD30>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A91646BF10>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A91646BE80>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A916469960>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A91646BA60>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A916469D20>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A916469A50>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A916469D80>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A916469CF0>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A9164699C0>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A916469DE0>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A916469C60>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A9164698D0>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A916469E70>, <Expr ['col("cost_actuals").sum()'] at 0x76A916469F00>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A916468A30>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A916468A00>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A9164689D0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A916468A60>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A916468BB0>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A916468C70>, <Expr ['col("budget_margin_percent").s…'] at 0x76A916468D00>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A916468CD0>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A916468D60>, <Expr ['col("margin_actuals").sum()'] at 0x76A916468EB0>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A916468D90>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A916468EE0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A916468F10>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A916468FA0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A916468FD0>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A916469000>, <Expr ['col("initial_average_retail_pr…'] at 0x76A916468E50>, <Expr ['col("initial_average_retail_pr…'] at 0x76A916469090>, <Expr ['col("budget_per_sku").sum()'] at 0x76A916469060>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A916469450>, <Expr ['col("Check_box").max()'] at 0x76A9164691B0>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,0.0,11758.7683247113,9.1492581023,1600336360.8479385376,38.9693056464,5.0,38.9693056464,1246367433.0000002384,2.2454541723,0.0,1564401541.2620460987,954765123.1099891663,1564401541.2232999802,1564401541.2232999802,100.0,100.0,0.0,619895.0,0.0,954765123.1100000143,1272173792.5232999325,176226570.2900005579,0.0,0.0,441256.0,542598837.4600000381,347973.4,555062511.7899999619,114950.0,12463674.3300000001,907026866.9555000067,104890.0,0.0,0.0,103.1495,61989500.0,54058575.2879000008,61985268.1811000034,619895.0,7555708056.0,41.0,11137.0,100.146,619895.0,0.0,104617.0,10038300.0,0.0,0.0,0.3551,0.0,0.0,954765123.1100000143,17234755999.0,48111602.0,0.0,0.0,176017860.7599999905,954765123.1100000143,0.0,0.0,0.0,0.0,67254598559.1910018921,0.0,0.0,0.0,0.0,4.241,0.0,13609.4332,0.0,0.0,0.0,0.0,13609.4332,0.0,0.0,288.3164196564,449575.0368453583,0.0,0.0,100.0,0.0,42.0208403641,5188627075.88879776,67.5602215471,366580976.7000000477,0.0,0.0,609636418.1520569324,9023600.0443987176,5188627075.88879776,1683179128.1651751995,5188627075.88879776,1600336360.847938776,1564401541.2620458603,17491433108.0568504333,10141385924.3347549438,6584440.7963792738]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":11758.7683247113,"proposed_sellthru_percent":9.1492581023,"retail_value_including_markdown":1600336360.8479385376,"budget_gross_margin_percent":38.9693056464,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":38.9693056464,"MarkdownValue":1246367433.0000002384,"markdown_percent":2.2454541723,"DisplayItemValue":0.0,"budget_amount":1564401541.2620460987,"budget_cost":954765123.1099891663,"deficit":1564401541.2232999802,"Original_BudgetAmount":1564401541.2232999802,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":619895.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":954765123.1100000143,"PO":1272173792.5232999325,"COSTPRICE":176226570.2900005579,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":441256.0,"net_sales_ly":542598837.4600000381,"net_sales_lly":347973.4,"gross_sales_ly":555062511.7899999619,"total_sku_count":114950.0,"ly_customer_disc":12463674.3300000001,"SupplyCost":907026866.9555000067,"SALESQTY":104890.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":103.1495,"budget_qty_act_fct_percent":61989500.0,"budget_vs_py_qty_percent":54058575.2879000008,"budget_vs_ppy_qty_percent":61985268.1811000034,"QTY_Buy_By_SKU":619895.0,"total_sku_count_ty":7555708056.0,"total_sku_count_lly":41.0,"total_sku_count_ly":11137.0,"quantity_mix_percent":100.146,"quantity_act_forecast":619895.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":104617.0,"quantity_act_forecast_vs_ly_percent":10038300.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.3551,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":954765123.1100000143,"budget_vs_py_cost_percent":17234755999.0,"budget_vs_ppy_cost_percent":48111602.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":176017860.7599999905,"cost_act_forecast":954765123.1100000143,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":67254598559.1910018921,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":4.241,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":13609.4332,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":13609.4332,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":67.5602215471,"FirstMargin_percent":42.0208403641,"budget_vpy":288.3164196564,"budget_vppy":449575.0368453583,"StockatRetailPrice":5188627075.88879776,"TYForecast":5188627075.88879776,"LYvsACT_FCT_percent":100.0,"supply_retail_value":1564401541.2620458603} } data_json
INFO:     106.51.119.229:0 - "GET /otb/sub_filters HTTP/1.1" 200 OK
{'history_date_range': {'fro': '2023-07-15', 'to': '2023-07-31'}, 'forecast_date_range': {'fro': '2024-06-15', 'to': '2024-07-31'}, 'sales_channel': [], 'product_family': [], 'sub_families': [], 'suppliers': [], 'category': [], 'sub_category': [], 'sku': [], 'top_items': [], 'store_class': [], 'select_all_kpi': '', 'page_number': 0, 'page_size': 10, 'fetch_from_db': False, 'group_by': {'status': True, 'columns': []}, 'expand': {'status': False, 'row': {}}, 'sort': {}, 'table_changes': {}, 'secondary_filter': {'family': ['LAPTOP', 'BMOBILE ACCESSORIES', 'COMPLEMENTARY', 'AC', 'MDA', '0', 'TABLET', 'SDA', 'MOBILE', 'NON', 'TV'], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []}} SDFD
page_size=10 page_number=0 history_date_range=DateFromTo(fro='2023-07-15', to='2023-07-31') forecast_date_range=DateFromTo(fro='2024-06-15', to='2024-07-31') sales_channel=[] product_family=[] sub_families=[] category=[] sub_category=[] suppliers=[] sku=[] top_items=[] store_class=[] secondary_filter=SecondaryFilter(HistoricalYear=[], history_dates=[], history_Quarter=[], history_month=[], history_week=[], history_Day=[], BudgetYear=[], BudgetDate=[], Quarter=[], month=[], week=[], Day=[], region=[], country=[], city=[], Store_Name=[], season=[], Channel=[], article_score=[])
we are here main grpby
The main grouping
we are calling main groupby process
conn established
{"secondary_filter": {"family": ["LAPTOP", "BMOBILE ACCESSORIES", "COMPLEMENTARY", "AC", "MDA", "0", "TABLET", "SDA", "MOBILE", "NON", "TV"], "sub_family": [], "supplier": [], "category": [], "dom_comm": [], "sub_category": [], "extended_sub_category": [], "sub_category_supplier": [], "HistoricalYear": [], "history_Day": [], "history_Quarter": [], "history_dates": [], "history_month": [], "history_week": [], "BudgetYear": [], "season": [], "country": [], "region": [], "area": [], "city": [], "Store_Name": [], "month": [], "week": [], "BudgetDate": [], "Quarter": [], "Day": [], "Channel": [], "article_score": []}} json format
secondary filter applied
{'family': ['LAPTOP', 'BMOBILE ACCESSORIES', 'COMPLEMENTARY', 'AC', 'MDA', '0', 'TABLET', 'SDA', 'MOBILE', 'NON', 'TV'], 'sub_family': [], 'supplier': [], 'category': [], 'dom_comm': [], 'sub_category': [], 'extended_sub_category': [], 'sub_category_supplier': [], 'HistoricalYear': [], 'history_Day': [], 'history_Quarter': [], 'history_dates': [], 'history_month': [], 'history_week': [], 'BudgetYear': [], 'season': [], 'country': [], 'region': [], 'area': [], 'city': [], 'Store_Name': [], 'month': [], 'week': [], 'BudgetDate': [], 'Quarter': [], 'Day': [], 'Channel': [], 'article_score': []} passing_to_procedure
[] passing_to_procedure0
True sun_filter_state_lambda
0_g_len
No MFS WITH SFS 
No MFS WITH SFS group is []
we are calling main groupby process
conn established
[]
main aggregation executed
1389.58621616 end of sku wise stored proc
conn established
OrderedDict([('final_price', Decimal('0E-24')), ('act_forecast_vs_budget_percent', Decimal('0E-24')), ('SalesActualsByForecast', Decimal('0E-24')), ('initial_average_retail_price', Decimal('11758.7683247112756766')), ('proposed_sellthru_percent', Decimal('9.1492581023037876')), ('retail_value_including_markdown', Decimal('0E-24')), ('budget_gross_margin_percent', Decimal('27.4787111154496941')), ('Logistic%', Decimal('5.0000000000000000')), ('adjusted_budget_gross_margin_percent', 27.478711115449695), ('MarkdownValue', Decimal('0E-24')), ('markdown_percent', Decimal('0E-24')), ('DisplayItemValue', Decimal('0E-24')), ('budget_amount', 1564401541.2620444), ('budget_cost', 954765123.1099796), ('deficit', Decimal('1564401541.2233')), ('Original_BudgetAmount', Decimal('1564401541.2233')), ('budget_percent', Decimal('99.8578')), ('relative_budget_percent', Decimal('0.0000')), ('History_Net_Sales', Decimal('0.0000')), ('budget_qty', 619895.0), ('ACT_FCT', Decimal('0.0000')), ('Original_BudgetCostofGoods', Decimal('954765123.1100')), ('PO', Decimal('1272173792.5233')), ('COSTPRICE', 176226570.29000074), ('Historical_Gross_Margin', Decimal('0.0000')), ('sales_actual', Decimal('0.0000')), ('stock_on_hand_qty', Decimal('441256')), ('net_sales_ly', Decimal('542598837.4600')), ('net_sales_lly', Decimal('347973.4000')), ('gross_sales_ly', Decimal('555062511.7900')), ('total_sku_count', Decimal('114950')), ('ly_customer_disc', Decimal('12463674.3300')), ('SupplyCost', Decimal('907026866.9555')), ('SALESQTY', 104890.0), ('DisplayItemQty', Decimal('0.0000')), ('COR_EOLStock_value', Decimal('0.0000')), ('Budget_Qty_Perc', Decimal('103.1495')), ('budget_qty_act_fct_percent', Decimal('61989500.0000')), ('budget_vs_py_qty_percent', Decimal('54058575.2879')), ('budget_vs_ppy_qty_percent', Decimal('61985268.1811')), ('QTY_Buy_By_SKU', Decimal('619895.0000')), ('total_sku_count_ty', Decimal('7555708056')), ('total_sku_count_lly', Decimal('41')), ('total_sku_count_ly', Decimal('11137')), ('quantity_mix_percent', Decimal('100.1460')), ('quantity_act_forecast', Decimal('619895.0000')), ('quantity_act_forecast_vs_budget_percent', Decimal('0.0000')), ('sold_qty_ly', Decimal('104617.0000')), ('quantity_act_forecast_vs_ly_percent', Decimal('10038300.0000')), ('quantity_act_or_forecast_per_sku', Decimal('0.0000')), ('quantity_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('budget_cost_percent', Decimal('0.3551')), ('budget_vs_act_forecast_cost_percent', Decimal('0.0000')), ('cost_budget_per_sku', Decimal('0.0000')), ('BudgetCostofGoods', Decimal('954765123.1100')), ('budget_vs_py_cost_percent', Decimal('17234755999.0000')), ('budget_vs_ppy_cost_percent', Decimal('48111602.0000')), ('cost_mix_percent', Decimal('0.0000')), ('cost_actuals', Decimal('0.0000')), ('cost_of_goods_ly', Decimal('176017860.7600')), ('cost_act_forecast', Decimal('954765123.1100')), ('cost_act_forecast_vs_budget_perc', Decimal('0.0000')), ('cost_act_forecast_vs_ly_percent', Decimal('0.0000')), ('cost_act_forecast_vs_ppy_percent', Decimal('0.0000')), ('cost_act_or_forecast_per_sku', Decimal('0.0000')), ('budget_margin_percent', Decimal('67254598559.1910')), ('budget_margin_mix_percent', Decimal('0.0000')), ('budget_vs_act_forecast_margin_percent', Decimal('0.0000')), ('margin_actuals', Decimal('0.0000')), ('margin_act_forecast', Decimal('0.0000')), ('units_per_sku_total', Decimal('4.2410')), ('units_per_sku_lly', Decimal('0.0000')), ('unit_buy_by_sku_total', Decimal('13609.4332')), ('unit_buy_by_sku_ly', Decimal('0.0000')), ('unit_buy_by_sku_lly', Decimal('0.0000')), ('initial_average_retail_price_ly', Decimal('0.0000')), ('initial_average_retail_price_lly', Decimal('0.0000')), ('budget_per_sku', Decimal('13609.4332')), ('budget_qty_ty', Decimal('0.0000')), ('Check_box', Decimal('0.0000'))]) 1 
 80 getData dictsize
1389.786514669 end of fetch data
(1, 80) output data shape
shape: (1, 80)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ final_pri ┆ act_forec ┆ SalesActu ┆ initial_a ┆ … ┆ initial_a ┆ budget_pe ┆ budget_qt ┆ Check_bo │
│ ce        ┆ ast_vs_bu ┆ alsByFore ┆ verage_re ┆   ┆ verage_re ┆ r_sku     ┆ y_ty      ┆ x        │
│ ---       ┆ dget_perc ┆ cast      ┆ tail_pric ┆   ┆ tail_pric ┆ ---       ┆ ---       ┆ ---      │
│ f64       ┆ ent       ┆ ---       ┆ e         ┆   ┆ e_lly     ┆ f64       ┆ f64       ┆ f64      │
│           ┆ ---       ┆ f64       ┆ ---       ┆   ┆ ---       ┆           ┆           ┆          │
│           ┆ f64       ┆           ┆ f64       ┆   ┆ f64       ┆           ┆           ┆          │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ 0.0       ┆ 0.0       ┆ 0.0       ┆ 11758.768 ┆ … ┆ 0.0       ┆ 13609.433 ┆ 0.0       ┆ 0.0      │
│           ┆           ┆           ┆ 325       ┆   ┆           ┆ 2         ┆           ┆          │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘ the data grp 2
Error in grpby sttsxxx withot cols, with S_F_S is 'OTB' object has no attribute 'call_filter'
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/operations.py", line 575, in apply_group_by
    OTB.SUB_FILTER = OTB.call_filter(DATA.filter(list(filter_condition)), OTB.SUB_FILTER, group, DATA)
AttributeError: 'OTB' object has no attribute 'call_filter'. Did you mean: 'main_filters'?

['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] cccccccoooolllls
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box'] columns_after_main_gpby
shape: (1, 1)
┌───────────────────┐
│ ly_margin_percent │
│ ---               │
│ f64               │
╞═══════════════════╡
│ 67.560222         │
└───────────────────┘ ly_mgn
shape: (1, 8)
┌────────────┬────────────┬────────────┬───────────┬───────────┬───────────┬───────────┬───────────┐
│ ly_custome ┆ net_sales_ ┆ supply_ret ┆ FirstMarg ┆ retail_va ┆ proposed_ ┆ PurchaseR ┆ markdown_ │
│ r_disc     ┆ ly         ┆ ail_value  ┆ in_percen ┆ lue_inclu ┆ sellthru_ ┆ etailValu ┆ percent   │
│ ---        ┆ ---        ┆ ---        ┆ t         ┆ ding_mark ┆ percent   ┆ eatGrossS ┆ ---       │
│ f64        ┆ f64        ┆ f64        ┆ ---       ┆ down      ┆ ---       ┆ ale       ┆ f64       │
│            ┆            ┆            ┆ f64       ┆ ---       ┆ f64       ┆ ---       ┆           │
│            ┆            ┆            ┆           ┆ f64       ┆           ┆ f64       ┆           │
╞════════════╪════════════╪════════════╪═══════════╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1.2464e7   ┆ 5.4260e8   ┆ 1.5644e9   ┆ 42.02084  ┆ 1.6003e9  ┆ 9.149258  ┆ 1.7491e10 ┆ 2.245454  │
└────────────┴────────────┴────────────┴───────────┴───────────┴───────────┴───────────┴───────────┘ the_disc
111111
222222222
['final_price', 'act_forecast_vs_budget_percent', 'SalesActualsByForecast', 'initial_average_retail_price', 'proposed_sellthru_percent', 'retail_value_including_markdown', 'budget_gross_margin_percent', 'Logistic%', 'adjusted_budget_gross_margin_percent', 'MarkdownValue', 'markdown_percent', 'DisplayItemValue', 'budget_amount', 'budget_cost', 'deficit', 'Original_BudgetAmount', 'budget_percent', 'relative_budget_percent', 'History_Net_Sales', 'budget_qty', 'ACT_FCT', 'Original_BudgetCostofGoods', 'PO', 'COSTPRICE', 'Historical_Gross_Margin', 'sales_actual', 'stock_on_hand_qty', 'net_sales_ly', 'net_sales_lly', 'gross_sales_ly', 'total_sku_count', 'ly_customer_disc', 'SupplyCost', 'SALESQTY', 'DisplayItemQty', 'COR_EOLStock_value', 'Budget_Qty_Perc', 'budget_qty_act_fct_percent', 'budget_vs_py_qty_percent', 'budget_vs_ppy_qty_percent', 'QTY_Buy_By_SKU', 'total_sku_count_ty', 'total_sku_count_lly', 'total_sku_count_ly', 'quantity_mix_percent', 'quantity_act_forecast', 'quantity_act_forecast_vs_budget_percent', 'sold_qty_ly', 'quantity_act_forecast_vs_ly_percent', 'quantity_act_or_forecast_per_sku', 'quantity_act_forecast_vs_ppy_percent', 'budget_cost_percent', 'budget_vs_act_forecast_cost_percent', 'cost_budget_per_sku', 'BudgetCostofGoods', 'budget_vs_py_cost_percent', 'budget_vs_ppy_cost_percent', 'cost_mix_percent', 'cost_actuals', 'cost_of_goods_ly', 'cost_act_forecast', 'cost_act_forecast_vs_budget_perc', 'cost_act_forecast_vs_ly_percent', 'cost_act_forecast_vs_ppy_percent', 'cost_act_or_forecast_per_sku', 'budget_margin_percent', 'budget_margin_mix_percent', 'budget_vs_act_forecast_margin_percent', 'margin_actuals', 'margin_act_forecast', 'units_per_sku_total', 'units_per_sku_lly', 'unit_buy_by_sku_total', 'unit_buy_by_sku_ly', 'unit_buy_by_sku_lly', 'initial_average_retail_price_ly', 'initial_average_retail_price_lly', 'budget_per_sku', 'budget_qty_ty', 'Check_box', 'budget_vpy', 'budget_vppy', 'LYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_ly', 'LLYvsACT_FCT_percent', 'SALES_ACT_FCT_per_sku_lly', 'FirstMargin_percent', 'PurchasedRetailValueGrossSale', 'ly_margin_percent', 'ly_margin', 'margin_act_forecast_vs_ly_margin_percent', 'margin_act_or_forecast_per_sku', 'budget_gross_margin', 'budget_vs_py_margin_percent', 'StockatRetailPrice', 'StockatCostPrice', 'TYForecast', 'GrossSales', 'supply_retail_value', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] after 222222222
thread '<unnamed>' panicked at crates/polars-plan/src/logical_plan/optimizer/simplify_expr.rs:311:14:
called `Option::unwrap()` on a `None` value
[<Expr ['col("final_price").mean()'] at 0x76A23116B550>, <Expr ['col("act_forecast_vs_budget_pe…'] at 0x76A23116A710>, <Expr ['col("SalesActualsByForecast").…'] at 0x76A23116B9A0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A23116BDC0>, <Expr ['col("proposed_sellthru_percent…'] at 0x76A23116BA60>, <Expr ['col("retail_value_including_ma…'] at 0x76A23116A6B0>, <Expr ['col("budget_gross_margin_perce…'] at 0x76A23116A2C0>, <Expr ['col("Logistic%").mean()'] at 0x76A23116BFD0>, <Expr ['col("adjusted_budget_gross_mar…'] at 0x76A23116A4A0>, <Expr ['col("MarkdownValue").mean()'] at 0x76A23116A740>, <Expr ['col("markdown_percent").mean()'] at 0x76A231168D90>, <Expr ['col("DisplayItemValue").mean()'] at 0x76A231168F10>, <Expr ['col("budget_amount").sum()'] at 0x76A23116A6E0>, <Expr ['col("budget_cost").sum()'] at 0x76A2311683A0>, <Expr ['col("deficit").sum()'] at 0x76A231168580>, <Expr ['col("Original_BudgetAmount").s…'] at 0x76A2311683D0>, <Expr ['col("budget_percent").sum()'] at 0x76A23116B9D0>, <Expr ['col("relative_budget_percent")…'] at 0x76A2311687F0>, <Expr ['col("History_Net_Sales").sum()'] at 0x76A23116A2F0>, <Expr ['col("budget_qty").sum()'] at 0x76A231169390>, <Expr ['col("ACT_FCT").sum()'] at 0x76A231168EE0>, <Expr ['col("Original_BudgetCostofGood…'] at 0x76A23116B280>, <Expr ['col("PO").sum()'] at 0x76A231168E80>, <Expr ['col("COSTPRICE").sum()'] at 0x76A231168C10>, <Expr ['col("Historical_Gross_Margin")…'] at 0x76A231168190>, <Expr ['col("sales_actual").sum()'] at 0x76A231168DF0>, <Expr ['col("stock_on_hand_qty").sum()'] at 0x76A23116B400>, <Expr ['col("net_sales_ly").sum()'] at 0x76A2311689D0>, <Expr ['col("net_sales_lly").sum()'] at 0x76A231168610>, <Expr ['col("gross_sales_ly").sum()'] at 0x76A2311689A0>, <Expr ['col("total_sku_count").sum()'] at 0x76A231168A00>, <Expr ['col("ly_customer_disc").sum()'] at 0x76A231168880>, <Expr ['col("SupplyCost").sum()'] at 0x76A23116A3E0>, <Expr ['col("SALESQTY").sum()'] at 0x76A23116ADA0>, <Expr ['col("DisplayItemQty").sum()'] at 0x76A231169090>, <Expr ['col("COR_EOLStock_value").sum(…'] at 0x76A23116B580>, <Expr ['col("Budget_Qty_Perc").sum()'] at 0x76A231168460>, <Expr ['col("budget_qty_act_fct_percen…'] at 0x76A231168A90>, <Expr ['col("budget_vs_py_qty_percent"…'] at 0x76A2311686A0>, <Expr ['col("budget_vs_ppy_qty_percent…'] at 0x76A231168A60>, <Expr ['col("QTY_Buy_By_SKU").sum()'] at 0x76A231168A30>, <Expr ['col("total_sku_count_ty").sum(…'] at 0x76A23116B430>, <Expr ['col("total_sku_count_lly").sum…'] at 0x76A231168430>, <Expr ['col("total_sku_count_ly").sum(…'] at 0x76A231168760>, <Expr ['col("quantity_mix_percent").su…'] at 0x76A2311682E0>, <Expr ['col("quantity_act_forecast").s…'] at 0x76A231168AC0>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A231168550>, <Expr ['col("sold_qty_ly").sum()'] at 0x76A231168640>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A2311685B0>, <Expr ['col("quantity_act_or_forecast_…'] at 0x76A23116BD00>, <Expr ['col("quantity_act_forecast_vs_…'] at 0x76A231168250>, <Expr ['col("budget_cost_percent").sum…'] at 0x76A2311682B0>, <Expr ['col("budget_vs_act_forecast_co…'] at 0x76A23116AEF0>, <Expr ['col("cost_budget_per_sku").sum…'] at 0x76A23116B070>, <Expr ['col("BudgetCostofGoods").sum()'] at 0x76A231169270>, <Expr ['col("budget_vs_py_cost_percent…'] at 0x76A23116AF20>, <Expr ['col("budget_vs_ppy_cost_percen…'] at 0x76A23116B010>, <Expr ['col("cost_mix_percent").sum()'] at 0x76A23116ACB0>, <Expr ['col("cost_actuals").sum()'] at 0x76A23116A830>, <Expr ['col("cost_of_goods_ly").sum()'] at 0x76A23116AE00>, <Expr ['col("cost_act_forecast").sum()'] at 0x76A23116BEB0>, <Expr ['col("cost_act_forecast_vs_budg…'] at 0x76A2311681F0>, <Expr ['col("cost_act_forecast_vs_ly_p…'] at 0x76A23116ADD0>, <Expr ['col("cost_act_forecast_vs_ppy_…'] at 0x76A231168790>, <Expr ['col("cost_act_or_forecast_per_…'] at 0x76A23116AFB0>, <Expr ['col("budget_margin_percent").s…'] at 0x76A231168490>, <Expr ['col("budget_margin_mix_percent…'] at 0x76A231168730>, <Expr ['col("budget_vs_act_forecast_ma…'] at 0x76A91646A7D0>, <Expr ['col("margin_actuals").sum()'] at 0x76A916468CA0>, <Expr ['col("margin_act_forecast").sum…'] at 0x76A59C50A140>, <Expr ['col("units_per_sku_total").sum…'] at 0x76A91646A6B0>, <Expr ['col("units_per_sku_lly").sum()'] at 0x76A91646A5C0>, <Expr ['col("unit_buy_by_sku_total").s…'] at 0x76A91646A5F0>, <Expr ['col("unit_buy_by_sku_ly").sum(…'] at 0x76A91646A560>, <Expr ['col("unit_buy_by_sku_lly").sum…'] at 0x76A91646A4A0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A91646A4D0>, <Expr ['col("initial_average_retail_pr…'] at 0x76A91646A470>, <Expr ['col("budget_per_sku").sum()'] at 0x76A91646A500>, <Expr ['col("budget_qty_ty").sum()'] at 0x76A91646A3B0>, <Expr ['col("Check_box").max()'] at 0x76A91646A320>] aggregation_dict
<class 'polars.dataframe.frame.DataFrame'> the bottom column/series or frame
we are at bottom margin calculations
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/parameters.py", line 1432, in bottom_margin_calculation
    df = df.with_columns((((pl.col('cost_of_goods_ly')/(pl.col('cost_of_goods_ly')+pl.col('stock_cost_ly'))).replace({np.inf:0, -np.inf:0}).fill_nan(0))*100).alias('proposed_sellthru_percent'))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/dataframe/frame.py", line 8302, in with_columns
    return self.lazy().with_columns(*exprs, **named_exprs).collect(_eager=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 1937, in collect
    return wrap_df(ldf.collect())
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value

bottom mg calc completed
1
2
3
Traceback (most recent call last):
  File "/home/ubuntu/OTB_API/routes/__init__.py", line 462, in get_data_ws
    bottom_column[float_cols] = bottom_column[float_cols].astype(float)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1144, in __getitem__
    return self._get_with(key)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/series.py", line 1185, in _get_with
    return self.loc[key]
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1420, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1360, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexing.py", line 1558, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PurchasedRetailValueGrossSale', 'PurchaseRetailValueatGrossSale', 'OTBorPurchaseCost', 'OTBquantity'] not in index"
 bo_co_ser
4
{"columns":["final_price","act_forecast_vs_budget_percent","SalesActualsByForecast","initial_average_retail_price","proposed_sellthru_percent","retail_value_including_markdown","budget_gross_margin_percent","Logistic%","adjusted_budget_gross_margin_percent","MarkdownValue","markdown_percent","DisplayItemValue","budget_amount","budget_cost","deficit","Original_BudgetAmount","budget_percent","relative_budget_percent","History_Net_Sales","budget_qty","ACT_FCT","Original_BudgetCostofGoods","PO","COSTPRICE","Historical_Gross_Margin","sales_actual","stock_on_hand_qty","net_sales_ly","net_sales_lly","gross_sales_ly","total_sku_count","ly_customer_disc","SupplyCost","SALESQTY","DisplayItemQty","COR_EOLStock_value","Budget_Qty_Perc","budget_qty_act_fct_percent","budget_vs_py_qty_percent","budget_vs_ppy_qty_percent","QTY_Buy_By_SKU","total_sku_count_ty","total_sku_count_lly","total_sku_count_ly","quantity_mix_percent","quantity_act_forecast","quantity_act_forecast_vs_budget_percent","sold_qty_ly","quantity_act_forecast_vs_ly_percent","quantity_act_or_forecast_per_sku","quantity_act_forecast_vs_ppy_percent","budget_cost_percent","budget_vs_act_forecast_cost_percent","cost_budget_per_sku","BudgetCostofGoods","budget_vs_py_cost_percent","budget_vs_ppy_cost_percent","cost_mix_percent","cost_actuals","cost_of_goods_ly","cost_act_forecast","cost_act_forecast_vs_budget_perc","cost_act_forecast_vs_ly_percent","cost_act_forecast_vs_ppy_percent","cost_act_or_forecast_per_sku","budget_margin_percent","budget_margin_mix_percent","budget_vs_act_forecast_margin_percent","margin_actuals","margin_act_forecast","units_per_sku_total","units_per_sku_lly","unit_buy_by_sku_total","unit_buy_by_sku_ly","unit_buy_by_sku_lly","initial_average_retail_price_ly","initial_average_retail_price_lly","budget_per_sku","budget_qty_ty","Check_box","budget_vpy","budget_vppy","LYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_ly","LLYvsACT_FCT_percent","SALES_ACT_FCT_per_sku_lly","FirstMargin_percent","PurchasedRetailValueGrossSale","ly_margin_percent","ly_margin","margin_act_forecast_vs_ly_margin_percent","margin_act_or_forecast_per_sku","budget_gross_margin","budget_vs_py_margin_percent","StockatRetailPrice","StockatCostPrice","TYForecast","GrossSales","supply_retail_value","PurchaseRetailValueatGrossSale","OTBorPurchaseCost","OTBquantity"],"index":[0],"data":[[0.0,0.0,0.0,11758.7683247113,9.1492581023,1600336360.8479371071,38.9693056464,5.0,38.9693056464,1246367433.0000002384,2.2454541723,0.0,1564401541.2620444298,954765123.1099796295,1564401541.2232999802,1564401541.2232999802,100.0,100.0,0.0,619895.0,0.0,954765123.1100000143,1272173792.5232999325,176226570.2900007367,0.0,0.0,441256.0,542598837.4600000381,347973.4,555062511.7899999619,114950.0,12463674.3300000001,907026866.9555000067,104890.0,0.0,0.0,103.1495,61989500.0,54058575.2879000008,61985268.1811000034,619895.0,7555708056.0,41.0,11137.0,100.146,619895.0,0.0,104617.0,10038300.0,0.0,0.0,0.3551,0.0,0.0,954765123.1100000143,17234755999.0,48111602.0,0.0,0.0,176017860.7599999905,954765123.1100000143,0.0,0.0,0.0,0.0,67254598559.1910018921,0.0,0.0,0.0,0.0,4.241,0.0,13609.4332,0.0,0.0,0.0,0.0,13609.4332,0.0,0.0,288.3164196564,449575.0368453578,0.0,0.0,100.0,0.0,42.0208403641,5188627075.88879776,67.5602215471,366580976.7000000477,0.0,0.0,609636418.1520648003,9023600.0443988331,5188627075.88879776,1683179128.1651751995,5188627075.88879776,1600336360.8479371071,1564401541.2620444298,17491433108.0568351746,10141385924.3347568512,6584440.7963793408]], "select_all_kpi":false,"editable_cols":["Logistic%", "DisplayItemQty", "COR_EOLStock_value", "markdown_percent", "proposed_sellthru_percent", "DisplayItemValue"], "percent_col":["new_budget_mix", "budget_percent", "relative_budget_percent", "act_forecast_vs_budget_percent", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "markdown_percent", "FirstMargin_percent", "proposed_sellthru_percent", "LYvsACT_FCT_percent", "coefficient_score_mix_percent", "budget_vpy"],"tabs":{"BudgetValue": ["Check_box", "Channel", "Region", "StoreId", "Store", "Department", "Family", "SubFamily", "Supplier", "Category", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "Status", "ENDOFLife", "Description", "ITEMID", "historical_year", "history_quarter", "history_month", "history_week", "history_day", "INVOICEDATE", "Budget_Year", "budget_quarter", "budget_month", "budget_week", "Budget_date", "budget_day", "revised_budget_amount", "new_budget_mix", "budget_amount", "budget_percent", "BudgetCostofGoods", "budget_qty", "budget_gross_margin_percent", "adjusted_budget_gross_margin_percent", "Logistic%", "SupplyCost", "FirstMargin_percent", "markdown_percent", "MarkdownValue", "proposed_sellthru_percent", "retail_value_including_markdown", "StockatRetailPrice", "DisplayItemQty", "DisplayItemValue", "COR_EOLStock_value", "TYForecast", "PurchaseRetailValueatGrossSale", "OTBorPurchaseCost", "OTBquantity", "stock_on_hand_qty", "initial_average_retail_price", "StockatCostPrice", "total_sku_count", "units_per_sku_total", "budget_per_sku", "sales_actual", "ACT_FCT", "act_forecast_vs_budget_percent", "net_sales_ly", "cost_of_goods_ly", "gross_sales_ly", "ly_margin_percent", "budget_vpy", "LYvsACT_FCT_percent", "initial_average_retail_price_ly", "unit_buy_by_sku_ly", "SALES_ACT_FCT_per_sku_ly", "total_sku_count_ly", "net_sales_lly", "LLYvsACT_FCT_percent", "initial_average_retail_price_lly", "unit_buy_by_sku_lly", "SALES_ACT_FCT_per_sku_lly", "total_sku_count_lly", "final_price"], "BudgetCost": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "BudgetCostofGoods", "budget_vs_py_cost_percent", "cost_mix_percent", "cost_actuals", "cost_act_forecast", "cost_act_forecast_vs_budget_perc", "cost_of_goods_ly", "cost_act_forecast_vs_ly_percent", "cost_act_or_forecast_per_sku", "stock_cost_ly"], "BudgetQuantity": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_qty", "Budget_Qty_Perc", "budget_qty_act_fct_percent", "budget_vs_py_qty_percent", "budget_vs_ppy_qty_percent", "QTY_Buy_By_SKU", "total_sku_count", "unit_buy_by_sku_total", "SKU_COUNT", "quantity_mix_percent", "quantity_actuals", "quantity_act_forecast", "quantity_act_forecast_vs_budget_percent", "sold_qty_ly", "quantity_act_forecast_vs_ly_percent", "quantity_act_or_forecast_per_sku", "quantity_ppy", "quantity_act_forecast_vs_ppy_percent"], "BudgetMargin": ["Channel", "Region", "StoreId", "Store", "Department", "Category", "Family", "SubFamily", "Supplier", "DOM_COMM", "SubCategory", "ExtendedSubCategory", "SubCategorySupplier", "AssemblyCodeNickName", "ITEMID", "Status", "ENDOFLife", "Description", "Budget_Year", "historical_year", "budget_margin_percent", "budget_margin_mix_percent", "budget_vs_act_forecast_margin_percent", "budget_vs_py_margin_percent", "budget_vs_ppy_margin_percent", "ly_margin", "margin_act_forecast_vs_ly_percent", "total_sku_count", "margin_budget_per_sku", "margin_act_or_forecast_per_sku", "lly_margin", "margin_act_forecast_vs_ppy_percent", "margin_actuals", "margin_act_forecast", "budget_gross_margin_percent", "Historical_Gross_Margin", "adjusted_budget_gross_margin_percent", "FirstMargin_percent", "proposed_sellthru_percent"]} ,"items":1,"total":{"final_price":0.0,"act_forecast_vs_budget_percent":0.0,"SalesActualsByForecast":0.0,"initial_average_retail_price":11758.7683247113,"proposed_sellthru_percent":9.1492581023,"retail_value_including_markdown":1600336360.8479371071,"budget_gross_margin_percent":38.9693056464,"Logistic%":5.0,"adjusted_budget_gross_margin_percent":38.9693056464,"MarkdownValue":1246367433.0000002384,"markdown_percent":2.2454541723,"DisplayItemValue":0.0,"budget_amount":1564401541.2620444298,"budget_cost":954765123.1099796295,"deficit":1564401541.2232999802,"Original_BudgetAmount":1564401541.2232999802,"budget_percent":100.0,"relative_budget_percent":100.0,"History_Net_Sales":0.0,"budget_qty":619895.0,"ACT_FCT":0.0,"Original_BudgetCostofGoods":954765123.1100000143,"PO":1272173792.5232999325,"COSTPRICE":176226570.2900007367,"Historical_Gross_Margin":0.0,"sales_actual":0.0,"stock_on_hand_qty":441256.0,"net_sales_ly":542598837.4600000381,"net_sales_lly":347973.4,"gross_sales_ly":555062511.7899999619,"total_sku_count":114950.0,"ly_customer_disc":12463674.3300000001,"SupplyCost":907026866.9555000067,"SALESQTY":104890.0,"DisplayItemQty":0.0,"COR_EOLStock_value":0.0,"Budget_Qty_Perc":103.1495,"budget_qty_act_fct_percent":61989500.0,"budget_vs_py_qty_percent":54058575.2879000008,"budget_vs_ppy_qty_percent":61985268.1811000034,"QTY_Buy_By_SKU":619895.0,"total_sku_count_ty":7555708056.0,"total_sku_count_lly":41.0,"total_sku_count_ly":11137.0,"quantity_mix_percent":100.146,"quantity_act_forecast":619895.0,"quantity_act_forecast_vs_budget_percent":0.0,"sold_qty_ly":104617.0,"quantity_act_forecast_vs_ly_percent":10038300.0,"quantity_act_or_forecast_per_sku":0.0,"quantity_act_forecast_vs_ppy_percent":0.0,"budget_cost_percent":0.3551,"budget_vs_act_forecast_cost_percent":0.0,"cost_budget_per_sku":0.0,"BudgetCostofGoods":954765123.1100000143,"budget_vs_py_cost_percent":17234755999.0,"budget_vs_ppy_cost_percent":48111602.0,"cost_mix_percent":0.0,"cost_actuals":0.0,"cost_of_goods_ly":176017860.7599999905,"cost_act_forecast":954765123.1100000143,"cost_act_forecast_vs_budget_perc":0.0,"cost_act_forecast_vs_ly_percent":0.0,"cost_act_forecast_vs_ppy_percent":0.0,"cost_act_or_forecast_per_sku":0.0,"budget_margin_percent":67254598559.1910018921,"budget_margin_mix_percent":0.0,"budget_vs_act_forecast_margin_percent":0.0,"margin_actuals":0.0,"margin_act_forecast":0.0,"units_per_sku_total":4.241,"units_per_sku_lly":0.0,"unit_buy_by_sku_total":13609.4332,"unit_buy_by_sku_ly":0.0,"unit_buy_by_sku_lly":0.0,"initial_average_retail_price_ly":0.0,"initial_average_retail_price_lly":0.0,"budget_per_sku":13609.4332,"budget_qty_ty":0.0,"Check_box":0.0,"ly_margin_percent":67.5602215471,"FirstMargin_percent":42.0208403641,"budget_vpy":288.3164196564,"budget_vppy":449575.0368453578,"StockatRetailPrice":5188627075.88879776,"TYForecast":5188627075.88879776,"LYvsACT_FCT_percent":100.0,"supply_retail_value":1564401541.2620444298} }INFO:     connection closed
 data_json
WebSocket connection closed unexpectedly
INFO:     205.210.31.45:60952 - "GET / HTTP/1.1" 200 OK
INFO:     167.94.138.55:0 - "GET / HTTP/1.1" 200 OK
INFO:     167.94.138.55:0 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     198.235.24.68:0 - "GET / HTTP/1.1" 200 OK
INFO:     198.235.24.33:0 - "GET / HTTP/1.1" 200 OK
INFO:     198.235.24.228:0 - "GET / HTTP/1.1" 200 OK
INFO:     170.64.186.19:0 - "GET / HTTP/1.1" 200 OK
INFO:     45.33.109.8:0 - "GET / HTTP/1.1" 200 OK
INFO:     45.79.181.179:0 - "GET / HTTP/1.1" 200 OK
INFO:     161.35.49.163:49780 - "GET / HTTP/1.1" 200 OK
INFO:     66.228.56.68:0 - "GET / HTTP/1.1" 200 OK
INFO:     205.210.31.136:0 - "GET / HTTP/1.1" 200 OK
WARNING:  Invalid HTTP request received.
INFO:     205.210.31.131:58820 - "GET / HTTP/1.1" 200 OK
INFO:     45.79.115.134:53512 - "GET / HTTP/1.1" 200 OK
INFO:     45.79.181.223:29446 - "GET / HTTP/1.1" 200 OK
INFO:     205.210.31.41:58594 - "GET / HTTP/1.1" 200 OK
INFO:     198.235.24.9:0 - "GET / HTTP/1.1" 200 OK
WARNING:  Invalid HTTP request received.
WARNING:  Invalid HTTP request received.
INFO:     152.42.184.95:0 - "GET / HTTP/1.1" 200 OK
INFO:     152.42.184.95:0 - "GET /favicon.ico HTTP/1.1" 404 Not Found
WARNING:  Invalid HTTP request received.
WARNING:  Invalid HTTP request received.
INFO:     139.59.127.19:34080 - "GET / HTTP/1.1" 200 OK
INFO:     139.59.127.19:34092 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     198.235.24.133:0 - "GET / HTTP/1.1" 200 OK
INFO:     185.242.226.54:48622 - "GET / HTTP/1.1" 200 OK
INFO:     205.210.31.158:61104 - "GET / HTTP/1.1" 200 OK
INFO:     205.210.31.162:63680 - "GET / HTTP/1.1" 200 OK
WARNING:  Invalid HTTP request received.
INFO:     198.235.24.140:62288 - "GET / HTTP/1.1" 200 OK
INFO:     147.185.132.40:0 - "GET / HTTP/1.1" 200 OK
INFO:     ('117.255.66.226', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection open
INFO:     connection closed
INFO:     ('61.1.194.101', 0) - "WebSocket /otb/get_data_ws" [accepted]
INFO:     connection open
Jun 25 14:04:15 ip-172-31-18-59 uvicorn[860567]: INFO:     Started parent process [860567]
Jun 25 14:04:17 ip-172-31-18-59 uvicorn[860577]: INFO:     Started server process [860577]
Jun 25 14:04:17 ip-172-31-18-59 uvicorn[860577]: INFO:     Waiting for application startup.
Jun 25 14:04:17 ip-172-31-18-59 uvicorn[860577]: INFO:     Application startup complete.
Jun 25 14:04:17 ip-172-31-18-59 uvicorn[860578]: INFO:     Started server process [860578]
Jun 25 14:04:17 ip-172-31-18-59 uvicorn[860578]: INFO:     Waiting for application startup.
Jun 25 14:04:17 ip-172-31-18-59 uvicorn[860578]: INFO:     Application startup complete.
Jun 25 14:04:20 ip-172-31-18-59 uvicorn[860577]: 1
Jun 25 14:04:20 ip-172-31-18-59 uvicorn[860577]: INFO:     ('49.205.144.113', 0) - "WebSocket /otb/get_data_ws" [accepted]
Jun 25 14:04:20 ip-172-31-18-59 uvicorn[860577]: INFO:     connection open
Jun 25 14:04:44 ip-172-31-18-59 uvicorn[860577]: WebSocket connection closed unexpectedly
Jun 25 14:04:44 ip-172-31-18-59 uvicorn[860577]: INFO:     connection closed
